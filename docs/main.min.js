!function($global){"use strict";var $_,$hxClasses={},$estr=function(){return js_Boot.__string_rec(this,"")},$hxEnums=$hxEnums||{};function $extend(from,fields){var proto=Object.create(from);for(var name in fields)proto[name]=fields[name];return fields.toString!==Object.prototype.toString&&(proto.toString=fields.toString),proto}var BulletPatterns=function(){};$hxClasses.BulletPatterns=BulletPatterns,BulletPatterns.__name__="BulletPatterns",BulletPatterns.get=function(patternName){var value;switch(patternName){case"aim":value=BulletPatterns.aimDemo();break;case"bind-position":value=BulletPatterns.bindPosition();break;case"control-flow":value=BulletPatterns.controlFlow();break;case"default":value=BulletPatterns.firedancerDemo();break;case"fire-with-pattern":value=BulletPatterns.fireWithPattern();break;case"laundry":value=BulletPatterns.laundry();break;case"move":value=BulletPatterns.move();break;case"move-2":value=BulletPatterns.move2();break;case"nway-radial-line":value=BulletPatterns.nwayRadialLine();break;case"nway-whip":value=BulletPatterns.nWayWhip();break;case"parallel":value=BulletPatterns.parallelDemo();break;case"random":value=BulletPatterns.randomDemo();break;case"shot-direction":value=BulletPatterns.shotDirection();break;case"shot-position":value=BulletPatterns.shotPosition();break;case"shot-speed":value=BulletPatterns.shotSpeed();break;case"sin-cos":value=BulletPatterns.sinCos();break;case"transform":value=BulletPatterns.transform();break;case"vanish":value=BulletPatterns.vanishDemo();break;case"variables":value=BulletPatterns.variables();break;default:value=null}return value},BulletPatterns.defaultPattern=function(){return BulletPatterns.firedancerDemo()},BulletPatterns.firedancerDemo=function(){firedancer_script_Api.shot.speed;var main=new firedancer_script_nodes_SetActorProperty(3,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(3,1))))),nodes=firedancer_script_ApiEx.radial(firedancer_script_ApiEx.nWay(firedancer_script_Api.fire(),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(7)),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(30,.017453292519943295)))}),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(2))}),main1=(firedancer_script_Api.shot.direction,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(30,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(15)))]))),nodes1=(firedancer_script_Api.shot.direction,nodes=new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(90,.017453292519943295))))),firedancer_script_ApiEx.radial(firedancer_script_ApiEx.line(firedancer_script_Api.fire(),{count:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(7)),shotSpeedChange:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(1.2,1)))}),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(2))})),main2=(firedancer_script_Api.shot.direction,[main,firedancer_script_Api.parallel([main1,new firedancer_script_nodes_List([nodes,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes1,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(30,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(15)))]))])])]);return BulletPatterns.asMain(new firedancer_script_nodes_List(main2),"")},BulletPatterns.controlFlow=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=[new firedancer_script_nodes_SetActorVector(3,vec),firedancer_script_Api.loop(new firedancer_script_nodes_List([firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60))),firedancer_script_Api.rep(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(8)),new firedancer_script_nodes_List([firedancer_script_Api.fire(),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(10)))]))]))];return BulletPatterns.asMain(new firedancer_script_nodes_List(main),"// Elements in an array are executed sequentially.\r\n\r\n[\r\n\tshot.velocity.set(4, 180), // (see other examples)\r\n\tloop([ // infinite loop\r\n\t\twait(60), // wait 60 frames = 1 second\r\n\t\trep(8, [ // repeat 8 times\r\n\t\t\tfire(), // emit a new actor (= bullet, enemy etc.)\r\n\t\t\twait(10)\r\n\t\t])\r\n\t])\r\n];")},BulletPatterns.move=function(){var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(8,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),nodes=new firedancer_script_nodes_SetActorVector(1,vec),nodes1=firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30))),main=(vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(16,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,.017453292519943295)))}),firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,nodes1,new firedancer_script_nodes_AddActorProperty(1,firedancer_script_nodes_ActorPropertyAddOperation.AddVector(vec)),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30))),new firedancer_script_nodes_SetActorProperty(1,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60)))])));return BulletPatterns.asMain(main,"/*\r\n\tTerminology:\r\n\t\tposition = { r: distance, θ: bearing }\r\n\t\tvelocity = { r: speed,  θ: direction }\r\n\r\n\tAngle values are in degrees, north-based and clockwise.\r\n*/\r\n\r\nloop([\r\n\tvelocity.set(8, 180), // polar coords (length, angle) at default\r\n\twait(30),\r\n\tvelocity.add(16, 0), // you can either set or add\r\n\twait(30),\r\n\tspeed.set(0), // set/add length or angle independently\r\n\twait(30),\r\n\tfire(),\r\n\twait(30)\r\n]);")},BulletPatterns.move2=function(){var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(16,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),nodes=new firedancer_script_nodes_SetActorVector(1,vec).frames(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60))),nodes1=new firedancer_script_nodes_SetActorProperty(1,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))))),nodes2=firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30))),main=(firedancer_script_Api.velocity.cartesian,vec=firedancer_script_expression_VecExpression.fromCartesianExpressions({x:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))),y:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(-16,1)))}),firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,nodes1,nodes2,new firedancer_script_nodes_SetActorVector(1,vec),new firedancer_script_nodes_SetActorProperty(1,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))))).frames(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30)))])));return BulletPatterns.asMain(main,"loop([\r\n\tvelocity.set(16, 180).frames(60), // change gradually\r\n\tspeed.set(0),\r\n\twait(30),\r\n\tvelocity.cartesian.set(0, -16), // cartesian coords\r\n\tspeed.set(0).frames(60),\r\n\twait(30),\r\n]);")},BulletPatterns.shotSpeed=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(3,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),nodes=new firedancer_script_nodes_SetActorVector(3,vec),nodes1=new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(20)),nodes2=firedancer_script_Api.fire(),main=(firedancer_script_Api.shot.speed,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,firedancer_script_Api.rep(nodes1,new firedancer_script_nodes_List([nodes2,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(.5,1))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4)))])),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60)))])));return BulletPatterns.asMain(main,"loop([\r\n\tshot.velocity.set(5, 180),\r\n\trep(30, [\r\n\t\tfire(),\r\n\t\tshot.speed.add(1),\r\n\t\twait(1)\r\n\t]),\r\n\twait(60)\r\n]);")},BulletPatterns.shotDirection=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(5,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=new firedancer_script_nodes_SetActorVector(3,vec),nodes=firedancer_script_Api.fire(),main1=(firedancer_script_Api.shot.direction,[main,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(12,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(1)))]))]);return BulletPatterns.asMain(new firedancer_script_nodes_List(main1),"[\r\n\tshot.velocity.set(5, 180),\r\n\tloop([\r\n\t\tfire(),\r\n\t\tshot.direction.add(12),\r\n\t\twait(1)\r\n\t])\r\n];")},BulletPatterns.shotPosition=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(6,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),nodes=new firedancer_script_nodes_SetActorVector(3,vec),nodes1=(firedancer_script_Api.shot.position,vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(150,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),new firedancer_script_nodes_SetActorVector(2,vec)),nodes2=firedancer_script_Api.fire(),main=(firedancer_script_Api.shot.bearing,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,nodes1,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes2,new firedancer_script_nodes_AddActorProperty(2,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(8,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(2)))]))])));return BulletPatterns.asMain(main,"loop([\r\n\t\t\tshot.velocity.set(6, 180), // { speed: 6, direction: 180 }\r\n\t\t\tshot.position.set(150, 180), // { distance: 150, bearing: 180 }\r\n\t\t\tloop([\r\n\t\t\t\tfire(),\r\n\t\t\t\tshot.bearing.add(8),\r\n\t\t\t\twait(2)\r\n\t\t\t])\r\n\t\t]);")},BulletPatterns.nwayRadialLine=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=firedancer_script_Api.loop(new firedancer_script_nodes_List([new firedancer_script_nodes_SetActorVector(3,vec),firedancer_script_ApiEx.nWay(firedancer_script_Api.fire(),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(10)),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(90,.017453292519943295)))}),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60))),firedancer_script_ApiEx.radial(firedancer_script_Api.fire(),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(36))}),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60))),firedancer_script_ApiEx.line(firedancer_script_Api.fire(),{count:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(10)),shotSpeedChange:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(10,1)))}),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(60)))]));return BulletPatterns.asMain(main,"loop([\r\n\tshot.velocity.set(4, 180),\r\n\tnWay(fire(), { ways: 10, angle: 90 }),\r\n\twait(60),\r\n\tradial(fire(), { ways: 36 }),\r\n\twait(60),\r\n\tline(fire(), { count: 10, shotSpeedChange: 10 }),\r\n\twait(60)\r\n]);\r\n\r\n/*\r\n\tnWay() and line() are shorthands for dup() with limited parameters.\r\n*/\r\n")},BulletPatterns.aimDemo=function(){firedancer_script_Api.shot.speed;var main=new firedancer_script_nodes_SetActorProperty(3,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(8,1))))),distance=(firedancer_script_Api.shot.position,new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(150,1)))),min=(firedancer_script_Api.random.angle,new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,.017453292519943295)))),vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:distance,angle:min.add(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.UnaryOperation(firedancer_assembly_Instruction.Random(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(360,.017453292519943295))).subtract(min)))))}),main1=[main,firedancer_script_Api.loop(new firedancer_script_nodes_List([new firedancer_script_nodes_SetActorVector(2,vec),firedancer_script_Api.aim(),firedancer_script_ApiEx.line(firedancer_script_Api.fire(),{count:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(8)),shotSpeedChange:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(6,1)))}),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(10)))]))];return BulletPatterns.asMain(new firedancer_script_nodes_List(main1),"[\r\n\tshot.speed.set(8),\r\n\tloop([\r\n\t\tshot.position.set(150, random.angle.between(0, 360)),\r\n\t\taim(), // sets shot direction to the angle to the target\r\n\t\tline(fire(), { count: 8, shotSpeedChange: 6 }),\r\n\t\twait(10)\r\n\t])\r\n];")},BulletPatterns.fireWithPattern=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(5,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=new firedancer_script_nodes_SetActorVector(3,vec),nodes=firedancer_script_Api.fire(new firedancer_script_nodes_List([firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30))),new firedancer_script_nodes_AddActorProperty(1,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(-120,.017453292519943295)))))])),main1=(firedancer_script_Api.shot.direction,[main,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(36,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(8)))]))]);return BulletPatterns.asMain(new firedancer_script_nodes_List(main1),"[\r\n\tshot.velocity.set(5, 180),\r\n\tloop([\r\n\t\tfire([\r\n\t\t\twait(30),\r\n\t\t\tdirection.add(-120)\r\n\t\t]),\r\n\t\tshot.direction.add(36),\r\n\t\twait(8)\r\n\t])\r\n];")},BulletPatterns.bindPosition=function(){var _this=firedancer_script_Api.shot.position,vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(30,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=new firedancer_script_nodes_SetActorVector(2,vec),nodes=new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(12));(_this=firedancer_script_Api.fire(firedancer_script_Api.loop(new firedancer_script_nodes_List([new firedancer_script_nodes_AddActorProperty(0,firedancer_script_nodes_ActorPropertyAddOperation.AddLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,1))))),new firedancer_script_nodes_AddActorProperty(0,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(1,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(1)))])))).bindPosition=!0;firedancer_script_Api.shot.bearing;var main1=[main,firedancer_script_Api.loop(new firedancer_script_nodes_List([firedancer_script_Api.rep(nodes,new firedancer_script_nodes_List([_this,new firedancer_script_nodes_AddActorProperty(2,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(30,.017453292519943295)))))])),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30)))]))];return BulletPatterns.asMain(new firedancer_script_nodes_List(main1),"/*\r\n\tIf you call bind() after fire(),\r\n\tthe position of fired actor will be\r\n\trelative from the actor that fired it.\r\n*/\r\n\r\n[\r\n\tshot.position.set(30, 180),\r\n\tloop([\r\n\t\trep(12, [\r\n\t\t\tfire(loop([\r\n\t\t\t\tdistance.add(4),\r\n\t\t\t\tbearing.add(1),\r\n\t\t\t\twait(1)\r\n\t\t\t])).bind(),\r\n\t\t\tshot.bearing.add(30),\r\n\t\t]),\r\n\t\twait(30)\r\n\t])\r\n];")},BulletPatterns.parallelDemo=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(5,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=new firedancer_script_nodes_SetActorVector(3,vec),main1=firedancer_script_Api.loop(new firedancer_script_nodes_List([firedancer_script_Api.fire(),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(8)))])),nodes=firedancer_script_Api.fire(),main2=(firedancer_script_Api.shot.direction,[main,firedancer_script_Api.parallel([main1,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(32,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4)))]))])]);return BulletPatterns.asMain(new firedancer_script_nodes_List(main2),"/*\r\n\tparallel() waits until all threads are completed, while\r\n\tasync() does not.\r\n*/\r\n\r\n[\r\n\tshot.velocity.set(5, 180),\r\n\tparallel([\r\n\t\tloop([\r\n\t\t\tfire(),\r\n\t\t\twait(8)\r\n\t\t]),\r\n\t\tloop([\r\n\t\t\tfire(),\r\n\t\t\tshot.direction.add(32),\r\n\t\t\twait(4)\r\n\t\t])\r\n\t])\r\n];")},BulletPatterns.vanishDemo=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(5,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=new firedancer_script_nodes_SetActorVector(3,vec),nodes=firedancer_script_Api.fire(new firedancer_script_nodes_List([firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30))),firedancer_script_Api.vanish()])),main1=(firedancer_script_Api.shot.direction,[main,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(12,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(1)))]))]);return BulletPatterns.asMain(new firedancer_script_nodes_List(main1),"[\r\n\tshot.velocity.set(5, 180),\r\n\tloop([\r\n\t\tfire([\r\n\t\t\twait(30),\r\n\t\t\tvanish()\r\n\t\t]),\r\n\t\tshot.direction.add(12),\r\n\t\twait(1)\r\n\t])\r\n];")},BulletPatterns.randomDemo=function(){firedancer_script_Api.shot.velocity;var min=new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(1,1))),speed=min.add(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.UnaryOperation(firedancer_assembly_Instruction.Random(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,1))).subtract(min))))),a=new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295))),vec=(firedancer_script_Api.random.angle,firedancer_script_expression_VecExpression.fromPolarExpressionss({length:speed,angle:a.add(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(90,.017453292519943295))).divide(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(2,1)))).unaryOperation(firedancer_assembly_Instruction.RandomSigned(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))))})),main=firedancer_script_Api.loop(new firedancer_script_nodes_List([new firedancer_script_nodes_SetActorVector(3,vec),firedancer_script_Api.fire(),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(2)))]));return BulletPatterns.asMain(main,"loop([\r\n\tshot.velocity.set(\r\n\t\trandom.between(1, 4),\r\n\t\t180 + (random.angle.grouping(90)) // 180 ± 45\r\n\t),\r\n\tfire(),\r\n\twait(2)\r\n]);")},BulletPatterns.variables=function(){var cnt=firedancer_script_Api.intVar("cnt"),vec=(firedancer_script_Api.shot.velocity,firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(5,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))})),main=new firedancer_script_nodes_SetActorVector(3,vec),main1=firedancer_script_expression_IntLocalVariableExpression.let(cnt),b=(firedancer_script_Api.shot.direction,new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(20))),main2=[main,main1,firedancer_script_Api.loop(new firedancer_script_nodes_List([new firedancer_script_nodes_SetActorProperty(3,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetAngle(firedancer_script_expression_IntLocalVariableExpression.get(cnt).multiply(b).toAngleExpression())),firedancer_script_Api.fire(),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4))),firedancer_script_expression_IntLocalVariableExpression.increment(cnt)]))];return BulletPatterns.asMain(new firedancer_script_nodes_List(main2),'/*\r\n\tYou can define any local variable with\r\n\tintVar(), floatVar() or angleVar().\r\n\r\n\tEach array behaves as a scope.\r\n\tShadowing is allowed.\r\n\r\n\tYou can change the assigned value by\r\n\tset(), add(), increment() or decrement()\r\n\t(the latter two are only for integer variables).\r\n*/\r\n\r\nfinal cnt = intVar("cnt");\r\n\r\n[\r\n\tshot.velocity.set(5, 180),\r\n\tcnt.let(), // declare in the current scope\r\n\tloop([\r\n\t\tshot.direction.set(cnt * 20),\r\n\t\tfire(),\r\n\t\twait(4),\r\n\t\tcnt.increment()\r\n\t])\r\n];')},BulletPatterns.sinCos=function(){var varBearing=firedancer_script_Api.angleVar("bearing"),main=new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(16)),nodes=firedancer_script_expression_AngleLocalVariableExpression.let(varBearing),_this=firedancer_script_Api.position.cartesian,vec=firedancer_script_expression_VecExpression.fromCartesianExpressions({x:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(300,1))).multiply(firedancer_script_Api.cos(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varBearing))),y:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(60,1))).multiply(firedancer_script_Api.sin(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varBearing)))});(_this=firedancer_script_Api.fire(new firedancer_script_nodes_List([nodes,firedancer_script_Api.loop(new firedancer_script_nodes_List([new firedancer_script_nodes_SetActorVector(0,vec),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(1))),firedancer_script_expression_AngleLocalVariableExpression.add(varBearing,new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,.017453292519943295))))]))]))).bindPosition=!0;var main1=[firedancer_script_Api.rep(main,new firedancer_script_nodes_List([_this,firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4)))]))];return BulletPatterns.asMain(new firedancer_script_nodes_List(main1),'final varBearing = angleVar("bearing");\r\n\r\n[\r\n\trep(16, [\r\n\t\tfire([\r\n\t\t\tvarBearing.let(),\r\n\t\t\tloop([\r\n\t\t\t\tposition.cartesian.set(\r\n\t\t\t\t\t300 * cos(varBearing),\r\n\t\t\t\t\t60 * sin(varBearing)\r\n\t\t\t\t),\r\n\t\t\t\twait(1),\r\n\t\t\t\tvarBearing.add(4)\r\n\t\t\t])\r\n\t\t]).bind(),\r\n\t\twait(4)\r\n\t])\r\n];')},BulletPatterns.transform=function(){var varBearing=firedancer_script_Api.angleVar("bearing"),varRotation=firedancer_script_Api.angleVar("rotation"),main=new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(24)),nodes=firedancer_script_expression_AngleLocalVariableExpression.let(varBearing),nodes1=firedancer_script_expression_AngleLocalVariableExpression.let(varRotation),vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(150,1))),angle:firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varBearing)}),_this=firedancer_script_Api.fire(new firedancer_script_nodes_List([nodes,nodes1,firedancer_script_Api.loop(new firedancer_script_nodes_List([new firedancer_script_nodes_SetActorVector(0,vec).rotate(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varRotation)).scale(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(1,1))),new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(.3,1)))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(1))),firedancer_script_expression_AngleLocalVariableExpression.add(varBearing,new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,.017453292519943295)))),firedancer_script_expression_AngleLocalVariableExpression.add(varRotation,new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(2,.017453292519943295))))]))]));_this.bindPosition=!0;var main1=[firedancer_script_Api.rep(main,new firedancer_script_nodes_List([_this,firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(6)))]))];return BulletPatterns.asMain(new firedancer_script_nodes_List(main1),'final varBearing = angleVar("bearing");\r\nfinal varRotation = angleVar("rotation");\r\n\r\n[\r\n\trep(24, [\r\n\t\tfire([\r\n\t\t\tvarBearing.let(),\r\n\t\t\tvarRotation.let(),\r\n\t\t\tloop([\r\n\t\t\t\tposition.set(150, varBearing)\r\n\t\t\t\t\t.rotate(varRotation)\r\n\t\t\t\t\t.scale(1.0, 0.3),\r\n\t\t\t\twait(1),\r\n\t\t\t\tvarBearing.add(4),\r\n\t\t\t\tvarRotation.add(2)\r\n\t\t\t])\r\n\t\t]).bind(),\r\n\t\twait(6)\r\n\t])\r\n];')},BulletPatterns.nWayWhip=function(){firedancer_script_Api.shot.velocity;var vec=firedancer_script_expression_VecExpression.fromPolarExpressionss({length:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,1))),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(180,.017453292519943295)))}),main=[new firedancer_script_nodes_SetActorVector(3,vec),firedancer_script_Api.loop(new firedancer_script_nodes_List([firedancer_script_Api.dup(firedancer_script_ApiEx.nWay(firedancer_script_Api.fire(),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(5)),angle:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(90,.017453292519943295)))}),{count:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(8)),intervalFrames:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4)),shotSpeedChange:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(8,1))),shotDirectionRange:{start:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(-6,.017453292519943295))),end:new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(6,.017453292519943295)))}}),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(30)))]))];return BulletPatterns.asMain(new firedancer_script_nodes_List(main),"[\r\n\tshot.velocity.set(4, 180),\r\n\tloop([\r\n\t\tnWay(fire(), { ways: 5, angle: 90 }).dup({\r\n\t\t\tcount: 8,\r\n\t\t\tintervalFrames: 4,\r\n\t\t\tshotSpeedChange: 8,\r\n\t\t\tshotDirectionRange: { start: -6, end: 6 }\r\n\t\t}),\r\n\t\twait(30)\r\n\t])\r\n];")},BulletPatterns.laundry=function(){firedancer_script_Api.shot.speed;var main=new firedancer_script_nodes_SetActorProperty(3,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(12,1))))),nodes=firedancer_script_ApiEx.radial(firedancer_script_Api.fire(),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(10))}),main1=(firedancer_script_Api.shot.direction,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(8,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4)))]))),main2=(nodes=firedancer_script_ApiEx.radial(firedancer_script_Api.fire(),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4))}),firedancer_script_Api.shot.direction,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(4,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(2)))]))),main3=(nodes=firedancer_script_ApiEx.radial(firedancer_script_Api.fire(),{ways:new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(4))}),firedancer_script_Api.shot.direction,[main,firedancer_script_Api.parallel([main1,main2,firedancer_script_Api.loop(new firedancer_script_nodes_List([nodes,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(-4,.017453292519943295))))),firedancer_script_Api.wait(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(2)))]))])]);return BulletPatterns.asMain(new firedancer_script_nodes_List(main3),"[\r\n\tshot.speed.set(12),\r\n\tparallel([\r\n\t\tloop([\r\n\t\t\tradial(fire(), { ways: 10 }),\r\n\t\t\tshot.direction.add(8),\r\n\t\t\twait(4)\r\n\t\t]),\r\n\t\tloop([\r\n\t\t\tradial(fire(), { ways: 4 }),\r\n\t\t\tshot.direction.add(4),\r\n\t\t\twait(2)\r\n\t\t]),\r\n\t\tloop([\r\n\t\t\tradial(fire(), { ways: 4 }),\r\n\t\t\tshot.direction.add(-4),\r\n\t\t\twait(2)\r\n\t\t])\r\n\t])\r\n];")},BulletPatterns.asMain=function(ast,script){null==script&&(script=""),script=StringTools.replace(script,"\t","  "),Dom.script(script);var _g=new haxe_ds_StringMap;_g.h.main=ast;var assembly=firedancer_script_Api.compileToAssembly(_g,!0);Dom.assembly(assembly.toString());var programPackage=assembly.assemble();return Dom.program(programPackage.toString()),assembly.assemble()};var Dom=function(){};$hxClasses.Dom=Dom,Dom.__name__="Dom",Dom.initialize=function(){var selector=window.document.getElementById("demo-selector");selector.onchange=function(){if(null!=Global.world){var pkg=BulletPatterns.get(selector.value);if(null!=pkg){var programPackage=pkg;Global.world.reset(programPackage,programPackage.getProgramByName("main"))}}}},Dom.script=function(text){window.document.getElementById("script").textContent=text},Dom.assembly=function(text){window.document.getElementById("assembly").textContent=text},Dom.program=function(text){window.document.getElementById("program").textContent=text};var EReg=function(r,opt){this.r=new RegExp(r,opt.split("u").join(""))};$hxClasses.EReg=EReg,EReg.__name__="EReg",EReg.prototype={match:function(s){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(s),this.r.s=s,null!=this.r.m},matched:function(n){if(null!=this.r.m&&n>=0&&n<this.r.m.length)return this.r.m[n];throw haxe_Exception.thrown("EReg::matched")},__class__:EReg};var Global=function(){};$hxClasses.Global=Global,Global.__name__="Global";var HxOverrides=function(){};$hxClasses.HxOverrides=HxOverrides,HxOverrides.__name__="HxOverrides",HxOverrides.strDate=function(s){switch(s.length){case 8:var k=s.split(":"),d=new Date;return d.setTime(0),d.setUTCHours(k[0]),d.setUTCMinutes(k[1]),d.setUTCSeconds(k[2]),d;case 10:k=s.split("-");return new Date(k[0],k[1]-1,k[2],0,0,0);case 19:var y=(k=s.split(" "))[0].split("-"),t=k[1].split(":");return new Date(y[0],y[1]-1,y[2],t[0],t[1],t[2]);default:throw haxe_Exception.thrown("Invalid date format : "+s)}},HxOverrides.cca=function(s,index){var x=s.charCodeAt(index);if(x==x)return x},HxOverrides.substr=function(s,pos,len){if(null==len)len=s.length;else if(len<0){if(0!=pos)return"";len=s.length+len}return s.substr(pos,len)},HxOverrides.remove=function(a,obj){var i=a.indexOf(obj);return-1!=i&&(a.splice(i,1),!0)},HxOverrides.now=function(){return Date.now()};var IntIterator=function(min,max){this.min=min,this.max=max};$hxClasses.IntIterator=IntIterator,IntIterator.__name__="IntIterator",IntIterator.prototype={hasNext:function(){return this.min<this.max},next:function(){return this.min++},__class__:IntIterator};var Lambda=function(){};$hxClasses.Lambda=Lambda,Lambda.__name__="Lambda",Lambda.array=function(it){for(var o,a=[],i=(o=it)instanceof Array?new haxe_iterators_ArrayIterator(o):o.iterator();i.hasNext();){var i1=i.next();a.push(i1)}return a};var broker_App=function(width,height,fullscreen){null==fullscreen&&(fullscreen=!0),broker_App.width=width,broker_App.height=height,this.startFullscreen=fullscreen,broker_App.data=new broker_HeapsApp(this)};$hxClasses["broker.App"]=broker_App,broker_App.__name__="broker.App",broker_App.prototype={initialize:function(){},update:function(){},__class__:broker_App};var Main=function(width,height,fullscreen){broker_App.call(this,width,height,fullscreen)};$hxClasses.Main=Main,Main.__name__="Main",Main.main=function(){new Main(720,960,!1),Dom.initialize()},Main.__super__=broker_App,Main.prototype=$extend(broker_App.prototype,{initialize:function(){hxd_Res.set_loader(new hxd_res_Loader(new hxd_fs_EmbedFileSystem(haxe_Unserializer.run("oy10:bullet.pngty9:agent.pngtg")))),broker_App.data.engine.backgroundColor=-1;var initialScene=new scenes_PlayScene,this1=30;initialScene.fadeInFrom(-1,this1,!0);var _this=new broker_scene_SceneStack(initialScene,this1=16);_this.tag=new sneaker_tag_Tag("scene stack",null),this.sceneStack=_this},update:function(){this.sceneStack.update()},__class__:Main}),Math.__name__="Math";var Reflect=function(){};$hxClasses.Reflect=Reflect,Reflect.__name__="Reflect",Reflect.field=function(o,field){try{return o[field]}catch(_g){return null}},Reflect.fields=function(o){var a=[];if(null!=o){var hasOwnProperty=Object.prototype.hasOwnProperty;for(var f in o)"__id__"!=f&&"hx__closures__"!=f&&hasOwnProperty.call(o,f)&&a.push(f)}return a},Reflect.isFunction=function(f){return"function"==typeof f&&!(f.__name__||f.__ename__)},Reflect.compare=function(a,b){return a==b?0:a>b?1:-1},Reflect.compareMethods=function(f1,f2){return f1==f2||!(!Reflect.isFunction(f1)||!Reflect.isFunction(f2))&&(f1.scope==f2.scope&&f1.method==f2.method&&null!=f1.method)},Reflect.isEnumValue=function(v){return null!=v&&null!=v.__enum__},Reflect.deleteField=function(o,field){return!!Object.prototype.hasOwnProperty.call(o,field)&&(delete o[field],!0)};var Std=function(){};$hxClasses.Std=Std,Std.__name__="Std",Std.string=function(s){return js_Boot.__string_rec(s,"")},Std.parseInt=function(x){if(null!=x)for(var _g=0,_g1=x.length;_g<_g1;){var i=_g++,c=x.charCodeAt(i);if(c<=8||c>=14&&32!=c&&45!=c){var nc=x.charCodeAt(i+1),v=parseInt(x,120==nc||88==nc?16:10);return isNaN(v)?null:v}}return null};var StringBuf=function(){this.b=""};$hxClasses.StringBuf=StringBuf,StringBuf.__name__="StringBuf",StringBuf.prototype={add:function(x){this.b+=Std.string(x)},__class__:StringBuf};var StringTools=function(){};$hxClasses.StringTools=StringTools,StringTools.__name__="StringTools",StringTools.startsWith=function(s,start){return s.length>=start.length&&0==s.lastIndexOf(start,0)},StringTools.isSpace=function(s,pos){var c=HxOverrides.cca(s,pos);return c>8&&c<14||32==c},StringTools.ltrim=function(s){for(var l=s.length,r=0;r<l&&StringTools.isSpace(s,r);)++r;return r>0?HxOverrides.substr(s,r,l-r):s},StringTools.rtrim=function(s){for(var l=s.length,r=0;r<l&&StringTools.isSpace(s,l-r-1);)++r;return r>0?HxOverrides.substr(s,0,l-r):s},StringTools.trim=function(s){return StringTools.ltrim(StringTools.rtrim(s))},StringTools.replace=function(s,sub,by){return s.split(sub).join(by)},StringTools.hex=function(n,digits){for(var s="";s="0123456789ABCDEF".charAt(15&n)+s,(n>>>=4)>0;);if(null!=digits)for(;s.length<digits;)s="0"+s;return s};var firedancer_vm_EventHandler=function(){};$hxClasses["firedancer.vm.EventHandler"]=firedancer_vm_EventHandler,firedancer_vm_EventHandler.__name__="firedancer.vm.EventHandler",firedancer_vm_EventHandler.prototype={onGlobalEvent:function(globalEventCode){throw haxe_Exception.thrown(new sneaker_exception_NotOverriddenException(null,{fileName:"firedancer/vm/EventHandler.hx",lineNumber:23,className:"firedancer.vm.EventHandler",methodName:"onGlobalEvent"}))},onLocalEvent:function(localEventCode,x,y,thread,originPositionRef,targetpositionRef){throw haxe_Exception.thrown(new sneaker_exception_NotOverriddenException(null,{fileName:"firedancer/vm/EventHandler.hx",lineNumber:46,className:"firedancer.vm.EventHandler",methodName:"onLocalEvent"}))},__class__:firedancer_vm_EventHandler};var TestEventHandler=function(){};$hxClasses.TestEventHandler=TestEventHandler,TestEventHandler.__name__="TestEventHandler",TestEventHandler.__super__=firedancer_vm_EventHandler,TestEventHandler.prototype=$extend(firedancer_vm_EventHandler.prototype,{onGlobalEvent:function(eventCode){sneaker_print_Printer.println_String("Invoked global event. (code: "+eventCode+")")},__class__:TestEventHandler});var ValueType=$hxEnums.ValueType={__ename__:"ValueType",__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"],TNull:{_hx_index:0,__enum__:"ValueType",toString:$estr},TInt:{_hx_index:1,__enum__:"ValueType",toString:$estr},TFloat:{_hx_index:2,__enum__:"ValueType",toString:$estr},TBool:{_hx_index:3,__enum__:"ValueType",toString:$estr},TObject:{_hx_index:4,__enum__:"ValueType",toString:$estr},TFunction:{_hx_index:5,__enum__:"ValueType",toString:$estr},TClass:($_=function(c){return{_hx_index:6,c:c,__enum__:"ValueType",toString:$estr}},$_.__params__=["c"],$_),TEnum:($_=function(e){return{_hx_index:7,e:e,__enum__:"ValueType",toString:$estr}},$_.__params__=["e"],$_),TUnknown:{_hx_index:8,__enum__:"ValueType",toString:$estr}};ValueType.__empty_constructs__=[ValueType.TNull,ValueType.TInt,ValueType.TFloat,ValueType.TBool,ValueType.TObject,ValueType.TFunction,ValueType.TUnknown];var Type=function(){};$hxClasses.Type=Type,Type.__name__="Type",Type.createInstance=function(cl,args){return new(Function.prototype.bind.apply(cl,[null].concat(args)))},Type.createEnum=function(e,constr,params){var f=Reflect.field(e,constr);if(null==f)throw haxe_Exception.thrown("No such constructor "+constr);if(Reflect.isFunction(f)){if(null==params)throw haxe_Exception.thrown("Constructor "+constr+" need parameters");return f.apply(e,params)}if(null!=params&&0!=params.length)throw haxe_Exception.thrown("Constructor "+constr+" does not need parameters");return f},Type.createEnumIndex=function(e,index,params){var c=e.__constructs__[index];if(null==c)throw haxe_Exception.thrown(index+" is not a valid enum constructor index");return Type.createEnum(e,c,params)},Type.typeof=function(v){switch(typeof v){case"boolean":return ValueType.TBool;case"function":return v.__name__||v.__ename__?ValueType.TObject:ValueType.TFunction;case"number":return Math.ceil(v)==v%2147483648?ValueType.TInt:ValueType.TFloat;case"object":if(null==v)return ValueType.TNull;var e=v.__enum__;if(null!=e)return ValueType.TEnum($hxEnums[e]);var c=js_Boot.getClass(v);return null!=c?ValueType.TClass(c):ValueType.TObject;case"string":return ValueType.TClass(String);case"undefined":return ValueType.TNull;default:return ValueType.TUnknown}},Type.enumEq=function(a,b){if(a==b)return!0;try{var e=a.__enum__;if(null==e||e!=b.__enum__)return!1;if(a._hx_index!=b._hx_index)return!1;for(var enm=$hxEnums[e],params=enm[enm.__constructs__[a._hx_index]].__params__,_g=0;_g<params.length;){var f=params[_g];if(++_g,!Type.enumEq(a[f],b[f]))return!1}}catch(_g){return!1}return!0},Type.enumParameters=function(e){var enm=$hxEnums[e.__enum__],params=enm[enm.__constructs__[e._hx_index]].__params__;if(null!=params){for(var _g=[],_g1=0;_g1<params.length;){var p=params[_g1];++_g1,_g.push(e[p])}return _g}return[]};var World=function(){var this1=new h2d_Mask(720,960),area=this.area=this1,color=this1=-66049,value=(this1=16777215&color,.00392156862745098*(color>>>24)),this2=value<0?0:value>1?1:value,backgroundTile=h2d_Tile.fromColor(this1,area.width,area.height,this2),background=this1=new h2d_Bitmap(backgroundTile);area.addChild(background);this1=new h2d_Object;this.armiesContainer=this1;var _this=this.armiesContainer;this1=2;_this.posChanged=!0,_this.x=720/this1,_this.posChanged=!0,_this.y=0,area.addChild(this.armiesContainer);var programPackage=BulletPatterns.defaultPattern();this.reset(programPackage,programPackage.getProgramByName("main"))};$hxClasses.World=World,World.__name__="World",World.prototype={reset:function(programPackage,mainProgram){this.armiesContainer.removeChildren();var sprite=this1=new h2d_BatchElement(null);sprite.x=0,sprite.y=720;var targetPositionRef=sprite;this.army=_$World_WorldBuilder.createArmy(this.armiesContainer,targetPositionRef,720,960,programPackage),this.army.crashAll();var this1=mainProgram;this.army.newAgent(0,200,0,0,this1)},update:function(){this.army.update(),this.army.synchronize()},__class__:World};var _$World_WorldBuilder=function(){};$hxClasses["_World.WorldBuilder"]=_$World_WorldBuilder,_$World_WorldBuilder.__name__="_World.WorldBuilder",_$World_WorldBuilder.createArmy=function(parent,targetPositionRef,areaWidth,areaHeight,programPackage){var agentTile=hxd_Res.get_loader().loadCache("agent.png",hxd_res_Image).toTile().center();(this1=new h2d_SpriteBatch(h2d_Tile.fromTexture(agentTile.innerTex))).hasRotationScale=!0;var agentBatch=this1;parent.addChild(agentBatch);var this1,bulletTile=hxd_Res.get_loader().loadCache("bullet.png",hxd_res_Image).toTile().center();(this1=new h2d_SpriteBatch(h2d_Tile.fromTexture(bulletTile.innerTex))).hasRotationScale=!0;var bulletBatch=this1;parent.addChild(bulletBatch);var bullets=actor_ArmyBuilder.createActors(4096,programPackage,bulletBatch,bulletTile),agents=actor_ArmyBuilder.createActors(64,programPackage,agentBatch,agentTile,bullets);return new actor_Army(agents,bullets,targetPositionRef)};var banker_aosoa_Structure=function(){};$hxClasses["banker.aosoa.Structure"]=banker_aosoa_Structure,banker_aosoa_Structure.__name__="banker.aosoa.Structure",banker_aosoa_Structure.__isInterface__=!0;var broker_entity_BasicEntity=function(){};$hxClasses["broker.entity.BasicEntity"]=broker_entity_BasicEntity,broker_entity_BasicEntity.__name__="broker.entity.BasicEntity",broker_entity_BasicEntity.__interfaces__=[banker_aosoa_Structure];var broker_entity_BasicBatchEntity=function(){};$hxClasses["broker.entity.BasicBatchEntity"]=broker_entity_BasicBatchEntity,broker_entity_BasicBatchEntity.__name__="broker.entity.BasicBatchEntity",broker_entity_BasicBatchEntity.spriteVectorFactory=function(chunkCapacity){var this1=chunkCapacity;return this1=new Array(this1)},broker_entity_BasicBatchEntity.__super__=broker_entity_BasicEntity,broker_entity_BasicBatchEntity.prototype=$extend(broker_entity_BasicEntity.prototype,{__class__:broker_entity_BasicBatchEntity});var actor_ActorChunk=function(chunkId,chunkCapacity,defaultReadWriteIndexMap,batchValue,spriteFactory,programTableValue,eventHandlerValue,emitterValue){this.rotationVelocity=.03,this.disusedCount=0,this.usedCount=0,this.nextWriteIndex=0,this.endReadIndex=0,this.chunkId=chunkId;for(var this1=this2=this1=new Array(chunkCapacity),_g=(this.x=this1,0),_g1=(_this=this.x).length;_g<_g1;){_this[this1=i=_g++]=0}this1=this.x;var r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);for(this.xBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.y=this1,_g=0,_g1=(_this=this.y).length;_g<_g1;){_this[this1=i=_g++]=0}this1=this.y,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);for(this.yBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.vx=this1,_g=0,_g1=(_this=this.vx).length;_g<_g1;){_this[this1=i=_g++]=0}this1=this.vx,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);for(this.vxBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.vy=this1,_g=0,_g1=(_this=this.vy).length;_g<_g1;){_this[this1=i=_g++]=0}this1=this.vy,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);this.vyBuffer=r;this.usedSprites=broker_entity_BasicBatchEntity.spriteVectorFactory(chunkCapacity),this.disusedSprites=broker_entity_BasicBatchEntity.spriteVectorFactory(chunkCapacity),this.batch=batchValue;for(this1=this2=this1=new Array(chunkCapacity),this.sprite=this1,_g=0,_g1=(_this=this.sprite).length;_g<_g1;){_this[this1=i=_g++]=spriteFactory()}this1=this.sprite,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);this.spriteBuffer=r;this.programTable=programTableValue,this.eventHandler=eventHandlerValue,this.emitter=emitterValue;for(this1=this2=this1=new Array(chunkCapacity),this.threads=this1,_g=0,_g1=(_this=this.threads).length;_g<_g1;){var index=this1=i=_g++;0;for(var _this1=this2=new Array(4),_g2=0,_g3=_this1.length;_g2<_g3;){_this1[_g2++]=new firedancer_vm_Thread(128)}var this6=_this1;_this[index]=this6}this1=this.threads,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);this.threadsBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.originPositionRef=this1;var value=this1=null;for(_g=0,_g1=(_this=this.originPositionRef).length;_g<_g1;){_this[this1=i=_g++]=value}this1=this.originPositionRef,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);for(this.originPositionRefBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.frameCount=this1,value=0,_g=0,_g1=(_this=this.frameCount).length;_g<_g1;){_this[this1=i=_g++]=value}this1=this.frameCount,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);for(this.frameCountBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.dead=this1,_g=0,_g1=(_this=this.dead).length;_g<_g1;){_this[this1=i=_g++]=!1}this1=this.dead,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);for(this.deadBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.id=this1,value=-1,_g=0,_g1=(_this=this.id).length;_g<_g1;){_this[this1=i=_g++]=value}this1=this.id,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);var _this;for(this.idBuffer=r,this1=this2=this1=new Array(chunkCapacity),this.entityId=this1,value=0,_g=0,_g1=(_this=this.entityId).length;_g<_g1;){_this[this1=i=_g++]=value}this1=this.entityId,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length);this.entityIdBuffer=r,this1=chunkCapacity-0;for(var vector=this2=this1=this2=new Array(this1),i=0,n=0;n<chunkCapacity;)vector[i]=n,++i,++n;this.entityIdReadIndexMap=vector;this1=defaultReadWriteIndexMap,r=this2=new Array(this1.length);haxe_ds_Vector.blit(this1,0,r,0,this1.length),this.readWriteIndexMap=r;var id=this.id;for(i=0;i<chunkCapacity;){var this2=chunkId<<(this1=16)|i;id[i]=this2,++i}haxe_ds_Vector.blit(id,0,this.idBuffer,0,chunkCapacity);var len=(vector=this.entityId).length;for(i=0,n=0;i<len;)vector[i]=n,++i,++n;for(len=(vector=this.entityIdBuffer).length,i=0,n=0;i<len;)vector[i]=n,++i,++n};$hxClasses["actor.ActorChunk"]=actor_ActorChunk,actor_ActorChunk.__name__="actor.ActorChunk",actor_ActorChunk.prototype={synchronize:function(chunkCapacity,defaultReadWriteIndexMap){this.synchronizeBatch();var nextWriteIndex=this.nextWriteIndex;haxe_ds_Vector.blit(this.xBuffer,0,this.x,0,nextWriteIndex),haxe_ds_Vector.blit(this.yBuffer,0,this.y,0,nextWriteIndex),haxe_ds_Vector.blit(this.vxBuffer,0,this.vx,0,nextWriteIndex),haxe_ds_Vector.blit(this.vyBuffer,0,this.vy,0,nextWriteIndex),haxe_ds_Vector.blit(this.spriteBuffer,0,this.sprite,0,nextWriteIndex),haxe_ds_Vector.blit(this.threadsBuffer,0,this.threads,0,nextWriteIndex),haxe_ds_Vector.blit(this.originPositionRefBuffer,0,this.originPositionRef,0,nextWriteIndex),haxe_ds_Vector.blit(this.frameCountBuffer,0,this.frameCount,0,nextWriteIndex),haxe_ds_Vector.blit(this.deadBuffer,0,this.dead,0,nextWriteIndex),haxe_ds_Vector.blit(this.idBuffer,0,this.id,0,nextWriteIndex),haxe_ds_Vector.blit(this.entityIdBuffer,0,this.entityId,0,nextWriteIndex);for(var source=this.entityId,destination=this.entityIdReadIndexMap,i=0;i<nextWriteIndex;)destination[source[i]]=i,++i;haxe_ds_Vector.blit(defaultReadWriteIndexMap,0,this.readWriteIndexMap,0,chunkCapacity),this.endReadIndex=nextWriteIndex;for(var spriteBuffer=this.spriteBuffer,xBuffer=this.xBuffer,yBuffer=this.yBuffer,readWriteIndexMap=this.readWriteIndexMap,endReadIndex=this.endReadIndex,readIndex=0,nextWriteIndex1=this.nextWriteIndex,disuse=!1;readIndex<endReadIndex;){var sprite=spriteBuffer[i=readWriteIndexMap[readIndex]],x=xBuffer[i],y=yBuffer[i];if(sprite.x=x,sprite.y=y,disuse){--nextWriteIndex1;xBuffer[i]=xBuffer[nextWriteIndex1],yBuffer[i]=yBuffer[nextWriteIndex1],this.vxBuffer[i]=this.vxBuffer[nextWriteIndex1],this.vyBuffer[i]=this.vyBuffer[nextWriteIndex1];var tmp=spriteBuffer[i];spriteBuffer[i]=spriteBuffer[nextWriteIndex1],spriteBuffer[nextWriteIndex1]=tmp;var _this=this.threadsBuffer,tmp1=_this[i];_this[i]=_this[nextWriteIndex1],_this[nextWriteIndex1]=tmp1,this.originPositionRefBuffer[i]=this.originPositionRefBuffer[nextWriteIndex1],this.frameCountBuffer[i]=this.frameCountBuffer[nextWriteIndex1],this.deadBuffer[i]=this.deadBuffer[nextWriteIndex1];var _this1=this.idBuffer,tmp2=_this1[i];_this1[i]=_this1[nextWriteIndex1],_this1[nextWriteIndex1]=tmp2;var _this2=this.entityIdBuffer,tmp3=_this2[i];_this2[i]=_this2[nextWriteIndex1],_this2[nextWriteIndex1]=tmp3;var tmp4=readWriteIndexMap[i];readWriteIndexMap[i]=readWriteIndexMap[nextWriteIndex1],readWriteIndexMap[nextWriteIndex1]=tmp4,disuse=!1}++readIndex}return this.nextWriteIndex=nextWriteIndex1,nextWriteIndex},synchronizeBatch:function(){var batch=this.batch,this1=this.disusedCount;broker_draw_heaps_BatchDraw.removeSprites(batch,this.disusedSprites,this1),this.disusedCount=0;this1=this.usedCount;broker_draw_heaps_BatchDraw.addSprites(batch,this.usedSprites,this1),this.usedCount=0},__class__:actor_ActorChunk};var actor_ActorAosoa=function(chunkCapacity,chunkCount,batchValue,spriteFactory,programTableValue,eventHandlerValue,emitterValue){this.nextWriteChunkIndex=0,this.endReadChunkIndex=0;for(var _g=[],_g1=0,_g2=chunkCapacity;_g1<_g2;){var this1=_g1++;_g.push(this1)}var defaultReadWriteIndexMap=_g.slice(0),chunkId=0,_this=this1=this1=new Array(chunkCount);for(_g=0,_g1=_this.length;_g<_g1;){_this[this1=_g++]=new actor_ActorChunk(chunkId++,chunkCapacity,defaultReadWriteIndexMap,batchValue,spriteFactory,programTableValue,eventHandlerValue,emitterValue)}this.chunks=_this,this.chunkCapacity=chunkCapacity,this.capacity=chunkCount*chunkCapacity,this.defaultReadWriteIndexMap=defaultReadWriteIndexMap};$hxClasses["actor.ActorAosoa"]=actor_ActorAosoa,actor_ActorAosoa.__name__="actor.ActorAosoa",actor_ActorAosoa.prototype={synchronize:function(){for(var chunks=this.chunks,chunkCount=chunks.length,chunkCapacity=this.chunkCapacity,defaultReadWriteIndexMap=this.defaultReadWriteIndexMap,usedChunkMaxIndex=0,chunkIndex=0;chunkIndex<chunkCount;)0!=chunks[chunkIndex].synchronize(chunkCapacity,defaultReadWriteIndexMap)&&(usedChunkMaxIndex=chunkIndex),++chunkIndex;var this1=usedChunkMaxIndex+1;this.endReadChunkIndex=this1},crashAll:function(){for(var chunks=this.chunks,chunkCapacity=this.chunkCapacity,endReadChunkIndex=this.endReadChunkIndex,i=0;i<endReadChunkIndex;){for(var chunk=chunks[i],spriteBuffer=chunk.spriteBuffer,disusedSprites=chunk.disusedSprites,disusedCount=chunk.disusedCount,readWriteIndexMap=chunk.readWriteIndexMap,endReadIndex=chunk.endReadIndex,readIndex=0,nextWriteIndex=chunk.nextWriteIndex,disuse=!1;readIndex<endReadIndex;){var i1=readWriteIndexMap[readIndex],sprite=spriteBuffer[i1];if(disuse=!0,disusedSprites[disusedCount]=sprite,++disusedCount,sprite.x=-3402823e32,disuse){--nextWriteIndex;chunk.xBuffer[i1]=chunk.xBuffer[nextWriteIndex],chunk.yBuffer[i1]=chunk.yBuffer[nextWriteIndex],chunk.vxBuffer[i1]=chunk.vxBuffer[nextWriteIndex],chunk.vyBuffer[i1]=chunk.vyBuffer[nextWriteIndex];var tmp=spriteBuffer[i1];spriteBuffer[i1]=spriteBuffer[nextWriteIndex],spriteBuffer[nextWriteIndex]=tmp;var _this=chunk.threadsBuffer,tmp1=_this[i1];_this[i1]=_this[nextWriteIndex],_this[nextWriteIndex]=tmp1,chunk.originPositionRefBuffer[i1]=chunk.originPositionRefBuffer[nextWriteIndex],chunk.frameCountBuffer[i1]=chunk.frameCountBuffer[nextWriteIndex],chunk.deadBuffer[i1]=chunk.deadBuffer[nextWriteIndex];var _this1=chunk.idBuffer,tmp2=_this1[i1];_this1[i1]=_this1[nextWriteIndex],_this1[nextWriteIndex]=tmp2;var _this2=chunk.entityIdBuffer,tmp3=_this2[i1];_this2[i1]=_this2[nextWriteIndex],_this2[nextWriteIndex]=tmp3;var tmp4=readWriteIndexMap[i1];readWriteIndexMap[i1]=readWriteIndexMap[nextWriteIndex],readWriteIndexMap[nextWriteIndex]=tmp4,disuse=!1}++readIndex}chunk.nextWriteIndex=nextWriteIndex,chunk.disusedCount=disusedCount,chunk.nextWriteIndex<chunkCapacity&&i<this.nextWriteChunkIndex&&(this.nextWriteChunkIndex=i),++i}},update:function(targetPositionRef){for(var chunks=this.chunks,chunkCapacity=this.chunkCapacity,endReadChunkIndex=this.endReadChunkIndex,i=0;i<endReadChunkIndex;){for(var chunk=chunks[i],programTable=chunk.programTable,spriteBuffer=chunk.spriteBuffer,x=chunk.xBuffer,y=chunk.yBuffer,vx=chunk.vxBuffer,vy=chunk.vyBuffer,threadsBuffer=chunk.threadsBuffer,originPositionRef=chunk.originPositionRefBuffer,frameCount=chunk.frameCountBuffer,disusedSprites=chunk.disusedSprites,disusedCount=chunk.disusedCount,dead=chunk.deadBuffer,rotationVelocity=chunk.rotationVelocity,eventHandler=chunk.eventHandler,emitter=chunk.emitter,readWriteIndexMap=chunk.readWriteIndexMap,endReadIndex=chunk.endReadIndex,readIndex=0,nextWriteIndex=chunk.nextWriteIndex,disuse=!1;readIndex<endReadIndex;){var tmp,i1=readWriteIndexMap[readIndex],sprite=spriteBuffer[i1],threads=threadsBuffer[i1];if(dead[i1])tmp=!0;else{var x1=x[i1],y1=y[i1];tmp=!(y1<1024&&-64<=y1&&-424<=x1&&x1<424)}if(tmp)disuse=!0,disusedSprites[disusedCount]=sprite,++disusedCount,sprite.x=-3402823e32;else-1==firedancer_vm_Vm.run(programTable,eventHandler,threads,128,x,y,vx,vy,originPositionRef,i1,emitter,sprite,targetPositionRef)&&(dead[i1]=!0);if(sprite.rotation+=rotationVelocity,frameCount[i1]+=1,disuse){--nextWriteIndex;chunk.xBuffer[i1]=chunk.xBuffer[nextWriteIndex],chunk.yBuffer[i1]=chunk.yBuffer[nextWriteIndex],chunk.vxBuffer[i1]=chunk.vxBuffer[nextWriteIndex],chunk.vyBuffer[i1]=chunk.vyBuffer[nextWriteIndex];var tmp1=spriteBuffer[i1];spriteBuffer[i1]=spriteBuffer[nextWriteIndex],spriteBuffer[nextWriteIndex]=tmp1;var tmp2=threadsBuffer[i1];threadsBuffer[i1]=threadsBuffer[nextWriteIndex],threadsBuffer[nextWriteIndex]=tmp2,chunk.originPositionRefBuffer[i1]=chunk.originPositionRefBuffer[nextWriteIndex],chunk.frameCountBuffer[i1]=chunk.frameCountBuffer[nextWriteIndex],chunk.deadBuffer[i1]=chunk.deadBuffer[nextWriteIndex];var _this=chunk.idBuffer,tmp3=_this[i1];_this[i1]=_this[nextWriteIndex],_this[nextWriteIndex]=tmp3;var _this1=chunk.entityIdBuffer,tmp4=_this1[i1];_this1[i1]=_this1[nextWriteIndex],_this1[nextWriteIndex]=tmp4;var tmp5=readWriteIndexMap[i1];readWriteIndexMap[i1]=readWriteIndexMap[nextWriteIndex],readWriteIndexMap[nextWriteIndex]=tmp5,disuse=!1}++readIndex}chunk.nextWriteIndex=nextWriteIndex,chunk.disusedCount=disusedCount,chunk.nextWriteIndex<chunkCapacity&&i<this.nextWriteChunkIndex&&(this.nextWriteChunkIndex=i),++i}},use:function(initialX,initialY,initialVx,initialVy,program,originPosition){for(var chunks=this.chunks,chunkCapacity=this.chunkCapacity,nextWriteChunkIndex=this.nextWriteChunkIndex,chunk=chunks[nextWriteChunkIndex];chunk.nextWriteIndex==chunkCapacity;)chunk=chunks[++nextWriteChunkIndex];var i=chunk.nextWriteIndex,spriteBuffer=chunk.spriteBuffer,x=chunk.xBuffer,y=chunk.yBuffer,vx=chunk.vxBuffer,vy=chunk.vyBuffer,threadsBuffer=chunk.threadsBuffer,originPositionRef=chunk.originPositionRefBuffer,frameCount=chunk.frameCountBuffer,dead=chunk.deadBuffer,usedSprites=chunk.usedSprites,usedCount=chunk.usedCount,sprite=spriteBuffer[i],threads=threadsBuffer[i];if(x[i]=initialX,y[i]=initialY,vx[i]=initialVx,vy[i]=initialVy,null!=program){var program1=program;(_this=threads[0]).active=!0;var this1=program1;_this.code=this1;var this1=program1.length;_this.codeLength=this1,_this.programCounter=0,_this.stackPointer=0,_this.shotX=0,_this.shotY=0,_this.shotVx=0,_this.shotVy=0;for(var len=threads.length,i1=1;i1<len;){(_this=threads[i1]).active=!1;this1=null;_this.code=this1,_this.codeLength=0,_this.programCounter=0,_this.stackPointer=0,_this.shotX=0,_this.shotY=0,_this.shotVx=0,_this.shotVy=0,++i1}}else for(len=threads.length,i1=0;i1<len;){var _this;(_this=threads[i1]).active=!1;this1=null;_this.code=this1,_this.codeLength=0,_this.programCounter=0,_this.stackPointer=0,_this.shotX=0,_this.shotY=0,_this.shotVx=0,_this.shotVy=0,++i1}originPositionRef[i]=originPosition,frameCount[i]=0,dead[i]=!1,usedSprites[this1=usedCount]=sprite,++usedCount,sprite.rotation=0;var nextIndex=this1=i+1;chunk.nextWriteIndex=nextIndex,chunk.usedCount=usedCount,this.nextWriteChunkIndex=nextWriteChunkIndex},__class__:actor_ActorAosoa};var ripper_Data=function(){};$hxClasses["ripper.Data"]=ripper_Data,ripper_Data.__name__="ripper.Data",ripper_Data.__isInterface__=!0;var actor_Army=function(agents,bullets,targetPositionRef){this.agents=agents,this.bullets=bullets,this.targetPositionRef=targetPositionRef};$hxClasses["actor.Army"]=actor_Army,actor_Army.__name__="actor.Army",actor_Army.__interfaces__=[ripper_Data],actor_Army.prototype={update:function(){this.agents.update(this.targetPositionRef),this.bullets.update(this.targetPositionRef)},synchronize:function(){this.agents.synchronize(),this.bullets.synchronize()},crashAll:function(){this.agents.crashAll(),this.bullets.crashAll()},newAgent:function(x,y,vx,vy,fdProgram){this.agents.use(x,y,vx,vy,fdProgram,null)},__class__:actor_Army};var actor_ArmyBuilder=function(){};$hxClasses["actor.ArmyBuilder"]=actor_ArmyBuilder,actor_ArmyBuilder.__name__="actor.ArmyBuilder",actor_ArmyBuilder.createActors=function(maxEntityCount,programPackage,batch,tile,bullets){var aosoa,a=actor_ArmyBuilder.defaultChunkCapacity,chunkCapacity=a<maxEntityCount?a:maxEntityCount,chunkCount=Math.ceil(maxEntityCount/chunkCapacity),programTable=programPackage.programTable,eventHandler=new TestEventHandler,emitter=new actor_Emitter(null!=bullets?bullets:aosoa);return aosoa=new actor_ActorAosoa(chunkCapacity,chunkCount,batch,(function(){return new h2d_BatchElement(tile)}),programTable,eventHandler,emitter)};var firedancer_vm_Emitter=function(){};$hxClasses["firedancer.vm.Emitter"]=firedancer_vm_Emitter,firedancer_vm_Emitter.__name__="firedancer.vm.Emitter",firedancer_vm_Emitter.prototype={emit:function(x,y,vx,vy,fireCode,program,originPositionRef){throw haxe_Exception.thrown(new sneaker_exception_NotOverriddenException(null,{fileName:"firedancer/vm/Emitter.hx",lineNumber:40,className:"firedancer.vm.Emitter",methodName:"emit"}))},__class__:firedancer_vm_Emitter};var actor_Emitter=function(aosoa){this.aosoa=aosoa};$hxClasses["actor.Emitter"]=actor_Emitter,actor_Emitter.__name__="actor.Emitter",actor_Emitter.__interfaces__=[ripper_Data],actor_Emitter.__super__=firedancer_vm_Emitter,actor_Emitter.prototype=$extend(firedancer_vm_Emitter.prototype,{emit:function(x,y,vx,vy,fireCode,program,originPositionRef){this.aosoa.use(x,y,vx,vy,program,originPositionRef)},__class__:actor_Emitter});var sinker_errors_Errors=function(){};$hxClasses["sinker.errors.Errors"]=sinker_errors_Errors,sinker_errors_Errors.__name__="sinker.errors.Errors",sinker_errors_Errors.emptyString=function(){return"Invalid operation. String is empty."};var banker_binary_BytesData={toHex:function(this1,length,separate){var s=new sneaker_string_$buffer_StringBuffer;if(separate&&1<length){for(var lastPos=this2=length-1,_g=0,_g1=lastPos;_g<_g1;){var this2=_g++,this5=(byte=this1.b[this2])>>4,c=banker_binary_BytesData.hexChars[this5];s.b+=String.fromCodePoint(c);var this6=15&byte,c1=banker_binary_BytesData.hexChars[this6];s.b+=String.fromCodePoint(c1),s.b+=String.fromCodePoint(32)}this2=(byte=this2=this1.b[lastPos])>>4,c=banker_binary_BytesData.hexChars[this2];s.b+=String.fromCodePoint(c);this2=15&byte,c=banker_binary_BytesData.hexChars[this2];s.b+=String.fromCodePoint(c)}else for(_g=0,_g1=length;_g<_g1;){var byte;this2=_g++,this5=(byte=this1.b[this2])>>4,c=banker_binary_BytesData.hexChars[this5];s.b+=String.fromCodePoint(c);this6=15&byte,c1=banker_binary_BytesData.hexChars[this6];s.b+=String.fromCodePoint(c1)}return s.b}},banker_binary_value_$types_PopReturn=function(value,size){this.value=value,this.size=size};$hxClasses["banker.binary.value_types.PopReturn"]=banker_binary_value_$types_PopReturn,banker_binary_value_$types_PopReturn.__name__="banker.binary.value_types.PopReturn",banker_binary_value_$types_PopReturn.prototype={__class__:banker_binary_value_$types_PopReturn};var banker_binary_value_$types_PopReturn2D=function(x,y,size){this.x=x,this.y=y,this.size=size};$hxClasses["banker.binary.value_types.PopReturn2D"]=banker_binary_value_$types_PopReturn2D,banker_binary_value_$types_PopReturn2D.__name__="banker.binary.value_types.PopReturn2D",banker_binary_value_$types_PopReturn2D.prototype={__class__:banker_binary_value_$types_PopReturn2D};var banker_binary_value_$types_PopReturn2D_$Float=function(x,y,size){this.x=x,this.y=y,this.size=size};$hxClasses["banker.binary.value_types.PopReturn2D_Float"]=banker_binary_value_$types_PopReturn2D_$Float,banker_binary_value_$types_PopReturn2D_$Float.__name__="banker.binary.value_types.PopReturn2D_Float",banker_binary_value_$types_PopReturn2D_$Float.prototype={__class__:banker_binary_value_$types_PopReturn2D_$Float};var banker_binary_value_$types_PopReturn2D_$banker_$binary_$value_$types_$Float32=function(x,y,size){this.x=x,this.y=y,this.size=size};$hxClasses["banker.binary.value_types.PopReturn2D_banker_binary_value_types_Float32"]=banker_binary_value_$types_PopReturn2D_$banker_$binary_$value_$types_$Float32,banker_binary_value_$types_PopReturn2D_$banker_$binary_$value_$types_$Float32.__name__="banker.binary.value_types.PopReturn2D_banker_binary_value_types_Float32",banker_binary_value_$types_PopReturn2D_$banker_$binary_$value_$types_$Float32.prototype={__class__:banker_binary_value_$types_PopReturn2D_$banker_$binary_$value_$types_$Float32};var banker_binary_value_$types_PopReturn_$Float=function(value,size){this.value=value,this.size=size};$hxClasses["banker.binary.value_types.PopReturn_Float"]=banker_binary_value_$types_PopReturn_$Float,banker_binary_value_$types_PopReturn_$Float.__name__="banker.binary.value_types.PopReturn_Float",banker_binary_value_$types_PopReturn_$Float.prototype={__class__:banker_binary_value_$types_PopReturn_$Float};var banker_binary_value_$types_PopReturn_$banker_$binary_$value_$types_$Float32=function(value,size){this.value=value,this.size=size};$hxClasses["banker.binary.value_types.PopReturn_banker_binary_value_types_Float32"]=banker_binary_value_$types_PopReturn_$banker_$binary_$value_$types_$Float32,banker_binary_value_$types_PopReturn_$banker_$binary_$value_$types_$Float32.__name__="banker.binary.value_types.PopReturn_banker_binary_value_types_Float32",banker_binary_value_$types_PopReturn_$banker_$binary_$value_$types_$Float32.prototype={__class__:banker_binary_value_$types_PopReturn_$banker_$binary_$value_$types_$Float32};var banker_binary_value_$types_PopReturn_$haxe_$Int32=function(value,size){this.value=value,this.size=size};$hxClasses["banker.binary.value_types.PopReturn_haxe_Int32"]=banker_binary_value_$types_PopReturn_$haxe_$Int32,banker_binary_value_$types_PopReturn_$haxe_$Int32.__name__="banker.binary.value_types.PopReturn_haxe_Int32",banker_binary_value_$types_PopReturn_$haxe_$Int32.prototype={__class__:banker_binary_value_$types_PopReturn_$haxe_$Int32};var banker_binary_value_$types_PopReturn_$haxe_$Int64=function(value,size){this.value=value,this.size=size};$hxClasses["banker.binary.value_types.PopReturn_haxe_Int64"]=banker_binary_value_$types_PopReturn_$haxe_$Int64,banker_binary_value_$types_PopReturn_$haxe_$Int64.__name__="banker.binary.value_types.PopReturn_haxe_Int64",banker_binary_value_$types_PopReturn_$haxe_$Int64.prototype={__class__:banker_binary_value_$types_PopReturn_$haxe_$Int64};var banker_binary_value_$types_TmpVec2D32=function(x,y){this.x=x,this.y=y};$hxClasses["banker.binary.value_types.TmpVec2D32"]=banker_binary_value_$types_TmpVec2D32,banker_binary_value_$types_TmpVec2D32.__name__="banker.binary.value_types.TmpVec2D32",banker_binary_value_$types_TmpVec2D32.prototype={__class__:banker_binary_value_$types_TmpVec2D32};var banker_binary_value_$types_TmpVec2D64=function(x,y){this.x=x,this.y=y};$hxClasses["banker.binary.value_types.TmpVec2D64"]=banker_binary_value_$types_TmpVec2D64,banker_binary_value_$types_TmpVec2D64.__name__="banker.binary.value_types.TmpVec2D64",banker_binary_value_$types_TmpVec2D64.prototype={__class__:banker_binary_value_$types_TmpVec2D64};var sneaker_tag_interfaces_Tagged=function(){};$hxClasses["sneaker.tag.interfaces.Tagged"]=sneaker_tag_interfaces_Tagged,sneaker_tag_interfaces_Tagged.__name__="sneaker.tag.interfaces.Tagged",sneaker_tag_interfaces_Tagged.__isInterface__=!0;var banker_common_LimitedCapacityBuffer=function(){};$hxClasses["banker.common.LimitedCapacityBuffer"]=banker_common_LimitedCapacityBuffer,banker_common_LimitedCapacityBuffer.__name__="banker.common.LimitedCapacityBuffer",banker_common_LimitedCapacityBuffer.__isInterface__=!0,banker_common_LimitedCapacityBuffer.__interfaces__=[sneaker_tag_interfaces_Tagged];var sneaker_tag_Tagged=function(){this.tag=sneaker_tag_Tags.anonymous};$hxClasses["sneaker.tag.Tagged"]=sneaker_tag_Tagged,sneaker_tag_Tagged.__name__="sneaker.tag.Tagged",sneaker_tag_Tagged.__interfaces__=[sneaker_tag_interfaces_Tagged],sneaker_tag_Tagged.prototype={__class__:sneaker_tag_Tagged};var ripper_Body=function(){};$hxClasses["ripper.Body"]=ripper_Body,ripper_Body.__name__="ripper.Body",ripper_Body.__isInterface__=!0;var banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap=function(capacity){this.nextFreeSlotIndex=0,sneaker_tag_Tagged.call(this);var this1=this1=new Array(capacity);this.vector=this1};$hxClasses["banker.container.buffer.top_aligned.TopAlignedBuffer_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap"]=banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__name__="banker.container.buffer.top_aligned.TopAlignedBuffer_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap",banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__interfaces__=[banker_common_LimitedCapacityBuffer],banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__super__=sneaker_tag_Tagged,banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype=$extend(sneaker_tag_Tagged.prototype,{__class__:banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap});var banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap=function(capacity){this.nextFreeSlotIndex=0,sneaker_tag_Tagged.call(this);var this1=this1=new Array(capacity);this.vector=this1};$hxClasses["banker.container.buffer.top_aligned.TopAlignedBuffer_h2d_Bitmap"]=banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap,banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap.__name__="banker.container.buffer.top_aligned.TopAlignedBuffer_h2d_Bitmap",banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap.__interfaces__=[banker_common_LimitedCapacityBuffer],banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap.__super__=sneaker_tag_Tagged,banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap.prototype=$extend(sneaker_tag_Tagged.prototype,{__class__:banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap});var banker_map_interfaces_Convert=function(){};$hxClasses["banker.map.interfaces.Convert"]=banker_map_interfaces_Convert,banker_map_interfaces_Convert.__name__="banker.map.interfaces.Convert",banker_map_interfaces_Convert.__isInterface__=!0;var banker_map_interfaces_Set=function(){};$hxClasses["banker.map.interfaces.Set"]=banker_map_interfaces_Set,banker_map_interfaces_Set.__name__="banker.map.interfaces.Set",banker_map_interfaces_Set.__isInterface__=!0;var banker_map_interfaces_Sequence=function(){};$hxClasses["banker.map.interfaces.Sequence"]=banker_map_interfaces_Sequence,banker_map_interfaces_Sequence.__name__="banker.map.interfaces.Sequence",banker_map_interfaces_Sequence.__isInterface__=!0;var banker_map_interfaces_Map=function(){};$hxClasses["banker.map.interfaces.Map"]=banker_map_interfaces_Map,banker_map_interfaces_Map.__name__="banker.map.interfaces.Map",banker_map_interfaces_Map.__isInterface__=!0;var banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt=function(capacity){this.nextFreeSlotIndex=0,sneaker_tag_Tagged.call(this);var this1=this1=new Array(capacity);this.keyVector=this1;this1=this1=new Array(capacity);this.valueVector=this1};$hxClasses["banker.map.buffer.top_aligned.TopAlignedBuffer_String_sinker_UInt"]=banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt,banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt.__name__="banker.map.buffer.top_aligned.TopAlignedBuffer_String_sinker_UInt",banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt.__interfaces__=[banker_common_LimitedCapacityBuffer],banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt.__super__=sneaker_tag_Tagged,banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt.prototype=$extend(sneaker_tag_Tagged.prototype,{__class__:banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt});var banker_map_ArrayMap_$String_$sinker_$UInt=function(capacity){banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt.call(this,capacity)};$hxClasses["banker.map.ArrayMap_String_sinker_UInt"]=banker_map_ArrayMap_$String_$sinker_$UInt,banker_map_ArrayMap_$String_$sinker_$UInt.__name__="banker.map.ArrayMap_String_sinker_UInt",banker_map_ArrayMap_$String_$sinker_$UInt.__interfaces__=[ripper_Body,banker_map_interfaces_Convert,banker_map_interfaces_Set,banker_map_interfaces_Sequence,banker_map_interfaces_Map],banker_map_ArrayMap_$String_$sinker_$UInt.__super__=banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt,banker_map_ArrayMap_$String_$sinker_$UInt.prototype=$extend(banker_map_buffer_top_$aligned_TopAlignedBuffer_$String_$sinker_$UInt.prototype,{__class__:banker_map_ArrayMap_$String_$sinker_$UInt});var banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt=function(capacity){this.nextFreeSlotIndex=0,sneaker_tag_Tagged.call(this);var this1=this1=new Array(capacity);this.keyVector=this1;this1=this1=new Array(capacity);this.valueVector=this1};$hxClasses["banker.map.buffer.top_aligned.TopAlignedBuffer_broker_sound_Sound_sinker_UInt"]=banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt,banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt.__name__="banker.map.buffer.top_aligned.TopAlignedBuffer_broker_sound_Sound_sinker_UInt",banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt.__interfaces__=[banker_common_LimitedCapacityBuffer],banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt.__super__=sneaker_tag_Tagged,banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt.prototype=$extend(sneaker_tag_Tagged.prototype,{__class__:banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt});var banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt=function(capacity){banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt.call(this,capacity)};$hxClasses["banker.map.ArrayMap_broker_sound_Sound_sinker_UInt"]=banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt,banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt.__name__="banker.map.ArrayMap_broker_sound_Sound_sinker_UInt",banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt.__interfaces__=[ripper_Body,banker_map_interfaces_Convert,banker_map_interfaces_Set,banker_map_interfaces_Sequence,banker_map_interfaces_Map],banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt.__super__=banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt,banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt.prototype=$extend(banker_map_buffer_top_$aligned_TopAlignedBuffer_$broker_$sound_$Sound_$sinker_$UInt.prototype,{__class__:banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt});var banker_pool_interfaces_ObjectPool=function(){};$hxClasses["banker.pool.interfaces.ObjectPool"]=banker_pool_interfaces_ObjectPool,banker_pool_interfaces_ObjectPool.__name__="banker.pool.interfaces.ObjectPool",banker_pool_interfaces_ObjectPool.__isInterface__=!0,banker_pool_interfaces_ObjectPool.__interfaces__=[banker_common_LimitedCapacityBuffer],banker_pool_interfaces_ObjectPool.prototype={__class__:banker_pool_interfaces_ObjectPool};var banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap=function(capacity,factory){banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.call(this,capacity);for(var vector=this.vector,_g=0,_g1=vector.length;_g<_g1;){vector[i=_g++]=factory()}var len=vector.length;if(0!=len)for(var tmp,i=0,k=len;i<len;){--k;tmp=vector[i],vector[i]=vector[k],vector[k]=tmp,++i}this.nextFreeSlotIndex=capacity};$hxClasses["banker.pool.ObjectPoolBuffer_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap"]=banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__name__="banker.pool.ObjectPoolBuffer_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap",banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__interfaces__=[ripper_Body],banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__super__=banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype=$extend(banker_container_buffer_top_$aligned_TopAlignedBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype,{__class__:banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap});var banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap=function(capacity,factory){var _gthis=this;banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.call(this,capacity,factory),this.putCallback=function(element){_gthis.put(element)}};$hxClasses["banker.pool.ObjectPoolBase_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap"]=banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__name__="banker.pool.ObjectPoolBase_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap",banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__interfaces__=[banker_pool_interfaces_ObjectPool],banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__super__=banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype=$extend(banker_pool_ObjectPoolBuffer_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype,{get:function(){var index=this.nextFreeSlotIndex-1;return this.nextFreeSlotIndex=index,this.vector[index]},put:function(element){var index=this.nextFreeSlotIndex;this.vector[index]=element;var this1=index+1;this.nextFreeSlotIndex=this1},__class__:banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap});var banker_pool_ObjectPoolBuffer_$h2d_$Bitmap=function(capacity,factory){banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap.call(this,capacity);for(var vector=this.vector,_g=0,_g1=vector.length;_g<_g1;){vector[i=_g++]=factory()}var len=vector.length;if(0!=len)for(var tmp,i=0,k=len;i<len;){--k;tmp=vector[i],vector[i]=vector[k],vector[k]=tmp,++i}this.nextFreeSlotIndex=capacity};$hxClasses["banker.pool.ObjectPoolBuffer_h2d_Bitmap"]=banker_pool_ObjectPoolBuffer_$h2d_$Bitmap,banker_pool_ObjectPoolBuffer_$h2d_$Bitmap.__name__="banker.pool.ObjectPoolBuffer_h2d_Bitmap",banker_pool_ObjectPoolBuffer_$h2d_$Bitmap.__interfaces__=[ripper_Body],banker_pool_ObjectPoolBuffer_$h2d_$Bitmap.__super__=banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap,banker_pool_ObjectPoolBuffer_$h2d_$Bitmap.prototype=$extend(banker_container_buffer_top_$aligned_TopAlignedBuffer_$h2d_$Bitmap.prototype,{__class__:banker_pool_ObjectPoolBuffer_$h2d_$Bitmap});var banker_pool_ObjectPoolBase_$h2d_$Bitmap=function(capacity,factory){var _gthis=this;banker_pool_ObjectPoolBuffer_$h2d_$Bitmap.call(this,capacity,factory),this.putCallback=function(element){_gthis.put(element)}};$hxClasses["banker.pool.ObjectPoolBase_h2d_Bitmap"]=banker_pool_ObjectPoolBase_$h2d_$Bitmap,banker_pool_ObjectPoolBase_$h2d_$Bitmap.__name__="banker.pool.ObjectPoolBase_h2d_Bitmap",banker_pool_ObjectPoolBase_$h2d_$Bitmap.__interfaces__=[banker_pool_interfaces_ObjectPool],banker_pool_ObjectPoolBase_$h2d_$Bitmap.__super__=banker_pool_ObjectPoolBuffer_$h2d_$Bitmap,banker_pool_ObjectPoolBase_$h2d_$Bitmap.prototype=$extend(banker_pool_ObjectPoolBuffer_$h2d_$Bitmap.prototype,{get:function(){var index=this.nextFreeSlotIndex-1;return this.nextFreeSlotIndex=index,this.vector[index]},put:function(element){var index=this.nextFreeSlotIndex;this.vector[index]=element;var this1=index+1;this.nextFreeSlotIndex=this1},__class__:banker_pool_ObjectPoolBase_$h2d_$Bitmap});var banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap=function(capacity,factory){banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.call(this,capacity,factory),this.factory=factory};$hxClasses["banker.pool.SafeObjectPool_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap"]=banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__name__="banker.pool.SafeObjectPool_broker_timer_builtin_heaps_PooledFadeOutTimer_h2d_Bitmap",banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.__super__=banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype=$extend(banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype,{get:function(){if(0!=this.nextFreeSlotIndex)return banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype.get.call(this);this.tag;return this.factory()},put:function(element){if(this.nextFreeSlotIndex<this.vector.length)banker_pool_ObjectPoolBase_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype.put.call(this,element);else this.tag},newTag:function(name,bits){return this.tag=new sneaker_tag_Tag(name,bits),this},__class__:banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap});var banker_pool_SafeObjectPool_$h2d_$Bitmap=function(capacity,factory){banker_pool_ObjectPoolBase_$h2d_$Bitmap.call(this,capacity,factory),this.factory=factory};$hxClasses["banker.pool.SafeObjectPool_h2d_Bitmap"]=banker_pool_SafeObjectPool_$h2d_$Bitmap,banker_pool_SafeObjectPool_$h2d_$Bitmap.__name__="banker.pool.SafeObjectPool_h2d_Bitmap",banker_pool_SafeObjectPool_$h2d_$Bitmap.__super__=banker_pool_ObjectPoolBase_$h2d_$Bitmap,banker_pool_SafeObjectPool_$h2d_$Bitmap.prototype=$extend(banker_pool_ObjectPoolBase_$h2d_$Bitmap.prototype,{get:function(){if(0!=this.nextFreeSlotIndex)return banker_pool_ObjectPoolBase_$h2d_$Bitmap.prototype.get.call(this);this.tag;return this.factory()},put:function(element){if(this.nextFreeSlotIndex<this.vector.length)banker_pool_ObjectPoolBase_$h2d_$Bitmap.prototype.put.call(this,element);else this.tag},newTag:function(name,bits){return this.tag=new sneaker_tag_Tag(name,bits),this},__class__:banker_pool_SafeObjectPool_$h2d_$Bitmap});var h3d_IDrawable=function(){};$hxClasses["h3d.IDrawable"]=h3d_IDrawable,h3d_IDrawable.__name__="h3d.IDrawable",h3d_IDrawable.__isInterface__=!0;var hxd_App=function(){var _gthis=this,engine=h3d_Engine.CURRENT;null!=engine?(this.engine=engine,engine.onReady=$bind(this,this.setup),haxe_Timer.delay($bind(this,this.setup),0)):hxd_System.start((function(){engine=new h3d_Engine,_gthis.engine=engine,engine.onReady=$bind(_gthis,_gthis.setup),engine.init()}))};$hxClasses["hxd.App"]=hxd_App,hxd_App.__name__="hxd.App",hxd_App.__interfaces__=[h3d_IDrawable],hxd_App.staticHandler=function(){},hxd_App.prototype={onResize:function(){},setScene:function(scene,disposePrevious){null==disposePrevious&&(disposePrevious=!0);var new2D=scene instanceof h2d_Scene?scene:null,new3D=scene instanceof h3d_scene_Scene?scene:null;if(null!=new2D?(this.sevents.removeScene(this.s2d),this.sevents.addScene(scene,0)):(null!=new3D&&this.sevents.removeScene(this.s3d),this.sevents.addScene(scene)),disposePrevious)if(null!=new2D)this.s2d.dispose();else{if(null==new3D)throw haxe_Exception.thrown("Can't dispose previous scene");this.s3d.dispose()}null!=new2D&&(this.s2d=new2D),null!=new3D&&(this.s3d=new3D)},render:function(e){this.s3d.render(e),this.s2d.render(e)},setup:function(){var _gthis=this,initDone=!1;this.engine.onReady=hxd_App.staticHandler,this.engine.onResized=function(){null!=_gthis.s2d&&(_gthis.s2d.checkResize(),initDone&&_gthis.onResize())},this.s3d=new h3d_scene_Scene,this.s2d=new h2d_Scene,this.sevents=new hxd_SceneEvents,this.sevents.addScene(this.s2d),this.sevents.addScene(this.s3d),this.loadAssets((function(){initDone=!0,_gthis.init(),hxd_Timer.skip(),_gthis.mainLoop(),hxd_System.setLoop($bind(_gthis,_gthis.mainLoop)),hxd_Key.initialize()}))},loadAssets:function(onLoaded){onLoaded()},init:function(){},mainLoop:function(){if(hxd_Timer.update(),this.sevents.checkEvents(),!this.isDisposed&&(this.update(hxd_Timer.dt),!this.isDisposed)){var dt=hxd_Timer.dt;null!=this.s2d&&this.s2d.setElapsedTime(dt),null!=this.s3d&&this.s3d.setElapsedTime(dt),this.engine.render(this)}},update:function(dt){},__class__:hxd_App};var broker_HeapsApp=function(app){hxd_App.call(this),this.app=app};$hxClasses["broker.HeapsApp"]=broker_HeapsApp,broker_HeapsApp.__name__="broker.HeapsApp",broker_HeapsApp.__super__=hxd_App,broker_HeapsApp.prototype=$extend(hxd_App.prototype,{init:function(){broker_tools_Window.initialize(this.app.startFullscreen),broker_input_physical_Key.initialize(),broker_input_physical_Pad.initialize(),broker_scene_heaps_Scene.setApplication(broker_App.data),(new broker_scene_heaps_Scene).activate(),this.app.initialize()},update:function(dt){this.app.update();this.app;broker_sound_SoundManager.update(),++broker_App.frameCount},render:function(e){hxd_App.prototype.render.call(this,e)},__class__:broker_HeapsApp});var broker_draw_heaps_BatchDraw={addSprites:function(this1,sprites,endIndex){for(var i=0;i<endIndex;){var e=sprites[i];if(e.batch=this1,null==this1.first)this1.first=e,this1.last=e,e.prev=null,e.next=null;else{var last=this1.last;last.next=e,e.prev=last,e.next=null,this1.last=e}++i}},removeSprites:function(this1,sprites,endIndex){for(var i=0;i<endIndex;)this1.delete(sprites[i]),++i}},broker_input_physical_Key=function(){};$hxClasses["broker.input.physical.Key"]=broker_input_physical_Key,broker_input_physical_Key.__name__="broker.input.physical.Key",broker_input_physical_Key.initialize=function(){broker_input_physical_heaps_Key.initialize()};var broker_input_physical_Pad={initialize:function(){broker_input_physical_heaps_Pad.initialize()}},hxd_Pad=function(){this.rawYAxis=0,this.rawXAxis=0,this.prevButtons=[],this.values=[],this.buttons=[],this.config=hxd_Pad.DEFAULT_CONFIG,this.index=-1,this.connected=!0};$hxClasses["hxd.Pad"]=hxd_Pad,hxd_Pad.__name__="hxd.Pad",hxd_Pad.pickConfig=function(name){switch(name){case"054c-05c4-Wireless Controller":case"054c-09cc-Wireless Controller":return hxd_Pad.CONFIG_JS_DS4_FF;case"Wireless Controller (STANDARD GAMEPAD Vendor: 054c Product: 05c4)":case"Wireless Controller (STANDARD GAMEPAD Vendor: 054c Product: 09cc)":return hxd_Pad.CONFIG_JS_DS4;default:return hxd_Pad.CONFIG_JS_STD}},hxd_Pad.createDummy=function(){var p=new hxd_Pad;return p.connected=!1,p},hxd_Pad.wait=function(onPad){hxd_Pad.waitPad=onPad,hxd_Pad.initDone||(hxd_Pad.initDone=!0,window.addEventListener("gamepadconnected",(function(p){var pad=new hxd_Pad;pad.d=p.gamepad,pad.config=hxd_Pad.pickConfig(pad.d.id),pad.index=pad.d.index,hxd_Pad.pads.h[pad.d.index]=pad,hxd_Pad.waitPad(pad)})),window.addEventListener("gamepaddisconnected",(function(p){var pad=hxd_Pad.pads.h[p.gamepad.index];null!=pad&&(hxd_Pad.pads.remove(p.gamepad.index),pad.connected=!1,pad.onDisconnect())})),haxe_MainLoop.add(hxd_Pad.syncPads))},hxd_Pad.syncPads=function(){var freshPads=[];try{freshPads=$global.navigator.getGamepads()}catch(_g){}if(freshPads.length>0)for(var _g=0,_g1=freshPads.length;_g<_g1;){var i=_g++;null!=hxd_Pad.pads.h[i]&&(hxd_Pad.pads.h[i].d=freshPads[i])}for(var p=hxd_Pad.pads.iterator();p.hasNext();){var p1=p.next();for(_g=0,_g1=p1.d.buttons.length;_g<_g1;){i=_g++;p1.prevButtons[i]=p1.buttons[i],p1.buttons[i]=p1.d.buttons[i].pressed,p1.values[i]=p1.d.buttons[i].value}for(var _g2=0,_g3=p1.d.axes.length>>1;_g2<_g3;){var i1=_g2++,x=p1.d.axes[i1<<1],y=p1.d.axes[1+(i1<<1)];p1.values[(i1<<1)+p1.d.buttons.length]=x,p1.values[(i1<<1)+p1.d.buttons.length+1]=-y,0==i1&&(p1.rawXAxis=x,p1.rawYAxis=y)}}},hxd_Pad.prototype={onDisconnect:function(){},__class__:hxd_Pad};var broker_input_physical_heaps_Pad={initialize:function(){hxd_Pad.wait(broker_input_physical_PadMultitap.connect)},setOnDisconnect:function(this1,callback){this1.onDisconnect=callback}},broker_input_physical_PadMultitap=function(){};$hxClasses["broker.input.physical.PadMultitap"]=broker_input_physical_PadMultitap,broker_input_physical_PadMultitap.__name__="broker.input.physical.PadMultitap",broker_input_physical_PadMultitap.onConnect=function(pad,portIndex){},broker_input_physical_PadMultitap.onDisconnect=function(pad,portIndex){},broker_input_physical_PadMultitap.connect=function(pad){for(var _this=broker_input_physical_PadMultitap.ports,predicate=broker_input_physical_PadMultitap.portIsEmpty,endIndex=_this.length,found=-1,i=0;i<endIndex;){if(predicate(_this[i])){found=i;break}++i}if(-1!=found){var index=found;broker_input_physical_PadMultitap.ports[index][0]=pad,broker_input_physical_PadMultitap.onConnect(pad,index),broker_input_physical_heaps_Pad.setOnDisconnect(pad,(function(){broker_input_physical_PadMultitap.onDisconnect(pad,index),broker_input_physical_PadMultitap.ports[index][0]=broker_input_physical_heaps_Pad.NULL}))}},broker_input_physical_PadMultitap.portIsEmpty=function(port){return port[0]==broker_input_physical_heaps_Pad.NULL},broker_input_physical_PadMultitap.createPorts=function(capacity){for(var _this=this1=this1=new Array(capacity),_g=0,_g1=_this.length;_g<_g1;){var this1=_g++,vector=new Array(1);vector[0]=broker_input_physical_heaps_Pad.NULL;var this6=vector;_this[this1]=this6}return _this};var broker_input_physical_heaps_Key=function(){};$hxClasses["broker.input.physical.heaps.Key"]=broker_input_physical_heaps_Key,broker_input_physical_heaps_Key.__name__="broker.input.physical.heaps.Key",broker_input_physical_heaps_Key.initialize=function(){hxd_Key.initialize(),hxd_Key.keyPressed.length=256};var broker_scene_Layers=function(){var this2=new h2d_Object;this.background=this2;this2=new h2d_Object;this.main=this2;this2=new h2d_Object;this.surface=this2};$hxClasses["broker.scene.Layers"]=broker_scene_Layers,broker_scene_Layers.__name__="broker.scene.Layers",broker_scene_Layers.prototype={addTo:function(object){object.addChild(this.background),object.addChild(this.main),object.addChild(this.surface)},__class__:broker_scene_Layers};var broker_scene_SceneStack=function(initialScene,capacity){sneaker_tag_Tagged.call(this),this.scenes=[initialScene];initialScene.sceneStack=this,initialScene.activate()};$hxClasses["broker.scene.SceneStack"]=broker_scene_SceneStack,broker_scene_SceneStack.__name__="broker.scene.SceneStack",broker_scene_SceneStack.__super__=sneaker_tag_Tagged,broker_scene_SceneStack.prototype=$extend(sneaker_tag_Tagged.prototype,{peek:function(){var _this=this.scenes;return _this[_this.length-1]},update:function(){this.peek().step()},__class__:broker_scene_SceneStack});var broker_scene_internal_Scene=function(data,layers,timersCapacity){null==timersCapacity&&(timersCapacity=16);var _gthis=this;this.data=data,this.isInitialized=!1;this.sceneStack=null,this.layers=layers,this.timers=new broker_timer_Timers(timersCapacity),this.isActive=!1,this.isTransitioning=!1,this.setTransitionState=broker_scene_internal__$Scene_SceneStatics.dummyCallback,this.unsetTransitionState=broker_scene_internal__$Scene_SceneStatics.dummyCallback,this.setTransitionState=function(){_gthis.isTransitioning=!0},this.unsetTransitionState=function(){_gthis.isTransitioning=!1}};$hxClasses["broker.scene.internal.Scene"]=broker_scene_internal_Scene,broker_scene_internal_Scene.__name__="broker.scene.internal.Scene",broker_scene_internal_Scene.prototype={initialize:function(){this.isInitialized=!0},update:function(){},step:function(){this.isActive&&this.update(),this.timers.step()},activate:function(){this.isInitialized||this.initialize(),this.isTransitioning=!1,this.isActive=!0,this.step()},__class__:broker_scene_internal_Scene};var broker_scene_heaps_Scene=function(heapsScene,timersCapacity){var hScene=null!=heapsScene?heapsScene:new h2d_Scene;hScene.ctx.defaultSmooth=!0,hScene.set_scaleMode(h2d_ScaleMode.LetterBox(broker_App.width,broker_App.height));var layers=new broker_scene_Layers;broker_scene_internal_Scene.call(this,hScene,layers,timersCapacity);var mask=new h2d_Mask(broker_App.width,broker_App.height,hScene);layers.addTo(mask)};$hxClasses["broker.scene.heaps.Scene"]=broker_scene_heaps_Scene,broker_scene_heaps_Scene.__name__="broker.scene.heaps.Scene",broker_scene_heaps_Scene.setApplication=function(app){broker_scene_heaps_SceneStatics.setApplication(app)},broker_scene_heaps_Scene.__super__=broker_scene_internal_Scene,broker_scene_heaps_Scene.prototype=$extend(broker_scene_internal_Scene.prototype,{activate:function(){broker_scene_internal_Scene.prototype.activate.call(this),broker_scene_heaps_SceneStatics.heapsApp.setScene(this.data,!1)},fadeInFrom:function(color,duration,startNow){var bitmap=this.useSurfaceBitmap(color);bitmap.alpha=0;var timer=broker_scene_heaps_SceneStatics.bitmapFadeOutTimerPool.use(bitmap,duration,!0);if(timer.setOnCompleteObject(broker_scene_heaps_SceneStatics.bitmapPool.putCallback),startNow){var _this=this.timers,index=_this.bufferSize;_this.bufferVector[index]=timer;var this1=index+1;_this.bufferSize=this1,timer.setParent(_this)}return timer},useSurfaceBitmap:function(color){var bitmap=this.resetCoverBitmap(broker_scene_heaps_SceneStatics.bitmapPool.get(),color);return this.layers.surface.addChild(bitmap),bitmap},resetCoverBitmap:function(bitmap,color){var this1=16777215&color,value=.00392156862745098*(color>>>24),this2=value<0?0:value>1?1:value,texture=h3d_mat_Texture.fromColor(this1,this2),tile=bitmap.tile;tile.setTexture(texture);var heapsScene=this.data;return tile.setSize(heapsScene.width,heapsScene.height),bitmap},__class__:broker_scene_heaps_Scene});var broker_timer_Timer=function(duration,onStart,onComplete){this.progress=0,this.progressChangeRate=1,this.onStartCallback=null!=onStart?onStart:broker_timer_Timer.dummyCallback,this.onCompleteCallback=null!=onComplete?onComplete:broker_timer_Timer.dummyCallback;var this1=null;this.next=this1;this1=null;this.parent=this1,null!=duration&&this.setDuration(duration)};$hxClasses["broker.timer.Timer"]=broker_timer_Timer,broker_timer_Timer.__name__="broker.timer.Timer",broker_timer_Timer.dummyCallback=function(){},broker_timer_Timer.prototype={step:function(){var progress=this.progress;return 0==progress?(this.onStart(),this.onProgress(progress),this.progress=progress+this.progressChangeRate,!1):progress<1?(this.onProgress(progress),this.progress=progress+this.progressChangeRate,!1):(this.onComplete(),!0)},clearCallbacks:function(){return this.onStartCallback=broker_timer_Timer.dummyCallback,this.onCompleteCallback=broker_timer_Timer.dummyCallback,this},clearNext:function(){return this.next=null,this},clearParent:function(){return this.parent=null,this},setParent:function(parent){var this1=parent;return this.parent=this1,this},setDuration:function(duration){return this.progress=0,this.progressChangeRate=0==duration?0:1/duration,this},onStart:function(){this.onStartCallback()},onProgress:function(progress){},onComplete:function(){var parent=this.parent,next=this.next;if(null!=parent&&null!=next){var _this=parent,timer=next,index=_this.bufferSize;_this.bufferVector[index]=timer;var this1=index+1;_this.bufferSize=this1,timer.setParent(_this)}this.onCompleteCallback()},__class__:broker_timer_Timer};var broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap=function(){this.object=null,broker_timer_Timer.call(this),this.onStartObjectCallback=broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics.dummyObjectCallback,this.onCompleteObjectCallback=broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics.dummyObjectCallback};$hxClasses["broker.timer.builtin.heaps.ObjectTimer_h2d_Bitmap"]=broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap,broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap.__name__="broker.timer.builtin.heaps.ObjectTimer_h2d_Bitmap",broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap.__super__=broker_timer_Timer,broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap.prototype=$extend(broker_timer_Timer.prototype,{clearCallbacks:function(){return broker_timer_Timer.prototype.clearCallbacks.call(this),this.onStartObjectCallback=broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics.dummyObjectCallback,this.onCompleteObjectCallback=broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics.dummyObjectCallback,this},setOnCompleteObject:function(callback){return this.onCompleteObjectCallback=callback,this},onStart:function(){broker_timer_Timer.prototype.onStart.call(this),this.onStartObjectCallback(this.object)},onComplete:function(){broker_timer_Timer.prototype.onComplete.call(this),this.onCompleteObjectCallback(this.object)},__class__:broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap});var broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics=function(){};$hxClasses["broker.timer.builtin.heaps._ObjectTimer.ObjectTimerStatics"]=broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics,broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics.__name__="broker.timer.builtin.heaps._ObjectTimer.ObjectTimerStatics",broker_timer_builtin_heaps__$ObjectTimer_ObjectTimerStatics.dummyObjectCallback=function(object){};var broker_timer_builtin_heaps_FadeOutTimerPool_$h2d_$Bitmap=function(capacity){var _gthis=this;banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.call(this,capacity,(function(){return new broker_timer_builtin_heaps_PooledFadeOutTimer_$h2d_$Bitmap(_gthis)}))};$hxClasses["broker.timer.builtin.heaps.FadeOutTimerPool_h2d_Bitmap"]=broker_timer_builtin_heaps_FadeOutTimerPool_$h2d_$Bitmap,broker_timer_builtin_heaps_FadeOutTimerPool_$h2d_$Bitmap.__name__="broker.timer.builtin.heaps.FadeOutTimerPool_h2d_Bitmap",broker_timer_builtin_heaps_FadeOutTimerPool_$h2d_$Bitmap.__super__=banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap,broker_timer_builtin_heaps_FadeOutTimerPool_$h2d_$Bitmap.prototype=$extend(banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype,{get:function(){throw haxe_Exception.thrown("Not implemented. Call use() instead of get().")},use:function(object,duration,removeOnComplete){null==removeOnComplete&&(removeOnComplete=!1);var timer=banker_pool_SafeObjectPool_$broker_$timer_$builtin_$heaps_$PooledFadeOutTimer_$h2d_$Bitmap.prototype.get.call(this);return broker_timer_TimerExtension.reset(timer,duration),timer.object=object,timer.pool=this,timer.removeOnComplete=removeOnComplete,timer},__class__:broker_timer_builtin_heaps_FadeOutTimerPool_$h2d_$Bitmap});var broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap=function(){this.removeOnComplete=!1,broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap.call(this)};$hxClasses["broker.timer.builtin.heaps.FadeOutTimer_h2d_Bitmap"]=broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap,broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap.__name__="broker.timer.builtin.heaps.FadeOutTimer_h2d_Bitmap",broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap.__super__=broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap,broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap.prototype=$extend(broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap.prototype,{onProgress:function(progress){this.object.alpha=1-progress},onComplete:function(){broker_timer_builtin_heaps_ObjectTimer_$h2d_$Bitmap.prototype.onComplete.call(this);var object=this.object;this.removeOnComplete?null!=object&&null!=object.parent&&object.parent.removeChild(object):object.alpha=0},__class__:broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap});var broker_timer_builtin_heaps_PooledFadeOutTimer_$h2d_$Bitmap=function(pool){broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap.call(this),this.pool=pool};$hxClasses["broker.timer.builtin.heaps.PooledFadeOutTimer_h2d_Bitmap"]=broker_timer_builtin_heaps_PooledFadeOutTimer_$h2d_$Bitmap,broker_timer_builtin_heaps_PooledFadeOutTimer_$h2d_$Bitmap.__name__="broker.timer.builtin.heaps.PooledFadeOutTimer_h2d_Bitmap",broker_timer_builtin_heaps_PooledFadeOutTimer_$h2d_$Bitmap.__super__=broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap,broker_timer_builtin_heaps_PooledFadeOutTimer_$h2d_$Bitmap.prototype=$extend(broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap.prototype,{onComplete:function(){broker_timer_builtin_heaps_FadeOutTimer_$h2d_$Bitmap.prototype.onComplete.call(this),this.pool.put(this)},__class__:broker_timer_builtin_heaps_PooledFadeOutTimer_$h2d_$Bitmap});var broker_scene_heaps_SceneStatics=function(){};$hxClasses["broker.scene.heaps.SceneStatics"]=broker_scene_heaps_SceneStatics,broker_scene_heaps_SceneStatics.__name__="broker.scene.heaps.SceneStatics",broker_scene_heaps_SceneStatics.setApplication=function(app){broker_scene_heaps_SceneStatics.heapsApp=app;var pool=new banker_pool_SafeObjectPool_$h2d_$Bitmap(4,(function(){return new h2d_Bitmap(h2d_Tile.fromColor(16777215))}));pool.newTag("Scene Bitmap pool"),broker_scene_heaps_SceneStatics.bitmapPool=pool};var broker_scene_internal__$Scene_SceneStatics=function(){};$hxClasses["broker.scene.internal._Scene.SceneStatics"]=broker_scene_internal__$Scene_SceneStatics,broker_scene_internal__$Scene_SceneStatics.__name__="broker.scene.internal._Scene.SceneStatics",broker_scene_internal__$Scene_SceneStatics.dummyCallback=function(){};var broker_sound_Sound=function(data,defaultVolume,minInterval,isLooped,maxQueueCount,allowsLayered,onPlay){null==allowsLayered&&(allowsLayered=!1),null==maxQueueCount&&(maxQueueCount=0),null==isLooped&&(isLooped=!1),null==minInterval&&(minInterval=1),null==defaultVolume&&(defaultVolume=1),this.data=data,this.defaultVolume=defaultVolume,this.minInterval=minInterval,this.isLooped=isLooped,this.maxQueueCount=maxQueueCount,this.allowsLayered=allowsLayered,this.onPlay=null!=onPlay?onPlay:broker_sound_Sound.emptyOnPlay;this.lastPlayedChannel=null,this.lastPlayedFrameCount=0};$hxClasses["broker.sound.Sound"]=broker_sound_Sound,broker_sound_Sound.__name__="broker.sound.Sound",broker_sound_Sound.emptyOnPlay=function(sound,channel){},broker_sound_Sound.prototype={play:function(){var currentFrameCount=broker_sound_SoundManager.frameCount,lastChannel=this.lastPlayedChannel;if(null!=lastChannel){if((this1=currentFrameCount-this.lastPlayedFrameCount)<this.minInterval)return broker_sound_SoundManager.enqueue(this),this1=null;this.allowsLayered||lastChannel.stop()}var newChannel=this.data.play(this.isLooped,this.defaultVolume);this.onPlay(this,newChannel);var this1=newChannel;return this.lastPlayedChannel=this1,this.lastPlayedFrameCount=currentFrameCount,this1=newChannel},__class__:broker_sound_Sound};var broker_sound_SoundManager=function(){};$hxClasses["broker.sound.SoundManager"]=broker_sound_SoundManager,broker_sound_SoundManager.__name__="broker.sound.SoundManager",broker_sound_SoundManager.updateQueues=function(sound,queueCount){if(broker_sound_SoundManager.frameCount-sound.lastPlayedFrameCount<sound.minInterval)return!1;sound.play();--queueCount;for(var _this=broker_sound_SoundManager.queuedSounds,size=_this.nextFreeSlotIndex,keys=_this.keyVector,_this1=keys,found=-1,i=0;i<size;){if(_this1[i]==sound){found=i;break}++i}if(-1!=(index=found))_this.valueVector[index]=queueCount;else{keys[size]=sound,_this.valueVector[size]=queueCount;var index=size+1;_this.nextFreeSlotIndex=index}return 0==queueCount},broker_sound_SoundManager.enqueue=function(sound){var maxQueueCount=sound.maxQueueCount;if(0!=maxQueueCount){for(var queuedSounds=broker_sound_SoundManager.queuedSounds,_this=queuedSounds.keyVector,endIndex=queuedSounds.nextFreeSlotIndex,found=!1,i=0;i<endIndex;){if(_this[i]==sound){found=!0;break}++i}if(found){for(_this=queuedSounds.keyVector,endIndex=queuedSounds.nextFreeSlotIndex,found=-1,i=0;i<endIndex;){if(_this[i]==sound){found=i;break}++i}var index=found,nextQueueCount=this1=queuedSounds.valueVector[index]+1;if(nextQueueCount<=maxQueueCount){var size=queuedSounds.nextFreeSlotIndex;for(_this=keys=queuedSounds.keyVector,found=-1,i=0;i<size;){if(_this[i]==sound){found=i;break}++i}if(-1!=(index=found))queuedSounds.valueVector[index]=nextQueueCount;else{keys[size]=sound,queuedSounds.valueVector[size]=nextQueueCount;index=this1=size+1;queuedSounds.nextFreeSlotIndex=index}}}else{if(queuedSounds.nextFreeSlotIndex==queuedSounds.keyVector.length){var this1=2;queuedSounds=new banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt(queuedSounds.keyVector.length*this1),broker_sound_SoundManager.queuedSounds=queuedSounds}var keys;for(size=queuedSounds.nextFreeSlotIndex,_this=keys=queuedSounds.keyVector,found=-1,i=0;i<size;){if(_this[i]==sound){found=i;break}++i}if(-1!=(index=found))queuedSounds.valueVector[index]=1;else{keys[size]=sound,queuedSounds.valueVector[size]=1;index=this1=size+1;queuedSounds.nextFreeSlotIndex=index}}}},broker_sound_SoundManager.update=function(){var timer=(this1=broker_sound_SoundManager.masterVolumeChangeTimer)[0];if(null!=timer&&timer.step()){this1[0]=null}for(var _this=broker_sound_SoundManager.queuedSounds,predicate=broker_sound_SoundManager.updateQueues,keys=_this.keyVector,values=_this.valueVector,len=_this.nextFreeSlotIndex,i=0;i<len;)if(predicate(keys[i],values[i])){var this1=--len;keys[i]=keys[len],values[i]=values[len],!0}else++i;_this.nextFreeSlotIndex=len,++broker_sound_SoundManager.frameCount};var broker_sound_heaps_SoundManagerData=function(){};$hxClasses["broker.sound.heaps.SoundManagerData"]=broker_sound_heaps_SoundManagerData,broker_sound_heaps_SoundManagerData.__name__="broker.sound.heaps.SoundManagerData",broker_sound_heaps_SoundManagerData.disposeAll=function(){hxd_snd_Manager.get().dispose()};var broker_timer_TimerExtension=function(){};$hxClasses["broker.timer.TimerExtension"]=broker_timer_TimerExtension,broker_timer_TimerExtension.__name__="broker.timer.TimerExtension",broker_timer_TimerExtension.reset=function(_this,duration){return _this.setDuration(duration),_this.clearCallbacks(),_this.clearNext(),_this.clearParent(),_this};var broker_timer_Timers=function(capacity){var this1=this1=new Array(capacity);this.vector=this1,this.size=0;this1=this1=new Array(capacity);this.bufferVector=this1,this.bufferSize=0};$hxClasses["broker.timer.Timers"]=broker_timer_Timers,broker_timer_Timers.__name__="broker.timer.Timers",broker_timer_Timers.prototype={step:function(){var vector=this.vector,size=this.size,bufferSize=this.bufferSize;if(0!=bufferSize){var this1=0;haxe_ds_Vector.blit(this.bufferVector,this1,vector,size,bufferSize),this.bufferSize=0,size=this1=size+bufferSize}for(var readIndex=0,writeIndex=0;readIndex<size;){var timer=vector[readIndex];++readIndex,timer.step()?timer.clearParent():(vector[writeIndex]=timer,++writeIndex)}this.size=writeIndex},__class__:broker_timer_Timers};var broker_tools_PerformanceProfiler=function(){};$hxClasses["broker.tools.PerformanceProfiler"]=broker_tools_PerformanceProfiler,broker_tools_PerformanceProfiler.__name__="broker.tools.PerformanceProfiler",broker_tools_PerformanceProfiler.stop=function(){};var broker_tools_Window=function(){};$hxClasses["broker.tools.Window"]=broker_tools_Window,broker_tools_Window.__name__="broker.tools.Window",broker_tools_Window.onClose=function(){},broker_tools_Window.initialize=function(fullscreen){hxd_Window.getInstance().onClose=function(){return broker_tools_Window.prepareClose(),!0}},broker_tools_Window.prepareClose=function(){broker_sound_heaps_SoundManagerData.disposeAll(),broker_tools_PerformanceProfiler.stop(),broker_tools_Window.onClose()};var firedancer_assembly_Assembler=function(){};$hxClasses["firedancer.assembly.Assembler"]=firedancer_assembly_Assembler,firedancer_assembly_Assembler.__name__="firedancer.assembly.Assembler",firedancer_assembly_Assembler.assemble=function(code){for(var labelPositionMap=new haxe_ds_IntMap,instructions=[],lengthInBytes=0,_g=0,_g1=code.length;_g<_g1;){var cur=code[_g++];if(2==cur._hx_index){var labelId=cur.labelId;labelPositionMap.h[labelId]=lengthInBytes}else{instructions.push(cur);lengthInBytes=this2=lengthInBytes+firedancer_assembly_InstructionExtension.bytecodeLength(cur)}}var variableTable=new firedancer_assembly_VariableTable,words=[];for(_g=0,_g1=instructions.length;_g<_g1;){var instruction=instructions[_g++],curWords=firedancer_assembly_InstructionAssembler.toWordArray(instruction,labelPositionMap,variableTable),writeIndex=this2=words.length,readIndex=0,otherLength=curWords.length,this4=writeIndex+otherLength;for(words.length=this4;readIndex<otherLength;){var this5=readIndex;words[writeIndex]=curWords[this5],++writeIndex,++readIndex}}var length=0;for(_g=0,_g1=words.length;_g<_g1;){switch((_g2=words[_g++])._hx_index){case 0:_g2.code;this2=1;break;case 1:_g2.value;this2=4;break;case 2:_g2.value;this2=8}length=length+this2}var bytes=new haxe_io_Bytes(new ArrayBuffer(length)),data=bytes,pos=0;for(_g=0,_g1=words.length;_g<_g1;){var _g2;switch((_g2=words[_g++])._hx_index){case 0:var this2=_g2.code;data.b[pos]=this2,pos=pos+1;break;case 1:var v=_g2.value;data.setInt32(pos,v),pos=this4=pos+4;break;case 2:var v1=_g2.value;data.setDouble(pos,v1),pos=this5=pos+8}}return bytes};var firedancer_assembly_VariableTable=function(){this.addressStackMap=new haxe_ds_StringMap,this.table=[]};$hxClasses["firedancer.assembly.VariableTable"]=firedancer_assembly_VariableTable,firedancer_assembly_VariableTable.__name__="firedancer.assembly.VariableTable",firedancer_assembly_VariableTable.notFound=function(key){return"Variable not found: "+key},firedancer_assembly_VariableTable.prototype={let:function(key,type){for(var address=0,inserted=!1,_g=0,_g1=this1=this.table.length;_g<_g1;){var this2,i=_g++,this1=i,entry=this.table[this1];switch(type){case 0:this2=4;break;case 1:this2=8;break;case 2:this2=16}if(address+this2<entry.address){this.table.splice(i,0,{key:key,address:address,type:type}),inserted=!0;break}var b,a=entry.address;switch(entry.type){case 0:b=4;break;case 1:b=8;break;case 2:b=16}address=a+b}if(!inserted)this1=this.table.push({key:key,address:address,type:type});var addressStack=this.addressStackMap.h[key];if(null!=addressStack)this1=addressStack.push(address);else this.addressStackMap.h[key]=[address]},getAddress:function(key){var addressStack=this.addressStackMap.h[key];if(null==addressStack)throw haxe_Exception.thrown(firedancer_assembly_VariableTable.notFound(key));var address,this2=addressStack.length-1;-1!=this2?address=addressStack[this2]:address=null;if(null==address)throw haxe_Exception.thrown(firedancer_assembly_VariableTable.notFound(key));return address},free:function(key){var addressStack=this.addressStackMap.h[key];if(null==addressStack)throw haxe_Exception.thrown(firedancer_assembly_VariableTable.notFound(key));for(var address=addressStack.pop(),table=this.table,_g=0,_g1=table.length;_g<_g1;){var i=_g++,entry=table[i];if(entry.key==key&&entry.address==address){var index=i,arrayLength=table.length,rangeLength=arrayLength-index-1,sourceIndex=(table[index],index+1);if(sourceIndex<index)for(var i1=sourceIndex+rangeLength,k=index+rangeLength;i1>sourceIndex;){--i1,--k;table[k]=table[i1]}else if(sourceIndex>index)for(var i2=sourceIndex,k1=index,endI=sourceIndex+rangeLength;i2<endI;)table[k1]=table[i2],++i2,++k1;var this12=arrayLength-1;table.length=this12;break}}},__class__:firedancer_assembly_VariableTable};var firedancer_assembly_AssemblyCode={toString:function(this1){var len=this1.length,newArray=[];newArray.length=len;for(var newArray1=newArray,i=0;i<len;)newArray1[i]=firedancer_assembly_InstructionExtension.toString(this1[i]),++i;return newArray1.join("\n")+"\n"}},firedancer_assembly_AssemblyCodePackage=function(codeList,nameIndexMap){this.codeList=codeList,this.nameIndexMap=nameIndexMap};$hxClasses["firedancer.assembly.AssemblyCodePackage"]=firedancer_assembly_AssemblyCodePackage,firedancer_assembly_AssemblyCodePackage.__name__="firedancer.assembly.AssemblyCodePackage",firedancer_assembly_AssemblyCodePackage.prototype={optimize:function(){var this1=this.codeList,callback=firedancer_assembly_Optimizer.optimize,len=this1.length,newArray=[];newArray.length=len;for(var newArray1=newArray,i=0;i<len;)newArray1[i]=callback(this1[i]),++i;return new firedancer_assembly_AssemblyCodePackage(newArray1,this.nameIndexMap)},assemble:function(){var this1=this.codeList,callback=firedancer_assembly_Assembler.assemble,len=this1.length,newArray=[];newArray.length=len;for(var newArray1=newArray,i=0;i<len;)newArray1[i]=callback(this1[i]),++i;var bytecodeList=newArray1.slice(0);return new firedancer_vm_ProgramPackage(bytecodeList,this.nameIndexMap)},toString:function(){for(var codeList=this.codeList,this1=codeList.length,names=this2=this1=this2=new Array(this1),_g=haxe_ds_StringMap.kvIterator(this.nameIndexMap.h);_g.hasNext();){var name=(_g1=_g.next()).key;names[id=_g1.value]=name}for(var buf=new sneaker_string_$buffer_StringBuffer,lastId=this2=(this1=codeList.length)-1,_g1=(_g=0,this1=codeList.length);_g<_g1;){var id,value=names[this1=id=_g++];name=null!=value?value:"(anonymous)";buf.b+=Std.string(Std.string("[ASSEMBLY CODE] ID: "+id+", name: "+name)+"\n");var this2=id,x=""+firedancer_assembly_AssemblyCode.toString(codeList[this2]);buf.b+=Std.string(x),id<lastId&&(buf.b+=String.fromCodePoint(10))}return buf.b},__class__:firedancer_assembly_AssemblyCodePackage};var firedancer_assembly_Builder=function(){};$hxClasses["firedancer.assembly.Builder"]=firedancer_assembly_Builder,firedancer_assembly_Builder.__name__="firedancer.assembly.Builder",firedancer_assembly_Builder.constructLoop=function(context,pushLoopCount,body){var nextLabelIdStack=context.nextLabelIdStack,nextLabelId=this1=nextLabelIdStack.pop(),startLabelId=nextLabelId++,endLabelId=nextLabelId++,this1=nextLabelIdStack.push(nextLabelId),prepareLoop=[],writeIndex=this1=prepareLoop.length,readIndex=0,otherLength=this1=pushLoopCount.length;this1=writeIndex+otherLength;for(prepareLoop.length=this1;readIndex<otherLength;){this1=readIndex;prepareLoop[writeIndex]=pushLoopCount[this1],++writeIndex,++readIndex}this1=prepareLoop.push(firedancer_assembly_Instruction.Label(startLabelId)),this1=prepareLoop.push(firedancer_assembly_Instruction.CountDownGotoLabel(endLabelId));for(var arrays=[prepareLoop,body,[firedancer_assembly_Instruction.GotoLabel(startLabelId),firedancer_assembly_Instruction.Label(endLabelId)]],arrayCount=this1=arrays.length,elementCount=0,_g=0,_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}this1=elementCount;var newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1},firedancer_assembly_Builder.loop=function(context,body,count){var pushLoopCount=count.loadToVolatile(context);pushLoopCount.push(firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg)));return firedancer_assembly_Builder.constructLoop(context,pushLoopCount,body)},firedancer_assembly_Builder.loopUnrolled=function(iterator,bodyFactory){for(var _g=[],_g1=iterator;_g1.min<_g1.max;){var i=_g1.min++;_g.push(bodyFactory(i))}var arrays=_g,arrayCount=this1=arrays.length,elementCount=0;for(_g=0,_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}var this1=elementCount,newArray=[];newArray.length=this1;var newArray1=newArray;for(i=0,_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1};var firedancer_assembly_DataRegisterSpecifier={get:function(type){switch(type){case 0:return 0;case 1:return 2;case 2:return 4}},getBuffer:function(this1){var reg=this1;switch(reg){case 0:return 1;case 2:return 3;default:throw haxe_Exception.thrown("Buffer is not available for "+firedancer_assembly_DataRegisterSpecifier.toString(reg))}},toString:function(this1){switch(this1){case 0:return"ri";case 1:return"rib";case 2:return"rf";case 3:return"rfb";case 4:return"rvec"}}},firedancer_assembly_Instruction=$hxEnums["firedancer.assembly.Instruction"]={__ename__:"firedancer.assembly.Instruction",__constructs__:["Break","CountDownBreak","Label","GotoLabel","CountDownGotoLabel","UseThread","AwaitThread","End","Load","Save","Let","Store","Free","Push","Pop","Peek","Drop","Fire","Event","Debug","Add","Sub","Minus","Mult","Div","Mod","Cast","RandomRatio","Random","RandomSigned","Sin","Cos","Increment","Decrement","Get","GetTarget","GetDiff","Set","Increase","Comment","None"],Break:{_hx_index:0,__enum__:"firedancer.assembly.Instruction",toString:$estr},CountDownBreak:{_hx_index:1,__enum__:"firedancer.assembly.Instruction",toString:$estr},Label:($_=function(labelId){return{_hx_index:2,labelId:labelId,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["labelId"],$_),GotoLabel:($_=function(labelId){return{_hx_index:3,labelId:labelId,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["labelId"],$_),CountDownGotoLabel:($_=function(labelId){return{_hx_index:4,labelId:labelId,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["labelId"],$_),UseThread:($_=function(programId,output){return{_hx_index:5,programId:programId,output:output,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["programId","output"],$_),AwaitThread:{_hx_index:6,__enum__:"firedancer.assembly.Instruction",toString:$estr},End:($_=function(endCode){return{_hx_index:7,endCode:endCode,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["endCode"],$_),Load:($_=function(input){return{_hx_index:8,input:input,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input"],$_),Save:($_=function(input){return{_hx_index:9,input:input,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input"],$_),Let:($_=function(varKey,type){return{_hx_index:10,varKey:varKey,type:type,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["varKey","type"],$_),Store:($_=function(input,varKey){return{_hx_index:11,input:input,varKey:varKey,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input","varKey"],$_),Free:($_=function(varKey,type){return{_hx_index:12,varKey:varKey,type:type,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["varKey","type"],$_),Push:($_=function(input){return{_hx_index:13,input:input,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input"],$_),Pop:($_=function(type){return{_hx_index:14,type:type,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["type"],$_),Peek:($_=function(type,bytesToSkip){return{_hx_index:15,type:type,bytesToSkip:bytesToSkip,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["type","bytesToSkip"],$_),Drop:($_=function(type){return{_hx_index:16,type:type,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["type"],$_),Fire:($_=function(fireType){return{_hx_index:17,fireType:fireType,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["fireType"],$_),Event:($_=function(eventType){return{_hx_index:18,eventType:eventType,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["eventType"],$_),Debug:($_=function(debugCode){return{_hx_index:19,debugCode:debugCode,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["debugCode"],$_),Add:($_=function(input){return{_hx_index:20,input:input,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input"],$_),Sub:($_=function(input){return{_hx_index:21,input:input,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input"],$_),Minus:($_=function(input){return{_hx_index:22,input:input,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input"],$_),Mult:($_=function(inputA,inputB){return{_hx_index:23,inputA:inputA,inputB:inputB,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["inputA","inputB"],$_),Div:($_=function(inputA,inputB){return{_hx_index:24,inputA:inputA,inputB:inputB,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["inputA","inputB"],$_),Mod:($_=function(inputA,inputB){return{_hx_index:25,inputA:inputA,inputB:inputB,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["inputA","inputB"],$_),Cast:($_=function(castType){return{_hx_index:26,castType:castType,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["castType"],$_),RandomRatio:{_hx_index:27,__enum__:"firedancer.assembly.Instruction",toString:$estr},Random:($_=function(max){return{_hx_index:28,max:max,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["max"],$_),RandomSigned:($_=function(maxMagnitude){return{_hx_index:29,maxMagnitude:maxMagnitude,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["maxMagnitude"],$_),Sin:{_hx_index:30,__enum__:"firedancer.assembly.Instruction",toString:$estr},Cos:{_hx_index:31,__enum__:"firedancer.assembly.Instruction",toString:$estr},Increment:($_=function(address){return{_hx_index:32,address:address,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["address"],$_),Decrement:($_=function(address){return{_hx_index:33,address:address,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["address"],$_),Get:($_=function(property){return{_hx_index:34,property:property,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["property"],$_),GetTarget:($_=function(prop){return{_hx_index:35,prop:prop,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["prop"],$_),GetDiff:($_=function(input,property){return{_hx_index:36,input:input,property:property,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input","property"],$_),Set:($_=function(input,property){return{_hx_index:37,input:input,property:property,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input","property"],$_),Increase:($_=function(input,property){return{_hx_index:38,input:input,property:property,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["input","property"],$_),Comment:($_=function(text){return{_hx_index:39,text:text,__enum__:"firedancer.assembly.Instruction",toString:$estr}},$_.__params__=["text"],$_),None:{_hx_index:40,__enum__:"firedancer.assembly.Instruction",toString:$estr}};firedancer_assembly_Instruction.__empty_constructs__=[firedancer_assembly_Instruction.Break,firedancer_assembly_Instruction.CountDownBreak,firedancer_assembly_Instruction.AwaitThread,firedancer_assembly_Instruction.RandomRatio,firedancer_assembly_Instruction.Sin,firedancer_assembly_Instruction.Cos,firedancer_assembly_Instruction.None];var firedancer_assembly_InstructionAssembler=function(){};$hxClasses["firedancer.assembly.InstructionAssembler"]=firedancer_assembly_InstructionAssembler,firedancer_assembly_InstructionAssembler.__name__="firedancer.assembly.InstructionAssembler",firedancer_assembly_InstructionAssembler.toWordArray=function(inst,labelPositionMap,variableTable){switch(inst._hx_index){case 0:var this1=0;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 1:this1=1;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 2:inst.labelId;throw haxe_Exception.thrown("Labels must be consumed before converting to WordArray.");case 3:var labelId=inst.labelId;if(null==(pos=labelPositionMap.h[labelId]))throw haxe_Exception.thrown("Unknown label ID: "+(null==labelId?"null":Std.string(labelId)));this1=2;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(pos)];case 4:var pos;labelId=inst.labelId;if(null==(pos=labelPositionMap.h[labelId]))throw haxe_Exception.thrown("Unknown label ID: "+(null==labelId?"null":Std.string(labelId)));this1=3;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(pos)];case 5:var output=inst.output,programId=inst.programId;switch(output._hx_index){case 0:this1=4;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(programId)];case 1:if(3==(operand=output.operand)._hx_index){this1=5;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(programId)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 6:this1=6;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 7:var endCode=inst.endCode;this1=7;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(endCode)];case 8:switch((input=inst.input)._hx_index){case 1:switch((operand=input.operand)._hx_index){case 0:var value=operand.value;this1=8;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(value)];case 1:return[];case 2:this1=9;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 4:var key=operand.key;this1=17;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(variableTable.getAddress(key))];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operand=input.operand)._hx_index){case 0:value=operand.value,this1=10;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(value)];case 1:return[];case 2:this1=11;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 4:key=operand.key,this1=18;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(variableTable.getAddress(key))];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 3:switch((operand=input.operand)._hx_index){case 0:var y=operand.y,x=operand.x;this1=12;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(x),firedancer_assembly_WordEnum.FloatWord(y)];case 1:return[];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 9:switch((input=inst.input)._hx_index){case 1:switch((operand=input.operand)._hx_index){case 0:value=operand.value,this1=13;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(value)];case 1:this1=14;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operand=input.operand)._hx_index){case 0:value=operand.value,this1=15;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(value)];case 1:this1=16;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 10:var type=inst.type,varKey=inst.varKey;return variableTable.let(varKey,type),[];case 11:varKey=inst.varKey;var input=inst.input,address=variableTable.getAddress(varKey);switch(input._hx_index){case 1:switch((operand=input.operand)._hx_index){case 0:value=operand.value,this1=19;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address),firedancer_assembly_WordEnum.IntWord(value)];case 1:this1=20;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operand=input.operand)._hx_index){case 0:value=operand.value,this1=21;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address),firedancer_assembly_WordEnum.FloatWord(value)];case 1:this1=22;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 12:inst.type,varKey=inst.varKey;return variableTable.free(varKey),[];case 13:switch((input=inst.input)._hx_index){case 1:switch((operand=input.operand)._hx_index){case 0:value=operand.value,this1=23;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(value)];case 1:this1=24;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operand=input.operand)._hx_index){case 0:value=operand.value,this1=25;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(value)];case 1:this1=26;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 3:switch((operand=input.operand)._hx_index){case 0:y=operand.y,x=operand.x,this1=27;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(x),firedancer_assembly_WordEnum.FloatWord(y)];case 1:this1=28;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 14:switch(type=inst.type){case 0:opcode=this1=29;break;case 1:opcode=this1=30;break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}return[firedancer_assembly_WordEnum.OpcodeWord(opcode)];case 15:var bytesToSkip=inst.bytesToSkip;switch(type=inst.type){case 1:opcode=this1=31;break;case 2:opcode=this1=33;break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}return[firedancer_assembly_WordEnum.OpcodeWord(opcode),firedancer_assembly_WordEnum.IntWord(bytesToSkip)];case 16:var opcode;switch(type=inst.type){case 1:opcode=this1=32;break;case 2:opcode=this1=34;break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}return[firedancer_assembly_WordEnum.OpcodeWord(opcode)];case 17:var fireType=inst.fireType;switch(fireType._hx_index){case 0:this1=35;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 1:var fireArgument=fireType.fireArgument;this1=36;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(fireArgument)];case 2:var fireCode=fireType.fireCode;this1=37;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(fireCode)];case 3:fireCode=fireType.fireCode,fireArgument=fireType.fireArgument,this1=38;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(fireArgument),firedancer_assembly_WordEnum.IntWord(fireCode)]}break;case 18:switch(inst.eventType){case 0:this1=39;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 1:this1=40;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}break;case 19:var debugCode=inst.debugCode;this1=41;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(debugCode)];case 20:switch((input=inst.input)._hx_index){case 0:var b=input.b;switch((a=input.a)._hx_index){case 0:var aVal=a.value;if(1==b._hx_index){this1=64;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(0==b._hx_index){var bVal=b.value;this1=64;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==b._hx_index){this1=65;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 4:key=a.key,address=variableTable.getAddress(key);switch(b._hx_index){case 0:bVal=b.value,this1=110;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address),firedancer_assembly_WordEnum.IntWord(bVal)];case 1:this1=111;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 1:b=input.b;switch((a=input.a)._hx_index){case 0:aVal=a.value;if(1==b._hx_index){this1=78;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(0==b._hx_index){bVal=b.value,this1=78;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==b._hx_index){this1=79;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 4:key=a.key,address=variableTable.getAddress(key);switch(b._hx_index){case 0:bVal=b.value,this1=114;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address),firedancer_assembly_WordEnum.FloatWord(bVal)];case 1:this1=115;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(address)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 21:switch((input=inst.input)._hx_index){case 0:b=input.b;switch((a=input.a)._hx_index){case 0:aVal=a.value;if(1==b._hx_index){this1=67;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(0==b._hx_index){bVal=b.value,this1=66;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==b._hx_index){this1=68;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 1:var a;b=input.b;switch((a=input.a)._hx_index){case 0:aVal=a.value;if(1==b._hx_index){this1=81;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(0==b._hx_index){bVal=b.value,this1=80;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==b._hx_index){this1=82;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 22:switch((input=inst.input)._hx_index){case 1:if(1==(operand=input.operand)._hx_index){this1=69;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==(operand=input.operand)._hx_index){this1=83;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 3:if(1==(operand=input.operand)._hx_index){this1=92;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 23:var inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:switch((operandA=inputA.operand)._hx_index){case 0:aVal=operandA.value;if(1==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=70;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(1==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value,this1=70;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=71;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operandA=inputA.operand)._hx_index){case 0:aVal=operandA.value;if(2==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=84;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(2==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value,this1=84;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(2==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=85;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 3:if(1!=(operandA=inputA.operand)._hx_index)throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());if(2!=inputB._hx_index)throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());switch((operandB=inputB.operand)._hx_index){case 0:bVal=operandB.value,this1=93;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(bVal)];case 1:this1=94;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 24:inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:switch((operandA=inputA.operand)._hx_index){case 0:aVal=operandA.value;if(1==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=73;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(1==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value,this1=72;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=74;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operandA=inputA.operand)._hx_index){case 0:aVal=operandA.value;if(2==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=87;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(2==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value,this1=86;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(2==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=88;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 3:if(1!=(operandA=inputA.operand)._hx_index)throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());if(2!=inputB._hx_index)throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());switch((operandB=inputB.operand)._hx_index){case 0:value=operandB.value,this1=93;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(1/value)];case 1:this1=95;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 25:var inputA;inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:switch((operandA=inputA.operand)._hx_index){case 0:aVal=operandA.value;if(1==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=76;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(1==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value,this1=75;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(1==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=77;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:var operandA;switch((operandA=inputA.operand)._hx_index){case 0:aVal=operandA.value;if(2==inputB._hx_index){if(1==(operandB=inputB.operand)._hx_index){this1=90;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(aVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 1:if(2==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value,this1=89;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(bVal)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());case 2:if(2==inputB._hx_index){var operandB;if(1==(operandB=inputB.operand)._hx_index){this1=91;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 26:switch(type=inst.castType){case 0:this1=96;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 1:this1=97;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 2:this1=98;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}break;case 27:this1=99;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 28:var max=inst.max;switch(max._hx_index){case 1:switch((operand=max.operand)._hx_index){case 0:value=operand.value,this1=104;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(value)];case 1:this1=105;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operand=max.operand)._hx_index){case 0:value=operand.value,this1=100;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(value)];case 1:this1=101;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 29:var maxMagnitude=inst.maxMagnitude;switch(maxMagnitude._hx_index){case 1:switch((operand=maxMagnitude.operand)._hx_index){case 0:value=operand.value,this1=106;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(value)];case 1:this1=107;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 2:switch((operand=maxMagnitude.operand)._hx_index){case 0:value=operand.value,this1=102;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.FloatWord(value)];case 1:this1=103;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 30:this1=108;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 31:this1=109;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 32:varKey=inst.address,this1=112;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(variableTable.getAddress(varKey))];case 33:varKey=inst.address,this1=113;return[firedancer_assembly_WordEnum.OpcodeWord(this1),firedancer_assembly_WordEnum.IntWord(variableTable.getAddress(varKey))];case 34:var prop=inst.property;return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getReadOpcode(prop))];case 35:switch(prop=inst.prop){case 0:this1=140;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 1:this1=141;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 2:this1=142;return[firedancer_assembly_WordEnum.OpcodeWord(this1)];case 3:this1=143;return[firedancer_assembly_WordEnum.OpcodeWord(this1)]}break;case 36:prop=inst.property;switch((input=inst.input)._hx_index){case 2:switch((operand=input.operand)._hx_index){case 0:value=operand.value;return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getDiffOpcode(prop,1)),firedancer_assembly_WordEnum.FloatWord(value)];case 1:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getDiffOpcode(prop,2))];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 3:var operand=input.operand;if(0!=prop.component)throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());switch(operand._hx_index){case 0:y=operand.y,x=operand.x;return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getDiffOpcode(prop,1)),firedancer_assembly_WordEnum.FloatWord(x),firedancer_assembly_WordEnum.FloatWord(y)];case 1:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getDiffOpcode(prop,2))];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 37:prop=inst.property;switch((input=inst.input)._hx_index){case 2:switch((operand=input.operand)._hx_index){case 0:value=operand.value;return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,0,1)),firedancer_assembly_WordEnum.FloatWord(value)];case 1:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,0,2))];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 3:operand=input.operand;if(0!=prop.component)throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());switch(operand._hx_index){case 0:y=operand.y,x=operand.x;return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,0,1)),firedancer_assembly_WordEnum.FloatWord(x),firedancer_assembly_WordEnum.FloatWord(y)];case 1:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,0,2))];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 38:prop=inst.property;switch((input=inst.input)._hx_index){case 2:switch((operand=input.operand)._hx_index){case 0:value=operand.value;return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,1,1)),firedancer_assembly_WordEnum.FloatWord(value)];case 1:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,1,2))];case 3:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,1,4))];default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 3:operand=input.operand;if(0!=prop.component)throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported());switch(operand._hx_index){case 0:y=operand.y,x=operand.x;return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,1,1)),firedancer_assembly_WordEnum.FloatWord(x),firedancer_assembly_WordEnum.FloatWord(y)];case 1:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,1,2))];case 2:return[firedancer_assembly_WordEnum.OpcodeWord(firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode(prop,1,4))]}break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionAssembler.unsupported())}break;case 39:inst.text;return[];case 40:return[]}},firedancer_assembly_InstructionAssembler.unsupported=function(){return"Unsupported operation."};var firedancer_assembly_InstructionExtension=function(){};$hxClasses["firedancer.assembly.InstructionExtension"]=firedancer_assembly_InstructionExtension,firedancer_assembly_InstructionExtension.__name__="firedancer.assembly.InstructionExtension",firedancer_assembly_InstructionExtension.toString=function(inst){switch(inst._hx_index){case 0:return"break";case 1:return"countdown break";case 2:var labelId=inst.labelId;return"label "+Std.string(labelId);case 3:labelId=inst.labelId;return"goto label "+Std.string(labelId);case 4:labelId=inst.labelId;return"countdown goto label "+Std.string(labelId);case 5:var output=inst.output,programId=inst.programId;return"use thread "+Std.string(programId)+" -> "+firedancer_assembly_OperandExtension.toString(output);case 6:return"await thread";case 7:var endCode=inst.endCode;return"end "+(null==endCode?"null":""+endCode);case 8:var input=inst.input;output=firedancer_assembly_DataRegisterSpecifier.get(firedancer_assembly_OperandExtension.getType(input));return"load "+firedancer_assembly_OperandExtension.toString(input)+" -> "+firedancer_assembly_DataRegisterSpecifier.toString(output);case 9:input=inst.input,output=firedancer_assembly_DataRegisterSpecifier.getBuffer(firedancer_assembly_DataRegisterSpecifier.get(firedancer_assembly_OperandExtension.getType(input)));return"save "+firedancer_assembly_OperandExtension.toString(input)+" -> "+firedancer_assembly_DataRegisterSpecifier.toString(output);case 10:var type=inst.type,varKey=inst.varKey;return"let "+firedancer_assembly_OperandTools.varToString(varKey,type);case 11:varKey=inst.varKey,input=inst.input;return"store "+firedancer_assembly_OperandExtension.toString(input)+" -> "+firedancer_assembly_OperandTools.varToString(varKey,firedancer_assembly_OperandExtension.getType(input));case 12:type=inst.type,varKey=inst.varKey;return"free "+firedancer_assembly_OperandTools.varToString(varKey,type);case 13:input=inst.input;return"push "+firedancer_assembly_OperandExtension.toString(input)+" -> s";case 14:type=inst.type;return"pop s -> "+(outputStr=firedancer_assembly_DataRegisterSpecifier.toString(firedancer_assembly_DataRegisterSpecifier.get(type)));case 15:var bytesToSkip=inst.bytesToSkip,outputStr=(type=inst.type,firedancer_assembly_DataRegisterSpecifier.toString(firedancer_assembly_DataRegisterSpecifier.get(type)));return"peek "+firedancer_assembly_ValueType.toString(type)+" s, "+bytesToSkip+" -> "+outputStr;case 16:type=inst.type;return"drop "+firedancer_assembly_ValueType.toString(type);case 17:var fireType=inst.fireType;return firedancer_assembly_types_FireTypeExtension.toString(fireType);case 18:var eventType=inst.eventType;return"event "+firedancer_assembly_types_EventType.toString(eventType)+" ri -> n";case 19:var debugCode=inst.debugCode;return"debug "+(null==debugCode?"null":""+debugCode)+" -> n";case 20:switch((input=inst.input)._hx_index){case 0:input.b;if(4==(a=input.a)._hx_index){var _g=a.key;outputStr=firedancer_assembly_IntOperandExtension.toString(a)}else outputStr=firedancer_assembly_DataRegisterSpecifier.toString(0);break;case 1:input.b;if(4==(a=input.a)._hx_index){_g=a.key;outputStr=firedancer_assembly_FloatOperandExtension.toString(a)}else outputStr=firedancer_assembly_DataRegisterSpecifier.toString(2);break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionExtension.unsupported())}return"add "+firedancer_assembly_OperandPairExtension.toString(input)+" -> "+outputStr;case 21:switch((input=inst.input)._hx_index){case 0:input.b;if(4==(a=input.a)._hx_index){_g=a.key;outputStr=firedancer_assembly_IntOperandExtension.toString(a)}else outputStr=firedancer_assembly_DataRegisterSpecifier.toString(0);break;case 1:var a;input.b;if(4==(a=input.a)._hx_index){_g=a.key;outputStr=firedancer_assembly_FloatOperandExtension.toString(a)}else outputStr=firedancer_assembly_DataRegisterSpecifier.toString(2);break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionExtension.unsupported())}return"sub "+firedancer_assembly_OperandPairExtension.toString(input)+" -> "+outputStr;case 22:var reg=inst.input;return"minus "+(inOutStr=firedancer_assembly_OperandExtension.toString(reg))+" -> "+inOutStr;case 23:var inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(0);break;case 2:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(2);break;case 3:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(4);break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionExtension.unsupported())}return"mult "+firedancer_assembly_OperandExtension.toString(inputA)+", "+firedancer_assembly_OperandExtension.toString(inputB)+" -> "+outputStr;case 24:inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(0);break;case 2:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(2);break;case 3:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(4);break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionExtension.unsupported())}return"div "+firedancer_assembly_OperandExtension.toString(inputA)+", "+firedancer_assembly_OperandExtension.toString(inputB)+" -> "+outputStr;case 25:var inputA;inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(0);break;case 2:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(2);break;case 3:_g=inputA.operand;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(4);break;default:throw haxe_Exception.thrown(firedancer_assembly_InstructionExtension.unsupported())}return"mod "+firedancer_assembly_OperandExtension.toString(inputA)+", "+firedancer_assembly_OperandExtension.toString(inputB)+" -> "+outputStr;case 26:type=inst.castType,outputStr=firedancer_assembly_DataRegisterSpecifier.toString(firedancer_assembly_DataRegisterSpecifier.get(firedancer_assembly_types_CastOperationType.getOutputType(type)));switch(type){case 0:return"cast ri -> "+outputStr;case 1:return"cast cartesian rfb, rf -> "+outputStr;case 2:return"cast polar rfb, rf -> "+outputStr}break;case 27:return"random ratio n -> rf";case 28:var max=inst.max;return"random "+firedancer_assembly_OperandExtension.toString(max)+" -> rf";case 29:var maxMagnitude=inst.maxMagnitude;return"random signed "+firedancer_assembly_OperandExtension.toString(maxMagnitude)+" -> rf";case 30:return"sin rf -> rf";case 31:return"cos rf -> rf";case 32:var address=inst.address;return"increment "+(inOutStr=firedancer_assembly_OperandTools.varToString(address,0))+" -> "+inOutStr;case 33:var inOutStr;address=inst.address;return"decrement "+(inOutStr=firedancer_assembly_OperandTools.varToString(address,0))+" -> "+inOutStr;case 34:var prop=inst.property;outputStr=firedancer_assembly_DataRegisterSpecifier.toString(firedancer_assembly_DataRegisterSpecifier.get(firedancer_assembly_types_ActorPropertyComponent.getValueType(prop.component)));return"get "+prop.toString()+" -> "+outputStr;case 35:prop=inst.prop,outputStr=firedancer_assembly_DataRegisterSpecifier.toString(firedancer_assembly_DataRegisterSpecifier.get(firedancer_assembly_types_TargetProperty.getType(prop)));return"get target_"+firedancer_assembly_types_TargetProperty.toString(prop)+" -> "+outputStr;case 36:prop=inst.property,input=inst.input,outputStr=firedancer_assembly_DataRegisterSpecifier.toString(firedancer_assembly_DataRegisterSpecifier.get(firedancer_assembly_OperandExtension.getType(input)));return"get diff "+firedancer_assembly_OperandExtension.toString(input)+", "+prop.toString()+" -> "+outputStr;case 37:prop=inst.property,input=inst.input;return"set "+firedancer_assembly_OperandExtension.toString(input)+" -> "+prop.toString();case 38:prop=inst.property,input=inst.input;return"increase "+firedancer_assembly_OperandExtension.toString(input)+" -> "+prop.toString();case 39:for(var lines=inst.text.split("\n"),result=new Array(lines.length),_g1=(_g=0,lines.length);_g<_g1;){var i=_g++;result[i]="// "+lines[i]}return result.join("\n");case 40:return"none"}},firedancer_assembly_InstructionExtension.bytecodeLength=function(inst){var b;switch(inst._hx_index){case 0:case 1:b=0;break;case 2:inst.labelId;throw haxe_Exception.thrown("Label cannot be directly converted to bytecode.");case 3:inst.labelId;b=4;break;case 4:inst.labelId;b=4;break;case 5:var output=inst.output;inst.programId;b=4+firedancer_assembly_OperandExtension.bytecodeLength(output);break;case 6:b=0;break;case 7:inst.endCode;b=4;break;case 8:var input=inst.input;b=firedancer_assembly_OperandExtension.bytecodeLength(input);break;case 9:input=inst.input;b=firedancer_assembly_OperandExtension.bytecodeLength(input);break;case 10:inst.type,inst.varKey;b=-1;break;case 11:inst.varKey,input=inst.input;b=firedancer_assembly_OperandExtension.bytecodeLength(input)+4;break;case 12:inst.type,inst.varKey;b=-1;break;case 13:input=inst.input;b=firedancer_assembly_OperandExtension.bytecodeLength(input);break;case 14:inst.type;b=0;break;case 15:inst.type,inst.bytesToSkip;b=4;break;case 16:inst.type;b=0;break;case 17:var fireType=inst.fireType;b=firedancer_assembly_types_FireTypeExtension.bytecodeLength(fireType);break;case 18:inst.eventType;b=0;break;case 19:inst.debugCode;b=4;break;case 20:input=inst.input;b=firedancer_assembly_OperandPairExtension.bytecodeLength(input);break;case 21:input=inst.input;b=firedancer_assembly_OperandPairExtension.bytecodeLength(input);break;case 22:inst.input;b=0;break;case 23:var inputB=inst.inputB,inputA=inst.inputA;b=firedancer_assembly_OperandExtension.bytecodeLength(inputB);break;case 24:inputB=inst.inputB,inputA=inst.inputA;b=firedancer_assembly_OperandExtension.bytecodeLength(inputA)+firedancer_assembly_OperandExtension.bytecodeLength(inputB);break;case 25:inputB=inst.inputB,inputA=inst.inputA;b=firedancer_assembly_OperandExtension.bytecodeLength(inputA)+firedancer_assembly_OperandExtension.bytecodeLength(inputB);break;case 26:inst.castType;b=0;break;case 27:b=0;break;case 28:var max=inst.max;b=firedancer_assembly_OperandExtension.bytecodeLength(max);break;case 29:var maxMagnitude=inst.maxMagnitude;b=firedancer_assembly_OperandExtension.bytecodeLength(maxMagnitude);break;case 30:case 31:b=0;break;case 32:inst.address;b=4;break;case 33:inst.address;b=4;break;case 34:inst.property;b=0;break;case 35:inst.prop;b=0;break;case 36:inst.property,input=inst.input;b=firedancer_assembly_OperandExtension.bytecodeLength(input);break;case 37:inst.property,input=inst.input;b=firedancer_assembly_OperandExtension.bytecodeLength(input);break;case 38:inst.property,input=inst.input;b=firedancer_assembly_OperandExtension.bytecodeLength(input);break;case 39:inst.text;b=-1;break;case 40:b=-1}return 1+b},firedancer_assembly_InstructionExtension.readsReg=function(inst,regType){switch(inst._hx_index){case 8:var input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;case 9:input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;case 11:inst.varKey,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;case 13:input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;case 18:inst.eventType;return 0==regType;case 20:input=inst.input;return firedancer_assembly_OperandPairExtension.tryGetRegType(input)==regType;case 21:input=inst.input;return firedancer_assembly_OperandPairExtension.tryGetRegType(input)==regType;case 22:input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;case 23:var inputB=inst.inputB,inputA=inst.inputA;return firedancer_assembly_OperandExtension.tryGetRegType(inputA)==regType||firedancer_assembly_OperandExtension.tryGetRegType(inputB)==regType;case 24:inputB=inst.inputB,inputA=inst.inputA;return firedancer_assembly_OperandExtension.tryGetRegType(inputA)==regType||firedancer_assembly_OperandExtension.tryGetRegType(inputB)==regType;case 25:inputB=inst.inputB,inputA=inst.inputA;return firedancer_assembly_OperandExtension.tryGetRegType(inputA)==regType||firedancer_assembly_OperandExtension.tryGetRegType(inputB)==regType;case 26:switch(inst.castType){case 0:return 0==regType;case 1:case 2:return 1==regType}break;case 28:var max=inst.max;return firedancer_assembly_OperandExtension.tryGetRegType(max)==regType;case 29:var maxMagnitude=inst.maxMagnitude;return firedancer_assembly_OperandExtension.tryGetRegType(maxMagnitude)==regType;case 30:case 31:return 1==regType;case 36:inst.property,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;case 37:inst.property,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;case 38:inst.property,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegType(input)==regType;default:return!1}},firedancer_assembly_InstructionExtension.readsRegBuf=function(inst,regType){switch(inst._hx_index){case 8:var input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;case 9:input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;case 11:inst.varKey,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;case 13:input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;case 20:input=inst.input;return firedancer_assembly_OperandPairExtension.tryGetRegBufType(input)==regType;case 21:input=inst.input;return firedancer_assembly_OperandPairExtension.tryGetRegBufType(input)==regType;case 22:input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;case 23:var inputB=inst.inputB,inputA=inst.inputA;return firedancer_assembly_OperandExtension.tryGetRegBufType(inputA)==regType||firedancer_assembly_OperandExtension.tryGetRegBufType(inputB)==regType;case 24:inputB=inst.inputB,inputA=inst.inputA;return firedancer_assembly_OperandExtension.tryGetRegBufType(inputA)==regType||firedancer_assembly_OperandExtension.tryGetRegBufType(inputB)==regType;case 25:inputB=inst.inputB,inputA=inst.inputA;return firedancer_assembly_OperandExtension.tryGetRegBufType(inputA)==regType||firedancer_assembly_OperandExtension.tryGetRegBufType(inputB)==regType;case 26:switch(inst.castType){case 1:case 2:return 1==regType;default:return!1}break;case 28:var max=inst.max;return firedancer_assembly_OperandExtension.tryGetRegBufType(max)==regType;case 29:var maxMagnitude=inst.maxMagnitude;return firedancer_assembly_OperandExtension.tryGetRegBufType(maxMagnitude)==regType;case 36:inst.property,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;case 37:inst.property,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;case 38:inst.property,input=inst.input;return firedancer_assembly_OperandExtension.tryGetRegBufType(input)==regType;default:return!1}},firedancer_assembly_InstructionExtension.tryGetWriteRegType=function(inst){var value;switch(inst._hx_index){case 8:var input=inst.input;value=firedancer_assembly_OperandExtension.getType(input);break;case 14:value=inst.type;break;case 15:inst.bytesToSkip;value=inst.type;break;case 20:input=inst.input;var inputA=firedancer_assembly_OperandPairExtension.getFirstOperand(input);switch(firedancer_assembly_OperandExtension.getKind(inputA)){case 1:case 2:case 3:value=firedancer_assembly_OperandExtension.getType(inputA);break;default:value=null}break;case 21:input=inst.input,inputA=firedancer_assembly_OperandPairExtension.getFirstOperand(input);switch(firedancer_assembly_OperandExtension.getKind(inputA)){case 1:case 2:case 3:value=firedancer_assembly_OperandExtension.getType(inputA);break;default:value=null}break;case 22:input=inst.input;switch(firedancer_assembly_OperandExtension.getKind(input)){case 1:case 2:case 3:value=firedancer_assembly_OperandExtension.getType(input);break;default:value=null}break;case 23:inst.inputB,inputA=inst.inputA;switch(firedancer_assembly_OperandExtension.getKind(inputA)){case 1:case 2:case 3:value=firedancer_assembly_OperandExtension.getType(inputA);break;default:value=null}break;case 24:inst.inputB,inputA=inst.inputA;switch(firedancer_assembly_OperandExtension.getKind(inputA)){case 1:case 2:case 3:value=firedancer_assembly_OperandExtension.getType(inputA);break;default:value=null}break;case 25:inst.inputB,inputA=inst.inputA;switch(firedancer_assembly_OperandExtension.getKind(inputA)){case 1:case 2:case 3:value=firedancer_assembly_OperandExtension.getType(inputA);break;default:value=null}break;case 26:var castType=inst.castType;value=firedancer_assembly_types_CastOperationType.getOutputType(castType);break;case 27:value=1;break;case 28:var max=inst.max;value=firedancer_assembly_OperandExtension.getType(max);break;case 29:var maxMagnitude=inst.maxMagnitude;value=firedancer_assembly_OperandExtension.getType(maxMagnitude);break;case 30:case 31:value=1;break;case 34:var prop=inst.property;value=firedancer_assembly_types_ActorPropertyComponent.getValueType(prop.component);break;case 35:prop=inst.prop;value=firedancer_assembly_types_TargetProperty.getType(prop);break;case 36:inst.property,input=inst.input;value=firedancer_assembly_OperandExtension.getType(input);break;default:value=null}return value},firedancer_assembly_InstructionExtension.tryGetWriteRegBufType=function(inst){var value;if(9==inst._hx_index){var input=inst.input;value=firedancer_assembly_OperandExtension.getType(input)}else value=null;return value},firedancer_assembly_InstructionExtension.tryGetReadVarKey=function(inst){var this1;switch(inst._hx_index){case 8:switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 9:switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 11:inst.varKey;switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 13:switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 20:switch((input=inst.input)._hx_index){case 0:input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;case 1:input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;default:this1=null}break;case 21:switch((input=inst.input)._hx_index){case 0:input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;case 1:var a;input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;default:this1=null}break;case 22:switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 23:inst.inputB;switch((input=inst.inputA)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 24:inst.inputB;switch((input=inst.inputA)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 25:inst.inputB;switch((input=inst.inputA)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 32:case 33:this1=inst.address;break;case 36:inst.property;switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 37:inst.property;switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 38:var input;inst.property;switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:var operand;if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;default:this1=null}return this1},firedancer_assembly_InstructionExtension.tryGetWriteVarKey=function(inst){var this1;switch(inst._hx_index){case 11:var varKey=inst.varKey,input=inst.input;this1=varKey;break;case 20:switch((input=inst.input)._hx_index){case 0:input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;case 1:input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;default:this1=null}break;case 21:switch((input=inst.input)._hx_index){case 0:input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;case 1:var a;input.b;if(4==(a=input.a)._hx_index)this1=a.key;else this1=null;break;default:this1=null}break;case 22:switch((input=inst.input)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 23:inst.inputB;switch((input=inst.inputA)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 24:inst.inputB;switch((input=inst.inputA)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 25:inst.inputB;switch((input=inst.inputA)._hx_index){case 1:if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;case 2:var operand;if(4==(operand=input.operand)._hx_index)this1=operand.key;else this1=null;break;default:this1=null}break;case 32:case 33:this1=varKey=inst.address;break;default:this1=null}return this1},firedancer_assembly_InstructionExtension.unsupported=function(){return"Unsupported operation."};var firedancer_assembly_InstructionOptimizer=function(){};$hxClasses["firedancer.assembly.InstructionOptimizer"]=firedancer_assembly_InstructionOptimizer,firedancer_assembly_InstructionOptimizer.__name__="firedancer.assembly.InstructionOptimizer",firedancer_assembly_InstructionOptimizer.tryReplaceRegWithImm=function(inst,maybeImm){var newInst;switch(inst._hx_index){case 8:var input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.Load(newInput):null;break;case 9:input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.Save(newInput):null;break;case 11:var address=inst.varKey;input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.Store(newInput,address):null;break;case 13:input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.Push(newInput):null;break;case 20:var nextOperands=inst.input;newInst=null!=(newNextOperands=firedancer_assembly_OperandPairExtension.tryReplaceRegWithImm(nextOperands,maybeImm))?firedancer_assembly_Instruction.Add(newNextOperands):null;break;case 21:var newNextOperands;nextOperands=inst.input;newInst=null!=(newNextOperands=firedancer_assembly_OperandPairExtension.tryReplaceRegWithImm(nextOperands,maybeImm))?firedancer_assembly_Instruction.Sub(newNextOperands):null;break;case 22:input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.Minus(newInput):null;break;case 23:var inputB=inst.inputB,inputA=inst.inputA;if(null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(inputA,maybeImm)))newInst=firedancer_assembly_Instruction.Mult(newInputA,inputB);else if(firedancer_assembly_OperandExtension.isRegBuf(inputA))newInst=null;else{newInst=null!=(newInputB=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(inputB,maybeImm))?firedancer_assembly_Instruction.Mult(inputA,newInputB):null}break;case 24:inputB=inst.inputB,inputA=inst.inputA;if(null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(inputA,maybeImm)))newInst=firedancer_assembly_Instruction.Div(newInputA,inputB);else if(firedancer_assembly_OperandExtension.isRegBuf(inputA))newInst=null;else{newInst=null!=(newInputB=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(inputB,maybeImm))?firedancer_assembly_Instruction.Div(inputA,newInputB):null}break;case 25:var newInputA,newInputB;inputB=inst.inputB,inputA=inst.inputA;if(null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(inputA,maybeImm)))newInst=firedancer_assembly_Instruction.Mod(newInputA,inputB);else newInst=null!=(newInputB=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(inputB,maybeImm))?firedancer_assembly_Instruction.Mod(inputA,newInputB):null;break;case 26:if(0==inst.castType)if(1==maybeImm._hx_index){var operand=maybeImm.operand;if(0==operand._hx_index){var value=operand.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(value)))}else newInst=null}else newInst=null;else newInst=null;break;case 36:var prop=inst.property;input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.GetDiff(newInput,prop):null;break;case 37:prop=inst.property,input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.Set(newInput,prop):null;break;case 38:var newInput;prop=inst.property,input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceRegWithImm(input,maybeImm))?firedancer_assembly_Instruction.Increase(newInput,prop):null;break;default:newInst=null}return newInst},firedancer_assembly_InstructionOptimizer.tryReplaceRegBufWithImm=function(inst,maybeImm){var newInst;switch(inst._hx_index){case 8:var input=inst.input,newInput=firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm(input,maybeImm);newInst=null!=newInput?firedancer_assembly_Instruction.Load(newInput):null;break;case 20:var nextOperands=inst.input;newInst=null!=(newNextOperands=firedancer_assembly_OperandPairExtension.tryReplaceRegBufWithImm(nextOperands,maybeImm))?firedancer_assembly_Instruction.Add(newNextOperands):null;break;case 21:var newNextOperands;nextOperands=inst.input;newInst=null!=(newNextOperands=firedancer_assembly_OperandPairExtension.tryReplaceRegBufWithImm(nextOperands,maybeImm))?firedancer_assembly_Instruction.Sub(newNextOperands):null;break;case 23:var inputB=inst.inputB,inputA=inst.inputA;if(null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm(inputA,maybeImm)))newInst=firedancer_assembly_Instruction.Mult(newInputA,inputB);else if(firedancer_assembly_OperandExtension.isRegBuf(inputA))newInst=null;else{newInst=null!=(newInputB=firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm(inputB,maybeImm))?firedancer_assembly_Instruction.Mult(inputA,newInputB):null}break;case 24:inputB=inst.inputB,inputA=inst.inputA;if(null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm(inputA,maybeImm)))newInst=firedancer_assembly_Instruction.Div(newInputA,inputB);else if(firedancer_assembly_OperandExtension.isRegBuf(inputA))newInst=null;else{newInst=null!=(newInputB=firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm(inputB,maybeImm))?firedancer_assembly_Instruction.Div(inputA,newInputB):null}break;case 25:var newInputA,newInputB;inputB=inst.inputB,inputA=inst.inputA;if(null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm(inputA,maybeImm)))newInst=firedancer_assembly_Instruction.Mod(newInputA,inputB);else newInst=null!=(newInputB=firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm(inputB,maybeImm))?firedancer_assembly_Instruction.Mod(inputA,newInputB):null;break;default:newInst=null}return newInst},firedancer_assembly_InstructionOptimizer.tryReplaceRegBufAndRegWithImm=function(inst,maybeImmA,maybeImmB){var newInst;switch(inst._hx_index){case 20:switch((nextOperands=inst.input)._hx_index){case 0:var b=nextOperands.b,a=nextOperands.a;if(firedancer_assembly_IntOperandExtension.isRegBuf(a)&&firedancer_assembly_IntOperandExtension.isReg(b)){var immA=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(immA+immB))):null}else newInst=null;break;case 1:b=nextOperands.b,a=nextOperands.a;if(firedancer_assembly_FloatOperandExtension.isRegBuf(a)&&firedancer_assembly_FloatOperandExtension.isReg(b)){immA=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(immA+immB))):null}else newInst=null;break;default:newInst=null}break;case 21:var nextOperands;switch((nextOperands=inst.input)._hx_index){case 0:b=nextOperands.b,a=nextOperands.a;if(firedancer_assembly_IntOperandExtension.isRegBuf(a)&&firedancer_assembly_IntOperandExtension.isReg(b)){immA=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(immA-immB))):null}else newInst=null;break;case 1:b=nextOperands.b,a=nextOperands.a;if(firedancer_assembly_FloatOperandExtension.isRegBuf(a)&&firedancer_assembly_FloatOperandExtension.isReg(b)){immA=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(immA-immB))):null}else newInst=null;break;default:newInst=null}break;case 23:var inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:var operandA=inputA.operand;if(firedancer_assembly_IntOperandExtension.isRegBuf(operandA))if(1==inputB._hx_index){var operandB=inputB.operand;if(firedancer_assembly_IntOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(immA*immB))):null}else newInst=null}else newInst=null;else newInst=null;break;case 2:operandA=inputA.operand;if(firedancer_assembly_FloatOperandExtension.isRegBuf(operandA))if(2==inputB._hx_index){operandB=inputB.operand;if(firedancer_assembly_FloatOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(immA*immB))):null}else newInst=null}else newInst=null;else newInst=null;break;case 3:operandA=inputA.operand;if(firedancer_assembly_VecOperandExtension.isReg(operandA))if(2==inputB._hx_index){operandB=inputB.operand;if(firedancer_assembly_FloatOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetVecImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmB);if(null!=immA&&null!=immB){var vecA=immA;b=immB;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(vecA.x*b,vecA.y*b)))}else newInst=null}else newInst=null}else newInst=null;else newInst=null;break;default:newInst=null}break;case 24:inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:operandA=inputA.operand;if(firedancer_assembly_IntOperandExtension.isRegBuf(operandA))if(1==inputB._hx_index){operandB=inputB.operand;if(firedancer_assembly_IntOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(immA/immB|0))):null}else newInst=null}else newInst=null;else newInst=null;break;case 2:operandA=inputA.operand;if(firedancer_assembly_FloatOperandExtension.isRegBuf(operandA))if(2==inputB._hx_index){operandB=inputB.operand;if(firedancer_assembly_FloatOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(immA/immB))):null}else newInst=null}else newInst=null;else newInst=null;break;case 3:operandA=inputA.operand;if(firedancer_assembly_VecOperandExtension.isReg(operandA))if(2==inputB._hx_index){operandB=inputB.operand;if(firedancer_assembly_FloatOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetVecImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmB);if(null!=immA&&null!=immB){vecA=immA,b=immB;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(vecA.x/b,vecA.y/b)))}else newInst=null}else newInst=null}else newInst=null;else newInst=null;break;default:newInst=null}break;case 25:var inputA;inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:operandA=inputA.operand;if(firedancer_assembly_IntOperandExtension.isRegBuf(operandA))if(1==inputB._hx_index){operandB=inputB.operand;if(firedancer_assembly_IntOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetIntImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(immA%immB))):null}else newInst=null}else newInst=null;else newInst=null;break;case 2:operandA=inputA.operand;if(firedancer_assembly_FloatOperandExtension.isRegBuf(operandA))if(2==inputB._hx_index){operandB=inputB.operand;if(firedancer_assembly_FloatOperandExtension.isReg(operandB)){immA=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmA),immB=firedancer_assembly_OperandExtension.tryGetFloatImm(maybeImmB);newInst=null!=immA&&null!=immB?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(immA%immB))):null}else newInst=null}else newInst=null;else newInst=null;break;default:newInst=null}break;case 26:switch(inst.castType){case 1:if(2==maybeImmA._hx_index)if(0==(operandA=maybeImmA.operand)._hx_index){var x=operandA.value;if(2==maybeImmB._hx_index)if(0==(operandB=maybeImmB.operand)._hx_index){var y=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(x,y)))}else newInst=null;else newInst=null}else newInst=null;else newInst=null;break;case 2:if(2==maybeImmA._hx_index)if(0==(operandA=maybeImmA.operand)._hx_index){var length=operandA.value;if(2==maybeImmB._hx_index)if(0==(operandB=maybeImmB.operand)._hx_index){var angle=.017453292519943295*(57.29577951308232*(angle=operandB.value)),unitVec_x=Math.sin(angle),unitVec_y=-Math.cos(angle),xFactor=unitVec_x;Math.abs(xFactor)<177635683940025e-29&&(xFactor=0),Math.abs(xFactor-1)<177635683940025e-29&&(xFactor=1),Math.abs(xFactor- -1)<177635683940025e-29&&(xFactor=-1),Math.abs(xFactor-.5)<177635683940025e-29&&(xFactor=.5),Math.abs(xFactor- -.5)<177635683940025e-29&&(xFactor=-.5);var yFactor=unitVec_y;Math.abs(yFactor)<177635683940025e-29&&(yFactor=0),Math.abs(yFactor-1)<177635683940025e-29&&(yFactor=1),Math.abs(yFactor- -1)<177635683940025e-29&&(yFactor=-1),Math.abs(yFactor-.5)<177635683940025e-29&&(yFactor=.5),Math.abs(yFactor- -.5)<177635683940025e-29&&(yFactor=-.5);var vec_x=xFactor*length,vec_y=yFactor*length;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(vec_x,vec_y)))}else newInst=null;else newInst=null}else newInst=null;else newInst=null;break;default:newInst=null}break;default:newInst=null}return newInst},firedancer_assembly_InstructionOptimizer.tryReplaceStackWithImm=function(inst,maybeImm){var newInst;switch(inst._hx_index){case 15:var bytesToSkip=inst.bytesToSkip,type=inst.type;if(0!=bytesToSkip)newInst=null;else switch(maybeImm._hx_index){case 0:newInst=null;break;case 1:var operand=maybeImm.operand;if(0==type)if(0==operand._hx_index){operand.value;newInst=firedancer_assembly_Instruction.Load(maybeImm)}else newInst=null;else newInst=null;break;case 2:operand=maybeImm.operand;if(1==type)if(0==operand._hx_index){operand.value;newInst=firedancer_assembly_Instruction.Load(maybeImm)}else newInst=null;else newInst=null;break;case 3:operand=maybeImm.operand;if(2==type)if(0==operand._hx_index){operand.y,operand.x;newInst=firedancer_assembly_Instruction.Load(maybeImm)}else newInst=null;else newInst=null}break;case 38:var prop=inst.property,input=inst.input;switch(input._hx_index){case 2:if(3==(operand=input.operand)._hx_index)if(2==maybeImm._hx_index)if(0==(maybeImmOperand=maybeImm.operand)._hx_index){maybeImmOperand.value;newInst=firedancer_assembly_Instruction.Increase(maybeImm,prop)}else newInst=null;else newInst=null;else newInst=null;break;case 3:var maybeImmOperand;if(2==(operand=input.operand)._hx_index)if(3==maybeImm._hx_index)if(0==(maybeImmOperand=maybeImm.operand)._hx_index){maybeImmOperand.y,maybeImmOperand.x;newInst=firedancer_assembly_Instruction.Increase(maybeImm,prop)}else newInst=null;else newInst=null;else newInst=null;break;default:newInst=null}break;default:newInst=null}return newInst},firedancer_assembly_InstructionOptimizer.tryFoldConstants=function(inst){var newInst;switch(inst._hx_index){case 20:switch((nextOperands=inst.input)._hx_index){case 0:var b=nextOperands.b;if(0==(a=nextOperands.a)._hx_index){var aVal=a.value;if(0==b._hx_index){var bVal=b.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(aVal+bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(b)):null}else if(0==b._hx_index){newInst=0==(bVal=b.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(a)):null}else newInst=null;break;case 1:b=nextOperands.b;if(0==(a=nextOperands.a)._hx_index){aVal=a.value;if(0==b._hx_index){bVal=b.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(aVal+bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(b)):null}else if(0==b._hx_index){newInst=0==(bVal=b.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(a)):null}else newInst=null;break;case 2:b=nextOperands.b;if(0==(a=nextOperands.a)._hx_index){var ay=a.y,ax=a.x;if(0==b._hx_index){var by=b.y,bx=b.x;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(ax+bx,ay+by)))}else newInst=0==ax&&0==ay?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(b)):null}else if(0==b._hx_index){by=b.y;newInst=0==(bx=b.x)&&0==by?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(a)):null}else newInst=null}break;case 21:var nextOperands;switch((nextOperands=inst.input)._hx_index){case 0:b=nextOperands.b;if(0==(a=nextOperands.a)._hx_index){aVal=a.value;if(0==b._hx_index){bVal=b.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(aVal-bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Int(b)):null}else if(0==b._hx_index){newInst=0==(bVal=b.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(a)):null}else newInst=null;break;case 1:b=nextOperands.b;if(0==(a=nextOperands.a)._hx_index){aVal=a.value;if(0==b._hx_index){bVal=b.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(aVal-bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Float(b)):null}else if(0==b._hx_index){newInst=0==(bVal=b.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(a)):null}else newInst=null;break;case 2:var a;b=nextOperands.b;if(0==(a=nextOperands.a)._hx_index){ay=a.y,ax=a.x;if(0==b._hx_index){by=b.y,bx=b.x;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(ax-bx,ay-by)))}else newInst=0==ax&&0==ay?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Vec(b)):null}else if(0==b._hx_index){by=b.y;newInst=0==(bx=b.x)&&0==by?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(a)):null}else newInst=null}break;case 22:switch((input=inst.input)._hx_index){case 1:if(0==(operand=input.operand)._hx_index){var value=operand.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(-value)))}else newInst=null;break;case 2:if(0==(operand=input.operand)._hx_index){value=operand.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(-value)))}else newInst=null;break;case 3:var operand;if(0==(operand=input.operand)._hx_index){var y=operand.y,x=operand.x;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(-x,-y)))}else newInst=null;break;default:newInst=null}break;case 23:var inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:if(0==(operandA=inputA.operand)._hx_index){aVal=operandA.value;if(1==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(aVal*bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0))):1==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(operandB)):null;else newInst=null}else if(1==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index)newInst=0==(bVal=operandB.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0))):1==bVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(operandA)):null;else newInst=null}else newInst=null;break;case 2:if(0==(operandA=inputA.operand)._hx_index){aVal=operandA.value;if(2==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(aVal*bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0))):1==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(operandB)):null;else newInst=null}else if(2==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index)newInst=0==(bVal=operandB.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0))):1==bVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(operandA)):null;else newInst=null}else newInst=null;break;case 3:if(0==(operandA=inputA.operand)._hx_index){ay=operandA.y,ax=operandA.x;if(2==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(ax*bVal,ay*bVal)))}else newInst=0==ax&&0==ay?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))):null;else newInst=null}else if(2==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index)newInst=0==(bVal=operandB.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0))):1==bVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(operandA)):null;else newInst=null}else newInst=null;break;default:newInst=null}break;case 24:inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:if(0==(operandA=inputA.operand)._hx_index){aVal=operandA.value;if(1==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(aVal/bVal|0)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0))):null;else newInst=null}else if(1==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index)newInst=1==(bVal=operandB.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(operandA)):null;else newInst=null}else newInst=null;break;case 2:if(0==(operandA=inputA.operand)._hx_index){aVal=operandA.value;if(2==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(aVal/bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0))):null;else newInst=null}else if(2==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index)newInst=1==(bVal=operandB.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(operandA)):null;else newInst=null}else newInst=null;break;case 3:if(0==(operandA=inputA.operand)._hx_index){ay=operandA.y,ax=operandA.x;if(2==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(ax/bVal,ay/bVal)))}else newInst=0==ax&&0==ay?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))):null;else newInst=null}else if(2==inputB._hx_index){if(0==(operandB=inputB.operand)._hx_index)newInst=1==(bVal=operandB.value)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(operandA)):null;else newInst=null}else newInst=null;break;default:newInst=null}break;case 25:var inputA;inputB=inst.inputB;switch((inputA=inst.inputA)._hx_index){case 1:if(0==(operandA=inputA.operand)._hx_index){aVal=operandA.value;if(1==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(aVal%bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0))):null;else newInst=null}else newInst=null;break;case 2:var operandA;if(0==(operandA=inputA.operand)._hx_index){var operandB;aVal=operandA.value;if(2==inputB._hx_index)if(0==(operandB=inputB.operand)._hx_index){bVal=operandB.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(aVal%bVal)))}else newInst=0==aVal?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0))):null;else newInst=null}else newInst=null;break;default:newInst=null}break;case 38:inst.property;var input=inst.input;newInst=firedancer_assembly_OperandExtension.isZero(input)?firedancer_assembly_Instruction.None:null;break;default:newInst=null}return newInst},firedancer_assembly_InstructionOptimizer.tryReplaceUnnecessaryCalculation=function(inst,maybeImm,regOrRegBuf){var newInst,maybeImmType=firedancer_assembly_OperandExtension.getType(maybeImm);switch(inst._hx_index){case 20:switch((nextOperands=inst.input)._hx_index){case 0:var b=nextOperands.b,a=nextOperands.a;if(0==maybeImmType&&firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_IntOperandExtension.isReg(a)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(b)):firedancer_assembly_IntOperandExtension.isReg(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(a)):null;break;case 3:newInst=firedancer_assembly_IntOperandExtension.isRegBuf(a)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(b)):firedancer_assembly_IntOperandExtension.isRegBuf(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(a)):null;break;default:newInst=null}else newInst=null;break;case 1:b=nextOperands.b,a=nextOperands.a;if(1==maybeImmType&&firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_FloatOperandExtension.isReg(a)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(b)):firedancer_assembly_FloatOperandExtension.isReg(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(a)):null;break;case 3:newInst=firedancer_assembly_FloatOperandExtension.isRegBuf(a)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(b)):firedancer_assembly_FloatOperandExtension.isRegBuf(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(a)):null;break;default:newInst=null}else newInst=null;break;case 2:b=nextOperands.b,a=nextOperands.a;if(2==maybeImmType&&firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_VecOperandExtension.isReg(a)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(b)):firedancer_assembly_VecOperandExtension.isReg(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(a)):null;break;case 3:newInst=null;break;default:newInst=null}else newInst=null}break;case 21:var nextOperands;switch((nextOperands=inst.input)._hx_index){case 0:b=nextOperands.b,a=nextOperands.a;if(0==maybeImmType&&firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_IntOperandExtension.isReg(a)?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Int(b)):firedancer_assembly_IntOperandExtension.isReg(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(a)):null;break;case 3:newInst=firedancer_assembly_IntOperandExtension.isRegBuf(a)?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Int(b)):firedancer_assembly_IntOperandExtension.isRegBuf(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(a)):null;break;default:newInst=null}else newInst=null;break;case 1:b=nextOperands.b,a=nextOperands.a;if(1==maybeImmType&&firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_FloatOperandExtension.isReg(a)?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Float(b)):firedancer_assembly_FloatOperandExtension.isReg(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(a)):null;break;case 3:newInst=firedancer_assembly_FloatOperandExtension.isRegBuf(a)?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Float(b)):firedancer_assembly_FloatOperandExtension.isRegBuf(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(a)):null;break;default:newInst=null}else newInst=null;break;case 2:b=nextOperands.b,a=nextOperands.a;newInst=2==maybeImmType&&firedancer_assembly_OperandExtension.isZero(maybeImm)&&2==regOrRegBuf?firedancer_assembly_VecOperandExtension.isReg(a)?firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Vec(b)):firedancer_assembly_VecOperandExtension.isReg(b)?firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(a)):null:null}break;case 22:var input=inst.input;switch(regOrRegBuf){case 2:if(firedancer_assembly_OperandExtension.isReg(input))switch(maybeImm._hx_index){case 1:if(0==(operand=maybeImm.operand)._hx_index){var value=operand.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(-value)))}else newInst=null;break;case 2:if(0==(operand=maybeImm.operand)._hx_index){value=operand.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(-value)))}else newInst=null;break;case 3:if(0==(operand=maybeImm.operand)._hx_index){var y=operand.y,x=operand.x;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(-x,-y)))}else newInst=null;break;default:newInst=null}else newInst=null;break;case 3:if(firedancer_assembly_OperandExtension.isRegBuf(input))switch(maybeImm._hx_index){case 1:if(0==(operand=maybeImm.operand)._hx_index){value=operand.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(-value)))}else newInst=null;break;case 2:if(0==(operand=maybeImm.operand)._hx_index){value=operand.value;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(-value)))}else newInst=null;break;case 3:var operand;if(0==(operand=maybeImm.operand)._hx_index){y=operand.y,x=operand.x;newInst=firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(-x,-y)))}else newInst=null;break;default:newInst=null}else newInst=null;break;default:newInst=null}break;case 23:var inputB=inst.inputB,inputA=inst.inputA,outputType=firedancer_assembly_OperandExtension.getType(inputA);if(firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:if(firedancer_assembly_OperandExtension.tryGetRegType(inputA)==maybeImmType||firedancer_assembly_OperandExtension.isRegBuf(inputA)&&firedancer_assembly_OperandExtension.tryGetRegType(inputB)==maybeImmType){switch(outputType){case 0:newInst1=firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0));break;case 1:newInst1=firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0));break;case 2:newInst1=firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))}newInst=firedancer_assembly_Instruction.Load(newInst1)}else newInst=null;break;case 3:if(firedancer_assembly_OperandExtension.tryGetRegBufType(inputA)==maybeImmType||firedancer_assembly_OperandExtension.isReg(inputA)&&firedancer_assembly_OperandExtension.tryGetRegBufType(inputB)==maybeImmType){switch(outputType){case 0:newInst1=firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0));break;case 1:newInst1=firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0));break;case 2:newInst1=firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))}newInst=firedancer_assembly_Instruction.Load(newInst1)}else newInst=null;break;default:newInst=null}else if(firedancer_assembly_OperandExtension.isOne(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_OperandExtension.tryGetRegType(inputB)==maybeImmType?firedancer_assembly_OperandExtension.isReg(inputA)?firedancer_assembly_Instruction.None:firedancer_assembly_Instruction.Load(inputA):null;break;case 3:newInst=firedancer_assembly_OperandExtension.tryGetRegBufType(inputB)==maybeImmType?firedancer_assembly_OperandExtension.isReg(inputA)?firedancer_assembly_Instruction.None:firedancer_assembly_Instruction.Load(inputA):null;break;default:newInst=null}else newInst=null;break;case 24:inputB=inst.inputB,inputA=inst.inputA,outputType=firedancer_assembly_OperandExtension.getType(inputA);if(firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:if(firedancer_assembly_OperandExtension.tryGetRegType(inputA)==maybeImmType){switch(outputType){case 0:newInst1=firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0));break;case 1:newInst1=firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0));break;case 2:newInst1=firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))}newInst=firedancer_assembly_Instruction.Load(newInst1)}else newInst=null;break;case 3:if(firedancer_assembly_OperandExtension.tryGetRegBufType(inputA)==maybeImmType){switch(outputType){case 0:newInst1=firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0));break;case 1:newInst1=firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0));break;case 2:newInst1=firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))}newInst=firedancer_assembly_Instruction.Load(newInst1)}else newInst=null;break;default:newInst=null}else if(firedancer_assembly_OperandExtension.isOne(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_OperandExtension.tryGetRegType(inputB)==maybeImmType?firedancer_assembly_OperandExtension.isReg(inputA)?firedancer_assembly_Instruction.None:firedancer_assembly_Instruction.Load(inputA):null;break;case 3:newInst=firedancer_assembly_OperandExtension.tryGetRegBufType(inputB)==maybeImmType?firedancer_assembly_OperandExtension.isReg(inputA)?firedancer_assembly_Instruction.None:firedancer_assembly_Instruction.Load(inputA):null;break;default:newInst=null}else newInst=null;break;case 25:inputB=inst.inputB,inputA=inst.inputA,outputType=firedancer_assembly_OperandExtension.getType(inputA);if(firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:if(firedancer_assembly_OperandExtension.tryGetRegType(inputA)==maybeImmType){switch(outputType){case 0:newInst1=firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0));break;case 1:newInst1=firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0));break;case 2:newInst1=firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))}newInst=firedancer_assembly_Instruction.Load(newInst1)}else newInst=null;break;case 3:if(firedancer_assembly_OperandExtension.tryGetRegBufType(inputA)==maybeImmType){var newInst1;switch(outputType){case 0:newInst1=firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(0));break;case 1:newInst1=firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(0));break;case 2:newInst1=firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Imm(0,0))}newInst=firedancer_assembly_Instruction.Load(newInst1)}else newInst=null;break;default:newInst=null}else newInst=null;break;case 38:inst.property,input=inst.input;if(firedancer_assembly_OperandExtension.isZero(maybeImm))switch(regOrRegBuf){case 2:newInst=firedancer_assembly_OperandExtension.tryGetRegType(input)==maybeImmType?firedancer_assembly_Instruction.None:null;break;case 3:newInst=firedancer_assembly_OperandExtension.tryGetRegBufType(input)==maybeImmType?firedancer_assembly_Instruction.None:null;break;default:newInst=null}else newInst=null;break;default:newInst=null}return newInst},firedancer_assembly_InstructionOptimizer.tryReplaceVariable=function(inst,variables){var newInst;switch(inst._hx_index){case 8:var input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.Load(newInput):null;break;case 9:input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.Save(newInput):null;break;case 11:var address=inst.varKey;input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.Store(newInput,address):null;break;case 13:input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.Push(newInput):null;break;case 20:switch((nextOperands=inst.input)._hx_index){case 0:var b=nextOperands.b;if(4==(a=nextOperands.a)._hx_index){var key=a.key;if(null==(stack=variables.variableStackMap.h[key]))throw haxe_Exception.thrown("Variable not declared: "+key);newInst=null!=(imm=stack[stack.length-1].tryGetIntImm())?firedancer_assembly_Instruction.Add(firedancer_assembly_OperandPair.Int(firedancer_assembly_IntOperand.Imm(imm),b)):null}else newInst=null;break;case 1:b=nextOperands.b;if(4==(a=nextOperands.a)._hx_index){key=a.key;if(null==(stack=variables.variableStackMap.h[key]))throw haxe_Exception.thrown("Variable not declared: "+key);newInst=null!=(imm=stack[stack.length-1].tryGetFloatImm())?firedancer_assembly_Instruction.Add(firedancer_assembly_OperandPair.Float(firedancer_assembly_FloatOperand.Imm(imm),b)):null}else newInst=null;break;default:newInst=null}break;case 21:var nextOperands;switch((nextOperands=inst.input)._hx_index){case 0:b=nextOperands.b;if(4==(a=nextOperands.a)._hx_index){key=a.key;if(null==(stack=variables.variableStackMap.h[key]))throw haxe_Exception.thrown("Variable not declared: "+key);newInst=null!=(imm=stack[stack.length-1].tryGetIntImm())?firedancer_assembly_Instruction.Sub(firedancer_assembly_OperandPair.Int(firedancer_assembly_IntOperand.Imm(imm),b)):null}else newInst=null;break;case 1:var a;b=nextOperands.b;if(4==(a=nextOperands.a)._hx_index){var stack,imm;key=a.key;if(null==(stack=variables.variableStackMap.h[key]))throw haxe_Exception.thrown("Variable not declared: "+key);newInst=null!=(imm=stack[stack.length-1].tryGetFloatImm())?firedancer_assembly_Instruction.Sub(firedancer_assembly_OperandPair.Float(firedancer_assembly_FloatOperand.Imm(imm),b)):null}else newInst=null;break;default:newInst=null}break;case 22:input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.Minus(newInput):null;break;case 23:var inputB=inst.inputB,inputA=inst.inputA;newInst=null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(inputA,variables))?firedancer_assembly_Instruction.Mult(newInputA,inputB):null;break;case 24:inputB=inst.inputB,inputA=inst.inputA;newInst=null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(inputA,variables))?firedancer_assembly_Instruction.Div(newInputA,inputB):null;break;case 25:var newInputA;inputB=inst.inputB,inputA=inst.inputA;newInst=null!=(newInputA=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(inputA,variables))?firedancer_assembly_Instruction.Mod(newInputA,inputB):null;break;case 36:var prop=inst.property;input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.GetDiff(newInput,prop):null;break;case 37:prop=inst.property,input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.Set(newInput,prop):null;break;case 38:var newInput;prop=inst.property,input=inst.input;newInst=null!=(newInput=firedancer_assembly_OperandExtension.tryReplaceVarWithImm(input,variables))?firedancer_assembly_Instruction.Increase(newInput,prop):null;break;default:newInst=null}return newInst};var firedancer_assembly_Operand=$hxEnums["firedancer.assembly.Operand"]={__ename__:"firedancer.assembly.Operand",__constructs__:["Null","Int","Float","Vec"],Null:{_hx_index:0,__enum__:"firedancer.assembly.Operand",toString:$estr},Int:($_=function(operand){return{_hx_index:1,operand:operand,__enum__:"firedancer.assembly.Operand",toString:$estr}},$_.__params__=["operand"],$_),Float:($_=function(operand){return{_hx_index:2,operand:operand,__enum__:"firedancer.assembly.Operand",toString:$estr}},$_.__params__=["operand"],$_),Vec:($_=function(operand){return{_hx_index:3,operand:operand,__enum__:"firedancer.assembly.Operand",toString:$estr}},$_.__params__=["operand"],$_)};firedancer_assembly_Operand.__empty_constructs__=[firedancer_assembly_Operand.Null];var firedancer_assembly_OperandExtension=function(){};$hxClasses["firedancer.assembly.OperandExtension"]=firedancer_assembly_OperandExtension,firedancer_assembly_OperandExtension.__name__="firedancer.assembly.OperandExtension",firedancer_assembly_OperandExtension.toString=function(_this){switch(_this._hx_index){case 0:return"n";case 1:var operand=_this.operand;return firedancer_assembly_IntOperandExtension.toString(operand);case 2:operand=_this.operand;return firedancer_assembly_FloatOperandExtension.toString(operand);case 3:operand=_this.operand;return firedancer_assembly_VecOperandExtension.toString(operand)}},firedancer_assembly_OperandExtension.bytecodeLength=function(_this){switch(_this._hx_index){case 0:return 0;case 1:var operand=_this.operand;return firedancer_assembly_IntOperandExtension.bytecodeLength(operand);case 2:operand=_this.operand;return firedancer_assembly_FloatOperandExtension.bytecodeLength(operand);case 3:operand=_this.operand;return firedancer_assembly_VecOperandExtension.bytecodeLength(operand)}},firedancer_assembly_OperandExtension.getType=function(_this){switch(_this._hx_index){case 0:throw haxe_Exception.thrown("Cannot determine type of Null.");case 1:_this.operand;return 0;case 2:_this.operand;return 1;case 3:_this.operand;return 2}},firedancer_assembly_OperandExtension.tryGetRegType=function(_this){var type;switch(_this._hx_index){case 0:type=null;break;case 1:type=1==_this.operand._hx_index?0:null;break;case 2:type=1==_this.operand._hx_index?1:null;break;case 3:type=1==_this.operand._hx_index?2:null}return type},firedancer_assembly_OperandExtension.tryGetRegBufType=function(_this){var type;switch(_this._hx_index){case 0:type=null;break;case 1:type=2==_this.operand._hx_index?0:null;break;case 2:type=2==_this.operand._hx_index?1:null;break;default:type=null}return type},firedancer_assembly_OperandExtension.isReg=function(_this){switch(_this._hx_index){case 0:return!1;case 1:var operand=_this.operand;return firedancer_assembly_IntOperandExtension.isReg(operand);case 2:operand=_this.operand;return firedancer_assembly_FloatOperandExtension.isReg(operand);case 3:operand=_this.operand;return firedancer_assembly_VecOperandExtension.isReg(operand)}},firedancer_assembly_OperandExtension.isRegBuf=function(_this){switch(_this._hx_index){case 0:return!1;case 1:var operand=_this.operand;return firedancer_assembly_IntOperandExtension.isRegBuf(operand);case 2:operand=_this.operand;return firedancer_assembly_FloatOperandExtension.isRegBuf(operand);case 3:operand=_this.operand;return!1}},firedancer_assembly_OperandExtension.isStack=function(_this){switch(_this._hx_index){case 0:return!1;case 1:return _this.operand==firedancer_assembly_IntOperand.Stack;case 2:return _this.operand==firedancer_assembly_FloatOperand.Stack;case 3:return _this.operand==firedancer_assembly_VecOperand.Stack}},firedancer_assembly_OperandExtension.getKind=function(_this){switch(_this._hx_index){case 0:return 0;case 1:switch((operand=_this.operand)._hx_index){case 0:operand.value;return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:operand.key;return 5}break;case 2:switch((operand=_this.operand)._hx_index){case 0:operand.value;return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 4:operand.key;return 5}break;case 3:var operand;switch((operand=_this.operand)._hx_index){case 0:operand.y,operand.x;return 1;case 1:return 2;case 2:return 4}}},firedancer_assembly_OperandExtension.tryGetIntImm=function(_this){var result;if(1==_this._hx_index){var operand=_this.operand;if(0==operand._hx_index)result=operand.value;else result=null}else result=null;return result},firedancer_assembly_OperandExtension.tryGetFloatImm=function(_this){var result;if(2==_this._hx_index){var operand=_this.operand;if(0==operand._hx_index)result=operand.value;else result=null}else result=null;return result},firedancer_assembly_OperandExtension.tryGetVecImm=function(_this){var result;if(3==_this._hx_index){var operand=_this.operand;if(0==operand._hx_index){var y=operand.y;result={x:operand.x,y:y}}else result=null}else result=null;return result},firedancer_assembly_OperandExtension.tryReplaceRegWithImm=function(_this,maybeImm){var newOperand;switch(_this._hx_index){case 0:newOperand=null;break;case 1:if(1==_this.operand._hx_index)if(1==maybeImm._hx_index)if(0==(maybeIntImm=maybeImm.operand)._hx_index){maybeIntImm.value;newOperand=maybeImm}else newOperand=null;else newOperand=null;else newOperand=null;break;case 2:if(1==_this.operand._hx_index)if(2==maybeImm._hx_index)if(0==(maybeIntImm=maybeImm.operand)._hx_index){maybeIntImm.value;newOperand=maybeImm}else newOperand=null;else newOperand=null;else newOperand=null;break;case 3:var maybeIntImm;if(1==_this.operand._hx_index)if(3==maybeImm._hx_index)if(0==(maybeIntImm=maybeImm.operand)._hx_index){maybeIntImm.y,maybeIntImm.x;newOperand=maybeImm}else newOperand=null;else newOperand=null;else newOperand=null}return newOperand},firedancer_assembly_OperandExtension.tryReplaceRegBufWithImm=function(_this,maybeImm){var newOperand;switch(_this._hx_index){case 1:if(2==_this.operand._hx_index)if(1==maybeImm._hx_index)if(0==(maybeIntImm=maybeImm.operand)._hx_index){maybeIntImm.value;newOperand=maybeImm}else newOperand=null;else newOperand=null;else newOperand=null;break;case 2:var maybeIntImm;if(2==_this.operand._hx_index)if(2==maybeImm._hx_index)if(0==(maybeIntImm=maybeImm.operand)._hx_index){maybeIntImm.value;newOperand=maybeImm}else newOperand=null;else newOperand=null;else newOperand=null;break;default:newOperand=null}return newOperand},firedancer_assembly_OperandExtension.tryReplaceVarWithImm=function(_this,variables){var newOperand;switch(_this._hx_index){case 0:newOperand=null;break;case 1:if(4==(thisOperand=_this.operand)._hx_index){var address=thisOperand.key;if(null==(stack=variables.variableStackMap.h[address]))throw haxe_Exception.thrown("Variable not declared: "+address);if(null!=(variable=stack[stack.length-1]).operand)if(1==(_g=variable.operand)._hx_index)if(0==(maybeIntImm=_g.operand)._hx_index){var _g=maybeIntImm.value;newOperand=variable.operand}else newOperand=null;else newOperand=null;else newOperand=null}else newOperand=null;break;case 2:var thisOperand;if(4==(thisOperand=_this.operand)._hx_index){var stack,variable,maybeIntImm;address=thisOperand.key;if(null==(stack=variables.variableStackMap.h[address]))throw haxe_Exception.thrown("Variable not declared: "+address);if(null!=(variable=stack[stack.length-1]).operand)if(2==(_g=variable.operand)._hx_index)if(0==(maybeIntImm=_g.operand)._hx_index){_g=maybeIntImm.value;newOperand=variable.operand}else newOperand=null;else newOperand=null;else newOperand=null}else newOperand=null;break;default:newOperand=null}return newOperand},firedancer_assembly_OperandExtension.isZero=function(_this){switch(_this._hx_index){case 1:var operand=_this.operand;return firedancer_assembly_IntOperandExtension.isZero(operand);case 2:operand=_this.operand;return firedancer_assembly_FloatOperandExtension.isZero(operand);case 3:operand=_this.operand;return firedancer_assembly_VecOperandExtension.isZero(operand);default:return!1}},firedancer_assembly_OperandExtension.isOne=function(_this){switch(_this._hx_index){case 1:var operand=_this.operand;return firedancer_assembly_IntOperandExtension.isOne(operand);case 2:operand=_this.operand;return firedancer_assembly_FloatOperandExtension.isOne(operand);default:return!1}};var firedancer_assembly_OperandPair=$hxEnums["firedancer.assembly.OperandPair"]={__ename__:"firedancer.assembly.OperandPair",__constructs__:["Int","Float","Vec"],Int:($_=function(a,b){return{_hx_index:0,a:a,b:b,__enum__:"firedancer.assembly.OperandPair",toString:$estr}},$_.__params__=["a","b"],$_),Float:($_=function(a,b){return{_hx_index:1,a:a,b:b,__enum__:"firedancer.assembly.OperandPair",toString:$estr}},$_.__params__=["a","b"],$_),Vec:($_=function(a,b){return{_hx_index:2,a:a,b:b,__enum__:"firedancer.assembly.OperandPair",toString:$estr}},$_.__params__=["a","b"],$_)};firedancer_assembly_OperandPair.__empty_constructs__=[];var firedancer_assembly_OperandPairExtension=function(){};$hxClasses["firedancer.assembly.OperandPairExtension"]=firedancer_assembly_OperandPairExtension,firedancer_assembly_OperandPairExtension.__name__="firedancer.assembly.OperandPairExtension",firedancer_assembly_OperandPairExtension.toString=function(_this){switch(_this._hx_index){case 0:var b=_this.b,a=_this.a;return firedancer_assembly_IntOperandExtension.toString(a)+", "+firedancer_assembly_IntOperandExtension.toString(b);case 1:b=_this.b,a=_this.a;return firedancer_assembly_FloatOperandExtension.toString(a)+", "+firedancer_assembly_FloatOperandExtension.toString(b);case 2:b=_this.b,a=_this.a;return firedancer_assembly_VecOperandExtension.toString(a)+", "+firedancer_assembly_VecOperandExtension.toString(b)}},firedancer_assembly_OperandPairExtension.bytecodeLength=function(_this){switch(_this._hx_index){case 0:var b=_this.b,a=_this.a;return firedancer_assembly_IntOperandExtension.bytecodeLength(a)+firedancer_assembly_IntOperandExtension.bytecodeLength(b);case 1:b=_this.b,a=_this.a;return firedancer_assembly_FloatOperandExtension.bytecodeLength(a)+firedancer_assembly_FloatOperandExtension.bytecodeLength(b);case 2:b=_this.b,a=_this.a;return firedancer_assembly_VecOperandExtension.bytecodeLength(a)+firedancer_assembly_VecOperandExtension.bytecodeLength(b)}},firedancer_assembly_OperandPairExtension.getFirstOperand=function(_this){switch(_this._hx_index){case 0:_this.b;var a=_this.a;return firedancer_assembly_Operand.Int(a);case 1:_this.b,a=_this.a;return firedancer_assembly_Operand.Float(a);case 2:_this.b,a=_this.a;return firedancer_assembly_Operand.Vec(a)}},firedancer_assembly_OperandPairExtension.tryGetRegType=function(_this){var type;switch(_this._hx_index){case 0:var b=_this.b,a=_this.a;type=firedancer_assembly_IntOperandExtension.isReg(a)||firedancer_assembly_IntOperandExtension.isReg(b)?0:null;break;case 1:b=_this.b,a=_this.a;type=firedancer_assembly_FloatOperandExtension.isReg(a)||firedancer_assembly_FloatOperandExtension.isReg(b)?1:null;break;case 2:b=_this.b,a=_this.a;type=firedancer_assembly_VecOperandExtension.isReg(a)||firedancer_assembly_VecOperandExtension.isReg(b)?2:null}return type},firedancer_assembly_OperandPairExtension.tryGetRegBufType=function(_this){var type;switch(_this._hx_index){case 0:var b=_this.b,a=_this.a;type=firedancer_assembly_IntOperandExtension.isRegBuf(a)||firedancer_assembly_IntOperandExtension.isRegBuf(b)?0:null;break;case 1:b=_this.b,a=_this.a;type=firedancer_assembly_FloatOperandExtension.isRegBuf(a)||firedancer_assembly_FloatOperandExtension.isRegBuf(b)?1:null;break;default:type=null}return type},firedancer_assembly_OperandPairExtension.tryReplaceRegWithImm=function(_this,maybeImm){var newPair;switch(_this._hx_index){case 0:var b=_this.b,a=_this.a;if(1==maybeImm._hx_index){var maybeIntImm=maybeImm.operand;if(0==maybeIntImm._hx_index){maybeIntImm.value;newPair=firedancer_assembly_IntOperandExtension.isReg(a)?2==b._hx_index?null:firedancer_assembly_OperandPair.Int(maybeIntImm,b):firedancer_assembly_IntOperandExtension.isReg(b)?2==a._hx_index?null:firedancer_assembly_OperandPair.Int(a,maybeIntImm):null}else newPair=null}else newPair=null;break;case 1:b=_this.b,a=_this.a;if(2==maybeImm._hx_index){var maybeFloatImm=maybeImm.operand;if(0==maybeFloatImm._hx_index){maybeFloatImm.value;newPair=firedancer_assembly_FloatOperandExtension.isReg(a)?2==b._hx_index?null:firedancer_assembly_OperandPair.Float(maybeFloatImm,b):firedancer_assembly_FloatOperandExtension.isReg(b)?2==a._hx_index?null:firedancer_assembly_OperandPair.Float(a,maybeFloatImm):null}else newPair=null}else newPair=null;break;case 2:b=_this.b,a=_this.a;newPair=null}return newPair},firedancer_assembly_OperandPairExtension.tryReplaceRegBufWithImm=function(_this,maybeImm){var newPair;switch(_this._hx_index){case 0:var b=_this.b,a=_this.a;if(1==maybeImm._hx_index){var maybeIntImm=maybeImm.operand;if(0==maybeIntImm._hx_index){maybeIntImm.value;newPair=firedancer_assembly_IntOperandExtension.isRegBuf(a)?firedancer_assembly_OperandPair.Int(maybeIntImm,b):firedancer_assembly_IntOperandExtension.isRegBuf(b)?firedancer_assembly_OperandPair.Int(a,maybeIntImm):null}else newPair=null}else newPair=null;break;case 1:b=_this.b,a=_this.a;if(2==maybeImm._hx_index){var maybeFloatImm=maybeImm.operand;if(0==maybeFloatImm._hx_index){maybeFloatImm.value;newPair=firedancer_assembly_FloatOperandExtension.isRegBuf(a)?firedancer_assembly_OperandPair.Float(maybeFloatImm,b):firedancer_assembly_FloatOperandExtension.isRegBuf(b)?firedancer_assembly_OperandPair.Float(a,maybeFloatImm):null}else newPair=null}else newPair=null;break;case 2:b=_this.b,a=_this.a;newPair=null}return newPair};var firedancer_assembly_IntOperand=$hxEnums["firedancer.assembly.IntOperand"]={__ename__:"firedancer.assembly.IntOperand",__constructs__:["Imm","Reg","RegBuf","Stack","Var"],Imm:($_=function(value){return{_hx_index:0,value:value,__enum__:"firedancer.assembly.IntOperand",toString:$estr}},$_.__params__=["value"],$_),Reg:{_hx_index:1,__enum__:"firedancer.assembly.IntOperand",toString:$estr},RegBuf:{_hx_index:2,__enum__:"firedancer.assembly.IntOperand",toString:$estr},Stack:{_hx_index:3,__enum__:"firedancer.assembly.IntOperand",toString:$estr},Var:($_=function(key){return{_hx_index:4,key:key,__enum__:"firedancer.assembly.IntOperand",toString:$estr}},$_.__params__=["key"],$_)};firedancer_assembly_IntOperand.__empty_constructs__=[firedancer_assembly_IntOperand.Reg,firedancer_assembly_IntOperand.RegBuf,firedancer_assembly_IntOperand.Stack];var firedancer_assembly_IntOperandExtension=function(){};$hxClasses["firedancer.assembly.IntOperandExtension"]=firedancer_assembly_IntOperandExtension,firedancer_assembly_IntOperandExtension.__name__="firedancer.assembly.IntOperandExtension",firedancer_assembly_IntOperandExtension.toString=function(_this){switch(_this._hx_index){case 0:var value=_this.value;return null==value?"null":""+value;case 1:return"ri";case 2:return"rib";case 3:return"s";case 4:var key=_this.key;return firedancer_assembly_OperandTools.varToString(key,0)}},firedancer_assembly_IntOperandExtension.bytecodeLength=function(_this){switch(_this._hx_index){case 0:_this.value;return 4;case 4:_this.key;return 4;default:return 0}},firedancer_assembly_IntOperandExtension.isReg=function(_this){return 1==_this._hx_index},firedancer_assembly_IntOperandExtension.isRegBuf=function(_this){return 2==_this._hx_index},firedancer_assembly_IntOperandExtension.isZero=function(_this){return 0==_this._hx_index&&0==_this.value},firedancer_assembly_IntOperandExtension.isOne=function(_this){return 0==_this._hx_index&&1==_this.value};var firedancer_assembly_FloatOperand=$hxEnums["firedancer.assembly.FloatOperand"]={__ename__:"firedancer.assembly.FloatOperand",__constructs__:["Imm","Reg","RegBuf","Stack","Var"],Imm:($_=function(value){return{_hx_index:0,value:value,__enum__:"firedancer.assembly.FloatOperand",toString:$estr}},$_.__params__=["value"],$_),Reg:{_hx_index:1,__enum__:"firedancer.assembly.FloatOperand",toString:$estr},RegBuf:{_hx_index:2,__enum__:"firedancer.assembly.FloatOperand",toString:$estr},Stack:{_hx_index:3,__enum__:"firedancer.assembly.FloatOperand",toString:$estr},Var:($_=function(key){return{_hx_index:4,key:key,__enum__:"firedancer.assembly.FloatOperand",toString:$estr}},$_.__params__=["key"],$_)};firedancer_assembly_FloatOperand.__empty_constructs__=[firedancer_assembly_FloatOperand.Reg,firedancer_assembly_FloatOperand.RegBuf,firedancer_assembly_FloatOperand.Stack];var firedancer_assembly_FloatOperandExtension=function(){};$hxClasses["firedancer.assembly.FloatOperandExtension"]=firedancer_assembly_FloatOperandExtension,firedancer_assembly_FloatOperandExtension.__name__="firedancer.assembly.FloatOperandExtension",firedancer_assembly_FloatOperandExtension.toString=function(_this){switch(_this._hx_index){case 0:var value=_this.value;return firedancer_assembly_OperandTools.ftoa(value);case 1:return"rf";case 2:return"rfb";case 3:return"s";case 4:var key=_this.key;return firedancer_assembly_OperandTools.varToString(key,1)}},firedancer_assembly_FloatOperandExtension.bytecodeLength=function(_this){switch(_this._hx_index){case 0:_this.value;return 8;case 4:_this.key;return 4;default:return 0}},firedancer_assembly_FloatOperandExtension.isReg=function(_this){return 1==_this._hx_index},firedancer_assembly_FloatOperandExtension.isRegBuf=function(_this){return 2==_this._hx_index},firedancer_assembly_FloatOperandExtension.isZero=function(_this){if(0==_this._hx_index){var value=_this.value;return Math.abs(value)<177635683940025e-29}return!1},firedancer_assembly_FloatOperandExtension.isOne=function(_this){if(0==_this._hx_index){var value=_this.value;return Math.abs(value-1)<177635683940025e-29}return!1};var firedancer_assembly_VecOperand=$hxEnums["firedancer.assembly.VecOperand"]={__ename__:"firedancer.assembly.VecOperand",__constructs__:["Imm","Reg","Stack"],Imm:($_=function(x,y){return{_hx_index:0,x:x,y:y,__enum__:"firedancer.assembly.VecOperand",toString:$estr}},$_.__params__=["x","y"],$_),Reg:{_hx_index:1,__enum__:"firedancer.assembly.VecOperand",toString:$estr},Stack:{_hx_index:2,__enum__:"firedancer.assembly.VecOperand",toString:$estr}};firedancer_assembly_VecOperand.__empty_constructs__=[firedancer_assembly_VecOperand.Reg,firedancer_assembly_VecOperand.Stack];var firedancer_assembly_VecOperandExtension=function(){};$hxClasses["firedancer.assembly.VecOperandExtension"]=firedancer_assembly_VecOperandExtension,firedancer_assembly_VecOperandExtension.__name__="firedancer.assembly.VecOperandExtension",firedancer_assembly_VecOperandExtension.toString=function(_this){switch(_this._hx_index){case 0:var y=_this.y,x=_this.x;return"("+firedancer_assembly_OperandTools.ftoa(x)+", "+firedancer_assembly_OperandTools.ftoa(y)+")";case 1:return"rvec";case 2:return"s"}},firedancer_assembly_VecOperandExtension.bytecodeLength=function(_this){if(0==_this._hx_index){_this.y,_this.x;return 16}return 0},firedancer_assembly_VecOperandExtension.isReg=function(_this){return 1==_this._hx_index},firedancer_assembly_VecOperandExtension.isZero=function(_this){if(0==_this._hx_index){var y=_this.y,x=_this.x;return Math.abs(x)<177635683940025e-29&&Math.abs(y)<177635683940025e-29}return!1};var firedancer_assembly_OperandTools=function(){};$hxClasses["firedancer.assembly.OperandTools"]=firedancer_assembly_OperandTools,firedancer_assembly_OperandTools.__name__="firedancer.assembly.OperandTools",firedancer_assembly_OperandTools.ftoa=function(v){return(0|v)==v?v+".0":null==v?"null":""+v},firedancer_assembly_OperandTools.varToString=function(key,type){if(-1!=key.indexOf('"',null))throw haxe_Exception.thrown("Invalid variable key. Contains double quote: "+key);var typeChar;switch(type){case 0:typeChar="i";break;case 1:typeChar="f";break;case 2:typeChar="v"}return typeChar+'var["'+key+'"]'};var firedancer_assembly_Optimizer=function(){};$hxClasses["firedancer.assembly.Optimizer"]=firedancer_assembly_Optimizer,firedancer_assembly_Optimizer.__name__="firedancer.assembly.Optimizer",firedancer_assembly_Optimizer.optimize=function(code){var cnt=0;for(code=code.slice();;){var optimized=!1;if(firedancer_assembly_Optimizer.tryOptimizeCalc(code)&&(optimized=!0),firedancer_assembly_Optimizer.tryOptimizeStack(code)&&(optimized=!0),firedancer_assembly_Optimizer.tryOptimizeVar(code)&&(optimized=!0),firedancer_assembly_Optimizer.tryOptimizeWait(code)&&(optimized=!0),!optimized)break;for(var len=code.length,readIndex=0,writeIndex=0;readIndex<len;){var element=code[readIndex];++readIndex,element!=firedancer_assembly_Instruction.None?(code[writeIndex]=element,++writeIndex):!0}if(code.length=writeIndex,1024<++cnt)throw haxe_Exception.thrown("Detected infinite loop in the optimization process.")}return code},firedancer_assembly_Optimizer.tryOptimizeCalc=function(code){if((this1=code.length)<=1)return!1;for(var curInst,gotoNext,optimizedAny=!1,curIntReg=firedancer_assembly__$Optimizer_RegContent.createNull(),curFloatReg=firedancer_assembly__$Optimizer_RegContent.createNull(),curVecReg=firedancer_assembly__$Optimizer_RegContent.createNull(),curIntRegBuf=firedancer_assembly__$Optimizer_RegContent.createNull(),curFloatRegBuf=firedancer_assembly__$Optimizer_RegContent.createNull(),justSyncedIntReg=!1,justSyncedFloatReg=!1,i=0;;){var tmp;if(!(i<(this1=code.length)))break;switch(gotoNext=!0,(curInst=code[i])._hx_index){case 8:var input=curInst.input;switch(input._hx_index){case 1:switch(input.operand._hx_index){case 1:var newInst=firedancer_assembly_Instruction.None;code[i]=newInst,i==i&&(curInst=newInst,gotoNext=!1),optimizedAny=!0;break;case 2:if(justSyncedIntReg){var newInst1=firedancer_assembly_Instruction.None;code[i]=newInst1,i==i&&(curInst=newInst1,gotoNext=!1),optimizedAny=!0}}break;case 2:switch(input.operand._hx_index){case 1:var newInst2=firedancer_assembly_Instruction.None;code[i]=newInst2,i==i&&(curInst=newInst2,gotoNext=!1),optimizedAny=!0;break;case 2:if(justSyncedFloatReg){var newInst3=firedancer_assembly_Instruction.None;code[i]=newInst3,i==i&&(curInst=newInst3,gotoNext=!1),optimizedAny=!0}}}break;case 9:var input1=curInst.input;switch(input1._hx_index){case 1:switch(input1.operand._hx_index){case 1:if(justSyncedIntReg){var newInst4=firedancer_assembly_Instruction.None;code[i]=newInst4,i==i&&(curInst=newInst4,gotoNext=!1),optimizedAny=!0}break;case 2:var newInst5=firedancer_assembly_Instruction.None;code[i]=newInst5,i==i&&(curInst=newInst5,gotoNext=!1),optimizedAny=!0}break;case 2:switch(input1.operand._hx_index){case 1:if(justSyncedFloatReg){var newInst6=firedancer_assembly_Instruction.None;code[i]=newInst6,i==i&&(curInst=newInst6,gotoNext=!1),optimizedAny=!0}break;case 2:var newInst7=firedancer_assembly_Instruction.None;code[i]=newInst7,i==i&&(curInst=newInst7,gotoNext=!1),optimizedAny=!0}}}var mightBeImm=curIntReg.getMaybeImm(),result=!1;if(null!=mightBeImm){var optimizedInst=firedancer_assembly_InstructionOptimizer.tryReplaceRegWithImm(curInst,mightBeImm);if(null!=optimizedInst){var newInst8=optimizedInst;code[i]=newInst8,i==i&&(curInst=newInst8,gotoNext=!1),optimizedAny=!0,result=!0}}if(result)tmp=!0;else{var mightBeImm1=curFloatReg.getMaybeImm(),result1=!1;if(null!=mightBeImm1){var optimizedInst1=firedancer_assembly_InstructionOptimizer.tryReplaceRegWithImm(curInst,mightBeImm1);if(null!=optimizedInst1){var newInst9=optimizedInst1;code[i]=newInst9,i==i&&(curInst=newInst9,gotoNext=!1),optimizedAny=!0,result1=!0}}if(result1)tmp=!0;else{var mightBeImm2=curVecReg.getMaybeImm(),result2=!1;if(null!=mightBeImm2){var optimizedInst2=firedancer_assembly_InstructionOptimizer.tryReplaceRegWithImm(curInst,mightBeImm2);if(null!=optimizedInst2){var newInst10=optimizedInst2;code[i]=newInst10,i==i&&(curInst=newInst10,gotoNext=!1),optimizedAny=!0,result2=!0}}if(result2)tmp=!0;else{var mightBeImm3=curIntRegBuf.getMaybeImm(),result3=!1;if(null!=mightBeImm3){var optimizedInst3=firedancer_assembly_InstructionOptimizer.tryReplaceRegBufWithImm(curInst,mightBeImm3);if(null!=optimizedInst3){var newInst11=optimizedInst3;code[i]=newInst11,i==i&&(curInst=newInst11,gotoNext=!1),optimizedAny=!0,result3=!0}}if(result3)tmp=!0;else{var mightBeImm4=curFloatRegBuf.getMaybeImm(),result4=!1;if(null!=mightBeImm4){var optimizedInst4=firedancer_assembly_InstructionOptimizer.tryReplaceRegBufWithImm(curInst,mightBeImm4);if(null!=optimizedInst4){var newInst12=optimizedInst4;code[i]=newInst12,i==i&&(curInst=newInst12,gotoNext=!1),optimizedAny=!0,result4=!0}}if(result4)tmp=!0;else{var mightBeImmA=curIntRegBuf.getMaybeImm(),mightBeImmB=curIntReg.getMaybeImm(),result5=!1;if(null!=mightBeImmA&&null!=mightBeImmB){var optimizedInst5=firedancer_assembly_InstructionOptimizer.tryReplaceRegBufAndRegWithImm(curInst,mightBeImmA,mightBeImmB);if(null!=optimizedInst5){var newInst13=optimizedInst5;code[i]=newInst13,i==i&&(curInst=newInst13,gotoNext=!1),optimizedAny=!0,result5=!0}}if(result5)tmp=!0;else{var mightBeImmA1=curFloatRegBuf.getMaybeImm(),mightBeImmB1=curFloatReg.getMaybeImm(),result6=!1;if(null!=mightBeImmA1&&null!=mightBeImmB1){var optimizedInst6=firedancer_assembly_InstructionOptimizer.tryReplaceRegBufAndRegWithImm(curInst,mightBeImmA1,mightBeImmB1);if(null!=optimizedInst6){var newInst14=optimizedInst6;code[i]=newInst14,i==i&&(curInst=newInst14,gotoNext=!1),optimizedAny=!0,result6=!0}}tmp=result6}}}}}}if(!tmp){var mightBeImm5=curIntReg.getMaybeImm(),result7=!1;if(null!=mightBeImm5){var optimizedInst7=firedancer_assembly_InstructionOptimizer.tryReplaceUnnecessaryCalculation(curInst,mightBeImm5,2);if(null!=optimizedInst7){var newInst15=optimizedInst7;code[i]=newInst15,i==i&&(curInst=newInst15,gotoNext=!1),optimizedAny=!0,result7=!0}}if(!result7){var mightBeImm6=curFloatReg.getMaybeImm(),result8=!1;if(null!=mightBeImm6){var optimizedInst8=firedancer_assembly_InstructionOptimizer.tryReplaceUnnecessaryCalculation(curInst,mightBeImm6,2);if(null!=optimizedInst8){var newInst16=optimizedInst8;code[i]=newInst16,i==i&&(curInst=newInst16,gotoNext=!1),optimizedAny=!0,result8=!0}}if(!result8){var mightBeImm7=curVecReg.getMaybeImm(),result9=!1;if(null!=mightBeImm7){var optimizedInst9=firedancer_assembly_InstructionOptimizer.tryReplaceUnnecessaryCalculation(curInst,mightBeImm7,2);if(null!=optimizedInst9){var newInst17=optimizedInst9;code[i]=newInst17,i==i&&(curInst=newInst17,gotoNext=!1),optimizedAny=!0,result9=!0}}if(!result9){var mightBeImm8=curIntRegBuf.getMaybeImm(),result10=!1;if(null!=mightBeImm8){var optimizedInst10=firedancer_assembly_InstructionOptimizer.tryReplaceUnnecessaryCalculation(curInst,mightBeImm8,3);if(null!=optimizedInst10){var newInst18=optimizedInst10;code[i]=newInst18,i==i&&(curInst=newInst18,gotoNext=!1),optimizedAny=!0,result10=!0}}if(!result10){var mightBeImm9=curFloatRegBuf.getMaybeImm();if(null!=mightBeImm9){var optimizedInst11=firedancer_assembly_InstructionOptimizer.tryReplaceUnnecessaryCalculation(curInst,mightBeImm9,3);if(null!=optimizedInst11){var newInst19=optimizedInst11;code[i]=newInst19,i==i&&(curInst=newInst19,gotoNext=!1),optimizedAny=!0,!0}}}}}}}var folded=firedancer_assembly_InstructionOptimizer.tryFoldConstants(curInst);if(null!=folded){var newInst20=folded;code[i]=newInst20,i==i&&(curInst=newInst20,gotoNext=!1),optimizedAny=!0}firedancer_assembly_InstructionExtension.readsReg(curInst,0)&&(curIntReg.maybeRead=!0),firedancer_assembly_InstructionExtension.readsReg(curInst,1)&&(curFloatReg.maybeRead=!0),firedancer_assembly_InstructionExtension.readsReg(curInst,2)&&(curVecReg.maybeRead=!0),firedancer_assembly_InstructionExtension.readsRegBuf(curInst,0)&&(curIntRegBuf.maybeRead=!0),firedancer_assembly_InstructionExtension.readsRegBuf(curInst,1)&&(curFloatRegBuf.maybeRead=!0);var writeRegType=firedancer_assembly_InstructionExtension.tryGetWriteRegType(curInst);if(null!=writeRegType)switch(writeRegType){case 0:if(curIntReg.isEliminatable(i)){var index=curIntReg.loadedIndex,newInst21=firedancer_assembly_Instruction.None;code[index]=newInst21,index==i&&(curInst=newInst21,gotoNext=!1),optimizedAny=!0}switch(curInst._hx_index){case 8:var loaded=curInst.input;curIntReg=new firedancer_assembly__$Optimizer_RegContent(loaded,i,!0),justSyncedIntReg=firedancer_assembly_OperandExtension.isRegBuf(loaded);break;case 14:curInst.type;curIntReg=new firedancer_assembly__$Optimizer_RegContent(null,i,!1),justSyncedIntReg=!1;break;default:curIntReg=new firedancer_assembly__$Optimizer_RegContent(null,i,!0),justSyncedIntReg=!1}break;case 1:if(curFloatReg.isEliminatable(i)){var index1=curFloatReg.loadedIndex,newInst22=firedancer_assembly_Instruction.None;code[index1]=newInst22,index1==i&&(curInst=newInst22,gotoNext=!1),optimizedAny=!0}switch(curInst._hx_index){case 8:var loaded1=curInst.input;curFloatReg=new firedancer_assembly__$Optimizer_RegContent(loaded1,i,!0),justSyncedFloatReg=firedancer_assembly_OperandExtension.isRegBuf(loaded1);break;case 14:curInst.type;curFloatReg=new firedancer_assembly__$Optimizer_RegContent(null,i,!1),justSyncedIntReg=!1;break;default:curFloatReg=new firedancer_assembly__$Optimizer_RegContent(null,i,!0),justSyncedFloatReg=!1}break;case 2:if(curVecReg.isEliminatable(i)){var index2=curVecReg.loadedIndex,newInst23=firedancer_assembly_Instruction.None;code[index2]=newInst23,index2==i&&(curInst=newInst23,gotoNext=!1),optimizedAny=!0}switch(curInst._hx_index){case 8:var loaded2=curInst.input;curVecReg=new firedancer_assembly__$Optimizer_RegContent(loaded2,i,!0);break;case 14:curInst.type;curIntReg=new firedancer_assembly__$Optimizer_RegContent(null,i,!1);break;default:curVecReg=new firedancer_assembly__$Optimizer_RegContent(null,i,!0)}}var writeRegBufType=firedancer_assembly_InstructionExtension.tryGetWriteRegBufType(curInst);if(null!=writeRegBufType)switch(writeRegBufType){case 0:if(curIntRegBuf.isEliminatable(i)){var index3=curIntRegBuf.loadedIndex,newInst24=firedancer_assembly_Instruction.None;code[index3]=newInst24,index3==i&&(curInst=newInst24,gotoNext=!1),optimizedAny=!0}if(9==curInst._hx_index){var saved=curInst.input;curIntRegBuf=new firedancer_assembly__$Optimizer_RegContent(saved,i,!0),justSyncedIntReg=firedancer_assembly_OperandExtension.isReg(saved)}else curIntRegBuf=new firedancer_assembly__$Optimizer_RegContent(null,i,!0),justSyncedIntReg=!1;break;case 1:if(curFloatRegBuf.isEliminatable(i)){var index4=curFloatRegBuf.loadedIndex,newInst25=firedancer_assembly_Instruction.None;code[index4]=newInst25,index4==i&&(curInst=newInst25,gotoNext=!1),optimizedAny=!0}if(9==curInst._hx_index){var saved1=curInst.input;curFloatRegBuf=new firedancer_assembly__$Optimizer_RegContent(saved1,i,!0),justSyncedFloatReg=firedancer_assembly_OperandExtension.isReg(saved1)}else curFloatRegBuf=new firedancer_assembly__$Optimizer_RegContent(null,i,!0),justSyncedFloatReg=!1}gotoNext&&++i}var this1=code.length;if(curIntReg.isEliminatable(this1)){index=curIntReg.loadedIndex,newInst=firedancer_assembly_Instruction.None;code[index]=newInst,index==i&&(curInst=newInst,gotoNext=!1),optimizedAny=!0}this1=code.length;if(curFloatReg.isEliminatable(this1)){index=curFloatReg.loadedIndex,newInst=firedancer_assembly_Instruction.None;code[index]=newInst,index==i&&(curInst=newInst,gotoNext=!1),optimizedAny=!0}this1=code.length;if(curVecReg.isEliminatable(this1)){index=curVecReg.loadedIndex,newInst=firedancer_assembly_Instruction.None;code[index]=newInst,index==i&&(curInst=newInst,gotoNext=!1),optimizedAny=!0}this1=code.length;if(curIntRegBuf.isEliminatable(this1)){index=curIntRegBuf.loadedIndex,newInst=firedancer_assembly_Instruction.None;code[index]=newInst,index==i&&(curInst=newInst,gotoNext=!1),optimizedAny=!0}this1=code.length;if(curFloatRegBuf.isEliminatable(this1)){index=curFloatRegBuf.loadedIndex,newInst=firedancer_assembly_Instruction.None;code[index]=newInst,index==i&&(curInst=newInst,gotoNext=!1),optimizedAny=!0}return optimizedAny},firedancer_assembly_Optimizer.tryOptimizeStack=function(code){if(code.length<=1)return!1;for(var optimizedAny=!1,curStacked=[],i=0;;){if(!(i<code.length))break;var curInst=code[i];switch(curInst._hx_index){case 1:curStacked.pop();break;case 4:curInst.labelId,curStacked.pop();break;case 5:curInst.programId;var output=curInst.output;if(1==output._hx_index)if(3==output.operand._hx_index)curStacked.push(new firedancer_assembly_StackElement(output,i,null));break;case 6:curStacked.pop();break;case 13:var input=curInst.input;curStacked.push(new firedancer_assembly_StackElement(input,i,null));break;case 14:curInst.type;var stackTop=curStacked.pop();if(!stackTop.maybeRead){var tmp;if(1!=firedancer_assembly_OperandExtension.getKind(stackTop.operand)){var this8=i-1;tmp=stackTop.pushedIndex==this8}else tmp=!0;if(tmp){var newInst=firedancer_assembly_Instruction.Load(stackTop.operand);code[i]=newInst,i==i&&(curInst=newInst),optimizedAny=!0;var index=stackTop.pushedIndex,newInst1=firedancer_assembly_Instruction.None;code[index]=newInst1,i==index&&(curInst=newInst1),optimizedAny=!0}}break;case 15:curInst.bytesToSkip,curInst.type;var stackTop1,this10=curStacked.length-1;if(-1!=this10){stackTop1=curStacked[this10]}else{stackTop1=null}null!=stackTop1&&(stackTop1.maybeRead=!0);break;case 16:curInst.type,curStacked.pop();break;case 38:curInst.property;var input1=curInst.input;if(firedancer_assembly_OperandExtension.isStack(input1)){var stackTop2,this15=curStacked.length-1;if(-1!=this15){stackTop2=curStacked[this15]}else{stackTop2=null}null!=stackTop2&&(stackTop2.maybeRead=!0)}}var stackTop3,this19=curStacked.length-1;if(-1!=this19){stackTop3=curStacked[this19]}else{stackTop3=null}if(null!=stackTop3){var optimizedInst=firedancer_assembly_InstructionOptimizer.tryReplaceStackWithImm(curInst,stackTop3.operand);if(null!=optimizedInst){var newInst2=optimizedInst;code[i]=newInst2,i==i&&(curInst=newInst2),optimizedAny=!0}}++i}return optimizedAny},firedancer_assembly_Optimizer.tryOptimizeVar=function(code){if(code.length<=1)return!1;for(var curInst,optimizedAny=!1,variables=new firedancer_assembly_Variables,i=0;;){if(!(i<code.length))break;switch((curInst=code[i])._hx_index){case 2:curInst.labelId;variables.allMayBeReadOrAssigned();break;case 3:curInst.labelId;variables.allMayBeReadOrAssigned();break;case 4:curInst.labelId;variables.allMayBeReadOrAssigned();break;case 10:curInst.type;var varKey=curInst.varKey;variables.let(varKey,i);break;case 12:curInst.type;var varKey1=curInst.varKey,stack=variables.variableStackMap.h[varKey1];if(null==stack)throw haxe_Exception.thrown("Variable not declared: "+varKey1);var variable=stack[stack.length-1];if(!variable.maybeRead){var assignedIndex=variable.lastAssignedIndex;if(-1!=assignedIndex){var index=assignedIndex,newInst=firedancer_assembly_Instruction.None;code[index]=newInst,i==index&&(curInst=newInst),optimizedAny=!0}}if(!variable.isUsed){var index1=variable.declaredIndex,newInst1=firedancer_assembly_Instruction.None;code[index1]=newInst1,i==index1&&(curInst=newInst1),optimizedAny=!0;var newInst2=firedancer_assembly_Instruction.None;code[i]=newInst2,i==i&&(curInst=newInst2),optimizedAny=!0}variables.free(varKey1);break;default:var newInst3=firedancer_assembly_InstructionOptimizer.tryReplaceVariable(curInst,variables);if(null!=newInst3){var newInst4=newInst3;code[i]=newInst4,i==i&&(curInst=newInst4),optimizedAny=!0}var readVarKey=firedancer_assembly_InstructionExtension.tryGetReadVarKey(curInst);if(null!=readVarKey){var varKey2=readVarKey,stack1=variables.variableStackMap.h[varKey2];if(null==stack1)throw haxe_Exception.thrown("Variable not declared: "+varKey2);var variable1=stack1[stack1.length-1];variable1.maybeRead=!0,variable1.isUsed=!0}var writeVarKey=firedancer_assembly_InstructionExtension.tryGetWriteVarKey(curInst);if(null!=writeVarKey){var varKey3=writeVarKey,stack2=variables.variableStackMap.h[varKey3];if(null==stack2)throw haxe_Exception.thrown("Variable not declared: "+varKey3);var variable2=stack2[stack2.length-1];if(!variable2.maybeRead){var assignedIndex1=variable2.lastAssignedIndex;if(-1!=assignedIndex1){var index2=assignedIndex1,newInst5=firedancer_assembly_Instruction.None;code[index2]=newInst5,i==index2&&(curInst=newInst5),optimizedAny=!0}}if(11==curInst._hx_index){curInst.varKey;var input=curInst.input;variables.assign(writeVarKey,i,input)}else variables.assign(writeVarKey,i)}}++i}return optimizedAny},firedancer_assembly_Optimizer.tryOptimizeWait=function(code){for(var optimizedAny=!1,i=1;;){if(!(i<code.length))break;if(1==code[i]._hx_index){var _g=code[i-1];if(13==_g._hx_index){var input=_g.input,constWaitCount=firedancer_assembly_OperandExtension.tryGetIntImm(input);if(null!=constWaitCount){var waitCount=constWaitCount;if(waitCount<=32){code[i-1]=firedancer_assembly_Instruction.None,optimizedAny=!0,code[i]=firedancer_assembly_Instruction.None,optimizedAny=!0;for(var _g1=0,_g2=waitCount;_g1<_g2;){_g1++;code.splice(i,0,firedancer_assembly_Instruction.Break)}i=i+waitCount}}}}++i}return optimizedAny};var firedancer_assembly__$Optimizer_RegContent=function(operand,loadedIndex,eliminatable){null==eliminatable&&(eliminatable=!0),this.maybeRead=!1,this.operand=null;var this1=operand;this.operand=this1,this.loadedIndex=loadedIndex,this.eliminatable=eliminatable};$hxClasses["firedancer.assembly._Optimizer.RegContent"]=firedancer_assembly__$Optimizer_RegContent,firedancer_assembly__$Optimizer_RegContent.__name__="firedancer.assembly._Optimizer.RegContent",firedancer_assembly__$Optimizer_RegContent.createNull=function(){return new firedancer_assembly__$Optimizer_RegContent(null,-1,!1)},firedancer_assembly__$Optimizer_RegContent.prototype={getMaybeImm:function(){var operand=this.operand;return null!=operand&&1==firedancer_assembly_OperandExtension.getKind(operand)?operand:null},isEliminatable:function(currentIndex){if(!this.eliminatable)return!1;if(this.maybeRead)return!1;var loadedIndex=this.loadedIndex;return-1!=loadedIndex&&loadedIndex!=currentIndex},__class__:firedancer_assembly__$Optimizer_RegContent};var firedancer_assembly_StackElement=function(operand,pushedIndex,maybeRead){this.maybeRead=!1,this.operand=operand,this.pushedIndex=pushedIndex,null!=maybeRead&&(this.maybeRead=maybeRead)};$hxClasses["firedancer.assembly.StackElement"]=firedancer_assembly_StackElement,firedancer_assembly_StackElement.__name__="firedancer.assembly.StackElement",firedancer_assembly_StackElement.prototype={__class__:firedancer_assembly_StackElement};var firedancer_assembly_VariableElement=function(declaredIndex,lastAssignedIndex,operand){this.maybeRead=!1,this.isUsed=!1,this.declaredIndex=declaredIndex,this.lastAssignedIndex=null!=lastAssignedIndex?lastAssignedIndex:-1;var this1=operand;this.operand=this1};$hxClasses["firedancer.assembly.VariableElement"]=firedancer_assembly_VariableElement,firedancer_assembly_VariableElement.__name__="firedancer.assembly.VariableElement",firedancer_assembly_VariableElement.prototype={tryGetIntImm:function(){if(null!=this.operand){var _g=this.operand;if(1==_g._hx_index){var operand=_g.operand;return 0==operand._hx_index?operand.value:null}return null}return null},tryGetFloatImm:function(){if(null!=this.operand){var _g=this.operand;if(2==_g._hx_index){var operand=_g.operand;return 0==operand._hx_index?operand.value:null}return null}return null},__class__:firedancer_assembly_VariableElement};var firedancer_assembly_Variables=function(){this.variableStackMap=new haxe_ds_StringMap};$hxClasses["firedancer.assembly.Variables"]=firedancer_assembly_Variables,firedancer_assembly_Variables.__name__="firedancer.assembly.Variables",firedancer_assembly_Variables.prototype={let:function(varKey,declaredIndex){var stack=this.variableStackMap.h[varKey],variable=new firedancer_assembly_VariableElement(declaredIndex,null,null);if(null==stack)this.variableStackMap.h[varKey]=[variable];else stack.push(variable)},assign:function(varKey,lastAssignedIndex,operand){var stack=this.variableStackMap.h[varKey];if(null!=stack){var variable=stack[(this1=stack.length)-1];variable.lastAssignedIndex=lastAssignedIndex;var this1=operand;variable.operand=this1,variable.maybeRead=!1,variable.isUsed=!0}},free:function(varKey){var stack=this.variableStackMap.h[varKey];if(null!=stack)stack.pop()},allMayBeReadOrAssigned:function(){for(var stack=haxe_ds_StringMap.valueIterator(this.variableStackMap.h);stack.hasNext();){var v,stack1=stack.next(),this2=stack1.length-1;if(-1!=this2){v=stack1[this2]}else{v=null}if(null!=v){var variable=v;variable.maybeRead=!0,variable.lastAssignedIndex=-1;variable.operand=null}}},__class__:firedancer_assembly_Variables};var firedancer_assembly_ValueType={toString:function(this1){switch(this1){case 0:return"int";case 1:return"float";case 2:return"vec"}}},firedancer_assembly_WordEnum=$hxEnums["firedancer.assembly.WordEnum"]={__ename__:"firedancer.assembly.WordEnum",__constructs__:["OpcodeWord","IntWord","FloatWord"],OpcodeWord:($_=function(code){return{_hx_index:0,code:code,__enum__:"firedancer.assembly.WordEnum",toString:$estr}},$_.__params__=["code"],$_),IntWord:($_=function(value){return{_hx_index:1,value:value,__enum__:"firedancer.assembly.WordEnum",toString:$estr}},$_.__params__=["value"],$_),FloatWord:($_=function(value){return{_hx_index:2,value:value,__enum__:"firedancer.assembly.WordEnum",toString:$estr}},$_.__params__=["value"],$_)};firedancer_assembly_WordEnum.__empty_constructs__=[];var firedancer_assembly_types_ActorProperty=function(type,component){this.type=type,this.component=component};$hxClasses["firedancer.assembly.types.ActorProperty"]=firedancer_assembly_types_ActorProperty,firedancer_assembly_types_ActorProperty.__name__="firedancer.assembly.types.ActorProperty",firedancer_assembly_types_ActorProperty.create=function(type,component){return new firedancer_assembly_types_ActorProperty(type,component)},firedancer_assembly_types_ActorProperty.prototype={toString:function(){switch(this.type){case 0:switch(this.component){case 0:return"position";case 1:return"distance";case 2:return"bearing"}break;case 1:switch(this.component){case 0:return"velocity";case 1:return"speed";case 2:return"direction"}break;case 2:switch(this.component){case 0:return"shot_position";case 1:return"shot_distance";case 2:return"shot_bearing"}break;case 3:switch(this.component){case 0:return"shot_velocity";case 1:return"shot_speed";case 2:return"shot_direction"}}},__class__:firedancer_assembly_types_ActorProperty};var firedancer_assembly_types_ActorPropertyComponent={getValueType:function(this1){switch(this1){case 0:return 2;case 1:case 2:return 1}}},firedancer_assembly_types_ActorPropertyExtension=function(){};$hxClasses["firedancer.assembly.types.ActorPropertyExtension"]=firedancer_assembly_types_ActorPropertyExtension,firedancer_assembly_types_ActorPropertyExtension.__name__="firedancer.assembly.types.ActorPropertyExtension",firedancer_assembly_types_ActorPropertyExtension.getReadOpcode=function(_this){var code;switch(_this.type){case 0:switch(_this.component){case 0:code=0;break;case 1:code=1;break;case 2:code=2}break;case 1:switch(_this.component){case 0:code=3;break;case 1:code=4;break;case 2:code=5}break;case 2:switch(_this.component){case 0:code=6;break;case 1:code=7;break;case 2:code=8}break;case 3:switch(_this.component){case 0:code=9;break;case 1:code=10;break;case 2:code=11}}return 128|code},firedancer_assembly_types_ActorPropertyExtension.getWriteOpcode=function(_this,operationType,inputKind){var code;switch(_this.type){case 0:switch(_this.component){case 0:switch(operationType){case 0:switch(inputKind){case 1:code=0;break;case 2:code=4;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=1;break;case 2:code=5;break;case 4:code=8;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 1:switch(operationType){case 0:switch(inputKind){case 1:code=10;break;case 2:code=12;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=11;break;case 2:code=13;break;case 4:code=14;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 2:switch(operationType){case 0:switch(inputKind){case 1:code=15;break;case 2:code=17;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=16;break;case 2:code=18;break;case 4:code=19;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}}break;case 1:switch(_this.component){case 0:switch(operationType){case 0:switch(inputKind){case 1:code=2;break;case 2:code=6;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=3;break;case 2:code=7;break;case 4:code=9;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 1:switch(operationType){case 0:switch(inputKind){case 1:code=20;break;case 2:code=22;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=21;break;case 2:code=23;break;case 4:code=24;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 2:switch(operationType){case 0:switch(inputKind){case 1:code=25;break;case 2:code=27;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=26;break;case 2:code=28;break;case 4:code=29;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}}break;case 2:switch(_this.component){case 0:switch(operationType){case 0:switch(inputKind){case 1:code=30;break;case 2:code=34;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=31;break;case 2:code=35;break;case 4:code=38;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 1:switch(operationType){case 0:switch(inputKind){case 1:code=40;break;case 2:code=42;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=41;break;case 2:code=43;break;case 4:code=44;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 2:switch(operationType){case 0:switch(inputKind){case 1:code=45;break;case 2:code=47;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=46;break;case 2:code=48;break;case 4:code=49;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}}break;case 3:switch(_this.component){case 0:switch(operationType){case 0:switch(inputKind){case 1:code=32;break;case 2:code=36;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=33;break;case 2:code=37;break;case 4:code=39;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 1:switch(operationType){case 0:switch(inputKind){case 1:code=50;break;case 2:code=52;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=51;break;case 2:code=53;break;case 4:code=54;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 2:switch(operationType){case 0:switch(inputKind){case 1:code=55;break;case 2:code=57;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=56;break;case 2:code=58;break;case 4:code=59;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}}}return 192|code},firedancer_assembly_types_ActorPropertyExtension.getDiffOpcode=function(_this,inputKind){var code;switch(_this.type){case 0:switch(_this.component){case 0:switch(inputKind){case 1:code=16;break;case 2:code=18;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=20;break;case 2:code=24;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 2:switch(inputKind){case 1:code=21;break;case 2:code=25;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 1:switch(_this.component){case 0:switch(inputKind){case 1:code=17;break;case 2:code=19;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=22;break;case 2:code=26;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 2:switch(inputKind){case 1:code=23;break;case 2:code=27;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 2:switch(_this.component){case 0:switch(inputKind){case 1:code=28;break;case 2:code=30;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=32;break;case 2:code=36;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 2:switch(inputKind){case 1:code=33;break;case 2:code=37;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}break;case 3:switch(_this.component){case 0:switch(inputKind){case 1:code=29;break;case 2:code=31;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 1:switch(inputKind){case 1:code=34;break;case 2:code=38;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}break;case 2:switch(inputKind){case 1:code=35;break;case 2:code=39;break;default:throw haxe_Exception.thrown(firedancer_assembly_types_ActorPropertyExtension.unsupported())}}}return 128|code},firedancer_assembly_types_ActorPropertyExtension.unsupported=function(){return"unsupported operation."};var firedancer_assembly_types_CastOperationType={getOutputType:function(this1){switch(this1){case 0:return 1;case 1:case 2:return 2}}},firedancer_assembly_types_EventType={toString:function(this1){switch(this1){case 0:return"global";case 1:return"local"}}},firedancer_assembly_types_FireType=$hxEnums["firedancer.assembly.types.FireType"]={__ename__:"firedancer.assembly.types.FireType",__constructs__:["Simple","Complex","SimpleWithCode","ComplexWithCode"],Simple:{_hx_index:0,__enum__:"firedancer.assembly.types.FireType",toString:$estr},Complex:($_=function(fireArgument){return{_hx_index:1,fireArgument:fireArgument,__enum__:"firedancer.assembly.types.FireType",toString:$estr}},$_.__params__=["fireArgument"],$_),SimpleWithCode:($_=function(fireCode){return{_hx_index:2,fireCode:fireCode,__enum__:"firedancer.assembly.types.FireType",toString:$estr}},$_.__params__=["fireCode"],$_),ComplexWithCode:($_=function(fireArgument,fireCode){return{_hx_index:3,fireArgument:fireArgument,fireCode:fireCode,__enum__:"firedancer.assembly.types.FireType",toString:$estr}},$_.__params__=["fireArgument","fireCode"],$_)};firedancer_assembly_types_FireType.__empty_constructs__=[firedancer_assembly_types_FireType.Simple];var firedancer_assembly_types_FireTypeExtension=function(){};$hxClasses["firedancer.assembly.types.FireTypeExtension"]=firedancer_assembly_types_FireTypeExtension,firedancer_assembly_types_FireTypeExtension.__name__="firedancer.assembly.types.FireTypeExtension",firedancer_assembly_types_FireTypeExtension.toString=function(_this){switch(_this._hx_index){case 0:return"fire";case 1:var fireArgument=_this.fireArgument;return"fire "+firedancer_vm_FireArgument.toString(fireArgument);case 2:return"fire code "+(fireCode=_this.fireCode);case 3:var fireCode=_this.fireCode;fireArgument=_this.fireArgument;return"fire "+firedancer_vm_FireArgument.toString(fireArgument)+" code "+fireCode}},firedancer_assembly_types_FireTypeExtension.bytecodeLength=function(_this){switch(_this._hx_index){case 0:return 0;case 1:_this.fireArgument;return 4;case 2:_this.fireCode;return 4;case 3:_this.fireCode,_this.fireArgument;return 8}};var firedancer_assembly_types_TargetProperty={toString:function(this1){switch(this1){case 0:return"position";case 1:return"x";case 2:return"y";case 3:return"angle_from_shot_position"}},getType:function(this1){switch(this1){case 0:return 2;case 1:case 2:case 3:return 1}}},firedancer_script_api_$components_ActorPropertyApiComponent=function(property){this.property=property};$hxClasses["firedancer.script.api_components.ActorPropertyApiComponent"]=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components_ActorPropertyApiComponent.__name__="firedancer.script.api_components.ActorPropertyApiComponent",firedancer_script_api_$components_ActorPropertyApiComponent.prototype={__class__:firedancer_script_api_$components_ActorPropertyApiComponent};var firedancer_script_api_$components_Position=function(){this.cartesian=new firedancer_script_api_$components_CartesianPosition,firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(0,0))};$hxClasses["firedancer.script.api_components.Position"]=firedancer_script_api_$components_Position,firedancer_script_api_$components_Position.__name__="firedancer.script.api_components.Position",firedancer_script_api_$components_Position.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components_Position.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components_Position});var firedancer_script_api_$components_Random=function(){this.angle=new firedancer_script_api_$components_RandomAngle};$hxClasses["firedancer.script.api_components.Random"]=firedancer_script_api_$components_Random,firedancer_script_api_$components_Random.__name__="firedancer.script.api_components.Random",firedancer_script_api_$components_Random.prototype={__class__:firedancer_script_api_$components_Random};var firedancer_script_api_$components_Shot=function(){this.angleToTarget=new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Inst(firedancer_assembly_Instruction.GetTarget(3)))),this.direction=new firedancer_script_api_$components__$ShotVelocity_ShotDirectionImpl,this.speed=new firedancer_script_api_$components__$ShotVelocity_ShotSpeedImpl,this.velocity=new firedancer_script_api_$components_ShotVelocity,this.bearing=new firedancer_script_api_$components__$ShotPosition_ShotBearingImpl,this.distance=new firedancer_script_api_$components__$ShotPosition_ShotDistanceImpl,this.position=new firedancer_script_api_$components_ShotPosition};$hxClasses["firedancer.script.api_components.Shot"]=firedancer_script_api_$components_Shot,firedancer_script_api_$components_Shot.__name__="firedancer.script.api_components.Shot",firedancer_script_api_$components_Shot.prototype={__class__:firedancer_script_api_$components_Shot};var firedancer_script_api_$components_Velocity=function(){this.cartesian=new firedancer_script_api_$components_CartesianVelocity,firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(1,0))};$hxClasses["firedancer.script.api_components.Velocity"]=firedancer_script_api_$components_Velocity,firedancer_script_api_$components_Velocity.__name__="firedancer.script.api_components.Velocity",firedancer_script_api_$components_Velocity.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components_Velocity.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components_Velocity});var firedancer_script_Api=function(){};$hxClasses["firedancer.script.Api"]=firedancer_script_Api,firedancer_script_Api.__name__="firedancer.script.Api",firedancer_script_Api.wait=function(frames){return new firedancer_script_nodes_Wait(frames)},firedancer_script_Api.loop=function(ast){return new firedancer_script_nodes_Loop(ast)},firedancer_script_Api.rep=function(count,ast){return new firedancer_script_nodes_Repeat(ast,count)},firedancer_script_Api.dup=function(ast,params){return new firedancer_script_nodes_Duplicate(ast,params)},firedancer_script_Api.fire=function(ast){return new firedancer_script_nodes_Fire(ast)},firedancer_script_Api.aim=function(){return new firedancer_script_nodes_Aim},firedancer_script_Api.parallel=function(asts){return new firedancer_script_nodes_Parallel(asts)},firedancer_script_Api.end=function(endCode){return new firedancer_script_nodes_End(endCode)},firedancer_script_Api.vanish=function(){return firedancer_script_Api.end(-1)},firedancer_script_Api.intVar=function(name){return name},firedancer_script_Api.floatVar=function(name){return name},firedancer_script_Api.angleVar=function(name){return name},firedancer_script_Api.sin=function(angle){return angle.sin()},firedancer_script_Api.cos=function(angle){return angle.cos()},firedancer_script_Api.compileToAssembly=function(namedAstMap,optimize){null==optimize&&(optimize=!0);for(var compileContext=new firedancer_script_CompileContext,_g=haxe_ds_StringMap.kvIterator(namedAstMap.h);_g.hasNext();){var _g1=_g.next(),name=_g1.key,assemblyCode=_g1.value.toAssembly(compileContext);compileContext.setNamedCode(assemblyCode,name)}var pkg=compileContext.createPackage();return optimize&&(pkg=pkg.optimize()),pkg};var firedancer_script_ApiEx=function(){};$hxClasses["firedancer.script.ApiEx"]=firedancer_script_ApiEx,firedancer_script_ApiEx.__name__="firedancer.script.ApiEx",firedancer_script_ApiEx.radial=function(ast,params){var loopCount=firedancer_script_Api.intVar("__loopCnt"),shotDirectionChangeRate=firedancer_script_Api.angleVar("__sDirChgRt"),nodes=firedancer_script_expression_IntLocalVariableExpression.let(loopCount,params.ways),nodes1=firedancer_script_expression_AngleLocalVariableExpression.let(shotDirectionChangeRate,new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(360)).divide(firedancer_script_expression_IntLocalVariableExpression.toIntExpression(loopCount)).toAngleExpression()),nodes2=firedancer_script_expression_IntLocalVariableExpression.toIntExpression(loopCount);firedancer_script_Api.shot.direction;return new firedancer_script_nodes_List([nodes,nodes1,firedancer_script_Api.rep(nodes2,new firedancer_script_nodes_List([ast,new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(shotDirectionChangeRate)))]))])},firedancer_script_ApiEx.nWay=function(ast,params){return firedancer_script_Api.dup(ast,{count:params.ways,shotDirectionRange:{start:params.angle.unaryMinus().divide(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(2,1)))),end:params.angle.divide(new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(2,1))))}})},firedancer_script_ApiEx.line=function(ast,params){return firedancer_script_Api.dup(ast,{count:params.count,shotSpeedChange:params.shotSpeedChange})};var firedancer_script_AstNode=function(){this.nodeType=firedancer_script_AstNodeType.Other};$hxClasses["firedancer.script.AstNode"]=firedancer_script_AstNode,firedancer_script_AstNode.__name__="firedancer.script.AstNode",firedancer_script_AstNode.prototype={containsWait:function(){throw haxe_Exception.thrown(new sneaker_exception_NotOverriddenException(null,{fileName:"firedancer/script/AstNode.hx",lineNumber:28,className:"firedancer.script.AstNode",methodName:"containsWait"}))},toAssembly:function(context){throw haxe_Exception.thrown(new sneaker_exception_NotOverriddenException(null,{fileName:"firedancer/script/AstNode.hx",lineNumber:34,className:"firedancer.script.AstNode",methodName:"toAssembly"}))},__class__:firedancer_script_AstNode};var firedancer_script_AstNodeType=$hxEnums["firedancer.script.AstNodeType"]={__ename__:"firedancer.script.AstNodeType",__constructs__:["EachFrame","Other"],EachFrame:($_=function(astToBeInjected){return{_hx_index:0,astToBeInjected:astToBeInjected,__enum__:"firedancer.script.AstNodeType",toString:$estr}},$_.__params__=["astToBeInjected"],$_),Other:{_hx_index:1,__enum__:"firedancer.script.AstNodeType",toString:$estr}};firedancer_script_AstNodeType.__empty_constructs__=[firedancer_script_AstNodeType.Other];var firedancer_script_CompileContext=function(){this.injectionStack=[],this.nameIndexMap=new haxe_ds_StringMap,this.codeList=[],this.nextLabelIdStack=[0],this.localVariables=new firedancer_script_LocalVariableTable(this)};$hxClasses["firedancer.script.CompileContext"]=firedancer_script_CompileContext,firedancer_script_CompileContext.__name__="firedancer.script.CompileContext",firedancer_script_CompileContext.prototype={setCode:function(code){var codeList=this.codeList;if(codeList.indexOf(code,0)>=0)return codeList.indexOf(code,0);var id=codeList.length;codeList.push(code);return id},setNamedCode:function(code,name){var index=this.setCode(code);return this.nameIndexMap.h[name]=index,index},createPackage:function(){return new firedancer_assembly_AssemblyCodePackage(this.codeList,this.nameIndexMap)},__class__:firedancer_script_CompileContext};var firedancer_script_LocalVariableTable=function(context){this.variableStack=[],this.variableCountStack=[],this.context=context};$hxClasses["firedancer.script.LocalVariableTable"]=firedancer_script_LocalVariableTable,firedancer_script_LocalVariableTable.__name__="firedancer.script.LocalVariableTable",firedancer_script_LocalVariableTable.prototype={startScope:function(){var this1=this.variableStack.length;this.variableCountStack.push(this1)},endScope:function(){var maybeTargetSize=this.variableCountStack.pop();if(null==maybeTargetSize)throw haxe_Exception.thrown("Called endScope() before startScope().");for(var targetSize=maybeTargetSize,freeInstructions=[],variableStack=this.variableStack;;){if(!(targetSize<variableStack.length))break;var variable=variableStack.pop();freeInstructions.push(firedancer_assembly_Instruction.Free(variable.name,variable.type))}return freeInstructions},push:function(name,type){this.variableStack.push(new firedancer_script_LocalVariable(name,type,this.context))},get:function(name){for(var variableStack=this.variableStack,i=variableStack.length-1;i>=0;){var variable=variableStack[i];if(variable.name==name)return variable;--i}throw haxe_Exception.thrown("Unknown local variable: "+name)},__class__:firedancer_script_LocalVariableTable};var firedancer_script_LocalVariable=function(name,type,context){this.name=name,this.type=type,this.context=context};$hxClasses["firedancer.script.LocalVariable"]=firedancer_script_LocalVariable,firedancer_script_LocalVariable.__name__="firedancer.script.LocalVariable",firedancer_script_LocalVariable.prototype={loadToVolatile:function(){switch(this.type){case 0:return[firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Var(this.name)))];case 1:return[firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Var(this.name)))];case 2:throw haxe_Exception.thrown("Local variable of vector type is not supported.")}},setValue:function(value){var store;switch(this.type){case 0:store=firedancer_assembly_Instruction.Store(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg),this.name);break;case 1:store=firedancer_assembly_Instruction.Store(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),this.name);break;case 2:throw haxe_Exception.thrown("Local variable of vector type is not supported.")}for(var arrays=[firedancer_script_expression_GenericExpression.loadToVolatile(value,this.context),[store]],arrayCount=this1=arrays.length,elementCount=0,_g=0,_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}var this1=elementCount,newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1},addValue:function(value){var store;switch(this.type){case 0:store=firedancer_assembly_Instruction.Add(firedancer_assembly_OperandPair.Int(firedancer_assembly_IntOperand.Var(this.name),firedancer_assembly_IntOperand.Reg));break;case 1:store=firedancer_assembly_Instruction.Add(firedancer_assembly_OperandPair.Float(firedancer_assembly_FloatOperand.Var(this.name),firedancer_assembly_FloatOperand.Reg));break;case 2:throw haxe_Exception.thrown("Local variable of vector type is not supported.")}for(var arrays=[firedancer_script_expression_GenericExpression.loadToVolatile(value,this.context),[store]],arrayCount=this1=arrays.length,elementCount=0,_g=0,_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}var this1=elementCount,newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1},increment:function(){if(0!=this.type)throw haxe_Exception.thrown("Cannot increment local variable that is not an integer.");return[firedancer_assembly_Instruction.Increment(this.name)]},decrement:function(){if(0!=this.type)throw haxe_Exception.thrown("Cannot decrement local variable that is not an integer.");return[firedancer_assembly_Instruction.Decrement(this.name)]},__class__:firedancer_script_LocalVariable};var firedancer_script_api_$components_CartesianPosition=function(){};$hxClasses["firedancer.script.api_components.CartesianPosition"]=firedancer_script_api_$components_CartesianPosition,firedancer_script_api_$components_CartesianPosition.__name__="firedancer.script.api_components.CartesianPosition",firedancer_script_api_$components_CartesianPosition.prototype={__class__:firedancer_script_api_$components_CartesianPosition};var firedancer_script_api_$components_RandomAngle=function(){};$hxClasses["firedancer.script.api_components.RandomAngle"]=firedancer_script_api_$components_RandomAngle,firedancer_script_api_$components_RandomAngle.__name__="firedancer.script.api_components.RandomAngle",firedancer_script_api_$components_RandomAngle.prototype={__class__:firedancer_script_api_$components_RandomAngle};var firedancer_script_api_$components_ShotPosition=function(){firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(2,0))};$hxClasses["firedancer.script.api_components.ShotPosition"]=firedancer_script_api_$components_ShotPosition,firedancer_script_api_$components_ShotPosition.__name__="firedancer.script.api_components.ShotPosition",firedancer_script_api_$components_ShotPosition.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components_ShotPosition.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components_ShotPosition});var firedancer_script_api_$components_ShotDistance={toExpression:function(this1){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Inst(firedancer_assembly_Instruction.Get(this1.property))))}},firedancer_script_api_$components__$ShotPosition_ShotDistanceImpl=function(){firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(2,1))};$hxClasses["firedancer.script.api_components._ShotPosition.ShotDistanceImpl"]=firedancer_script_api_$components__$ShotPosition_ShotDistanceImpl,firedancer_script_api_$components__$ShotPosition_ShotDistanceImpl.__name__="firedancer.script.api_components._ShotPosition.ShotDistanceImpl",firedancer_script_api_$components__$ShotPosition_ShotDistanceImpl.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components__$ShotPosition_ShotDistanceImpl.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components__$ShotPosition_ShotDistanceImpl});var firedancer_script_api_$components_ShotBearing={toExpression:function(this1){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Inst(firedancer_assembly_Instruction.Get(this1.property))))}},firedancer_script_api_$components__$ShotPosition_ShotBearingImpl=function(){firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(2,2))};$hxClasses["firedancer.script.api_components._ShotPosition.ShotBearingImpl"]=firedancer_script_api_$components__$ShotPosition_ShotBearingImpl,firedancer_script_api_$components__$ShotPosition_ShotBearingImpl.__name__="firedancer.script.api_components._ShotPosition.ShotBearingImpl",firedancer_script_api_$components__$ShotPosition_ShotBearingImpl.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components__$ShotPosition_ShotBearingImpl.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components__$ShotPosition_ShotBearingImpl});var firedancer_script_api_$components_ShotVelocity=function(){firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(3,0))};$hxClasses["firedancer.script.api_components.ShotVelocity"]=firedancer_script_api_$components_ShotVelocity,firedancer_script_api_$components_ShotVelocity.__name__="firedancer.script.api_components.ShotVelocity",firedancer_script_api_$components_ShotVelocity.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components_ShotVelocity.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components_ShotVelocity});var firedancer_script_api_$components_ShotSpeed={toExpression:function(this1){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Inst(firedancer_assembly_Instruction.Get(this1.property))))}},firedancer_script_api_$components__$ShotVelocity_ShotSpeedImpl=function(){firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(3,1))};$hxClasses["firedancer.script.api_components._ShotVelocity.ShotSpeedImpl"]=firedancer_script_api_$components__$ShotVelocity_ShotSpeedImpl,firedancer_script_api_$components__$ShotVelocity_ShotSpeedImpl.__name__="firedancer.script.api_components._ShotVelocity.ShotSpeedImpl",firedancer_script_api_$components__$ShotVelocity_ShotSpeedImpl.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components__$ShotVelocity_ShotSpeedImpl.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components__$ShotVelocity_ShotSpeedImpl});var firedancer_script_api_$components_ShotDirection={toExpression:function(this1){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Inst(firedancer_assembly_Instruction.Get(this1.property))))}},firedancer_script_api_$components__$ShotVelocity_ShotDirectionImpl=function(){firedancer_script_api_$components_ActorPropertyApiComponent.call(this,new firedancer_assembly_types_ActorProperty(3,2))};$hxClasses["firedancer.script.api_components._ShotVelocity.ShotDirectionImpl"]=firedancer_script_api_$components__$ShotVelocity_ShotDirectionImpl,firedancer_script_api_$components__$ShotVelocity_ShotDirectionImpl.__name__="firedancer.script.api_components._ShotVelocity.ShotDirectionImpl",firedancer_script_api_$components__$ShotVelocity_ShotDirectionImpl.__super__=firedancer_script_api_$components_ActorPropertyApiComponent,firedancer_script_api_$components__$ShotVelocity_ShotDirectionImpl.prototype=$extend(firedancer_script_api_$components_ActorPropertyApiComponent.prototype,{__class__:firedancer_script_api_$components__$ShotVelocity_ShotDirectionImpl});var firedancer_script_api_$components_CartesianVelocity=function(){};$hxClasses["firedancer.script.api_components.CartesianVelocity"]=firedancer_script_api_$components_CartesianVelocity,firedancer_script_api_$components_CartesianVelocity.__name__="firedancer.script.api_components.CartesianVelocity",firedancer_script_api_$components_CartesianVelocity.prototype={__class__:firedancer_script_api_$components_CartesianVelocity};var firedancer_script_expression_AngleLocalVariableExpression={toAngleExpression:function(this1){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Custom((function(context){var variable=context.localVariables.get(this1),code=variable.loadToVolatile();switch(variable.type){case 0:code.push(firedancer_assembly_Instruction.Cast(0)),code.push(firedancer_assembly_Instruction.Mult(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.RegBuf),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(.017453292519943295))));break;case 1:break;case 2:throw haxe_Exception.thrown("Cannot cast vector to float.")}return code}))))},let:function(this1,initialValue){return firedancer_script_nodes_DeclareLocalVariable.fromAngle(this1,initialValue)},add:function(this1,value){return new firedancer_script_nodes_OperateLocalVariable(this1,1,firedancer_script_expression__$GenericExpression_Data.AngleExpr(value))}},firedancer_script_expression_ExpressionData=function(){};$hxClasses["firedancer.script.expression.ExpressionData"]=firedancer_script_expression_ExpressionData,firedancer_script_expression_ExpressionData.__name__="firedancer.script.expression.ExpressionData",firedancer_script_expression_ExpressionData.__isInterface__=!0;var firedancer_script_expression_FloatLikeExpressionEnum=$hxEnums["firedancer.script.expression.FloatLikeExpressionEnum"]={__ename__:"firedancer.script.expression.FloatLikeExpressionEnum",__constructs__:["Constant","Runtime"],Constant:($_=function(value){return{_hx_index:0,value:value,__enum__:"firedancer.script.expression.FloatLikeExpressionEnum",toString:$estr}},$_.__params__=["value"],$_),Runtime:($_=function(expression){return{_hx_index:1,expression:expression,__enum__:"firedancer.script.expression.FloatLikeExpressionEnum",toString:$estr}},$_.__params__=["expression"],$_)};firedancer_script_expression_FloatLikeExpressionEnum.__empty_constructs__=[];var firedancer_script_expression_FloatLikeExpressionData=function(data){this.data=data};$hxClasses["firedancer.script.expression.FloatLikeExpressionData"]=firedancer_script_expression_FloatLikeExpressionData,firedancer_script_expression_FloatLikeExpressionData.__name__="firedancer.script.expression.FloatLikeExpressionData",firedancer_script_expression_FloatLikeExpressionData.__interfaces__=[firedancer_script_expression_ExpressionData],firedancer_script_expression_FloatLikeExpressionData.prototype={loadToVolatile:function(context){var _g=this.data;switch(_g._hx_index){case 0:var value=_g.value;return[firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(value.toImmediateValue())))];case 1:var expression=_g.expression;return firedancer_script_expression_subtypes_FloatLikeRuntimeExpression.loadToVolatile(expression,context)}},use:function(context,instruction){for(var arrays=[this.loadToVolatile(context),[instruction]],arrayCount=this1=arrays.length,elementCount=0,_g=0,_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}var this1=elementCount,newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1},unaryOperation:function(instruction){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.UnaryOperation(instruction,this)))},binaryOperation:function(instruction,other){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.BinaryOperation(instruction,this,other)))},unaryMinus:function(){return this.unaryOperation(firedancer_assembly_Instruction.Minus(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)))},cos:function(){return this.unaryOperation(firedancer_assembly_Instruction.Cos)},sin:function(){return this.unaryOperation(firedancer_assembly_Instruction.Sin)},add:function(other){return this.binaryOperation(firedancer_assembly_Instruction.Add(firedancer_assembly_OperandPair.Float(firedancer_assembly_FloatOperand.RegBuf,firedancer_assembly_FloatOperand.Reg)),other)},subtract:function(other){return this.binaryOperation(firedancer_assembly_Instruction.Sub(firedancer_assembly_OperandPair.Float(firedancer_assembly_FloatOperand.RegBuf,firedancer_assembly_FloatOperand.Reg)),other)},multiply:function(other){return this.binaryOperation(firedancer_assembly_Instruction.Mult(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.RegBuf),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),other)},divide:function(other){return this.binaryOperation(firedancer_assembly_Instruction.Div(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.RegBuf),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),other)},__class__:firedancer_script_expression_FloatLikeExpressionData};var firedancer_script_expression_FloatLocalVariableExpression={toFloatExpression:function(this1){return new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Custom((function(context){var variable=context.localVariables.get(this1),code=variable.loadToVolatile();switch(variable.type){case 0:code.push(firedancer_assembly_Instruction.Cast(0));break;case 1:break;case 2:throw haxe_Exception.thrown("Cannot cast vector to float.")}return code}))))},let:function(this1,initialValue){return firedancer_script_nodes_DeclareLocalVariable.fromFloat(this1,initialValue)}},firedancer_script_expression_GenericExpression={loadToVolatile:function(this1,context){switch(this1._hx_index){case 0:case 1:case 2:case 3:return this1.expr.loadToVolatile(context)}}},firedancer_script_expression__$GenericExpression_Data=$hxEnums["firedancer.script.expression._GenericExpression.Data"]={__ename__:"firedancer.script.expression._GenericExpression.Data",__constructs__:["IntExpr","FloatExpr","AngleExpr","VecExpr"],IntExpr:($_=function(expr){return{_hx_index:0,expr:expr,__enum__:"firedancer.script.expression._GenericExpression.Data",toString:$estr}},$_.__params__=["expr"],$_),FloatExpr:($_=function(expr){return{_hx_index:1,expr:expr,__enum__:"firedancer.script.expression._GenericExpression.Data",toString:$estr}},$_.__params__=["expr"],$_),AngleExpr:($_=function(expr){return{_hx_index:2,expr:expr,__enum__:"firedancer.script.expression._GenericExpression.Data",toString:$estr}},$_.__params__=["expr"],$_),VecExpr:($_=function(expr){return{_hx_index:3,expr:expr,__enum__:"firedancer.script.expression._GenericExpression.Data",toString:$estr}},$_.__params__=["expr"],$_)};firedancer_script_expression__$GenericExpression_Data.__empty_constructs__=[];var firedancer_script_expression_IntLikeExpressionEnum=$hxEnums["firedancer.script.expression.IntLikeExpressionEnum"]={__ename__:"firedancer.script.expression.IntLikeExpressionEnum",__constructs__:["Constant","Runtime"],Constant:($_=function(value){return{_hx_index:0,value:value,__enum__:"firedancer.script.expression.IntLikeExpressionEnum",toString:$estr}},$_.__params__=["value"],$_),Runtime:($_=function(expression){return{_hx_index:1,expression:expression,__enum__:"firedancer.script.expression.IntLikeExpressionEnum",toString:$estr}},$_.__params__=["expression"],$_)};firedancer_script_expression_IntLikeExpressionEnum.__empty_constructs__=[];var firedancer_script_expression_IntLikeExpressionData=function(data){this.data=data};$hxClasses["firedancer.script.expression.IntLikeExpressionData"]=firedancer_script_expression_IntLikeExpressionData,firedancer_script_expression_IntLikeExpressionData.__name__="firedancer.script.expression.IntLikeExpressionData",firedancer_script_expression_IntLikeExpressionData.__interfaces__=[firedancer_script_expression_ExpressionData],firedancer_script_expression_IntLikeExpressionData.prototype={toFloatExpression:function(){return this.toFloatLikeExpressionData(1)},toAngleExpression:function(){return this.toFloatLikeExpressionData(.017453292519943295)},loadToVolatile:function(context){var _g=this.data;switch(_g._hx_index){case 0:var value=_g.value;return[firedancer_assembly_Instruction.Load(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(value)))];case 1:var expression=_g.expression;return firedancer_script_expression_subtypes_IntLikeRuntimeExpression.loadToVolatile(expression,context)}},tryGetConstant:function(){var _g=this.data;switch(_g._hx_index){case 0:return _g.value;case 1:_g.expression;return null}},binaryOperation:function(instruction,other){return new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.BinaryOperation(instruction,this,other)))},subtract:function(other){return this.binaryOperation(firedancer_assembly_Instruction.Sub(firedancer_assembly_OperandPair.Int(firedancer_assembly_IntOperand.RegBuf,firedancer_assembly_IntOperand.Reg)),other)},multiply:function(other){return this.binaryOperation(firedancer_assembly_Instruction.Mult(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.RegBuf),firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg)),other)},divide:function(other){return this.binaryOperation(firedancer_assembly_Instruction.Div(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.RegBuf),firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg)),other)},toFloatLikeExpressionData:function(constantFactor){var _gthis=this,data=firedancer_script_expression_FloatLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Custom((function(context){for(var arrays=[_gthis.loadToVolatile(context),[firedancer_assembly_Instruction.Cast(0)],1==constantFactor?[]:[firedancer_assembly_Instruction.Mult(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Imm(constantFactor)))]],arrayCount=this1=arrays.length,elementCount=0,_g=0,_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}var this1=elementCount,newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1})));return new firedancer_script_expression_FloatLikeExpressionData(data)},__class__:firedancer_script_expression_IntLikeExpressionData};var firedancer_script_expression_IntLocalVariableExpression={toIntExpression:function(this1){return new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Runtime(firedancer_script_expression_subtypes_RuntimeExpressionEnum.Custom((function(context){var variable=context.localVariables.get(this1),code=variable.loadToVolatile();switch(variable.type){case 0:break;case 1:throw haxe_Exception.thrown("Cannot cast float to int.");case 2:throw haxe_Exception.thrown("Cannot cast vector to int.")}return code}))))},let:function(this1,initialValue){return firedancer_script_nodes_DeclareLocalVariable.fromInt(this1,initialValue)},increment:function(this1){return new firedancer_script_nodes_OperateLocalVariable(this1,2,null)},get:function(this1){return firedancer_script_expression_IntLocalVariableExpression.toIntExpression(this1)}},firedancer_script_expression_Transformation=function(a,b,c,d,e,f){this.a=a,this.b=b,this.c=c,this.d=d,this.e=e,this.f=f};$hxClasses["firedancer.script.expression.Transformation"]=firedancer_script_expression_Transformation,firedancer_script_expression_Transformation.__name__="firedancer.script.expression.Transformation",firedancer_script_expression_Transformation.multiply=function(mat1,mat2){return new firedancer_script_expression_Transformation(mat1.a.multiply(mat2.a).add(mat1.c.multiply(mat2.b)),mat1.b.multiply(mat2.a).add(mat1.d.multiply(mat2.b)),mat1.a.multiply(mat2.c).add(mat1.c.multiply(mat2.d)),mat1.b.multiply(mat2.c).add(mat1.d.multiply(mat2.d)),mat1.a.multiply(mat2.e).add(mat1.c.multiply(mat2.f)).add(mat1.e),mat1.b.multiply(mat2.e).add(mat1.d.multiply(mat2.f)).add(mat1.f))},firedancer_script_expression_Transformation.apply=function(mat,vec){var x=vec.x,y=vec.y;return{x:mat.a.multiply(x).add(mat.c.multiply(y)).add(mat.e),y:mat.b.multiply(x).add(mat.d.multiply(y)).add(mat.f)}},firedancer_script_expression_Transformation.createRotate=function(angle){return new firedancer_script_expression_Transformation(angle.cos(),angle.sin(),angle.sin().unaryMinus(),angle.cos(),new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))),new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))))},firedancer_script_expression_Transformation.createScale=function(x,y){return null==y&&(y=x),new firedancer_script_expression_Transformation(x,new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))),new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))),y,new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))),new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1))))},firedancer_script_expression_Transformation.prototype={__class__:firedancer_script_expression_Transformation};var firedancer_script_expression_VecExpression={fromCartesianExpressions:function(args){return new firedancer_script_expression_CartesianVecExpressionData(args.x,args.y)},fromPolarExpressionss:function(args){return new firedancer_script_expression_PolarVecExpressionData(args.length,args.angle)}},firedancer_script_expression_VecExpressionData=function(divisor){this.divisor=null;var this1=divisor;this.divisor=this1};$hxClasses["firedancer.script.expression.VecExpressionData"]=firedancer_script_expression_VecExpressionData,firedancer_script_expression_VecExpressionData.__name__="firedancer.script.expression.VecExpressionData",firedancer_script_expression_VecExpressionData.__interfaces__=[firedancer_script_expression_ExpressionData],firedancer_script_expression_VecExpressionData.prototype={transform:function(matrix){throw haxe_Exception.thrown(new sneaker_exception_NotOverriddenException(null,{fileName:"firedancer/script/expression/VecExpressionData.hx",lineNumber:25,className:"firedancer.script.expression.VecExpressionData",methodName:"transform"}))},loadToVolatile:function(context){throw haxe_Exception.thrown(new sneaker_exception_NotOverriddenException(null,{fileName:"firedancer/script/expression/VecExpressionData.hx",lineNumber:31,className:"firedancer.script.expression.VecExpressionData",methodName:"loadToVolatile"}))},use:function(context,instruction){var code=this.loadToVolatile(context);code.push(instruction);return code},__class__:firedancer_script_expression_VecExpressionData};var firedancer_script_expression_CartesianVecExpressionData=function(x,y,divisor,transformation){this.transformation=null,firedancer_script_expression_VecExpressionData.call(this,divisor),this.x=x,this.y=y;var this1=transformation;this.transformation=this1};$hxClasses["firedancer.script.expression.CartesianVecExpressionData"]=firedancer_script_expression_CartesianVecExpressionData,firedancer_script_expression_CartesianVecExpressionData.__name__="firedancer.script.expression.CartesianVecExpressionData",firedancer_script_expression_CartesianVecExpressionData.__super__=firedancer_script_expression_VecExpressionData,firedancer_script_expression_CartesianVecExpressionData.prototype=$extend(firedancer_script_expression_VecExpressionData.prototype,{transform:function(matrix){return new firedancer_script_expression_CartesianVecExpressionData(this.x,this.y,this.divisor,null!=this.transformation?firedancer_script_expression_Transformation.multiply(this.transformation,matrix):matrix)},loadToVolatile:function(context){var x=this.x,y=this.y;if(null!=this.transformation){var newVec=firedancer_script_expression_Transformation.apply(this.transformation,{x:x,y:y});x=newVec.x,y=newVec.y}for(var divisor=this.divisor,elementCount=0,_g=0,_g1=arrayCount=(arrays=[y.loadToVolatile(context),[firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))],x.loadToVolatile(context),[firedancer_assembly_Instruction.Save(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),firedancer_assembly_Instruction.Pop(1),firedancer_assembly_Instruction.Cast(1)]]).length;_g<_g1;){elementCount+=arrays[i=_g++].length}(newArray=[]).length=elementCount;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var _g2=0,_g3=(array=arrays[_g++]).length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}var newArray;if(null==divisor)return newArray1;var arrays,arrayCount;for(elementCount=0,_g=0,_g1=arrayCount=(arrays=[newArray1,divisor.loadToVolatile(context),[firedancer_assembly_Instruction.Div(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))]]).length;_g<_g1;){elementCount+=arrays[i=_g++].length}(newArray=[]).length=elementCount;for(newArray1=newArray,i=0,_g=0,_g1=arrayCount;_g<_g1;){var array;for(_g2=0,_g3=(array=arrays[_g++]).length;_g2<_g3;){this4=_g2++;newArray1[i]=array[this4],++i}}return newArray1},__class__:firedancer_script_expression_CartesianVecExpressionData});var firedancer_script_expression_PolarVecExpressionData=function(length,angle,divisor){firedancer_script_expression_VecExpressionData.call(this,divisor),this.length=length,this.angle=angle};$hxClasses["firedancer.script.expression.PolarVecExpressionData"]=firedancer_script_expression_PolarVecExpressionData,firedancer_script_expression_PolarVecExpressionData.__name__="firedancer.script.expression.PolarVecExpressionData",firedancer_script_expression_PolarVecExpressionData.__super__=firedancer_script_expression_VecExpressionData,firedancer_script_expression_PolarVecExpressionData.prototype=$extend(firedancer_script_expression_VecExpressionData.prototype,{transform:function(matrix){return new firedancer_script_expression_CartesianVecExpressionData(this.length.multiply(this.angle.cos()),this.length.multiply(this.angle.sin()),this.divisor,matrix)},loadToVolatile:function(context){for(var length=this.length,elementCount=0,_g=0,_g1=arrayCount=(arrays=[this.angle.loadToVolatile(context),[firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))],length.loadToVolatile(context),[firedancer_assembly_Instruction.Save(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),firedancer_assembly_Instruction.Pop(1),firedancer_assembly_Instruction.Cast(2)]]).length;_g<_g1;){elementCount+=arrays[i=_g++].length}(newArray=[]).length=elementCount;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var _g2=0,_g3=(array=arrays[_g++]).length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}var newArray,loadVecWithoutDivisor=newArray1;if(null==this.divisor)return loadVecWithoutDivisor;var arrays,arrayCount;for(elementCount=0,_g=0,_g1=arrayCount=(arrays=[loadVecWithoutDivisor,this.divisor.loadToVolatile(context),[firedancer_assembly_Instruction.Div(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))]]).length;_g<_g1;){elementCount+=arrays[i=_g++].length}(newArray=[]).length=elementCount;for(newArray1=newArray,i=0,_g=0,_g1=arrayCount;_g<_g1;){var array;for(_g2=0,_g3=(array=arrays[_g++]).length;_g2<_g3;){this4=_g2++;newArray1[i]=array[this4],++i}}return newArray1},__class__:firedancer_script_expression_PolarVecExpressionData});var firedancer_script_expression_subtypes_FloatLikeConstantData=function(value,factor){this.value=value,this.factor=factor};$hxClasses["firedancer.script.expression.subtypes.FloatLikeConstantData"]=firedancer_script_expression_subtypes_FloatLikeConstantData,firedancer_script_expression_subtypes_FloatLikeConstantData.__name__="firedancer.script.expression.subtypes.FloatLikeConstantData",firedancer_script_expression_subtypes_FloatLikeConstantData.prototype={toImmediateValue:function(){return this.factor*this.value},__class__:firedancer_script_expression_subtypes_FloatLikeConstantData};var firedancer_script_expression_subtypes_FloatLikeRuntimeExpression={loadToVolatile:function(this1,context){switch(this1._hx_index){case 0:return[this1.loadV];case 1:var operandExpr=this1.operand,instruction=this1.instruction,this2=(code=operandExpr.loadToVolatile(context)).push(instruction);return code;case 2:var operandExprB=this1.operandB,operandExprA=this1.operandA,code=(instruction=this1.instruction,[]),other=operandExprB.loadToVolatile(context),readIndex=0;this2=(writeIndex=this2=code.length)+(otherLength=this2=other.length);for(code.length=this2;readIndex<otherLength;){this2=readIndex;code[writeIndex]=other[this2],++writeIndex,++readIndex}var writeIndex,otherLength;this2=code.push(firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))),other=operandExprA.loadToVolatile(context),readIndex=0,this2=(writeIndex=this2=code.length)+(otherLength=this2=other.length);for(code.length=this2;readIndex<otherLength;){this2=readIndex;code[writeIndex]=other[this2],++writeIndex,++readIndex}this2=code.push(firedancer_assembly_Instruction.Save(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))),this2=code.push(firedancer_assembly_Instruction.Pop(1)),this2=code.push(instruction);return code;case 3:return(0,this1.loadToVolatile)(context)}}},firedancer_script_expression_subtypes_IntLikeRuntimeExpression={loadToVolatile:function(this1,context){switch(this1._hx_index){case 0:return[this1.loadV];case 1:var operandExpr=this1.operand,instruction=this1.instruction,this2=(code=operandExpr.loadToVolatile(context)).push(instruction);return code;case 2:var operandExprB=this1.operandB,operandExprA=this1.operandA,code=(instruction=this1.instruction,[]),other=operandExprB.loadToVolatile(context),readIndex=0;this2=(writeIndex=this2=code.length)+(otherLength=this2=other.length);for(code.length=this2;readIndex<otherLength;){this2=readIndex;code[writeIndex]=other[this2],++writeIndex,++readIndex}var writeIndex,otherLength;this2=code.push(firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg))),other=operandExprA.loadToVolatile(context),readIndex=0,this2=(writeIndex=this2=code.length)+(otherLength=this2=other.length);for(code.length=this2;readIndex<otherLength;){this2=readIndex;code[writeIndex]=other[this2],++writeIndex,++readIndex}this2=code.push(firedancer_assembly_Instruction.Save(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg))),this2=code.push(firedancer_assembly_Instruction.Pop(0)),this2=code.push(instruction);return code;case 3:return(0,this1.loadToVolatile)(context)}}},firedancer_script_expression_subtypes_RuntimeExpressionEnum=$hxEnums["firedancer.script.expression.subtypes.RuntimeExpressionEnum"]={__ename__:"firedancer.script.expression.subtypes.RuntimeExpressionEnum",__constructs__:["Inst","UnaryOperation","BinaryOperation","Custom"],Inst:($_=function(loadV){return{_hx_index:0,loadV:loadV,__enum__:"firedancer.script.expression.subtypes.RuntimeExpressionEnum",toString:$estr}},$_.__params__=["loadV"],$_),UnaryOperation:($_=function(instruction,operand){return{_hx_index:1,instruction:instruction,operand:operand,__enum__:"firedancer.script.expression.subtypes.RuntimeExpressionEnum",toString:$estr}},$_.__params__=["instruction","operand"],$_),BinaryOperation:($_=function(instruction,operandA,operandB){return{_hx_index:2,instruction:instruction,operandA:operandA,operandB:operandB,__enum__:"firedancer.script.expression.subtypes.RuntimeExpressionEnum",toString:$estr}},$_.__params__=["instruction","operandA","operandB"],$_),Custom:($_=function(loadToVolatile){return{_hx_index:3,loadToVolatile:loadToVolatile,__enum__:"firedancer.script.expression.subtypes.RuntimeExpressionEnum",toString:$estr}},$_.__params__=["loadToVolatile"],$_)};firedancer_script_expression_subtypes_RuntimeExpressionEnum.__empty_constructs__=[];var firedancer_script_nodes_AddActorProperty=function(propType,operation){firedancer_script_AstNode.call(this),this.propType=propType,this.operation=operation};$hxClasses["firedancer.script.nodes.AddActorProperty"]=firedancer_script_nodes_AddActorProperty,firedancer_script_nodes_AddActorProperty.__name__="firedancer.script.nodes.AddActorProperty",firedancer_script_nodes_AddActorProperty.__interfaces__=[ripper_Data],firedancer_script_nodes_AddActorProperty.__super__=firedancer_script_AstNode,firedancer_script_nodes_AddActorProperty.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!1},toAssembly:function(context){var c=context;switch(this.propType){case 0:switch((_g=this.operation)._hx_index){case 0:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(0,0)));case 1:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(0,1)));case 2:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(0,2)))}break;case 1:switch((_g=this.operation)._hx_index){case 0:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(1,0)));case 1:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(1,1)));case 2:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(1,2)))}break;case 2:switch((_g=this.operation)._hx_index){case 0:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(2,0)));case 1:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(2,1)));case 2:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(2,2)))}break;case 3:var _g;switch((_g=this.operation)._hx_index){case 0:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(3,0)));case 1:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(3,1)));case 2:return _g.arg.use(c,firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(3,2)))}}},__class__:firedancer_script_nodes_AddActorProperty});var firedancer_script_nodes_ActorPropertyAddOperation=$hxEnums["firedancer.script.nodes.ActorPropertyAddOperation"]={__ename__:"firedancer.script.nodes.ActorPropertyAddOperation",__constructs__:["AddVector","AddLength","AddAngle"],AddVector:($_=function(arg){return{_hx_index:0,arg:arg,__enum__:"firedancer.script.nodes.ActorPropertyAddOperation",toString:$estr}},$_.__params__=["arg"],$_),AddLength:($_=function(arg){return{_hx_index:1,arg:arg,__enum__:"firedancer.script.nodes.ActorPropertyAddOperation",toString:$estr}},$_.__params__=["arg"],$_),AddAngle:($_=function(arg){return{_hx_index:2,arg:arg,__enum__:"firedancer.script.nodes.ActorPropertyAddOperation",toString:$estr}},$_.__params__=["arg"],$_)};firedancer_script_nodes_ActorPropertyAddOperation.__empty_constructs__=[];var firedancer_script_nodes_Aim=function(){this.speed=null,firedancer_script_AstNode.call(this)};$hxClasses["firedancer.script.nodes.Aim"]=firedancer_script_nodes_Aim,firedancer_script_nodes_Aim.__name__="firedancer.script.nodes.Aim",firedancer_script_nodes_Aim.__interfaces__=[ripper_Data],firedancer_script_nodes_Aim.__super__=firedancer_script_AstNode,firedancer_script_nodes_Aim.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!1},toAssembly:function(context){return new firedancer_script_nodes_SetActorProperty(3,null!=this.speed?firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetVector(firedancer_script_expression_VecExpression.fromPolarExpressionss({length:this.speed,angle:firedancer_script_Api.shot.angleToTarget})):firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetAngle(firedancer_script_Api.shot.angleToTarget)).toAssembly(context)},__class__:firedancer_script_nodes_Aim});var firedancer_script_nodes_DeclareLocalVariable=function(name,initialValue){firedancer_script_AstNode.call(this),this.name=name,this.initialValue=initialValue};$hxClasses["firedancer.script.nodes.DeclareLocalVariable"]=firedancer_script_nodes_DeclareLocalVariable,firedancer_script_nodes_DeclareLocalVariable.__name__="firedancer.script.nodes.DeclareLocalVariable",firedancer_script_nodes_DeclareLocalVariable.fromInt=function(name,initialValue){return null==initialValue&&(initialValue=new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(0))),new firedancer_script_nodes_DeclareLocalVariable(name,firedancer_script_expression__$GenericExpression_Data.IntExpr(initialValue))},firedancer_script_nodes_DeclareLocalVariable.fromFloat=function(name,initialValue){return null==initialValue&&(initialValue=new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,1)))),new firedancer_script_nodes_DeclareLocalVariable(name,firedancer_script_expression__$GenericExpression_Data.FloatExpr(initialValue))},firedancer_script_nodes_DeclareLocalVariable.fromAngle=function(name,initialValue){return null==initialValue&&(initialValue=new firedancer_script_expression_FloatLikeExpressionData(firedancer_script_expression_FloatLikeExpressionEnum.Constant(new firedancer_script_expression_subtypes_FloatLikeConstantData(0,.017453292519943295)))),new firedancer_script_nodes_DeclareLocalVariable(name,firedancer_script_expression__$GenericExpression_Data.AngleExpr(initialValue))},firedancer_script_nodes_DeclareLocalVariable.__super__=firedancer_script_AstNode,firedancer_script_nodes_DeclareLocalVariable.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!1},toAssembly:function(context){var storeRL,letVar,name=this.name;switch((_g=this.initialValue)._hx_index){case 0:var _g1=_g.expr;letVar=firedancer_assembly_Instruction.Let(name,0),storeRL=firedancer_assembly_Instruction.Store(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg),name),context.localVariables.push(name,0);break;case 1:_g1=_g.expr;letVar=firedancer_assembly_Instruction.Let(name,1),storeRL=firedancer_assembly_Instruction.Store(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),name),context.localVariables.push(name,1);break;case 2:_g1=_g.expr;letVar=firedancer_assembly_Instruction.Let(name,1),storeRL=firedancer_assembly_Instruction.Store(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),name),context.localVariables.push(name,1);break;case 3:_g1=_g.expr;throw haxe_Exception.thrown("Local variable of vector type is not supported.")}var arrays=[[letVar],firedancer_script_expression_GenericExpression.loadToVolatile(this.initialValue,context),[storeRL]],arrayCount=this1=arrays.length,elementCount=0,_g=0;for(_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}var this1=elementCount,newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1},__class__:firedancer_script_nodes_DeclareLocalVariable});var firedancer_script_nodes_Duplicate=function(node,params){firedancer_script_AstNode.call(this),this.node=node,this.params=params};$hxClasses["firedancer.script.nodes.Duplicate"]=firedancer_script_nodes_Duplicate,firedancer_script_nodes_Duplicate.__name__="firedancer.script.nodes.Duplicate",firedancer_script_nodes_Duplicate.__super__=firedancer_script_AstNode,firedancer_script_nodes_Duplicate.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!!this.node.containsWait()||null!=this.params.intervalFrames},toAssembly:function(context){var params=this.params,preparation=[],interval=[],completion=[],varCount=firedancer_script_Api.intVar("__loopCnt"),this1=preparation.push(firedancer_script_expression_IntLocalVariableExpression.let(varCount,params.count.subtract(new firedancer_script_expression_IntLikeExpressionData(firedancer_script_expression_IntLikeExpressionEnum.Constant(1)))));if(null!=params.intervalFrames)this1=interval.push(firedancer_script_Api.wait(params.intervalFrames));if(null!=params.shotDistanceChange){var shotDistanceChange=params.shotDistanceChange,varInitialShotDistance=firedancer_script_Api.floatVar("__sDstBuf"),varShotDistanceChangeRate=firedancer_script_Api.floatVar("__sDstChgRt");this1=preparation.push(firedancer_script_expression_FloatLocalVariableExpression.let(varInitialShotDistance,firedancer_script_api_$components_ShotDistance.toExpression(firedancer_script_Api.shot.distance))),this1=preparation.push(firedancer_script_expression_FloatLocalVariableExpression.let(varShotDistanceChangeRate,shotDistanceChange.divide(firedancer_script_expression_IntLocalVariableExpression.get(varCount).toFloatExpression()))),firedancer_script_Api.shot.distance,this1=interval.push(new firedancer_script_nodes_AddActorProperty(2,firedancer_script_nodes_ActorPropertyAddOperation.AddLength(firedancer_script_expression_FloatLocalVariableExpression.toFloatExpression(varShotDistanceChangeRate)))),firedancer_script_Api.shot.distance,this1=completion.push(new firedancer_script_nodes_SetActorProperty(2,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(firedancer_script_expression_FloatLocalVariableExpression.toFloatExpression(varInitialShotDistance))))}if(null!=params.shotBearingRange){var range=params.shotBearingRange,varInitialShotBearing=firedancer_script_Api.angleVar("__sBrgBuf"),varShotBearingChangeRate=firedancer_script_Api.angleVar("__sBrgChgRt");this1=preparation.push(firedancer_script_expression_AngleLocalVariableExpression.let(varInitialShotBearing,firedancer_script_api_$components_ShotBearing.toExpression(firedancer_script_Api.shot.bearing))),firedancer_script_Api.shot.bearing,this1=preparation.push(new firedancer_script_nodes_AddActorProperty(2,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(range.start))),this1=preparation.push(firedancer_script_expression_AngleLocalVariableExpression.let(varShotBearingChangeRate,range.end.subtract(range.start).divide(firedancer_script_expression_IntLocalVariableExpression.get(varCount).toFloatExpression()))),firedancer_script_Api.shot.bearing,this1=interval.push(new firedancer_script_nodes_AddActorProperty(2,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varShotBearingChangeRate)))),firedancer_script_Api.shot.bearing,this1=completion.push(new firedancer_script_nodes_SetActorProperty(2,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetAngle(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varInitialShotBearing))))}if(null!=params.shotSpeedChange){var shotSpeedChange=params.shotSpeedChange,varInitialShotSpeed=firedancer_script_Api.floatVar("__sSpdBuf"),varShotSpeedChangeRate=firedancer_script_Api.floatVar("__sSpdChgRt");this1=preparation.push(firedancer_script_expression_FloatLocalVariableExpression.let(varInitialShotSpeed,firedancer_script_api_$components_ShotSpeed.toExpression(firedancer_script_Api.shot.speed))),this1=preparation.push(firedancer_script_expression_FloatLocalVariableExpression.let(varShotSpeedChangeRate,shotSpeedChange.divide(firedancer_script_expression_IntLocalVariableExpression.get(varCount).toFloatExpression()))),firedancer_script_Api.shot.speed,this1=interval.push(new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddLength(firedancer_script_expression_FloatLocalVariableExpression.toFloatExpression(varShotSpeedChangeRate)))),firedancer_script_Api.shot.speed,this1=completion.push(new firedancer_script_nodes_SetActorProperty(3,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetLength(firedancer_script_expression_FloatLocalVariableExpression.toFloatExpression(varInitialShotSpeed))))}if(null!=params.shotDirectionRange){range=params.shotDirectionRange;var varInitialShotDirection=firedancer_script_Api.angleVar("__sDirBuf"),varShotDirectionChangeRate=firedancer_script_Api.angleVar("__sDirChgRt");this1=preparation.push(firedancer_script_expression_AngleLocalVariableExpression.let(varInitialShotDirection,firedancer_script_api_$components_ShotDirection.toExpression(firedancer_script_Api.shot.direction))),firedancer_script_Api.shot.direction,this1=preparation.push(new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(range.start))),this1=preparation.push(firedancer_script_expression_AngleLocalVariableExpression.let(varShotDirectionChangeRate,range.end.subtract(range.start).divide(firedancer_script_expression_IntLocalVariableExpression.get(varCount).toFloatExpression()))),firedancer_script_Api.shot.direction,this1=interval.push(new firedancer_script_nodes_AddActorProperty(3,firedancer_script_nodes_ActorPropertyAddOperation.AddAngle(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varShotDirectionChangeRate)))),firedancer_script_Api.shot.direction,this1=completion.push(new firedancer_script_nodes_SetActorProperty(3,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetAngle(firedancer_script_expression_AngleLocalVariableExpression.toAngleExpression(varInitialShotDirection))))}for(var rep=firedancer_script_expression_IntLocalVariableExpression.toIntExpression(varCount),arrays=[[this.node],interval],arrayCount=this1=arrays.length,elementCount=0,_g=0,_g1=arrayCount;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}this1=elementCount;var newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=arrays[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}var rep1=firedancer_script_Api.rep(rep,new firedancer_script_nodes_List(newArray1));return new firedancer_script_nodes_List(preparation.concat([rep1,this.node]).concat(completion)).toAssembly(context)},__class__:firedancer_script_nodes_Duplicate});var firedancer_script_nodes_End=function(endCode){firedancer_script_AstNode.call(this),this.endCode=endCode};$hxClasses["firedancer.script.nodes.End"]=firedancer_script_nodes_End,firedancer_script_nodes_End.__name__="firedancer.script.nodes.End",firedancer_script_nodes_End.__interfaces__=[ripper_Data],firedancer_script_nodes_End.__super__=firedancer_script_AstNode,firedancer_script_nodes_End.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!1},toAssembly:function(context){return[firedancer_assembly_Instruction.End(this.endCode)]},__class__:firedancer_script_nodes_End});var firedancer_script_nodes_Fire=function(pattern){this.fireCode=0,this.bindPosition=!1,firedancer_script_AstNode.call(this),this.pattern=pattern};$hxClasses["firedancer.script.nodes.Fire"]=firedancer_script_nodes_Fire,firedancer_script_nodes_Fire.__name__="firedancer.script.nodes.Fire",firedancer_script_nodes_Fire.__interfaces__=[ripper_Data],firedancer_script_nodes_Fire.__super__=firedancer_script_AstNode,firedancer_script_nodes_Fire.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!1},toAssembly:function(context){var fireArgument;if(null==this.pattern){fireArgument=null}else{var nextLabelIdStack=context.nextLabelIdStack,programId=(nextLabelIdStack.push(0),context.setCode(this.pattern.toAssembly(context)));nextLabelIdStack.pop();fireArgument=firedancer_vm_FireArgument.from(programId,this.bindPosition)}var tmp,fireCode=this.fireCode;if(null==fireCode&&(fireCode=0),null==fireArgument)tmp=firedancer_assembly_Instruction.Fire(0==fireCode?firedancer_assembly_types_FireType.Simple:firedancer_assembly_types_FireType.SimpleWithCode(fireCode));else{var arg=fireArgument;tmp=firedancer_assembly_Instruction.Fire(0==fireCode?firedancer_assembly_types_FireType.Complex(arg):firedancer_assembly_types_FireType.ComplexWithCode(arg,fireCode))}return[tmp]},__class__:firedancer_script_nodes_Fire});var firedancer_script_nodes_List=function(nodes){firedancer_script_AstNode.call(this),this.nodes=nodes};$hxClasses["firedancer.script.nodes.List"]=firedancer_script_nodes_List,firedancer_script_nodes_List.__name__="firedancer.script.nodes.List",firedancer_script_nodes_List.__interfaces__=[ripper_Data],firedancer_script_nodes_List.__super__=firedancer_script_AstNode,firedancer_script_nodes_List.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){for(var nodes=this.nodes,found=!1,_g=0,_g1=nodes.length;_g<_g1;){if(nodes[_g++].containsWait()){found=!0;break}}return found},toAssembly:function(context){var codeList=[],nodes=this.nodes,everyFrameNodeCount=0;context.localVariables.startScope();for(var _g=0,_g1=this1=nodes.length;_g<_g1;){var node=nodes[this1=i=_g++];if(0==(_g2=node.nodeType)._hx_index){var code=_g2.astToBeInjected.toAssembly(context);context.injectionStack.push(code);++everyFrameNodeCount}codeList.push(node.toAssembly(context))}var completion=context.localVariables.endScope(),this1=codeList.push(completion);for(_g=0,_g1=everyFrameNodeCount;_g<_g1;)_g++,this1=context.injectionStack.pop();var arrayCount=this1=codeList.length,elementCount=0;for(_g=0,_g1=arrayCount;_g<_g1;){elementCount+=codeList[this1=i=_g++].length}this1=elementCount;var newArray=[];newArray.length=this1;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var array=codeList[this1=_g++],_g2=0,_g3=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1},__class__:firedancer_script_nodes_List});var firedancer_script_nodes_Loop=function(node){firedancer_script_AstNode.call(this),this.node=node};$hxClasses["firedancer.script.nodes.Loop"]=firedancer_script_nodes_Loop,firedancer_script_nodes_Loop.__name__="firedancer.script.nodes.Loop",firedancer_script_nodes_Loop.__interfaces__=[ripper_Data],firedancer_script_nodes_Loop.__super__=firedancer_script_AstNode,firedancer_script_nodes_Loop.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return this.node.containsWait()},toAssembly:function(context){if(!this.node.containsWait())throw haxe_Exception.thrown("Infinite loop must contain Wait.");var nextLabelIdStack=context.nextLabelIdStack,nextLabelId=this1=nextLabelIdStack.pop(),labelId=nextLabelId++,this1=nextLabelIdStack.push(nextLabelId),code=[],other=(this1=code.push(firedancer_assembly_Instruction.Label(labelId)),this.node.toAssembly(context)),writeIndex=this1=code.length,readIndex=0,otherLength=this1=other.length;this1=writeIndex+otherLength;for(code.length=this1;readIndex<otherLength;){this1=readIndex;code[writeIndex]=other[this1],++writeIndex,++readIndex}this1=code.push(firedancer_assembly_Instruction.GotoLabel(labelId));return code},__class__:firedancer_script_nodes_Loop});var firedancer_script_nodes_OperateLocalVariable=function(name,operation,value){switch(firedancer_script_AstNode.call(this),operation){case 0:case 1:if(null==value)throw haxe_Exception.thrown("Missing value to set/add.")}this.name=name,this.operation=operation;var this1=value;this.value=this1};$hxClasses["firedancer.script.nodes.OperateLocalVariable"]=firedancer_script_nodes_OperateLocalVariable,firedancer_script_nodes_OperateLocalVariable.__name__="firedancer.script.nodes.OperateLocalVariable",firedancer_script_nodes_OperateLocalVariable.__super__=firedancer_script_AstNode,firedancer_script_nodes_OperateLocalVariable.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!1},toAssembly:function(context){var variable=context.localVariables.get(this.name);switch(this.operation){case 0:return variable.setValue(this.value);case 1:return variable.addValue(this.value);case 2:return variable.increment();case 3:return variable.decrement()}},__class__:firedancer_script_nodes_OperateLocalVariable});var firedancer_script_nodes_Parallel=function(array){firedancer_script_AstNode.call(this),this.array=array};$hxClasses["firedancer.script.nodes.Parallel"]=firedancer_script_nodes_Parallel,firedancer_script_nodes_Parallel.__name__="firedancer.script.nodes.Parallel",firedancer_script_nodes_Parallel.__interfaces__=[ripper_Data],firedancer_script_nodes_Parallel.__super__=firedancer_script_AstNode,firedancer_script_nodes_Parallel.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!1},toAssembly:function(context){this1=this.array.shift();if(null==this1)return[];var main=this1.toAssembly(context),len=this2=(this1=this.array).length;(newArray=this2=[]).length=len;for(var newArray1=newArray,i=0;i<len;){var programId=context.setCode(this1[i].toAssembly(context));newArray1[i]=firedancer_assembly_Instruction.UseThread(programId,firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Stack)),++i}var newArray,invokeSub=newArray1,this2=(this1=this.array).length;(newArray=this1=[]).length=len=this2;for(newArray1=newArray,i=0;i<len;)newArray1[i]=firedancer_assembly_Instruction.AwaitThread,++i;for(var arrays=[invokeSub,main,newArray1],arrayCount=this1=arrays.length,elementCount=0,_g=0,_g1=arrayCount;_g<_g1;){elementCount+=this2=arrays[this1=i=_g++].length}(newArray=this2=[]).length=this1=elementCount;for(newArray1=newArray,i=0,_g=0,_g1=arrayCount;_g<_g1;)for(var this1,array=arrays[this1=_g++],_g2=0,_g3=this2=array.length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}return newArray1},__class__:firedancer_script_nodes_Parallel});var firedancer_script_nodes_Repeat=function(node,repetitionCount){this.unrolling=!1,firedancer_script_AstNode.call(this),this.node=node,this.repetitionCount=repetitionCount};$hxClasses["firedancer.script.nodes.Repeat"]=firedancer_script_nodes_Repeat,firedancer_script_nodes_Repeat.__name__="firedancer.script.nodes.Repeat",firedancer_script_nodes_Repeat.__interfaces__=[ripper_Data],firedancer_script_nodes_Repeat.__super__=firedancer_script_AstNode,firedancer_script_nodes_Repeat.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return this.node.containsWait()},toAssembly:function(context){var count=this.repetitionCount,body=this.node.toAssembly(context),constant=count.tryGetConstant();return null!=constant&&this.unrolling?firedancer_assembly_Builder.loopUnrolled(new IntIterator(0,constant),(function(_){return body})):firedancer_assembly_Builder.loop(context,body,count)},__class__:firedancer_script_nodes_Repeat});var firedancer_script_nodes_SetActorProperty=function(propType,operation){firedancer_script_AstNode.call(this),this.propType=propType,this.operation=operation};$hxClasses["firedancer.script.nodes.SetActorProperty"]=firedancer_script_nodes_SetActorProperty,firedancer_script_nodes_SetActorProperty.__name__="firedancer.script.nodes.SetActorProperty",firedancer_script_nodes_SetActorProperty.__interfaces__=[ripper_Data],firedancer_script_nodes_SetActorProperty.__super__=firedancer_script_AstNode,firedancer_script_nodes_SetActorProperty.prototype=$extend(firedancer_script_AstNode.prototype,{frames:function(frames){return new firedancer_script_nodes_SetActorPropertyLinear(this.propType,this.operation,frames)},containsWait:function(){return!1},toAssembly:function(context){var c=context;switch(this.propType){case 0:switch((_g=this.operation)._hx_index){case 0:var mat=_g.mat,e=_g.arg;return null!=mat&&(e=e.transform(mat)),e.use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(0,0)));case 1:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(0,1)));case 2:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(0,2)))}break;case 1:switch((_g=this.operation)._hx_index){case 0:mat=_g.mat,e=_g.arg;return null!=mat&&(e=e.transform(mat)),e.use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(1,0)));case 1:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(1,1)));case 2:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(1,2)))}break;case 2:switch((_g=this.operation)._hx_index){case 0:mat=_g.mat,e=_g.arg;return null!=mat&&(e=e.transform(mat)),e.use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(2,0)));case 1:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(2,1)));case 2:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(2,2)))}break;case 3:var _g;switch((_g=this.operation)._hx_index){case 0:mat=_g.mat,e=_g.arg;return null!=mat&&(e=e.transform(mat)),e.use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(3,0)));case 1:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(3,1)));case 2:return(e=_g.arg).use(c,firedancer_assembly_Instruction.Set(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(3,2)))}}},__class__:firedancer_script_nodes_SetActorProperty});var firedancer_script_nodes_SetActorVector=function(propType,vec,matrix){firedancer_script_nodes_SetActorProperty.call(this,propType,firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.SetVector(vec,matrix))};$hxClasses["firedancer.script.nodes.SetActorVector"]=firedancer_script_nodes_SetActorVector,firedancer_script_nodes_SetActorVector.__name__="firedancer.script.nodes.SetActorVector",firedancer_script_nodes_SetActorVector.__interfaces__=[ripper_Data],firedancer_script_nodes_SetActorVector.__super__=firedancer_script_nodes_SetActorProperty,firedancer_script_nodes_SetActorVector.prototype=$extend(firedancer_script_nodes_SetActorProperty.prototype,{transform:function(matrix){var _g=this.operation;if(0==_g._hx_index){var mat=_g.mat,vec=_g.arg;return new firedancer_script_nodes_SetActorVector(this.propType,vec,null!=mat?firedancer_script_expression_Transformation.multiply(mat,matrix):matrix)}throw haxe_Exception.thrown("Invalid operation in SetActorVector class.")},rotate:function(angle){return this.transform(firedancer_script_expression_Transformation.createRotate(angle))},scale:function(x,y){return this.transform(firedancer_script_expression_Transformation.createScale(x,y))},__class__:firedancer_script_nodes_SetActorVector});var firedancer_script_nodes_SetActorPropertyLinear=function(propType,operation,frames,loopUnrolling){null==loopUnrolling&&(loopUnrolling=!1),firedancer_script_AstNode.call(this),this.propType=propType,this.operation=operation,this.frames=frames,this.loopUnrolling=loopUnrolling};$hxClasses["firedancer.script.nodes.SetActorPropertyLinear"]=firedancer_script_nodes_SetActorPropertyLinear,firedancer_script_nodes_SetActorPropertyLinear.__name__="firedancer.script.nodes.SetActorPropertyLinear",firedancer_script_nodes_SetActorPropertyLinear.__super__=firedancer_script_AstNode,firedancer_script_nodes_SetActorPropertyLinear.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){var constFrames=this.frames.tryGetConstant();return null==constFrames||0<constFrames},toAssembly:function(context){var getDiff,divChange,pushChange,peekChange,addFromVolatile,dropChange,frames=this.frames,constFrames=frames.tryGetConstant();switch((_g=this.operation)._hx_index){case 0:var mat=_g.mat,vec=_g.arg;null!=mat&&(vec=vec.transform(mat));var divRRR=firedancer_assembly_Instruction.Div(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),code=[],loadFramesAsFloat=frames.toFloatExpression().loadToVolatile(context),readIndex=0,this1=(writeIndex=this1=code.length)+(otherLength=this1=loadFramesAsFloat.length);for(code.length=this1;readIndex<otherLength;){this1=readIndex;code[writeIndex]=loadFramesAsFloat[this1],++writeIndex,++readIndex}this1=code.push(divRRR);divChange=code,pushChange=firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg)),peekChange=firedancer_assembly_Instruction.Peek(2,4),dropChange=firedancer_assembly_Instruction.Drop(2),addFromVolatile=firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(this.propType,0));for(var getDiffRR=firedancer_assembly_Instruction.GetDiff(firedancer_assembly_Operand.Vec(firedancer_assembly_VecOperand.Reg),firedancer_assembly_types_ActorProperty.create(this.propType,0)),elementCount=0,_g1=0,_g2=arrayCount=this1=(arrays=[vec.loadToVolatile(context),[getDiffRR]]).length;_g1<_g2;){elementCount+=arrays[this1=i=_g1++].length}(newArray=[]).length=this1=elementCount;var newArray1=newArray,i=0;for(_g1=0,_g2=arrayCount;_g1<_g2;)for(var _g3=0,_g4=(array=arrays[this1=_g1++]).length;_g3<_g4;){var this4=_g3++;newArray1[i]=array[this4],++i}getDiff=newArray1;break;case 1:var length=_g.arg;divRRR=firedancer_assembly_Instruction.Div(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.RegBuf),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),code=[firedancer_assembly_Instruction.Save(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))],loadFramesAsFloat=frames.toFloatExpression().loadToVolatile(context),readIndex=0,this1=(writeIndex=this1=code.length)+(otherLength=this1=loadFramesAsFloat.length);for(code.length=this1;readIndex<otherLength;){this1=readIndex;code[writeIndex]=loadFramesAsFloat[this1],++writeIndex,++readIndex}this1=code.push(divRRR);divChange=code,pushChange=firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),peekChange=firedancer_assembly_Instruction.Peek(1,4),dropChange=firedancer_assembly_Instruction.Drop(1),addFromVolatile=firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(this.propType,1));getDiffRR=firedancer_assembly_Instruction.GetDiff(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(this.propType,1)),this1=(getDiff=length.loadToVolatile(context)).push(getDiffRR);break;case 2:var writeIndex,otherLength,angle=_g.arg;divRRR=firedancer_assembly_Instruction.Div(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.RegBuf),firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),code=[firedancer_assembly_Instruction.Save(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg))],loadFramesAsFloat=frames.toFloatExpression().loadToVolatile(context),readIndex=0,this1=(writeIndex=this1=code.length)+(otherLength=this1=loadFramesAsFloat.length);for(code.length=this1;readIndex<otherLength;){this1=readIndex;code[writeIndex]=loadFramesAsFloat[this1],++writeIndex,++readIndex}this1=code.push(divRRR);divChange=code,pushChange=firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg)),peekChange=firedancer_assembly_Instruction.Peek(1,4),dropChange=firedancer_assembly_Instruction.Drop(1),addFromVolatile=firedancer_assembly_Instruction.Increase(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(this.propType,2));getDiffRR=firedancer_assembly_Instruction.GetDiff(firedancer_assembly_Operand.Float(firedancer_assembly_FloatOperand.Reg),firedancer_assembly_types_ActorProperty.create(this.propType,2)),this1=(getDiff=angle.loadToVolatile(context)).push(getDiffRR)}var loopedBody,newArray,prepare=getDiff.concat(divChange).concat([pushChange]),body=[firedancer_assembly_Instruction.Break,peekChange,addFromVolatile];if(null!=constFrames)if(this.loopUnrolling)loopedBody=firedancer_assembly_Builder.loopUnrolled(new IntIterator(0,constFrames),(function(_){return body}));else{var pushLoopCount=firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Imm(constFrames)));loopedBody=firedancer_assembly_Builder.constructLoop(context,[pushLoopCount],body)}else loopedBody=firedancer_assembly_Builder.constructLoop(context,[firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg))],body);elementCount=0;var arrays,arrayCount,_g=0;for(_g1=arrayCount=this1=(arrays=[prepare,loopedBody,[dropChange]]).length;_g<_g1;){elementCount+=arrays[this1=i=_g++].length}(newArray=[]).length=this1=elementCount;for(newArray1=newArray,i=0,_g=0,_g1=arrayCount;_g<_g1;){var array;for(_g2=0,_g3=(array=arrays[this1=_g++]).length;_g2<_g3;){this4=_g2++;newArray1[i]=array[this4],++i}}return newArray1},__class__:firedancer_script_nodes_SetActorPropertyLinear});var firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation=$hxEnums["firedancer.script.nodes._SetActorProperty.ActorPropertySetOperation"]={__ename__:"firedancer.script.nodes._SetActorProperty.ActorPropertySetOperation",__constructs__:["SetVector","SetLength","SetAngle"],SetVector:($_=function(arg,mat){return{_hx_index:0,arg:arg,mat:mat,__enum__:"firedancer.script.nodes._SetActorProperty.ActorPropertySetOperation",toString:$estr}},$_.__params__=["arg","mat"],$_),SetLength:($_=function(arg){return{_hx_index:1,arg:arg,__enum__:"firedancer.script.nodes._SetActorProperty.ActorPropertySetOperation",toString:$estr}},$_.__params__=["arg"],$_),SetAngle:($_=function(arg){return{_hx_index:2,arg:arg,__enum__:"firedancer.script.nodes._SetActorProperty.ActorPropertySetOperation",toString:$estr}},$_.__params__=["arg"],$_)};firedancer_script_nodes__$SetActorProperty_ActorPropertySetOperation.__empty_constructs__=[];var firedancer_script_nodes_Wait=function(frames){firedancer_script_AstNode.call(this),this.frames=frames};$hxClasses["firedancer.script.nodes.Wait"]=firedancer_script_nodes_Wait,firedancer_script_nodes_Wait.__name__="firedancer.script.nodes.Wait",firedancer_script_nodes_Wait.__interfaces__=[ripper_Data],firedancer_script_nodes_Wait.__super__=firedancer_script_AstNode,firedancer_script_nodes_Wait.prototype=$extend(firedancer_script_AstNode.prototype,{containsWait:function(){return!0},toAssembly:function(context){var code=context.injectionStack.slice();code.reverse();for(var elementCount=0,_g=0,_g1=arrayCount=code.length;_g<_g1;){elementCount+=code[i=_g++].length}(newArray=[]).length=elementCount;var newArray1=newArray,i=0;for(_g=0,_g1=arrayCount;_g<_g1;)for(var _g2=0,_g3=(array=code[_g++]).length;_g2<_g3;){var this4=_g2++;newArray1[i]=array[this4],++i}var injectionCode=newArray1,loopBody=injectionCode.concat([firedancer_assembly_Instruction.Break]);if(0==injectionCode.length){var arrayCount,arrays=[this.frames.loadToVolatile(context),[firedancer_assembly_Instruction.Push(firedancer_assembly_Operand.Int(firedancer_assembly_IntOperand.Reg)),firedancer_assembly_Instruction.CountDownBreak]];for(elementCount=0,_g=0,_g1=arrayCount=arrays.length;_g<_g1;){elementCount+=arrays[i=_g++].length}var newArray;(newArray=[]).length=elementCount;for(newArray1=newArray,i=0,_g=0,_g1=arrayCount;_g<_g1;){var array;for(_g2=0,_g3=(array=arrays[_g++]).length;_g2<_g3;){this4=_g2++;newArray1[i]=array[this4],++i}}return newArray1}return firedancer_assembly_Builder.loop(context,loopBody,this.frames)},__class__:firedancer_script_nodes_Wait});var firedancer_vm_Bytecode={dump:function(this1,codeLength,markPosition){null==markPosition&&(markPosition=-1);var buf=new sneaker_string_$buffer_StringBuffer,codeDump=banker_binary_BytesData.toHex(this1,codeLength,!0);if(-1!=markPosition&&(0!=(pos=markPosition)&&pos<codeLength)){var chars=codeDump.split("");chars[markPosition*(this1=3)-1]="|",codeDump=chars.join("")}for(var codeDumpLength=codeDump.length,pos=0;pos<codeDumpLength;){buf.b+=Std.string(Std.string(HxOverrides.substr(codeDump,pos,47))+"\n"),pos=this1=pos+48}return buf.b}},haxe_ds_Option=$hxEnums["haxe.ds.Option"]={__ename__:"haxe.ds.Option",__constructs__:["Some","None"],Some:($_=function(v){return{_hx_index:0,v:v,__enum__:"haxe.ds.Option",toString:$estr}},$_.__params__=["v"],$_),None:{_hx_index:1,__enum__:"haxe.ds.Option",toString:$estr}};haxe_ds_Option.__empty_constructs__=[haxe_ds_Option.None];var js_Boot=function(){};$hxClasses["js.Boot"]=js_Boot,js_Boot.__name__="js.Boot",js_Boot.getClass=function(o){if(null==o)return null;if(o instanceof Array)return Array;var cl=o.__class__;if(null!=cl)return cl;var name=js_Boot.__nativeClassName(o);return null!=name?js_Boot.__resolveNativeClass(name):null},js_Boot.__string_rec=function(o,s){if(null==o)return"null";if(s.length>=5)return"<...>";var t=typeof o;switch("function"==t&&(o.__name__||o.__ename__)&&(t="object"),t){case"function":return"<function>";case"object":if(o.__enum__){var e=$hxEnums[o.__enum__],n=e.__constructs__[o._hx_index],con=e[n];return con.__params__?(s+="\t",n+"("+function($this){for(var _g=[],_g1=0,_g2=con.__params__;_g1<_g2.length;){var p=_g2[_g1];_g1+=1,_g.push(js_Boot.__string_rec(o[p],s))}return _g}().join(",")+")"):n}if(o instanceof Array){var str="[";s+="\t";for(var _g=0,_g1=o.length;_g<_g1;){var i=_g++;str+=(i>0?",":"")+js_Boot.__string_rec(o[i],s)}return str+="]"}var tostr;try{tostr=o.toString}catch(_g){return"???"}if(null!=tostr&&tostr!=Object.toString&&"function"==typeof tostr){var s2=o.toString();if("[object Object]"!=s2)return s2}str="{\n";s+="\t";var hasp=null!=o.hasOwnProperty,k=null;for(k in o)hasp&&!o.hasOwnProperty(k)||"prototype"!=k&&"__class__"!=k&&"__super__"!=k&&"__interfaces__"!=k&&"__properties__"!=k&&(2!=str.length&&(str+=", \n"),str+=s+k+" : "+js_Boot.__string_rec(o[k],s));return str+="\n"+(s=s.substring(1))+"}";case"string":return o;default:return String(o)}},js_Boot.__interfLoop=function(cc,cl){if(null==cc)return!1;if(cc==cl)return!0;var intf=cc.__interfaces__;if(null!=intf)for(var _g=0,_g1=intf.length;_g<_g1;){var i1=intf[_g++];if(i1==cl||js_Boot.__interfLoop(i1,cl))return!0}return js_Boot.__interfLoop(cc.__super__,cl)},js_Boot.__instanceof=function(o,cl){if(null==cl)return!1;switch(cl){case Array:return o instanceof Array;case Bool:return"boolean"==typeof o;case Dynamic:return null!=o;case Float:return"number"==typeof o;case Int:return"number"==typeof o&&(0|o)===o;case String:return"string"==typeof o;default:if(null==o)return!1;if("function"==typeof cl){if(js_Boot.__downcastCheck(o,cl))return!0}else if("object"==typeof cl&&js_Boot.__isNativeObj(cl)&&o instanceof cl)return!0;return cl==Class&&null!=o.__name__||(cl==Enum&&null!=o.__ename__||null!=o.__enum__&&$hxEnums[o.__enum__]==cl)}},js_Boot.__downcastCheck=function(o,cl){return o instanceof cl||!!cl.__isInterface__&&js_Boot.__interfLoop(js_Boot.getClass(o),cl)},js_Boot.__nativeClassName=function(o){var name=js_Boot.__toStr.call(o).slice(8,-1);return"Object"==name||"Function"==name||"Math"==name||"JSON"==name?null:name},js_Boot.__isNativeObj=function(o){return null!=js_Boot.__nativeClassName(o)},js_Boot.__resolveNativeClass=function(name){return $global[name]};var prayer_CompilerFlagType=$hxEnums["prayer.CompilerFlagType"]={__ename__:"prayer.CompilerFlagType",__constructs__:["Mandatory","Optional"],Mandatory:($_=function(defaultValue){return{_hx_index:0,defaultValue:defaultValue,__enum__:"prayer.CompilerFlagType",toString:$estr}},$_.__params__=["defaultValue"],$_),Optional:($_=function(nullValue){return{_hx_index:1,nullValue:nullValue,__enum__:"prayer.CompilerFlagType",toString:$estr}},$_.__params__=["nullValue"],$_)};prayer_CompilerFlagType.__empty_constructs__=[];var prayer_CompilerFlag=function(name,getDefine,validate,type){this.value=haxe_ds_Option.None,this.name=name,this.getDefine=getDefine,this.validate=validate,this.type=type};$hxClasses["prayer.CompilerFlag"]=prayer_CompilerFlag,prayer_CompilerFlag.__name__="prayer.CompilerFlag",prayer_CompilerFlag.prototype={get:function(){var _g=this.value;switch(_g._hx_index){case 0:return _g.v;case 1:return this.set()}},set:function(){var define=this.getDefine(),validated=this.validate(define);switch((_g=this.validate(define))._hx_index){case 0:var validValue=_g.v;return this.value=validated,validValue;case 1:var _g;switch((_g=this.type)._hx_index){case 0:var defaultValue=_g.defaultValue;return this.value=haxe_ds_Option.Some(defaultValue),defaultValue;case 1:var nullValue=_g.nullValue;return this.value=haxe_ds_Option.Some(nullValue),nullValue}}},__class__:prayer_CompilerFlag};var firedancer_vm_CompilerFlags=function(){};$hxClasses["firedancer.vm.CompilerFlags"]=firedancer_vm_CompilerFlags,firedancer_vm_CompilerFlags.__name__="firedancer.vm.CompilerFlags";var firedancer_vm_FireArgument={from:function(programId,bindPosition){if(0!=(-2147483648&programId))throw haxe_Exception.thrown("Invalid program ID: "+(null==programId?"null":Std.string(programId)));return(bindPosition?-2147483648:0)|programId},toString:function(this1){var this2=2147483647&this1,s="program "+(null==this2?"null":Std.string(this2));return 0!=(-2147483648&this1)&&(s+=" bind"),s}},firedancer_vm_Program={serialize:function(program){var s=new haxe_Serializer;return s.serialize(program),s.toString()}},firedancer_vm_ProgramPackage=function(programList,nameIdMapping,vmVersion){this.vmVersion=null!=vmVersion?vmVersion:firedancer_vm_CompilerFlags.version.get(),this.programTable=programList;for(var i=0,key=haxe_ds_StringMap.keysIterator(nameIdMapping.h);key.hasNext();){key.next();++i}for(var nameIdMap=new banker_map_ArrayMap_$String_$sinker_$UInt(i),_g=haxe_ds_StringMap.kvIterator(nameIdMapping.h);_g.hasNext();){var _g1=_g.next(),name=_g1.key,id=_g1.value,size=nameIdMap.nextFreeSlotIndex,keys=nameIdMap.keyVector,_this=keys,found=-1;for(i=0;i<size;){if(_this[i]==name){found=i;break}++i}var index=found;if(-1!=index)nameIdMap.valueVector[index]=id;else{keys[size]=name,nameIdMap.valueVector[size]=id;var index1=size+1;nameIdMap.nextFreeSlotIndex=index1}}this.nameIdMap=nameIdMap};$hxClasses["firedancer.vm.ProgramPackage"]=firedancer_vm_ProgramPackage,firedancer_vm_ProgramPackage.__name__="firedancer.vm.ProgramPackage",firedancer_vm_ProgramPackage.prototype={getProgramByName:function(name){for(var _this=this.nameIdMap,_this1=_this.keyVector,endIndex=_this.nextFreeSlotIndex,found=-1,i=0;i<endIndex;){if(_this1[i]==name){found=i;break}++i}var index=found,id=_this.valueVector[index];return this.programTable[id]},toString:function(){for(var nameIdMap={},_this=this.nameIdMap,keys=_this.keyVector,values=_this.valueVector,len=_this.nextFreeSlotIndex,i=0;i<len;){var this2=i;nameIdMap[keys[this1=i]]=values[this2],++i}for(var this1,callback=firedancer_vm_Program.serialize,length=(this1=this.programTable).length,r=this2=new Array(length),_g=0,_g1=len=length;_g<_g1;){var v=callback(this1[i=_g++]);r[i]=v}var obj={nameIdMap:nameIdMap,programTable:r.slice(0),vmVersion:this.vmVersion};return JSON.stringify(obj,null,"  ").toString()},__class__:firedancer_vm_ProgramPackage};var firedancer_vm_Thread=function(memoryCapacity){this.active=!1;this.code=null,this.codeLength=0,this.programCounter=0,this.memoryData=new haxe_io_Bytes(new ArrayBuffer(memoryCapacity)),this.stackPointer=0,this.shotX=0,this.shotY=0,this.shotVx=0,this.shotVy=0};$hxClasses["firedancer.vm.Thread"]=firedancer_vm_Thread,firedancer_vm_Thread.__name__="firedancer.vm.Thread",firedancer_vm_Thread.prototype={__class__:firedancer_vm_Thread};var firedancer_vm_ThreadList={useSubThread:function(this1,program,currentThread){for(var index=-1,i=1,len=this1.length;;){var thread=this1[i];if(!thread.active){thread.active=!0;var this2=program;thread.code=this2;var this3=program.length;thread.codeLength=this3,thread.programCounter=0,thread.stackPointer=0,thread.shotX=currentThread.shotX,thread.shotY=currentThread.shotY,thread.shotVx=currentThread.shotVx,thread.shotVy=currentThread.shotVy,index=i;break}if(!(++i<len))break}return index}},firedancer_vm_Vm=function(){};$hxClasses["firedancer.vm.Vm"]=firedancer_vm_Vm,firedancer_vm_Vm.__name__="firedancer.vm.Vm",firedancer_vm_Vm.run=function(programTable,eventHandler,threads,memoryCapacity,xVec,yVec,vxVec,vyVec,originPositionRefVec,vecIndex,emitter,thisPositionRef,targetPositionRef){var position_y,position_x,position_originY,position_originX,originPositionRef=originPositionRefVec[vecIndex],x=xVec[vecIndex],y=yVec[vecIndex];if(null==originPositionRef)position_originX=position_originY=0,position_x=x,position_y=y;else{var origin=originPositionRef;if(-3402823e32!=origin.x)position_x=x-(position_originX=origin.x),position_y=y-(position_originY=origin.y);else{var this1=null;originPositionRefVec[vecIndex]=this1,position_originX=position_originY=0,position_x=x,position_y=y}}for(var reg_vecY,reg_vecX,reg_intBuf,reg_int,reg_floatBuf,reg_float,mem_sp,mem_data,velocity_x=vxVec[vecIndex],velocity_y=vyVec[vecIndex],scan=new firedancer_vm_internal_Scanner,mem_capacity=memoryCapacity,endCode=0,deactivateAllThreads=!1,_g=0,_g1=threads.length;_g<_g1;){var thread=threads[this1=i=_g++];if(thread.active){scan.pc=thread.programCounter,scan.codeLength=thread.codeLength,scan.code=thread.code,reg_int=0,reg_intBuf=0,reg_float=0,reg_floatBuf=0,reg_vecX=0,reg_vecY=0,mem_data=thread.memoryData,mem_sp=thread.stackPointer;_hx_loop2:for(;;){if(scan.codeLength<=scan.pc){thread.active=!1;thread.code=null;break}var opcode=scan.code.b[scan.pc],this5=scan.pc+1;scan.pc=this5;var opcode1=opcode;switch(opcode1>>>6){case 0:switch(63&opcode1){case 0:break _hx_loop2;case 1:var this6=mem_sp-4;if(0<mem_data.getInt32(this6)){var this7=mem_data,pos=mem_sp-4;this7.setInt32(pos,this7.getInt32(pos)-1|0);var this9=scan.pc-1;scan.pc=this9;break _hx_loop2}mem_sp=mem_sp-4;break;case 2:var value=scan.code.getInt32(scan.pc),this12=scan.pc+4;scan.pc=this12;var this13=value;scan.pc=this13;break;case 3:var this14=mem_sp-4;if(0<mem_data.getInt32(this14)){var this15=mem_data,pos1=mem_sp-4;this15.setInt32(pos1,this15.getInt32(pos1)-1|0);var this17=scan.pc+4;scan.pc=this17}else{mem_sp=mem_sp-4;var value1=scan.code.getInt32(scan.pc),this20=scan.pc+4;scan.pc=this20;var this21=value1;scan.pc=this21}break;case 4:var value2=scan.code.getInt32(scan.pc),this22=scan.pc+4;scan.pc=this22;var this23=value2;firedancer_vm_ThreadList.useSubThread(threads,programTable[this23],thread);break;case 5:var value3=scan.code.getInt32(scan.pc),this24=scan.pc+4;scan.pc=this24;var this25=value3,threadId=firedancer_vm_ThreadList.useSubThread(threads,programTable[this25],thread),stackSize=mem_sp;mem_data.setInt32(stackSize,threadId),mem_sp=stackSize+4;break;case 6:var this27=mem_sp-4;if(threads[mem_data.getInt32(this27)].active){var this29=scan.pc-1;scan.pc=this29;break _hx_loop2}mem_sp=mem_sp-4;break;case 7:var value4=scan.code.getInt32(scan.pc),this32=scan.pc+4;scan.pc=this32,endCode=value4,deactivateAllThreads=!0;break _hx_loop2;case 8:var value5=scan.code.getInt32(scan.pc),this33=scan.pc+4;scan.pc=this33,reg_int=value5;break;case 9:reg_int=reg_intBuf;break;case 10:var value6=scan.code.getDouble(scan.pc),this34=scan.pc+8;scan.pc=this34,reg_float=value6;break;case 11:reg_float=reg_floatBuf;break;case 12:var value7=scan.code.getDouble(scan.pc),this35=scan.pc+8;scan.pc=this35;var value8=scan.code.getDouble(scan.pc),this36=scan.pc+8;scan.pc=this36,reg_vecX=value7,reg_vecY=value8;break;case 13:var value9=scan.code.getInt32(scan.pc),this37=scan.pc+4;scan.pc=this37,reg_intBuf=value9;break;case 14:reg_intBuf=reg_int;break;case 15:var value10=scan.code.getDouble(scan.pc),this38=scan.pc+8;scan.pc=this38,reg_floatBuf=value10;break;case 16:reg_floatBuf=reg_float;break;case 17:var value11=scan.code.getInt32(scan.pc),this39=scan.pc+4;scan.pc=this39;var this42=mem_capacity-value11-4;reg_int=mem_data.getInt32(this42);break;case 18:var value12=scan.code.getInt32(scan.pc),this43=scan.pc+4;scan.pc=this43;var this46=mem_capacity-value12-8;reg_float=mem_data.getDouble(this46);break;case 19:var value13=scan.code.getInt32(scan.pc),this47=scan.pc+4;scan.pc=this47;var value14=scan.code.getInt32(scan.pc),this48=scan.pc+4;scan.pc=this48;var this51=mem_capacity-value13-4;mem_data.setInt32(this51,value14);break;case 20:var value15=scan.code.getInt32(scan.pc),this52=scan.pc+4;scan.pc=this52;var this55=mem_capacity-value15-4;mem_data.setInt32(this55,reg_int);break;case 21:var value16=scan.code.getInt32(scan.pc),this56=scan.pc+4;scan.pc=this56;var value17=scan.code.getDouble(scan.pc),this57=scan.pc+8;scan.pc=this57;var this60=mem_capacity-value16-8;mem_data.setDouble(this60,value17);break;case 22:var value18=scan.code.getInt32(scan.pc),this61=scan.pc+4;scan.pc=this61;var this64=mem_capacity-value18-8;mem_data.setDouble(this64,reg_float);break;case 23:var value19=scan.code.getInt32(scan.pc),this65=scan.pc+4;scan.pc=this65;var stackSize1=mem_sp;mem_data.setInt32(stackSize1,value19),mem_sp=stackSize1+4;break;case 24:var stackSize2=mem_sp;mem_data.setInt32(stackSize2,reg_int),mem_sp=stackSize2+4;break;case 25:var value20=scan.code.getDouble(scan.pc),this68=scan.pc+8;scan.pc=this68;var stackSize3=mem_sp;mem_data.setDouble(stackSize3,value20),mem_sp=stackSize3+8;break;case 26:var stackSize4=mem_sp;mem_data.setDouble(stackSize4,reg_float),mem_sp=stackSize4+8;break;case 27:var value21=scan.code.getDouble(scan.pc),this71=scan.pc+8;scan.pc=this71;var value22=scan.code.getDouble(scan.pc),this72=scan.pc+8;scan.pc=this72;var stackSize5=mem_sp;mem_data.setDouble(stackSize5,value21);var stackSize6=mem_sp=stackSize5+8;mem_data.setDouble(stackSize6,value22),mem_sp=stackSize6+8;break;case 28:var stackSize7=mem_sp;mem_data.setDouble(stackSize7,reg_vecX);var stackSize8=mem_sp=stackSize7+8;mem_data.setDouble(stackSize8,reg_vecY),mem_sp=stackSize8+8;break;case 29:var stackSize9=mem_sp;mem_sp=stackSize9=stackSize9-4,reg_int=mem_data.getInt32(stackSize9);break;case 30:var stackSize10=mem_sp;mem_sp=stackSize10=stackSize10-8,reg_float=mem_data.getDouble(stackSize10);break;case 31:var value23=scan.code.getInt32(scan.pc),this79=scan.pc+4;scan.pc=this79;var this81=mem_sp-value23-8;reg_float=mem_data.getDouble(this81);break;case 32:mem_sp=mem_sp-8;break;case 33:var value24=scan.code.getInt32(scan.pc),this84=scan.pc+4;scan.pc=this84;var this85=mem_data,this86=mem_sp-value24,this88=this86-8-8,this89=this86-8;reg_vecX=this85.getDouble(this88),reg_vecY=this85.getDouble(this89);break;case 34:mem_sp=mem_sp-8-8;break;case 35:emitter.emit(position_originX+position_x+thread.shotX,position_originY+position_y+thread.shotY,thread.shotVx,thread.shotVy,0,null,null);break;case 36:var value25=scan.code.getInt32(scan.pc),this95=scan.pc+4;scan.pc=this95;var tmp,arg=value25,bytecode=programTable[2147483647&arg];if(0!=(-2147483648&arg)){tmp=thisPositionRef}else{tmp=null}emitter.emit(position_originX+position_x+thread.shotX,position_originY+position_y+thread.shotY,thread.shotVx,thread.shotVy,0,bytecode,tmp);break;case 37:var value26=scan.code.getInt32(scan.pc),this100=scan.pc+4;scan.pc=this100;var fireCode=value26;emitter.emit(position_originX+position_x+thread.shotX,position_originY+position_y+thread.shotY,thread.shotVx,thread.shotVy,fireCode,null,null);break;case 38:var value27=scan.code.getInt32(scan.pc),this103=scan.pc+4;scan.pc=this103;var arg1=value27,value28=scan.code.getInt32(scan.pc),this104=scan.pc+4;scan.pc=this104;var tmp1,fireCode1=value28,bytecode1=programTable[2147483647&arg1];if(0!=(-2147483648&arg1)){tmp1=thisPositionRef}else{tmp1=null}emitter.emit(position_originX+position_x+thread.shotX,position_originY+position_y+thread.shotY,thread.shotVx,thread.shotVy,fireCode1,bytecode1,tmp1);break;case 39:eventHandler.onGlobalEvent(reg_int);break;case 40:eventHandler.onLocalEvent(reg_int,position_x,position_y,thread,originPositionRef,targetPositionRef);break;case 41:var value29=scan.code.getInt32(scan.pc),this109=scan.pc+4;if(scan.pc=this109,0==value29){var buf=new sneaker_string_$buffer_StringBuffer;buf.b+=Std.string("---- DUMP -------------------------------------\n\n"),buf.b+=Std.string("[scanner]\n"),buf.b+="program counter: ",buf.b+=Std.string(Std.string(scan.pc)+"\n"),buf.b+="bytecode length: ",buf.b+=Std.string(Std.string(scan.codeLength)+"\n"),buf.b+=Std.string("bytecode:\n");x=firedancer_vm_Bytecode.dump(scan.code,scan.codeLength,scan.pc);buf.b+=Std.string(x),buf.b+=Std.string("\n[memory]\n"),buf.b+="stack pointer: ",buf.b+=Std.string(Std.string(mem_sp)+"\n"),buf.b+="capacity: ",buf.b+=Std.string(Std.string(mem_capacity)+"\n"),buf.b+=Std.string("memory dump:\n");var memData=mem_data,dump=banker_binary_BytesData.toHex(memData,mem_capacity,!0),dumpLength=dump.length;if(0!=mem_sp){var dumpChars=dump.split("");dumpChars[3*mem_sp-1]="|",dump=dumpChars.join("")}for(var pos2=0;pos2<dumpLength;){buf.b+=Std.string(Std.string(HxOverrides.substr(dump,pos2,47))+"\n"),pos2=pos2+48}buf.b+=Std.string("\n[data register file]\n"),buf.b+="int:      ",buf.b+=Std.string(Std.string(reg_int)+"\n"),buf.b+="intBuf:   ",buf.b+=Std.string(Std.string(reg_intBuf)+"\n"),buf.b+="float:    ",buf.b+=Std.string(Std.string(reg_float)+"\n"),buf.b+="floatBuf: ",buf.b+=Std.string(Std.string(reg_floatBuf)+"\n"),buf.b+="vecX:     ",buf.b+=Std.string(Std.string(reg_vecX)+"\n"),buf.b+="vecY:     ",buf.b+=Std.string(Std.string(reg_vecY)+"\n"),buf.b+=Std.string("\n------------------------------ END OF DUMP ----\n"),sneaker_print_Printer.println_String(buf.b)}}break;case 1:switch(63&opcode1){case 0:var value30=scan.code.getInt32(scan.pc),this113=scan.pc+4;scan.pc=this113,reg_int=reg_int+value30|0;break;case 1:reg_int=reg_intBuf+reg_int;break;case 2:var value31=scan.code.getInt32(scan.pc),this114=scan.pc+4;scan.pc=this114,reg_int=reg_int-value31|0;break;case 3:var value32=scan.code.getInt32(scan.pc),this115=scan.pc+4;scan.pc=this115,reg_int=value32-reg_int|0;break;case 4:reg_int=reg_intBuf-reg_int;break;case 5:reg_int=-reg_int;break;case 6:var value33=scan.code.getInt32(scan.pc),this116=scan.pc+4;scan.pc=this116,reg_int=haxe_Int32._mul(reg_int,value33);break;case 7:reg_int*=reg_intBuf;break;case 8:var value34=scan.code.getInt32(scan.pc),this117=scan.pc+4;scan.pc=this117,reg_int=reg_int/value34|0;break;case 9:var value35=scan.code.getInt32(scan.pc),this118=scan.pc+4;scan.pc=this118,reg_int=value35/reg_int|0;break;case 10:reg_int=reg_intBuf/reg_int|0;break;case 11:var value36=scan.code.getInt32(scan.pc),this119=scan.pc+4;scan.pc=this119,reg_int%=value36;break;case 12:var value37=scan.code.getInt32(scan.pc),this120=scan.pc+4;scan.pc=this120,reg_int=value37%reg_int;break;case 13:reg_int=reg_intBuf%reg_int;break;case 14:var value38=scan.code.getDouble(scan.pc),this121=scan.pc+8;scan.pc=this121,reg_float+=value38;break;case 15:reg_float=reg_floatBuf+reg_float;break;case 16:var value39=scan.code.getDouble(scan.pc),this122=scan.pc+8;scan.pc=this122,reg_float-=value39;break;case 17:var value40=scan.code.getDouble(scan.pc),this123=scan.pc+8;scan.pc=this123,reg_float=value40-reg_float;break;case 18:reg_float=reg_floatBuf-reg_float;break;case 19:reg_float=-reg_float;break;case 20:var value41=scan.code.getDouble(scan.pc),this124=scan.pc+8;scan.pc=this124,reg_float*=value41;break;case 21:reg_float*=reg_floatBuf;break;case 22:var value42=scan.code.getDouble(scan.pc),this125=scan.pc+8;scan.pc=this125,reg_float/=value42;break;case 23:var value43=scan.code.getDouble(scan.pc),this126=scan.pc+8;scan.pc=this126,reg_float=value43/reg_float;break;case 24:reg_float=reg_floatBuf/reg_float;break;case 25:var value44=scan.code.getDouble(scan.pc),this127=scan.pc+8;scan.pc=this127,reg_float%=value44;break;case 26:var value45=scan.code.getDouble(scan.pc),this128=scan.pc+8;scan.pc=this128,reg_float=value45%reg_float;break;case 27:reg_float=reg_floatBuf%reg_float;break;case 28:reg_vecX=-reg_vecX,reg_vecY=-reg_vecY;break;case 29:var value46=scan.code.getDouble(scan.pc),this129=scan.pc+8;scan.pc=this129;reg_vecX*=value46,reg_vecY*=value46;break;case 30:reg_vecX*=reg_float,reg_vecY*=reg_float;break;case 31:reg_vecX/=reg_float,reg_vecY/=reg_float;break;case 32:reg_float=reg_int;break;case 33:reg_vecX=reg_floatBuf,reg_vecY=reg_float;break;case 34:var length=reg_floatBuf,angle=reg_float;reg_vecX=length*Math.sin(angle),reg_vecY=length*-Math.cos(angle);break;case 35:reg_float=Math.random();break;case 36:var value47=scan.code.getDouble(scan.pc),this130=scan.pc+8;scan.pc=this130,reg_float=value47*Math.random();break;case 37:reg_float*=Math.random();break;case 38:var value48=scan.code.getDouble(scan.pc),this131=scan.pc+8;scan.pc=this131,reg_float=value48*(2*Math.random()-1);break;case 39:reg_float*=2*Math.random()-1;break;case 40:var value49=scan.code.getInt32(scan.pc),this132=scan.pc+4;scan.pc=this132,reg_int=value49*Math.random()|0;break;case 41:reg_int=reg_int*Math.random()|0;break;case 42:var value50=scan.code.getInt32(scan.pc),this133=scan.pc+4;scan.pc=this133,reg_int=value50*(2*Math.random()-1)|0;break;case 43:reg_int=reg_int*(2*Math.random()-1)|0;break;case 44:reg_float=Math.sin(reg_float);break;case 45:reg_float=Math.cos(reg_float);break;case 46:var value51=scan.code.getInt32(scan.pc),this134=scan.pc+4;scan.pc=this134;var value52=scan.code.getInt32(scan.pc),this135=scan.pc+4;scan.pc=this135;var this136=mem_data,pos3=mem_capacity-value51-4;this136.setInt32(pos3,this136.getInt32(pos3)+value52|0);break;case 47:var value53=scan.code.getInt32(scan.pc),this140=scan.pc+4;scan.pc=this140;var this141=mem_data,pos4=mem_capacity-value53-4;this141.setInt32(pos4,this141.getInt32(pos4)+reg_int|0);break;case 48:var value54=scan.code.getInt32(scan.pc),this145=scan.pc+4;scan.pc=this145;var this146=mem_data,pos5=mem_capacity-value54-4;this146.setInt32(pos5,this146.getInt32(pos5)+1|0);break;case 49:var value55=scan.code.getInt32(scan.pc),this150=scan.pc+4;scan.pc=this150;var this151=mem_data,pos6=mem_capacity-value55-4;this151.setInt32(pos6,this151.getInt32(pos6)+-1|0);break;case 50:var value56=scan.code.getInt32(scan.pc),this155=scan.pc+4;scan.pc=this155;var value57=scan.code.getDouble(scan.pc),this156=scan.pc+8;scan.pc=this156;var this157=mem_data,pos7=mem_capacity-value56-8;this157.setDouble(pos7,this157.getDouble(pos7)+value57);break;case 51:var value58=scan.code.getInt32(scan.pc),this161=scan.pc+4;scan.pc=this161;var this162=mem_data,pos8=mem_capacity-value58-8;this162.setDouble(pos8,this162.getDouble(pos8)+reg_float)}break;case 2:switch(63&opcode1){case 0:reg_vecX=position_x,reg_vecY=position_y;break;case 1:var x1=position_x;y=position_y;reg_float=Math.sqrt(x1*x1+y*y);break;case 2:reg_float=Math.atan2(position_x,-position_y);break;case 3:reg_vecX=velocity_x,reg_vecY=velocity_y;break;case 4:var x2=velocity_x,y1=velocity_y;reg_float=Math.sqrt(x2*x2+y1*y1);break;case 5:reg_float=Math.atan2(velocity_x,-velocity_y);break;case 6:reg_vecX=thread.shotX,reg_vecY=thread.shotY;break;case 7:var x3=thread.shotX,y2=thread.shotY;reg_float=Math.sqrt(x3*x3+y2*y2);break;case 8:reg_float=Math.atan2(thread.shotX,-thread.shotY);break;case 9:reg_vecX=thread.shotVx,reg_vecY=thread.shotVy;break;case 10:var x4=thread.shotVx,y3=thread.shotVy;reg_float=Math.sqrt(x4*x4+y3*y3);break;case 11:reg_float=Math.atan2(thread.shotVx,-thread.shotVy);break;case 12:reg_vecX=targetPositionRef.x,reg_vecY=targetPositionRef.y;break;case 13:reg_float=targetPositionRef.x;break;case 14:reg_float=targetPositionRef.y;break;case 15:reg_float=Math.atan2(targetPositionRef.x-(position_originX+position_x+thread.shotX),-(targetPositionRef.y-(position_originY+position_y+thread.shotY)));break;case 16:var value59=scan.code.getDouble(scan.pc),this166=scan.pc+8;scan.pc=this166;var value60=scan.code.getDouble(scan.pc),this167=scan.pc+8;scan.pc=this167,reg_vecX=value59-position_x,reg_vecY=value60-position_y;break;case 17:var value61=scan.code.getDouble(scan.pc),this168=scan.pc+8;scan.pc=this168;var value62=scan.code.getDouble(scan.pc),this169=scan.pc+8;scan.pc=this169,reg_vecX=value61-velocity_x,reg_vecY=value62-velocity_y;break;case 18:reg_vecX-=position_x,reg_vecY-=position_y;break;case 19:reg_vecX-=velocity_x,reg_vecY-=velocity_y;break;case 20:var value63=scan.code.getDouble(scan.pc),this170=scan.pc+8;scan.pc=this170;var x5=position_x,y4=position_y;reg_float=value63-Math.sqrt(x5*x5+y4*y4);break;case 21:var angleA=Math.atan2(position_x,-position_y),value64=scan.code.getDouble(scan.pc),this171=scan.pc+8;scan.pc=this171;var angle1=value64-angleA;reg_float=angle1-6.283185307179586*Math.floor(.15915494309189535*(angle1+3.141592653589793));break;case 22:var value65=scan.code.getDouble(scan.pc),this172=scan.pc+8;scan.pc=this172;var x6=velocity_x,y5=velocity_y;reg_float=value65-Math.sqrt(x6*x6+y5*y5);break;case 23:var angleA1=Math.atan2(velocity_x,-velocity_y),value66=scan.code.getDouble(scan.pc),this173=scan.pc+8;scan.pc=this173;var angle2=value66-angleA1;reg_float=angle2-6.283185307179586*Math.floor(.15915494309189535*(angle2+3.141592653589793));break;case 24:var x7=position_x,y6=position_y;reg_float-=Math.sqrt(x7*x7+y6*y6);break;case 25:var angle3=reg_float-Math.atan2(position_x,-position_y);reg_float=angle3-6.283185307179586*Math.floor(.15915494309189535*(angle3+3.141592653589793));break;case 26:var x8=velocity_x,y7=velocity_y;reg_float-=Math.sqrt(x8*x8+y7*y7);break;case 27:var angle4=reg_float-Math.atan2(velocity_x,-velocity_y);reg_float=angle4-6.283185307179586*Math.floor(.15915494309189535*(angle4+3.141592653589793));break;case 28:var value67=scan.code.getDouble(scan.pc),this174=scan.pc+8;scan.pc=this174;var x9=value67-thread.shotX,value68=scan.code.getDouble(scan.pc),this175=scan.pc+8;scan.pc=this175,reg_vecX=x9,reg_vecY=value68-thread.shotY;break;case 29:var value69=scan.code.getDouble(scan.pc),this176=scan.pc+8;scan.pc=this176;var x10=value69-thread.shotVx,value70=scan.code.getDouble(scan.pc),this177=scan.pc+8;scan.pc=this177,reg_vecX=x10,reg_vecY=value70-thread.shotVy;break;case 30:reg_vecX-=thread.shotX,reg_vecY-=thread.shotY;break;case 31:reg_vecX-=thread.shotVx,reg_vecY-=thread.shotVy;break;case 32:var value71=scan.code.getDouble(scan.pc),this178=scan.pc+8;scan.pc=this178;var x11=thread.shotX,y8=thread.shotY;reg_float=value71-Math.sqrt(x11*x11+y8*y8);break;case 33:var angleA2=Math.atan2(thread.shotX,-thread.shotY),value72=scan.code.getDouble(scan.pc),this179=scan.pc+8;scan.pc=this179;var angle5=value72-angleA2;reg_float=angle5-6.283185307179586*Math.floor(.15915494309189535*(angle5+3.141592653589793));break;case 34:var value73=scan.code.getDouble(scan.pc),this180=scan.pc+8;scan.pc=this180;var x12=thread.shotVx,y9=thread.shotVy;reg_float=value73-Math.sqrt(x12*x12+y9*y9);break;case 35:var angleA3=Math.atan2(thread.shotVx,-thread.shotVy),value74=scan.code.getDouble(scan.pc),this181=scan.pc+8;scan.pc=this181;var angle6=value74-angleA3;reg_float=angle6-6.283185307179586*Math.floor(.15915494309189535*(angle6+3.141592653589793));break;case 36:var x13=thread.shotX,y10=thread.shotY;reg_float-=Math.sqrt(x13*x13+y10*y10);break;case 37:var angle7=reg_float-Math.atan2(thread.shotX,-thread.shotY);reg_float=angle7-6.283185307179586*Math.floor(.15915494309189535*(angle7+3.141592653589793));break;case 38:var x14=thread.shotVx,y11=thread.shotVy;reg_float-=Math.sqrt(x14*x14+y11*y11);break;case 39:var angle8=reg_float-Math.atan2(thread.shotVx,-thread.shotVy);reg_float=angle8-6.283185307179586*Math.floor(.15915494309189535*(angle8+3.141592653589793))}break;case 3:switch(63&opcode1){case 0:var value75=scan.code.getDouble(scan.pc),this182=scan.pc+8;scan.pc=this182;var value76=scan.code.getDouble(scan.pc),this183=scan.pc+8;scan.pc=this183,position_x=value75,position_y=value76;break;case 1:var value77=scan.code.getDouble(scan.pc),this184=scan.pc+8;scan.pc=this184;var value78=scan.code.getDouble(scan.pc),this185=scan.pc+8;scan.pc=this185,position_x+=value77,position_y+=value78;break;case 2:var value79=scan.code.getDouble(scan.pc),this186=scan.pc+8;scan.pc=this186;var value80=scan.code.getDouble(scan.pc),this187=scan.pc+8;scan.pc=this187,velocity_x=value79,velocity_y=value80;break;case 3:var value81=scan.code.getDouble(scan.pc),this188=scan.pc+8;scan.pc=this188;var value82=scan.code.getDouble(scan.pc),this189=scan.pc+8;scan.pc=this189,velocity_x+=value81,velocity_y+=value82;break;case 4:position_x=reg_vecX,position_y=reg_vecY;break;case 5:position_x+=reg_vecX,position_y+=reg_vecY;break;case 6:velocity_x=reg_vecX,velocity_y=reg_vecY;break;case 7:velocity_x+=reg_vecX,velocity_y+=reg_vecY;break;case 8:var this190=mem_data,this193=mem_sp-8-8,this194=mem_sp-8;position_x+=this190.getDouble(this193),position_y+=this190.getDouble(this194);break;case 9:var this195=mem_data,this198=mem_sp-8-8,this199=mem_sp-8;position_x+=this195.getDouble(this198),position_y+=this195.getDouble(this199);break;case 10:var value83=scan.code.getDouble(scan.pc),this200=scan.pc+8;scan.pc=this200;var value84=value83,angle9=Math.atan2(position_x,-position_y);position_x=value84*Math.sin(angle9),position_y=value84*-Math.cos(angle9);break;case 11:var value85=scan.code.getDouble(scan.pc),this201=scan.pc+8;scan.pc=this201;var x15=position_x,y12=position_y,curLen=Math.sqrt(x15*x15+y12*y12),curAngle=Math.atan2(x15,-y12),length1=curLen+value85;position_x=length1*Math.sin(curAngle),position_y=length1*-Math.cos(curAngle);break;case 12:var value86=reg_float,angle10=Math.atan2(position_x,-position_y);position_x=value86*Math.sin(angle10),position_y=value86*-Math.cos(angle10);break;case 13:var x16=position_x,y13=position_y,curLen1=Math.sqrt(x16*x16+y13*y13),curAngle1=Math.atan2(x16,-y13),length2=curLen1+reg_float;position_x=length2*Math.sin(curAngle1),position_y=length2*-Math.cos(curAngle1);break;case 14:var this202=mem_sp-8,value87=mem_data.getDouble(this202),x17=position_x,y14=position_y,curLen2=Math.sqrt(x17*x17+y14*y14),curAngle2=Math.atan2(x17,-y14),length3=curLen2+value87;position_x=length3*Math.sin(curAngle2),position_y=length3*-Math.cos(curAngle2);break;case 15:var value88=scan.code.getDouble(scan.pc),this203=scan.pc+8;scan.pc=this203;var value89=value88,x18=position_x,y15=position_y,length4=Math.sqrt(x18*x18+y15*y15);position_x=length4*Math.sin(value89),position_y=length4*-Math.cos(value89);break;case 16:var value90=scan.code.getDouble(scan.pc),this204=scan.pc+8;scan.pc=this204;var x19=position_x,y16=position_y,curLen3=Math.sqrt(x19*x19+y16*y16),angle11=Math.atan2(x19,-y16)+value90;position_x=curLen3*Math.sin(angle11),position_y=curLen3*-Math.cos(angle11);break;case 17:var value91=reg_float,x20=position_x,y17=position_y,length5=Math.sqrt(x20*x20+y17*y17);position_x=length5*Math.sin(value91),position_y=length5*-Math.cos(value91);break;case 18:var x21=position_x,y18=position_y,curLen4=Math.sqrt(x21*x21+y18*y18),angle12=Math.atan2(x21,-y18)+reg_float;position_x=curLen4*Math.sin(angle12),position_y=curLen4*-Math.cos(angle12);break;case 19:var this205=mem_sp-8,value92=mem_data.getDouble(this205),x22=position_x,y19=position_y,curLen5=Math.sqrt(x22*x22+y19*y19),angle13=Math.atan2(x22,-y19)+value92;position_x=curLen5*Math.sin(angle13),position_y=curLen5*-Math.cos(angle13);break;case 20:var value93=scan.code.getDouble(scan.pc),this206=scan.pc+8;scan.pc=this206;var value94=value93,angle14=Math.atan2(velocity_x,-velocity_y);velocity_x=value94*Math.sin(angle14),velocity_y=value94*-Math.cos(angle14);break;case 21:var value95=scan.code.getDouble(scan.pc),this207=scan.pc+8;scan.pc=this207;var x23=velocity_x,y20=velocity_y,curLen6=Math.sqrt(x23*x23+y20*y20),curAngle6=Math.atan2(x23,-y20),length6=curLen6+value95;velocity_x=length6*Math.sin(curAngle6),velocity_y=length6*-Math.cos(curAngle6);break;case 22:var value96=reg_float,angle15=Math.atan2(velocity_x,-velocity_y);velocity_x=value96*Math.sin(angle15),velocity_y=value96*-Math.cos(angle15);break;case 23:var x24=velocity_x,y21=velocity_y,curLen7=Math.sqrt(x24*x24+y21*y21),curAngle7=Math.atan2(x24,-y21),length7=curLen7+reg_float;velocity_x=length7*Math.sin(curAngle7),velocity_y=length7*-Math.cos(curAngle7);break;case 24:var this208=mem_sp-8,value97=mem_data.getDouble(this208),x25=velocity_x,y22=velocity_y,curLen8=Math.sqrt(x25*x25+y22*y22),curAngle8=Math.atan2(x25,-y22),length8=curLen8+value97;velocity_x=length8*Math.sin(curAngle8),velocity_y=length8*-Math.cos(curAngle8);break;case 25:var value98=scan.code.getDouble(scan.pc),this209=scan.pc+8;scan.pc=this209;var value99=value98,x26=velocity_x,y23=velocity_y,length9=Math.sqrt(x26*x26+y23*y23);velocity_x=length9*Math.sin(value99),velocity_y=length9*-Math.cos(value99);break;case 26:var value100=scan.code.getDouble(scan.pc),this210=scan.pc+8;scan.pc=this210;var x27=velocity_x,y24=velocity_y,curLen9=Math.sqrt(x27*x27+y24*y24),angle16=Math.atan2(x27,-y24)+value100;velocity_x=curLen9*Math.sin(angle16),velocity_y=curLen9*-Math.cos(angle16);break;case 27:var value101=reg_float,x28=velocity_x,y25=velocity_y,length10=Math.sqrt(x28*x28+y25*y25);velocity_x=length10*Math.sin(value101),velocity_y=length10*-Math.cos(value101);break;case 28:var x29=velocity_x,y26=velocity_y,curLen10=Math.sqrt(x29*x29+y26*y26),angle17=Math.atan2(x29,-y26)+reg_float;velocity_x=curLen10*Math.sin(angle17),velocity_y=curLen10*-Math.cos(angle17);break;case 29:var this211=mem_sp-8,value102=mem_data.getDouble(this211),x30=velocity_x,y27=velocity_y,curLen11=Math.sqrt(x30*x30+y27*y27),angle18=Math.atan2(x30,-y27)+value102;velocity_x=curLen11*Math.sin(angle18),velocity_y=curLen11*-Math.cos(angle18);break;case 30:var value103=scan.code.getDouble(scan.pc),this212=scan.pc+8;scan.pc=this212;var value104=scan.code.getDouble(scan.pc),this213=scan.pc+8;scan.pc=this213,thread.shotX=value103,thread.shotY=value104;break;case 31:var value105=scan.code.getDouble(scan.pc),this214=scan.pc+8;scan.pc=this214;var value106=scan.code.getDouble(scan.pc),this215=scan.pc+8;scan.pc=this215,thread.shotX+=value105,thread.shotY+=value106;break;case 32:var value107=scan.code.getDouble(scan.pc),this216=scan.pc+8;scan.pc=this216;var value108=scan.code.getDouble(scan.pc),this217=scan.pc+8;scan.pc=this217,thread.shotVx=value107,thread.shotVy=value108;break;case 33:var value109=scan.code.getDouble(scan.pc),this218=scan.pc+8;scan.pc=this218;var value110=scan.code.getDouble(scan.pc),this219=scan.pc+8;scan.pc=this219,thread.shotVx+=value109,thread.shotVy+=value110;break;case 34:thread.shotX=reg_vecX,thread.shotY=reg_vecY;break;case 35:thread.shotX+=reg_vecX,thread.shotY+=reg_vecY;break;case 36:thread.shotVx=reg_vecX,thread.shotVy=reg_vecY;break;case 37:thread.shotVx+=reg_vecX,thread.shotVy+=reg_vecY;break;case 38:var this220=mem_data,this223=mem_sp-8-8,this224=mem_sp-8,vec_x4=this220.getDouble(this223),vec_y4=this220.getDouble(this224);thread.shotX+=vec_x4,thread.shotY+=vec_y4;break;case 39:var this225=mem_data,this228=mem_sp-8-8,this229=mem_sp-8,vec_x5=this225.getDouble(this228),vec_y5=this225.getDouble(this229);thread.shotVx+=vec_x5,thread.shotVy+=vec_y5;break;case 40:var value111=scan.code.getDouble(scan.pc),this230=scan.pc+8;scan.pc=this230;var value112=value111,angle19=Math.atan2(thread.shotX,-thread.shotY),newPosition_x10=value112*Math.sin(angle19),newPosition_y10=value112*-Math.cos(angle19);thread.shotX=newPosition_x10,thread.shotY=newPosition_y10;break;case 41:var value113=scan.code.getDouble(scan.pc),this231=scan.pc+8;scan.pc=this231;var x31=thread.shotX,y28=thread.shotY,curLen12=Math.sqrt(x31*x31+y28*y28),curAngle12=Math.atan2(x31,-y28),length11=curLen12+value113,newPosition_x11=length11*Math.sin(curAngle12),newPosition_y11=length11*-Math.cos(curAngle12);thread.shotX=newPosition_x11,thread.shotY=newPosition_y11;break;case 42:var value114=reg_float,angle20=Math.atan2(thread.shotX,-thread.shotY),newPosition_x12=value114*Math.sin(angle20),newPosition_y12=value114*-Math.cos(angle20);thread.shotX=newPosition_x12,thread.shotY=newPosition_y12;break;case 43:var x32=thread.shotX,y29=thread.shotY,curLen13=Math.sqrt(x32*x32+y29*y29),curAngle13=Math.atan2(x32,-y29),length12=curLen13+reg_float,newPosition_x13=length12*Math.sin(curAngle13),newPosition_y13=length12*-Math.cos(curAngle13);thread.shotX=newPosition_x13,thread.shotY=newPosition_y13;break;case 44:var this232=mem_sp-8,value115=mem_data.getDouble(this232),x33=thread.shotX,y30=thread.shotY,curLen14=Math.sqrt(x33*x33+y30*y30),curAngle14=Math.atan2(x33,-y30),length13=curLen14+value115,newPosition_x14=length13*Math.sin(curAngle14),newPosition_y14=length13*-Math.cos(curAngle14);thread.shotX=newPosition_x14,thread.shotY=newPosition_y14;break;case 45:var value116=scan.code.getDouble(scan.pc),this233=scan.pc+8;scan.pc=this233;var value117=value116,x34=thread.shotX,y31=thread.shotY,length14=Math.sqrt(x34*x34+y31*y31),newPosition_x15=length14*Math.sin(value117),newPosition_y15=length14*-Math.cos(value117);thread.shotX=newPosition_x15,thread.shotY=newPosition_y15;break;case 46:var value118=scan.code.getDouble(scan.pc),this234=scan.pc+8;scan.pc=this234;var x35=thread.shotX,y32=thread.shotY,curLen15=Math.sqrt(x35*x35+y32*y32),angle21=Math.atan2(x35,-y32)+value118,newPosition_x16=curLen15*Math.sin(angle21),newPosition_y16=curLen15*-Math.cos(angle21);thread.shotX=newPosition_x16,thread.shotY=newPosition_y16;break;case 47:var value119=reg_float,x36=thread.shotX,y33=thread.shotY,length15=Math.sqrt(x36*x36+y33*y33),newPosition_x17=length15*Math.sin(value119),newPosition_y17=length15*-Math.cos(value119);thread.shotX=newPosition_x17,thread.shotY=newPosition_y17;break;case 48:var x37=thread.shotX,y34=thread.shotY,curLen16=Math.sqrt(x37*x37+y34*y34),angle22=Math.atan2(x37,-y34)+reg_float,newPosition_x18=curLen16*Math.sin(angle22),newPosition_y18=curLen16*-Math.cos(angle22);thread.shotX=newPosition_x18,thread.shotY=newPosition_y18;break;case 49:var this235=mem_sp-8,value120=mem_data.getDouble(this235),x38=thread.shotX,y35=thread.shotY,curLen17=Math.sqrt(x38*x38+y35*y35),angle23=Math.atan2(x38,-y35)+value120,newPosition_x19=curLen17*Math.sin(angle23),newPosition_y19=curLen17*-Math.cos(angle23);thread.shotX=newPosition_x19,thread.shotY=newPosition_y19;break;case 50:var value121=scan.code.getDouble(scan.pc),this236=scan.pc+8;scan.pc=this236;var value122=value121,angle24=Math.atan2(thread.shotVx,-thread.shotVy),newVelocity_x10=value122*Math.sin(angle24),newVelocity_y10=value122*-Math.cos(angle24);thread.shotVx=newVelocity_x10,thread.shotVy=newVelocity_y10;break;case 51:var value123=scan.code.getDouble(scan.pc),this237=scan.pc+8;scan.pc=this237;var x39=thread.shotVx,y36=thread.shotVy,curLen18=Math.sqrt(x39*x39+y36*y36),curAngle18=Math.atan2(x39,-y36),length16=curLen18+value123,newVelocity_x11=length16*Math.sin(curAngle18),newVelocity_y11=length16*-Math.cos(curAngle18);thread.shotVx=newVelocity_x11,thread.shotVy=newVelocity_y11;break;case 52:var value124=reg_float,angle25=Math.atan2(thread.shotVx,-thread.shotVy),newVelocity_x12=value124*Math.sin(angle25),newVelocity_y12=value124*-Math.cos(angle25);thread.shotVx=newVelocity_x12,thread.shotVy=newVelocity_y12;break;case 53:var x40=thread.shotVx,y37=thread.shotVy,curLen19=Math.sqrt(x40*x40+y37*y37),curAngle19=Math.atan2(x40,-y37),length17=curLen19+reg_float,newVelocity_x13=length17*Math.sin(curAngle19),newVelocity_y13=length17*-Math.cos(curAngle19);thread.shotVx=newVelocity_x13,thread.shotVy=newVelocity_y13;break;case 54:var this238=mem_sp-8,value125=mem_data.getDouble(this238),x41=thread.shotVx,y38=thread.shotVy,curLen20=Math.sqrt(x41*x41+y38*y38),curAngle20=Math.atan2(x41,-y38),length18=curLen20+value125,newVelocity_x14=length18*Math.sin(curAngle20),newVelocity_y14=length18*-Math.cos(curAngle20);thread.shotVx=newVelocity_x14,thread.shotVy=newVelocity_y14;break;case 55:var value126=scan.code.getDouble(scan.pc),this239=scan.pc+8;scan.pc=this239;var value127=value126,x42=thread.shotVx,y39=thread.shotVy,length19=Math.sqrt(x42*x42+y39*y39),newVelocity_x15=length19*Math.sin(value127),newVelocity_y15=length19*-Math.cos(value127);thread.shotVx=newVelocity_x15,thread.shotVy=newVelocity_y15;break;case 56:var value128=scan.code.getDouble(scan.pc),this240=scan.pc+8;scan.pc=this240;var x43=thread.shotVx,y40=thread.shotVy,curLen21=Math.sqrt(x43*x43+y40*y40),angle26=Math.atan2(x43,-y40)+value128,newVelocity_x16=curLen21*Math.sin(angle26),newVelocity_y16=curLen21*-Math.cos(angle26);thread.shotVx=newVelocity_x16,thread.shotVy=newVelocity_y16;break;case 57:var value129=reg_float,x44=thread.shotVx,y41=thread.shotVy,length20=Math.sqrt(x44*x44+y41*y41),newVelocity_x17=length20*Math.sin(value129),newVelocity_y17=length20*-Math.cos(value129);thread.shotVx=newVelocity_x17,thread.shotVy=newVelocity_y17;break;case 58:var x45=thread.shotVx,y42=thread.shotVy,curLen22=Math.sqrt(x45*x45+y42*y42),angle27=Math.atan2(x45,-y42)+reg_float,newVelocity_x18=curLen22*Math.sin(angle27),newVelocity_y18=curLen22*-Math.cos(angle27);thread.shotVx=newVelocity_x18,thread.shotVy=newVelocity_y18;break;case 59:var this241=mem_sp-8,value130=mem_data.getDouble(this241),x46=thread.shotVx,y43=thread.shotVy,curLen23=Math.sqrt(x46*x46+y43*y43),angle28=Math.atan2(x46,-y43)+value130,newVelocity_x19=curLen23*Math.sin(angle28),newVelocity_y19=curLen23*-Math.cos(angle28);thread.shotVx=newVelocity_x19,thread.shotVy=newVelocity_y19}}}thread.programCounter=scan.pc,thread.stackPointer=mem_sp}}if(position_x+=velocity_x,position_y+=velocity_y,xVec[vecIndex]=position_originX+position_x,yVec[vecIndex]=position_originY+position_y,vxVec[vecIndex]=velocity_x,vyVec[vecIndex]=velocity_y,deactivateAllThreads)for(var len=threads.length,i=0;i<len;){var _this=threads[i];_this.active=!1;this1=null;_this.code=this1,++i}return endCode};var firedancer_vm_internal_DataRegisterFile=function(){};$hxClasses["firedancer.vm.internal.DataRegisterFile"]=firedancer_vm_internal_DataRegisterFile,firedancer_vm_internal_DataRegisterFile.__name__="firedancer.vm.internal.DataRegisterFile",firedancer_vm_internal_DataRegisterFile.prototype={__class__:firedancer_vm_internal_DataRegisterFile};var firedancer_vm_internal_Memory=function(capacity){this.capacity=capacity};$hxClasses["firedancer.vm.internal.Memory"]=firedancer_vm_internal_Memory,firedancer_vm_internal_Memory.__name__="firedancer.vm.internal.Memory",firedancer_vm_internal_Memory.prototype={__class__:firedancer_vm_internal_Memory};var firedancer_vm_internal_Scanner=function(){};$hxClasses["firedancer.vm.internal.Scanner"]=firedancer_vm_internal_Scanner,firedancer_vm_internal_Scanner.__name__="firedancer.vm.internal.Scanner",firedancer_vm_internal_Scanner.prototype={__class__:firedancer_vm_internal_Scanner};var format_gif_Block=$hxEnums["format.gif.Block"]={__ename__:"format.gif.Block",__constructs__:["BFrame","BExtension","BEOF"],BFrame:($_=function(frame){return{_hx_index:0,frame:frame,__enum__:"format.gif.Block",toString:$estr}},$_.__params__=["frame"],$_),BExtension:($_=function(extension){return{_hx_index:1,extension:extension,__enum__:"format.gif.Block",toString:$estr}},$_.__params__=["extension"],$_),BEOF:{_hx_index:2,__enum__:"format.gif.Block",toString:$estr}};format_gif_Block.__empty_constructs__=[format_gif_Block.BEOF];var format_gif_Extension=$hxEnums["format.gif.Extension"]={__ename__:"format.gif.Extension",__constructs__:["EGraphicControl","EComment","EText","EApplicationExtension","EUnknown"],EGraphicControl:($_=function(gce){return{_hx_index:0,gce:gce,__enum__:"format.gif.Extension",toString:$estr}},$_.__params__=["gce"],$_),EComment:($_=function(text){return{_hx_index:1,text:text,__enum__:"format.gif.Extension",toString:$estr}},$_.__params__=["text"],$_),EText:($_=function(pte){return{_hx_index:2,pte:pte,__enum__:"format.gif.Extension",toString:$estr}},$_.__params__=["pte"],$_),EApplicationExtension:($_=function(ext){return{_hx_index:3,ext:ext,__enum__:"format.gif.Extension",toString:$estr}},$_.__params__=["ext"],$_),EUnknown:($_=function(id,data){return{_hx_index:4,id:id,data:data,__enum__:"format.gif.Extension",toString:$estr}},$_.__params__=["id","data"],$_)};format_gif_Extension.__empty_constructs__=[];var format_gif_ApplicationExtension=$hxEnums["format.gif.ApplicationExtension"]={__ename__:"format.gif.ApplicationExtension",__constructs__:["AENetscapeLooping","AEUnknown"],AENetscapeLooping:($_=function(loops){return{_hx_index:0,loops:loops,__enum__:"format.gif.ApplicationExtension",toString:$estr}},$_.__params__=["loops"],$_),AEUnknown:($_=function(name,version,data){return{_hx_index:1,name:name,version:version,data:data,__enum__:"format.gif.ApplicationExtension",toString:$estr}},$_.__params__=["name","version","data"],$_)};format_gif_ApplicationExtension.__empty_constructs__=[];var format_gif_Version=$hxEnums["format.gif.Version"]={__ename__:"format.gif.Version",__constructs__:["GIF87a","GIF89a","Unknown"],GIF87a:{_hx_index:0,__enum__:"format.gif.Version",toString:$estr},GIF89a:{_hx_index:1,__enum__:"format.gif.Version",toString:$estr},Unknown:($_=function(version){return{_hx_index:2,version:version,__enum__:"format.gif.Version",toString:$estr}},$_.__params__=["version"],$_)};format_gif_Version.__empty_constructs__=[format_gif_Version.GIF87a,format_gif_Version.GIF89a];var format_gif_DisposalMethod=$hxEnums["format.gif.DisposalMethod"]={__ename__:"format.gif.DisposalMethod",__constructs__:["UNSPECIFIED","NO_ACTION","FILL_BACKGROUND","RENDER_PREVIOUS","UNDEFINED"],UNSPECIFIED:{_hx_index:0,__enum__:"format.gif.DisposalMethod",toString:$estr},NO_ACTION:{_hx_index:1,__enum__:"format.gif.DisposalMethod",toString:$estr},FILL_BACKGROUND:{_hx_index:2,__enum__:"format.gif.DisposalMethod",toString:$estr},RENDER_PREVIOUS:{_hx_index:3,__enum__:"format.gif.DisposalMethod",toString:$estr},UNDEFINED:($_=function(index){return{_hx_index:4,index:index,__enum__:"format.gif.DisposalMethod",toString:$estr}},$_.__params__=["index"],$_)};format_gif_DisposalMethod.__empty_constructs__=[format_gif_DisposalMethod.UNSPECIFIED,format_gif_DisposalMethod.NO_ACTION,format_gif_DisposalMethod.FILL_BACKGROUND,format_gif_DisposalMethod.RENDER_PREVIOUS];var format_gif_Reader=function(i){this.i=i,i.set_bigEndian(!1)};$hxClasses["format.gif.Reader"]=format_gif_Reader,format_gif_Reader.__name__="format.gif.Reader",format_gif_Reader.prototype={read:function(){var b=71;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=73;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=70;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");var gifVer=this.i.readString(3),version=format_gif_Version.GIF89a;switch(gifVer){case"87a":version=format_gif_Version.GIF87a;break;case"89a":version=format_gif_Version.GIF89a;break;default:version=format_gif_Version.Unknown(gifVer)}var width=this.i.readUInt16(),height=this.i.readUInt16(),packedField=this.i.readByte(),bgIndex=this.i.readByte(),pixelAspectRatio=this.i.readByte(),lsd={width:width,height:height,hasGlobalColorTable:128==(128&packedField),colorResolution:(112&packedField)>>>4,sorted:8==(8&packedField),globalColorTableSize:2<<(7&packedField),backgroundColorIndex:bgIndex,pixelAspectRatio:pixelAspectRatio=0!=pixelAspectRatio?(pixelAspectRatio+15)/64:1},gct=null;lsd.hasGlobalColorTable&&(gct=this.readColorTable(lsd.globalColorTableSize));for(var blocks=new haxe_ds_List;;){b=this.readBlock();if(blocks.add(b),b==format_gif_Block.BEOF)break}return{version:version,logicalScreenDescriptor:lsd,globalColorTable:gct,blocks:blocks}},readBlock:function(){switch(this.i.readByte()){case 33:return this.readExtension();case 44:return this.readImage();case 59:return format_gif_Block.BEOF}return format_gif_Block.BEOF},readImage:function(){var x=this.i.readUInt16(),y=this.i.readUInt16(),width=this.i.readUInt16(),height=this.i.readUInt16(),packed=this.i.readByte(),localColorTable=128==(128&packed),interlaced=64==(64&packed),sorted=32==(32&packed),localColorTableSize=2<<(7&packed),lct=null;return localColorTable&&(lct=this.readColorTable(localColorTableSize)),format_gif_Block.BFrame({x:x,y:y,width:width,height:height,localColorTable:localColorTable,interlaced:interlaced,sorted:sorted,localColorTableSize:localColorTableSize,pixels:this.readPixels(width,height,interlaced),colorTable:lct})},readPixels:function(width,height,interlaced){for(var input=this.i,pixelsCount=width*height,pixels=new haxe_io_Bytes(new ArrayBuffer(pixelsCount)),minCodeSize=input.readByte(),blockSize=input.readByte()-1,bits=input.readByte(),bitsCount=8,clearCode=1<<minCodeSize,eoiCode=clearCode+1,codeSize=minCodeSize+1,codeSizeLimit=1<<codeSize,codeMask=codeSizeLimit-1,baseDict=[],_g=0,_g1=clearCode;_g<_g1;){baseDict[i=_g++]=[i]}for(var newRecord,last,dict=[],dictLen=clearCode+2,i=0,code=0;i<pixelsCount;){for(last=code;bitsCount<codeSize&&0!=blockSize;)bits|=input.readByte()<<bitsCount,bitsCount+=8,0==--blockSize&&(blockSize=input.readByte());if(code=bits&codeMask,bits>>=codeSize,bitsCount-=codeSize,code!=clearCode){if(code==eoiCode)break;if(code<dictLen)last!=clearCode&&((newRecord=dict[last].slice()).push(dict[code][0]),dict[dictLen++]=newRecord);else{if(code!=dictLen)throw haxe_Exception.thrown("Invalid LZW code. Excepted: "+dictLen+", got: "+code);(newRecord=dict[last].slice()).push(newRecord[0]),dict[dictLen++]=newRecord}newRecord=dict[code];for(_g=0;_g<newRecord.length;){var item=newRecord[_g];++_g,pixels.b[i++]=item}dictLen==codeSizeLimit&&codeSize<12&&(codeMask=(codeSizeLimit=1<<++codeSize)-1)}else dict=baseDict.slice(),dictLen=clearCode+2,codeMask=(codeSizeLimit=1<<(codeSize=minCodeSize+1))-1}for(;blockSize>0;)input.readByte(),0==--blockSize&&(blockSize=input.readByte());for(;i<pixelsCount;)pixels.b[i++]=0;if(interlaced){var buffer=new haxe_io_Bytes(new ArrayBuffer(pixelsCount)),offset=this.deinterlace(pixels,buffer,8,0,0,width,height);offset=this.deinterlace(pixels,buffer,8,4,offset,width,height),offset=this.deinterlace(pixels,buffer,4,2,offset,width,height),this.deinterlace(pixels,buffer,2,1,offset,width,height),pixels=buffer}return pixels},deinterlace:function(input,output,step,y,offset,width,height){for(;y<height;)output.blit(y*width,input,offset,width),offset+=width,y+=step;return offset},readExtension:function(){var subId=this.i.readByte();switch(subId){case 1:if(12!=this.i.readByte())throw haxe_Exception.thrown("Incorrect size of Plain Text Extension introducer block.");for(var tmp=this.i.readUInt16(),tmp1=this.i.readUInt16(),tmp2=this.i.readUInt16(),tmp3=this.i.readUInt16(),tmp4=this.i.readByte(),tmp5=this.i.readByte(),tmp6=this.i.readByte(),tmp7=this.i.readByte(),buffer=new haxe_io_BytesOutput,bytes=new haxe_io_Bytes(new ArrayBuffer(255)),len=this.i.readByte();0!=len;)this.i.readBytes(bytes,0,len),buffer.writeBytes(bytes,0,len),len=this.i.readByte();return buffer.flush(),bytes=buffer.getBytes(),buffer.close(),format_gif_Block.BExtension(format_gif_Extension.EText({textGridX:tmp,textGridY:tmp1,textGridWidth:tmp2,textGridHeight:tmp3,charCellWidth:tmp4,charCellHeight:tmp5,textForegroundColorIndex:tmp6,textBackgroundColorIndex:tmp7,text:bytes.toString()}));case 249:if(4!=this.i.readByte())throw haxe_Exception.thrown("Incorrect Graphic Control Extension block size!");var disposalMethod,packed=this.i.readByte();switch((28&packed)>>2){case 0:disposalMethod=format_gif_DisposalMethod.UNSPECIFIED;break;case 1:disposalMethod=format_gif_DisposalMethod.NO_ACTION;break;case 2:disposalMethod=format_gif_DisposalMethod.FILL_BACKGROUND;break;case 3:disposalMethod=format_gif_DisposalMethod.RENDER_PREVIOUS;break;default:disposalMethod=format_gif_DisposalMethod.UNDEFINED((28&packed)>>2)}var b=format_gif_Block.BExtension(format_gif_Extension.EGraphicControl({disposalMethod:disposalMethod,userInput:2==(2&packed),hasTransparentColor:1==(1&packed),delay:this.i.readUInt16(),transparentIndex:this.i.readByte()}));return this.i.readByte(),b;case 254:for(buffer=new haxe_io_BytesOutput,bytes=new haxe_io_Bytes(new ArrayBuffer(255)),len=this.i.readByte();0!=len;)this.i.readBytes(bytes,0,len),buffer.writeBytes(bytes,0,len),len=this.i.readByte();return buffer.flush(),bytes=buffer.getBytes(),buffer.close(),format_gif_Block.BExtension(format_gif_Extension.EComment(bytes.toString()));case 255:return this.readApplicationExtension();default:for(buffer=new haxe_io_BytesOutput,bytes=new haxe_io_Bytes(new ArrayBuffer(255)),len=this.i.readByte();0!=len;)this.i.readBytes(bytes,0,len),buffer.writeBytes(bytes,0,len),len=this.i.readByte();return buffer.flush(),bytes=buffer.getBytes(),buffer.close(),format_gif_Block.BExtension(format_gif_Extension.EUnknown(subId,bytes))}},readApplicationExtension:function(){if(11!=this.i.readByte())throw haxe_Exception.thrown("Incorrect size of Application Extension introducer block.");for(var name=this.i.readString(8),version=this.i.readString(3),buffer=new haxe_io_BytesOutput,bytes=new haxe_io_Bytes(new ArrayBuffer(255)),len=this.i.readByte();0!=len;)this.i.readBytes(bytes,0,len),buffer.writeBytes(bytes,0,len),len=this.i.readByte();buffer.flush(),bytes=buffer.getBytes(),buffer.close();var data=bytes;return"NETSCAPE"==name&&"2.0"==version&&1==data.b[0]?format_gif_Block.BExtension(format_gif_Extension.EApplicationExtension(format_gif_ApplicationExtension.AENetscapeLooping(data.b[1]|data.b[2]<<8))):format_gif_Block.BExtension(format_gif_Extension.EApplicationExtension(format_gif_ApplicationExtension.AEUnknown(name,version,data)))},readColorTable:function(size){size*=3;for(var output=new haxe_io_Bytes(new ArrayBuffer(size)),c=0;c<size;){var v=this.i.readByte();output.b[c]=v;var v1=this.i.readByte();output.b[c+1]=v1;var v2=this.i.readByte();output.b[c+2]=v2,c+=3}return output},__class__:format_gif_Reader};var format_gif_Tools=function(){};$hxClasses["format.gif.Tools"]=format_gif_Tools,format_gif_Tools.__name__="format.gif.Tools",format_gif_Tools.extractFullBGRA=function(data,frameIndex){for(var gce=null,frameCaret=0,bytes=new haxe_io_Bytes(new ArrayBuffer(data.logicalScreenDescriptor.width*data.logicalScreenDescriptor.height*4)),_g_head=data.blocks.h;null!=_g_head;){var val=_g_head.item;_g_head=_g_head.next;var block=val;switch(block._hx_index){case 0:var frame=block.frame,ct=frame.localColorTable?frame.colorTable:data.globalColorTable;if(null==ct)throw haxe_Exception.thrown("Frame does not have a color table!");var transparentIndex=null!=gce&&gce.hasTransparentColor?3*gce.transparentIndex:-1,pixels=frame.pixels,x=0,writeCaret=4*(frame.y*data.logicalScreenDescriptor.width+frame.x),lineSkip=4*(data.logicalScreenDescriptor.width-frame.width)+4;switch((frameCaret!=frameIndex&&null!=gce?gce.disposalMethod:format_gif_DisposalMethod.NO_ACTION)._hx_index){case 2:for(var _g=0,_g1=pixels.length;_g<_g1;){_g++;bytes.b[writeCaret]=0,bytes.b[writeCaret+1]=0,bytes.b[writeCaret+2]=0,bytes.b[writeCaret+3]=0,++x==frame.width?(x=0,writeCaret+=lineSkip):writeCaret+=4}break;case 3:break;default:for(var _g2=0,_g3=pixels.length;_g2<_g3;){var i1=_g2++,index=3*pixels.b[i1];transparentIndex!=index&&(bytes.b[writeCaret]=ct.b[index+2],bytes.b[writeCaret+1]=ct.b[index+1],bytes.b[writeCaret+2]=ct.b[index],bytes.b[writeCaret+3]=255),++x==frame.width?(x=0,writeCaret+=lineSkip):writeCaret+=4}}if(frameCaret==frameIndex)return bytes;++frameCaret,gce=null;break;case 1:var ext=block.extension;if(0==ext._hx_index)gce=ext.gce}}return bytes};var format_mp3_SamplingRate=$hxEnums["format.mp3.SamplingRate"]={__ename__:"format.mp3.SamplingRate",__constructs__:["SR_8000","SR_11025","SR_12000","SR_22050","SR_24000","SR_32000","SR_44100","SR_48000","SR_Bad"],SR_8000:{_hx_index:0,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_11025:{_hx_index:1,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_12000:{_hx_index:2,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_22050:{_hx_index:3,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_24000:{_hx_index:4,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_32000:{_hx_index:5,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_44100:{_hx_index:6,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_48000:{_hx_index:7,__enum__:"format.mp3.SamplingRate",toString:$estr},SR_Bad:{_hx_index:8,__enum__:"format.mp3.SamplingRate",toString:$estr}};format_mp3_SamplingRate.__empty_constructs__=[format_mp3_SamplingRate.SR_8000,format_mp3_SamplingRate.SR_11025,format_mp3_SamplingRate.SR_12000,format_mp3_SamplingRate.SR_22050,format_mp3_SamplingRate.SR_24000,format_mp3_SamplingRate.SR_32000,format_mp3_SamplingRate.SR_44100,format_mp3_SamplingRate.SR_48000,format_mp3_SamplingRate.SR_Bad];var format_mp3_Bitrate=$hxEnums["format.mp3.Bitrate"]={__ename__:"format.mp3.Bitrate",__constructs__:["BR_8","BR_16","BR_24","BR_32","BR_40","BR_48","BR_56","BR_64","BR_80","BR_96","BR_112","BR_128","BR_144","BR_160","BR_176","BR_192","BR_224","BR_256","BR_288","BR_320","BR_352","BR_384","BR_416","BR_448","BR_Free","BR_Bad"],BR_8:{_hx_index:0,__enum__:"format.mp3.Bitrate",toString:$estr},BR_16:{_hx_index:1,__enum__:"format.mp3.Bitrate",toString:$estr},BR_24:{_hx_index:2,__enum__:"format.mp3.Bitrate",toString:$estr},BR_32:{_hx_index:3,__enum__:"format.mp3.Bitrate",toString:$estr},BR_40:{_hx_index:4,__enum__:"format.mp3.Bitrate",toString:$estr},BR_48:{_hx_index:5,__enum__:"format.mp3.Bitrate",toString:$estr},BR_56:{_hx_index:6,__enum__:"format.mp3.Bitrate",toString:$estr},BR_64:{_hx_index:7,__enum__:"format.mp3.Bitrate",toString:$estr},BR_80:{_hx_index:8,__enum__:"format.mp3.Bitrate",toString:$estr},BR_96:{_hx_index:9,__enum__:"format.mp3.Bitrate",toString:$estr},BR_112:{_hx_index:10,__enum__:"format.mp3.Bitrate",toString:$estr},BR_128:{_hx_index:11,__enum__:"format.mp3.Bitrate",toString:$estr},BR_144:{_hx_index:12,__enum__:"format.mp3.Bitrate",toString:$estr},BR_160:{_hx_index:13,__enum__:"format.mp3.Bitrate",toString:$estr},BR_176:{_hx_index:14,__enum__:"format.mp3.Bitrate",toString:$estr},BR_192:{_hx_index:15,__enum__:"format.mp3.Bitrate",toString:$estr},BR_224:{_hx_index:16,__enum__:"format.mp3.Bitrate",toString:$estr},BR_256:{_hx_index:17,__enum__:"format.mp3.Bitrate",toString:$estr},BR_288:{_hx_index:18,__enum__:"format.mp3.Bitrate",toString:$estr},BR_320:{_hx_index:19,__enum__:"format.mp3.Bitrate",toString:$estr},BR_352:{_hx_index:20,__enum__:"format.mp3.Bitrate",toString:$estr},BR_384:{_hx_index:21,__enum__:"format.mp3.Bitrate",toString:$estr},BR_416:{_hx_index:22,__enum__:"format.mp3.Bitrate",toString:$estr},BR_448:{_hx_index:23,__enum__:"format.mp3.Bitrate",toString:$estr},BR_Free:{_hx_index:24,__enum__:"format.mp3.Bitrate",toString:$estr},BR_Bad:{_hx_index:25,__enum__:"format.mp3.Bitrate",toString:$estr}};format_mp3_Bitrate.__empty_constructs__=[format_mp3_Bitrate.BR_8,format_mp3_Bitrate.BR_16,format_mp3_Bitrate.BR_24,format_mp3_Bitrate.BR_32,format_mp3_Bitrate.BR_40,format_mp3_Bitrate.BR_48,format_mp3_Bitrate.BR_56,format_mp3_Bitrate.BR_64,format_mp3_Bitrate.BR_80,format_mp3_Bitrate.BR_96,format_mp3_Bitrate.BR_112,format_mp3_Bitrate.BR_128,format_mp3_Bitrate.BR_144,format_mp3_Bitrate.BR_160,format_mp3_Bitrate.BR_176,format_mp3_Bitrate.BR_192,format_mp3_Bitrate.BR_224,format_mp3_Bitrate.BR_256,format_mp3_Bitrate.BR_288,format_mp3_Bitrate.BR_320,format_mp3_Bitrate.BR_352,format_mp3_Bitrate.BR_384,format_mp3_Bitrate.BR_416,format_mp3_Bitrate.BR_448,format_mp3_Bitrate.BR_Free,format_mp3_Bitrate.BR_Bad];var format_mp3_MPEG=function(){};$hxClasses["format.mp3.MPEG"]=format_mp3_MPEG,format_mp3_MPEG.__name__="format.mp3.MPEG",format_mp3_MPEG.enum2Num=function(m){switch(m._hx_index){case 0:return 3;case 1:return 2;case 2:return 0;case 3:return format_mp3_MPEG.Reserved}},format_mp3_MPEG.num2Enum=function(m){switch(m){case 0:return format_mp3_MPEGVersion.MPEG_V25;case 2:return format_mp3_MPEGVersion.MPEG_V2;case 3:return format_mp3_MPEGVersion.MPEG_V1;default:return format_mp3_MPEGVersion.MPEG_Reserved}},format_mp3_MPEG.srEnum2Num=function(sr){switch(sr._hx_index){case 0:return 8e3;case 1:return 11025;case 2:return 12e3;case 3:return 22050;case 4:return 24e3;case 5:return 32e3;case 6:return 44100;case 7:return 48e3;case 8:return-1}},format_mp3_MPEG.bitrateEnum2Num=function(br){switch(br._hx_index){case 0:return 8;case 1:return 16;case 2:return 24;case 3:return 32;case 4:return 40;case 5:return 48;case 6:return 56;case 7:return 64;case 8:return 80;case 9:return 96;case 10:return 112;case 11:return 128;case 12:return 144;case 13:return 160;case 14:return 176;case 15:return 192;case 16:return 224;case 17:return 256;case 18:return 288;case 19:return 320;case 20:return 352;case 21:return 384;case 22:return 416;case 23:return 448;case 24:return 0;case 25:return-1}};var format_mp3_CLayer=function(){};$hxClasses["format.mp3.CLayer"]=format_mp3_CLayer,format_mp3_CLayer.__name__="format.mp3.CLayer",format_mp3_CLayer.num2Enum=function(l){switch(l){case 1:return format_mp3_Layer.Layer3;case 2:return format_mp3_Layer.Layer2;case 3:return format_mp3_Layer.Layer1;default:return format_mp3_Layer.LayerReserved}};var format_mp3_CChannelMode=function(){};$hxClasses["format.mp3.CChannelMode"]=format_mp3_CChannelMode,format_mp3_CChannelMode.__name__="format.mp3.CChannelMode",format_mp3_CChannelMode.num2Enum=function(c){switch(c){case 0:return format_mp3_ChannelMode.Stereo;case 1:return format_mp3_ChannelMode.JointStereo;case 2:return format_mp3_ChannelMode.DualChannel;case 3:return format_mp3_ChannelMode.Mono;default:throw haxe_Exception.thrown("assert")}};var format_mp3_CEmphasis=function(){};$hxClasses["format.mp3.CEmphasis"]=format_mp3_CEmphasis,format_mp3_CEmphasis.__name__="format.mp3.CEmphasis",format_mp3_CEmphasis.num2Enum=function(c){switch(c){case 0:return format_mp3_Emphasis.NoEmphasis;case 1:return format_mp3_Emphasis.Ms50_15;case 2:return format_mp3_Emphasis.InvalidEmphasis;case 3:return format_mp3_Emphasis.CCIT_J17;default:throw haxe_Exception.thrown("assert")}};var format_mp3_MPEGVersion=$hxEnums["format.mp3.MPEGVersion"]={__ename__:"format.mp3.MPEGVersion",__constructs__:["MPEG_V1","MPEG_V2","MPEG_V25","MPEG_Reserved"],MPEG_V1:{_hx_index:0,__enum__:"format.mp3.MPEGVersion",toString:$estr},MPEG_V2:{_hx_index:1,__enum__:"format.mp3.MPEGVersion",toString:$estr},MPEG_V25:{_hx_index:2,__enum__:"format.mp3.MPEGVersion",toString:$estr},MPEG_Reserved:{_hx_index:3,__enum__:"format.mp3.MPEGVersion",toString:$estr}};format_mp3_MPEGVersion.__empty_constructs__=[format_mp3_MPEGVersion.MPEG_V1,format_mp3_MPEGVersion.MPEG_V2,format_mp3_MPEGVersion.MPEG_V25,format_mp3_MPEGVersion.MPEG_Reserved];var format_mp3_Layer=$hxEnums["format.mp3.Layer"]={__ename__:"format.mp3.Layer",__constructs__:["LayerReserved","Layer3","Layer2","Layer1"],LayerReserved:{_hx_index:0,__enum__:"format.mp3.Layer",toString:$estr},Layer3:{_hx_index:1,__enum__:"format.mp3.Layer",toString:$estr},Layer2:{_hx_index:2,__enum__:"format.mp3.Layer",toString:$estr},Layer1:{_hx_index:3,__enum__:"format.mp3.Layer",toString:$estr}};format_mp3_Layer.__empty_constructs__=[format_mp3_Layer.LayerReserved,format_mp3_Layer.Layer3,format_mp3_Layer.Layer2,format_mp3_Layer.Layer1];var format_mp3_ChannelMode=$hxEnums["format.mp3.ChannelMode"]={__ename__:"format.mp3.ChannelMode",__constructs__:["Stereo","JointStereo","DualChannel","Mono"],Stereo:{_hx_index:0,__enum__:"format.mp3.ChannelMode",toString:$estr},JointStereo:{_hx_index:1,__enum__:"format.mp3.ChannelMode",toString:$estr},DualChannel:{_hx_index:2,__enum__:"format.mp3.ChannelMode",toString:$estr},Mono:{_hx_index:3,__enum__:"format.mp3.ChannelMode",toString:$estr}};format_mp3_ChannelMode.__empty_constructs__=[format_mp3_ChannelMode.Stereo,format_mp3_ChannelMode.JointStereo,format_mp3_ChannelMode.DualChannel,format_mp3_ChannelMode.Mono];var format_mp3_Emphasis=$hxEnums["format.mp3.Emphasis"]={__ename__:"format.mp3.Emphasis",__constructs__:["NoEmphasis","Ms50_15","CCIT_J17","InvalidEmphasis"],NoEmphasis:{_hx_index:0,__enum__:"format.mp3.Emphasis",toString:$estr},Ms50_15:{_hx_index:1,__enum__:"format.mp3.Emphasis",toString:$estr},CCIT_J17:{_hx_index:2,__enum__:"format.mp3.Emphasis",toString:$estr},InvalidEmphasis:{_hx_index:3,__enum__:"format.mp3.Emphasis",toString:$estr}};format_mp3_Emphasis.__empty_constructs__=[format_mp3_Emphasis.NoEmphasis,format_mp3_Emphasis.Ms50_15,format_mp3_Emphasis.CCIT_J17,format_mp3_Emphasis.InvalidEmphasis];var format_mp3_FrameType=$hxEnums["format.mp3.FrameType"]={__ename__:"format.mp3.FrameType",__constructs__:["FT_MP3","FT_NONE"],FT_MP3:{_hx_index:0,__enum__:"format.mp3.FrameType",toString:$estr},FT_NONE:{_hx_index:1,__enum__:"format.mp3.FrameType",toString:$estr}};format_mp3_FrameType.__empty_constructs__=[format_mp3_FrameType.FT_MP3,format_mp3_FrameType.FT_NONE];var format_mp3_Reader=function(i){this.i=i,i.set_bigEndian(!0),this.bits=new format_tools_BitsInput(i),this.samples=0,this.sampleSize=0,this.any_read=!1};$hxClasses["format.mp3.Reader"]=format_mp3_Reader,format_mp3_Reader.__name__="format.mp3.Reader",format_mp3_Reader.prototype={skipID3v2:function(){this.id3v2_version=this.i.readUInt16(),this.id3v2_flags=this.i.readByte();var size=127&this.i.readByte();size=(size=(size=size<<7|127&this.i.readByte())<<7|127&this.i.readByte())<<7|127&this.i.readByte(),this.id3v2_data=this.i.read(size)},seekFrame:function(){try{for(var b;;)if(b=this.i.readByte(),this.any_read||(this.any_read=!0,73==b&&68==(b=this.i.readByte())&&51==(b=this.i.readByte())&&this.skipID3v2()),255==b&&(this.bits.nbits=0,7==(b=this.bits.readBits(3))))return format_mp3_FrameType.FT_MP3}catch(_g){if(haxe_Exception.caught(_g).unwrap()instanceof haxe_io_Eof)return format_mp3_FrameType.FT_NONE;throw _g}},readFrames:function(){for(var ft,frames=[];(ft=this.seekFrame())!=format_mp3_FrameType.FT_NONE;)switch(ft._hx_index){case 0:var f=this.readFrame();null!=f&&frames.push(f)}return frames},readFrameHeader:function(){var version=this.bits.readBits(2),layer=this.bits.readBits(2),hasCrc=!this.bits.readBit();if(version==format_mp3_MPEG.Reserved||layer==format_mp3_CLayer.LReserved)return null;var bitrateIdx=this.bits.readBits(4),bitrate=format_mp3_Tools.getBitrate(version,layer,bitrateIdx),samplingRateIdx=this.bits.readBits(2),samplingRate=format_mp3_Tools.getSamplingRate(version,samplingRateIdx),isPadded=this.bits.readBit(),privateBit=this.bits.readBit();if(bitrate==format_mp3_Bitrate.BR_Bad||bitrate==format_mp3_Bitrate.BR_Free||samplingRate==format_mp3_SamplingRate.SR_Bad)return null;var channelMode=this.bits.readBits(2),isIntensityStereo=this.bits.readBit(),isMSStereo=this.bits.readBit(),isCopyrighted=this.bits.readBit(),isOriginal=this.bits.readBit(),emphasis=this.bits.readBits(2),crc16=0;return hasCrc&&(crc16=this.i.readUInt16()),{version:format_mp3_MPEG.num2Enum(version),layer:format_mp3_CLayer.num2Enum(layer),hasCrc:hasCrc,crc16:crc16,bitrate:bitrate,samplingRate:samplingRate,isPadded:isPadded,privateBit:privateBit,channelMode:format_mp3_CChannelMode.num2Enum(channelMode),isIntensityStereo:isIntensityStereo,isMSStereo:isMSStereo,isCopyrighted:isCopyrighted,isOriginal:isOriginal,emphasis:format_mp3_CEmphasis.num2Enum(emphasis)}},readFrame:function(){var header=this.readFrameHeader();if(null==header||format_mp3_Tools.isInvalidFrameHeader(header))return null;try{var data=this.i.read(format_mp3_Tools.getSampleDataSizeHdr(header));return this.samples+=format_mp3_Tools.getSampleCountHdr(header),this.sampleSize+=data.length,{header:header,data:data}}catch(_g){if(haxe_Exception.caught(_g).unwrap()instanceof haxe_io_Eof)return null;throw _g}},read:function(){return{frames:this.readFrames(),sampleCount:this.samples,sampleSize:this.sampleSize,id3v2:null==this.id3v2_data?null:{versionBytes:this.id3v2_version,flagByte:this.id3v2_flags,data:this.id3v2_data}}},__class__:format_mp3_Reader};var format_mp3_Tools=function(){};$hxClasses["format.mp3.Tools"]=format_mp3_Tools,format_mp3_Tools.__name__="format.mp3.Tools",format_mp3_Tools.getBitrate=function(mpegVersion,layerIdx,bitrateIdx){return mpegVersion==format_mp3_MPEG.Reserved||layerIdx==format_mp3_CLayer.LReserved?format_mp3_Bitrate.BR_Bad:(3==mpegVersion?format_mp3_MPEG.V1_Bitrates:format_mp3_MPEG.V2_Bitrates)[layerIdx][bitrateIdx]},format_mp3_Tools.getSamplingRate=function(mpegVersion,samplingRateIdx){return format_mp3_MPEG.SamplingRates[mpegVersion][samplingRateIdx]},format_mp3_Tools.isInvalidFrameHeader=function(hdr){return hdr.version==format_mp3_MPEGVersion.MPEG_Reserved||hdr.layer==format_mp3_Layer.LayerReserved||hdr.bitrate==format_mp3_Bitrate.BR_Bad||hdr.bitrate==format_mp3_Bitrate.BR_Free||hdr.samplingRate==format_mp3_SamplingRate.SR_Bad},format_mp3_Tools.getSampleDataSize=function(mpegVersion,bitrate,samplingRate,isPadded,hasCrc){return((3==mpegVersion?144:72)*bitrate*1e3/samplingRate|0)+(isPadded?1:0)-(hasCrc?2:0)-4},format_mp3_Tools.getSampleDataSizeHdr=function(hdr){return format_mp3_Tools.getSampleDataSize(format_mp3_MPEG.enum2Num(hdr.version),format_mp3_MPEG.bitrateEnum2Num(hdr.bitrate),format_mp3_MPEG.srEnum2Num(hdr.samplingRate),hdr.isPadded,hdr.hasCrc)},format_mp3_Tools.getSampleCount=function(mpegVersion){return 3==mpegVersion?1152:576},format_mp3_Tools.getSampleCountHdr=function(hdr){return format_mp3_Tools.getSampleCount(format_mp3_MPEG.enum2Num(hdr.version))};var format_png_Color=$hxEnums["format.png.Color"]={__ename__:"format.png.Color",__constructs__:["ColGrey","ColTrue","ColIndexed"],ColGrey:($_=function(alpha){return{_hx_index:0,alpha:alpha,__enum__:"format.png.Color",toString:$estr}},$_.__params__=["alpha"],$_),ColTrue:($_=function(alpha){return{_hx_index:1,alpha:alpha,__enum__:"format.png.Color",toString:$estr}},$_.__params__=["alpha"],$_),ColIndexed:{_hx_index:2,__enum__:"format.png.Color",toString:$estr}};format_png_Color.__empty_constructs__=[format_png_Color.ColIndexed];var format_png_Chunk=$hxEnums["format.png.Chunk"]={__ename__:"format.png.Chunk",__constructs__:["CEnd","CHeader","CData","CPalette","CUnknown"],CEnd:{_hx_index:0,__enum__:"format.png.Chunk",toString:$estr},CHeader:($_=function(h){return{_hx_index:1,h:h,__enum__:"format.png.Chunk",toString:$estr}},$_.__params__=["h"],$_),CData:($_=function(b){return{_hx_index:2,b:b,__enum__:"format.png.Chunk",toString:$estr}},$_.__params__=["b"],$_),CPalette:($_=function(b){return{_hx_index:3,b:b,__enum__:"format.png.Chunk",toString:$estr}},$_.__params__=["b"],$_),CUnknown:($_=function(id,data){return{_hx_index:4,id:id,data:data,__enum__:"format.png.Chunk",toString:$estr}},$_.__params__=["id","data"],$_)};format_png_Chunk.__empty_constructs__=[format_png_Chunk.CEnd];var format_png_Reader=function(i){this.i=i,i.set_bigEndian(!0),this.checkCRC=!0};$hxClasses["format.png.Reader"]=format_png_Reader,format_png_Reader.__name__="format.png.Reader",format_png_Reader.prototype={read:function(){var b=137;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=80;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=78;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=71;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=13;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=10;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=26;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");b=10;if(this.i.readByte()!=b)throw haxe_Exception.thrown("Invalid header");for(var l=new haxe_ds_List;;){var c=this.readChunk();if(l.add(c),c==format_png_Chunk.CEnd)break}return l},readHeader:function(i){i.set_bigEndian(!0);var color1,width=i.readInt32(),height=i.readInt32(),colbits=i.readByte(),color=i.readByte();switch(color){case 0:color1=format_png_Color.ColGrey(!1);break;case 2:color1=format_png_Color.ColTrue(!1);break;case 3:color1=format_png_Color.ColIndexed;break;case 4:color1=format_png_Color.ColGrey(!0);break;case 6:color1=format_png_Color.ColTrue(!0);break;default:throw haxe_Exception.thrown("Unknown color model "+color+":"+colbits)}var compress=i.readByte(),filter=i.readByte();if(0!=compress||0!=filter)throw haxe_Exception.thrown("Invalid header");var interlace=i.readByte();if(0!=interlace&&1!=interlace)throw haxe_Exception.thrown("Invalid header");return{width:width,height:height,colbits:colbits,color:color1,interlaced:1==interlace}},readChunk:function(){var dataLen=this.i.readInt32(),id=this.i.readString(4),data=this.i.read(dataLen),crc=this.i.readInt32();if(this.checkCRC){var c_crc=-1;tmp=(tmp=255&((c_crc=c_crc>>>8^(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=255&(c_crc^HxOverrides.cca(id,0)))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp)))^HxOverrides.cca(id,1)))>>>1^-306674912&-(1&tmp),tmp=(tmp=255&((c_crc=c_crc>>>8^(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=tmp>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp)))^HxOverrides.cca(id,2)))>>>1^-306674912&-(1&tmp),c_crc=(c_crc=c_crc>>>8^(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=tmp>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp)))>>>8^(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=255&(c_crc^HxOverrides.cca(id,3)))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp));for(var b=data.b.bufferValue,_g=0,_g1=data.length;_g<_g1;){var tmp,i=_g++;c_crc=c_crc>>>8^(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=(tmp=255&(c_crc^b.bytes[i]))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))>>>1^-306674912&-(1&tmp))}if((-1^c_crc)!=crc)throw haxe_Exception.thrown("CRC check failure")}switch(id){case"IDAT":return format_png_Chunk.CData(data);case"IEND":return format_png_Chunk.CEnd;case"IHDR":return format_png_Chunk.CHeader(this.readHeader(new haxe_io_BytesInput(data)));case"PLTE":return format_png_Chunk.CPalette(data);default:return format_png_Chunk.CUnknown(id,data)}},__class__:format_png_Reader};var format_png_Tools=function(){};$hxClasses["format.png.Tools"]=format_png_Tools,format_png_Tools.__name__="format.png.Tools",format_png_Tools.getHeader=function(d){for(var _g_head=d.h;null!=_g_head;){var val=_g_head.item;_g_head=_g_head.next;var c=val;if(1==c._hx_index)return c.h}throw haxe_Exception.thrown("Header not found")},format_png_Tools.getPalette=function(d){for(var _g_head=d.h;null!=_g_head;){var val=_g_head.item;_g_head=_g_head.next;var c=val;if(3==c._hx_index)return c.b}return null},format_png_Tools.extract32=function(d,bytes,flipY){for(var h=format_png_Tools.getHeader(d),bgra=null==bytes?new haxe_io_Bytes(new ArrayBuffer(h.width*h.height*4)):bytes,data=null,fullData=null,_g_head=d.h;null!=_g_head;){var val=_g_head.item;if(_g_head=_g_head.next,2==(c=val)._hx_index){var b=c.b;null!=fullData?fullData.add(b):null==data?data=b:((fullData=new haxe_io_BytesBuffer).add(data),fullData.add(b),data=null)}}if(null!=fullData&&(data=fullData.getBytes()),null==data)throw haxe_Exception.thrown("Data not found");data=format_tools_Inflate.run(data);var r=0,w=0,lineDelta=0;flipY&&(lineDelta=8*-h.width,w=(h.height-1)*(4*h.width));var flipY1=flipY?-1:1;switch((_g=h.color)._hx_index){case 0:var alpha=_g.alpha;if(8!=h.colbits)throw haxe_Exception.thrown("Unsupported color mode");var stride=(alpha?2:1)*(width=h.width)+1;if(data.length<h.height*stride)throw haxe_Exception.thrown("Not enough data");var alphvaIdx=-1;if(!alpha)for(var _g1_head=d.h;null!=_g1_head;){val=_g1_head.item;if(_g1_head=_g1_head.next,4==(t=val)._hx_index&&"tRNS"==t.id){(data1=t.data).length>=2&&(alphvaIdx=data1.b[1]);break}}for(var _g1=0,_g2=h.height;_g1<_g2;){var y=_g1++;switch(f=data.b[r++]){case 0:if(alpha)for(var _g3=0,_g4=width;_g3<_g4;){_g3++;var v=data.b[r++];bgra.b[w++]=v,bgra.b[w++]=v,bgra.b[w++]=v,bgra.b[w++]=data.b[r++]}else for(var _g5=0,_g6=width;_g5<_g6;){_g5++;var v1=data.b[r++];bgra.b[w++]=v1,bgra.b[w++]=v1,bgra.b[w++]=v1,bgra.b[w++]=v1==alphvaIdx?0:255}break;case 1:var cv=0,ca=0;if(alpha)for(var _g7=0,_g8=width;_g7<_g8;){_g7++;cv+=data.b[r++],bgra.b[w++]=cv,bgra.b[w++]=cv,bgra.b[w++]=cv,ca+=data.b[r++],bgra.b[w++]=ca}else for(var _g9=0,_g10=width;_g9<_g10;){var x3=_g9++;cv+=data.b[r++],bgra.b[w++]=cv,bgra.b[w++]=cv,bgra.b[w++]=cv,bgra.b[w++]=cv==alphvaIdx?0:255}break;case 2:stride=0==y?0:4*width*flipY1;if(alpha)for(var _g11=0,_g12=width;_g11<_g12;){_g11++;var v2=data.b[r++]+bgra.b[w-stride];bgra.b[w++]=v2,bgra.b[w++]=v2,bgra.b[w++]=v2,bgra.b[w++]=data.b[r++]+bgra.b[w-stride]}else for(var _g13=0,_g14=width;_g13<_g14;){_g13++;var v3=data.b[r++]+bgra.b[w-stride];bgra.b[w++]=v3,bgra.b[w++]=v3,bgra.b[w++]=v3,bgra.b[w++]=v3==alphvaIdx?0:255}break;case 3:var cv1=0,ca1=0,stride1=0==y?0:4*width*flipY1;if(alpha)for(var _g15=0,_g16=width;_g15<_g16;){_g15++;cv1=data.b[r++]+(cv1+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cv1,bgra.b[w++]=cv1,bgra.b[w++]=cv1,ca1=data.b[r++]+(ca1+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=ca1}else for(var _g17=0,_g18=width;_g17<_g18;){_g17++;cv1=data.b[r++]+(cv1+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cv1,bgra.b[w++]=cv1,bgra.b[w++]=cv1,bgra.b[w++]=cv1==alphvaIdx?0:255}break;case 4:var stride2=4*width*flipY1,cv2=0,ca2=0;if(alpha)for(var _g19=0,_g20=width;_g19<_g20;){var x8=_g19++;(pa=(k=cv2+(b=0==y?0:bgra.b[w-stride2])-(c=0==x8||0==y?0:bgra.b[w-stride2-4]))-cv2)<0&&(pa=-pa),(pb=k-b)<0&&(pb=-pb),(pc=k-c)<0&&(pc=-pc);var pos=r++;cv2=(pa<=pb&&pa<=pc?cv2:pb<=pc?b:c)+data.b[pos]&255,bgra.b[w++]=cv2,bgra.b[w++]=cv2,bgra.b[w++]=cv2,(pa1=(k1=ca2+(b1=0==y?0:bgra.b[w-stride2])-(c1=0==x8||0==y?0:bgra.b[w-stride2-4]))-ca2)<0&&(pa1=-pa1),(pb1=k1-b1)<0&&(pb1=-pb1),(pc1=k1-c1)<0&&(pc1=-pc1);var pos1=r++;ca2=(pa1<=pb1&&pa1<=pc1?ca2:pb1<=pc1?b1:c1)+data.b[pos1]&255,bgra.b[w++]=ca2}else for(var _g21=0,_g22=width;_g21<_g22;){var x9=_g21++;(pa2=(k2=cv2+(b2=0==y?0:bgra.b[w-stride2])-(c2=0==x9||0==y?0:bgra.b[w-stride2-4]))-cv2)<0&&(pa2=-pa2),(pb2=k2-b2)<0&&(pb2=-pb2),(pc2=k2-c2)<0&&(pc2=-pc2);var pos2=r++;cv2=(pa2<=pb2&&pa2<=pc2?cv2:pb2<=pc2?b2:c2)+data.b[pos2]&255,bgra.b[w++]=cv2,bgra.b[w++]=cv2,bgra.b[w++]=cv2,bgra.b[w++]=cv2==alphvaIdx?0:255}break;default:throw haxe_Exception.thrown("Invalid filter "+f)}w+=lineDelta}break;case 1:alpha=_g.alpha;if(8!=h.colbits)throw haxe_Exception.thrown("Unsupported color mode");stride=(alpha?4:3)*(width=h.width)+1;if(data.length<h.height*stride)throw haxe_Exception.thrown("Not enough data");var alphaRed=-1,alphaGreen=-1,alphaBlue=-1;if(!alpha)for(_g1_head=d.h;null!=_g1_head;){val=_g1_head.item;if(_g1_head=_g1_head.next,4==(t=val)._hx_index&&"tRNS"==t.id){(data1=t.data).length>=6&&(alphaRed=data1.b[1],alphaGreen=data1.b[3],alphaBlue=data1.b[5]);break}}var cr=0,cg=0,cb=0,_g=(ca=0,0);for(_g1=h.height;_g<_g1;){y=_g++;switch(f=data.b[r++]){case 0:if(alpha)for(_g2=0,_g3=width;_g2<_g3;){_g2++;bgra.b[w++]=data.b[r+2],bgra.b[w++]=data.b[r+1],bgra.b[w++]=data.b[r],bgra.b[w++]=data.b[r+3],r+=4}else for(_g4=0,_g5=width;_g4<_g5;){_g4++;cb=data.b[r+2],bgra.b[w++]=cb,cg=data.b[r+1],bgra.b[w++]=cg,cr=data.b[r],bgra.b[w++]=cr,bgra.b[w++]=cr==alphaRed&&cg==alphaGreen&&cb==alphaBlue?0:255,r+=3}break;case 1:if(cr=cg=cb=ca=0,alpha)for(_g6=0,_g7=width;_g6<_g7;){_g6++;cb+=data.b[r+2],bgra.b[w++]=cb,cg+=data.b[r+1],bgra.b[w++]=cg,cr+=data.b[r],bgra.b[w++]=cr,ca+=data.b[r+3],bgra.b[w++]=ca,r+=4}else for(_g8=0,_g9=width;_g8<_g9;){x3=_g8++;cb+=data.b[r+2],bgra.b[w++]=cb,cg+=data.b[r+1],bgra.b[w++]=cg,cr+=data.b[r],bgra.b[w++]=cr,bgra.b[w++]=cr==alphaRed&&cg==alphaGreen&&cb==alphaBlue?0:255,r+=3}break;case 2:stride=0==y?0:4*width*flipY1;if(alpha)for(_g10=0,_g11=width;_g10<_g11;){_g10++;bgra.b[w]=data.b[r+2]+bgra.b[w-stride],++w,bgra.b[w]=data.b[r+1]+bgra.b[w-stride],++w,bgra.b[w]=data.b[r]+bgra.b[w-stride],++w,bgra.b[w]=data.b[r+3]+bgra.b[w-stride],++w,r+=4}else for(_g12=0,_g13=width;_g12<_g13;){_g12++;cb=data.b[r+2]+bgra.b[w-stride],bgra.b[w]=cb,++w,cg=data.b[r+1]+bgra.b[w-stride],bgra.b[w]=cg,++w,cr=data.b[r]+bgra.b[w-stride],bgra.b[w]=cr,++w,bgra.b[w++]=cr==alphaRed&&cg==alphaGreen&&cb==alphaBlue?0:255,r+=3}break;case 3:cr=cg=cb=ca=0;stride1=0==y?0:4*width*flipY1;if(alpha)for(_g14=0,_g15=width;_g14<_g15;){_g14++;cb=data.b[r+2]+(cb+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cb,cg=data.b[r+1]+(cg+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cg,cr=data.b[r]+(cr+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cr,ca=data.b[r+3]+(ca+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=ca,r+=4}else for(_g16=0,_g17=width;_g16<_g17;){_g16++;cb=data.b[r+2]+(cb+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cb,cg=data.b[r+1]+(cg+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cg,cr=data.b[r]+(cr+bgra.b[w-stride1]>>1)&255,bgra.b[w++]=cr,bgra.b[w++]=cr==alphaRed&&cg==alphaGreen&&cb==alphaBlue?0:255,r+=3}break;case 4:stride2=4*width*flipY1;if(cr=cg=cb=ca=0,alpha)for(_g18=0,_g19=width;_g18<_g19;){var b1,k1,pa1,pb1,pc1,b2,k2,pa2,pb2,pc2;x8=_g18++;(pa=(k=cb+(b=0==y?0:bgra.b[w-stride2])-(c=0==x8||0==y?0:bgra.b[w-stride2-4]))-cb)<0&&(pa=-pa),(pb=k-b)<0&&(pb=-pb),(pc=k-c)<0&&(pc=-pc),cb=(pa<=pb&&pa<=pc?cb:pb<=pc?b:c)+data.b[r+2]&255,bgra.b[w++]=cb,(pa1=(k1=cg+(b1=0==y?0:bgra.b[w-stride2])-(c1=0==x8||0==y?0:bgra.b[w-stride2-4]))-cg)<0&&(pa1=-pa1),(pb1=k1-b1)<0&&(pb1=-pb1),(pc1=k1-c1)<0&&(pc1=-pc1),cg=(pa1<=pb1&&pa1<=pc1?cg:pb1<=pc1?b1:c1)+data.b[r+1]&255,bgra.b[w++]=cg,(pa2=(k2=cr+(b2=0==y?0:bgra.b[w-stride2])-(c2=0==x8||0==y?0:bgra.b[w-stride2-4]))-cr)<0&&(pa2=-pa2),(pb2=k2-b2)<0&&(pb2=-pb2),(pc2=k2-c2)<0&&(pc2=-pc2),cr=(pa2<=pb2&&pa2<=pc2?cr:pb2<=pc2?b2:c2)+data.b[r]&255,bgra.b[w++]=cr;var b3=0==y?0:bgra.b[w-stride2],k3=ca+b3-(c3=0==x8||0==y?0:bgra.b[w-stride2-4]),pa3=k3-ca;pa3<0&&(pa3=-pa3);var pb3=k3-b3;pb3<0&&(pb3=-pb3);var pc3=k3-c3;pc3<0&&(pc3=-pc3),ca=(pa3<=pb3&&pa3<=pc3?ca:pb3<=pc3?b3:c3)+data.b[r+3]&255,bgra.b[w++]=ca,r+=4}else for(_g20=0,_g21=width;_g20<_g21;){x9=_g20++;var b4=0==y?0:bgra.b[w-stride2],c4=0==x9||0==y?0:bgra.b[w-stride2-4],k4=cb+b4-c4,pa4=k4-cb;pa4<0&&(pa4=-pa4);var pb4=k4-b4;pb4<0&&(pb4=-pb4);var pc4=k4-c4;pc4<0&&(pc4=-pc4),cb=(pa4<=pb4&&pa4<=pc4?cb:pb4<=pc4?b4:c4)+data.b[r+2]&255,bgra.b[w++]=cb;var b5=0==y?0:bgra.b[w-stride2],c5=0==x9||0==y?0:bgra.b[w-stride2-4],k5=cg+b5-c5,pa5=k5-cg;pa5<0&&(pa5=-pa5);var pb5=k5-b5;pb5<0&&(pb5=-pb5);var pc5=k5-c5;pc5<0&&(pc5=-pc5),cg=(pa5<=pb5&&pa5<=pc5?cg:pb5<=pc5?b5:c5)+data.b[r+1]&255,bgra.b[w++]=cg;var b6=0==y?0:bgra.b[w-stride2],c6=0==x9||0==y?0:bgra.b[w-stride2-4],k6=cr+b6-c6,pa6=k6-cr;pa6<0&&(pa6=-pa6);var pb6=k6-b6;pb6<0&&(pb6=-pb6);var pc6=k6-c6;pc6<0&&(pc6=-pc6),cr=(pa6<=pb6&&pa6<=pc6?cr:pb6<=pc6?b6:c6)+data.b[r]&255,bgra.b[w++]=cr,bgra.b[w++]=cr==alphaRed&&cg==alphaGreen&&cb==alphaBlue?0:255,r+=3}break;default:throw haxe_Exception.thrown("Invalid filter "+f)}w+=lineDelta}break;case 2:var pal=format_png_Tools.getPalette(d);if(null==pal)throw haxe_Exception.thrown("PNG Palette is missing");for(alpha=null,_g1_head=d.h;null!=_g1_head;){var t;val=_g1_head.item;if(_g1_head=_g1_head.next,4==(t=val)._hx_index&&"tRNS"==t.id){var data1;alpha=data1=t.data;break}}if(null!=alpha&&alpha.length<1<<h.colbits){var alpha2=new haxe_io_Bytes(new ArrayBuffer(1<<h.colbits));alpha2.blit(0,alpha,0,alpha.length),alpha2.fill(alpha.length,alpha2.length-alpha.length,255),alpha=alpha2}var width=h.width;stride=Math.ceil(width*h.colbits/8)+1;if(data.length<h.height*stride)throw haxe_Exception.thrown("Not enough data");var rline=h.width*h.colbits>>3;for(_g=0,_g1=h.height;_g<_g1;){var f;y=_g++;if(0!=(f=data.b[r++]))switch(f){case 1:var c=0;for(_g2=0,_g3=width;_g2<_g3;){_g2++;c+=v=data.b[r],data.b[r++]=255&c}break;case 2:for(stride=0==y?0:rline+1,_g4=0,_g5=width;_g4<_g5;){_g4++,v1=data.b[r];data.b[r]=v1+data.b[r-stride],++r}break;case 3:var c1=0;for(stride1=0==y?0:rline+1,_g6=0,_g7=width;_g6<_g7;){_g6++;c1=(v2=data.b[r])+(c1+data.b[r-stride1]>>1)&255,data.b[r++]=c1}break;case 4:stride2=rline+1;var c2=0;for(_g8=0,_g9=width;_g8<_g9;){x3=_g8++,v3=data.b[r];var c3,k,pa,pb,pc,numChannels=1;null==numChannels&&(numChannels=4),(pa=(k=c2+(b=0==y?0:data.b[r-stride2])-(c3=0==x3||0==y?0:data.b[r-stride2-numChannels]))-c2)<0&&(pa=-pa),(pb=k-b)<0&&(pb=-pb),(pc=k-c3)<0&&(pc=-pc),c2=(pa<=pb&&pa<=pc?c2:pb<=pc?b:c3)+v3&255,data.b[r++]=c2}break;default:throw haxe_Exception.thrown("Invalid filter "+f)}else r+=rline}r=0;if(8==h.colbits)for(_g=0,_g1=h.height;_g<_g1;){y=_g++;++r;for(_g2=0,_g3=h.width;_g2<_g3;){_g2++,c=data.b[r++];bgra.b[w++]=pal.b[3*c+2],bgra.b[w++]=pal.b[3*c+1],bgra.b[w++]=pal.b[3*c],bgra.b[w++]=null!=alpha?alpha.b[c]:255}w+=lineDelta}else{if(!(h.colbits<8))throw haxe_Exception.thrown(h.colbits+" indexed bits per pixel not supported");var req=h.colbits,mask=(1<<req)-1;for(_g=0,_g1=h.height;_g<_g1;){y=_g++;++r;var bits=0,nbits=0;for(_g2=0,_g3=h.width;_g2<_g3;){_g2++;nbits<req&&(bits=bits<<8|data.b[r++],nbits+=8);c=bits>>>nbits-req&mask;nbits-=req,bgra.b[w++]=pal.b[3*c+2],bgra.b[w++]=pal.b[3*c+1],bgra.b[w++]=pal.b[3*c],bgra.b[w++]=null!=alpha?alpha.b[c]:255}w+=lineDelta}}}return bgra};var format_tga_ImageOrigin=$hxEnums["format.tga.ImageOrigin"]={__ename__:"format.tga.ImageOrigin",__constructs__:["BottomLeft","BottomRight","TopLeft","TopRight"],BottomLeft:{_hx_index:0,__enum__:"format.tga.ImageOrigin",toString:$estr},BottomRight:{_hx_index:1,__enum__:"format.tga.ImageOrigin",toString:$estr},TopLeft:{_hx_index:2,__enum__:"format.tga.ImageOrigin",toString:$estr},TopRight:{_hx_index:3,__enum__:"format.tga.ImageOrigin",toString:$estr}};format_tga_ImageOrigin.__empty_constructs__=[format_tga_ImageOrigin.BottomLeft,format_tga_ImageOrigin.BottomRight,format_tga_ImageOrigin.TopLeft,format_tga_ImageOrigin.TopRight];var format_tga_ImageType=$hxEnums["format.tga.ImageType"]={__ename__:"format.tga.ImageType",__constructs__:["NoImage","UncompressedColorMapped","UncompressedTrueColor","UncompressedBlackAndWhite","RunLengthColorMapped","RunLengthTrueColor","RunLengthBlackAndWhite","Unknown"],NoImage:{_hx_index:0,__enum__:"format.tga.ImageType",toString:$estr},UncompressedColorMapped:{_hx_index:1,__enum__:"format.tga.ImageType",toString:$estr},UncompressedTrueColor:{_hx_index:2,__enum__:"format.tga.ImageType",toString:$estr},UncompressedBlackAndWhite:{_hx_index:3,__enum__:"format.tga.ImageType",toString:$estr},RunLengthColorMapped:{_hx_index:4,__enum__:"format.tga.ImageType",toString:$estr},RunLengthTrueColor:{_hx_index:5,__enum__:"format.tga.ImageType",toString:$estr},RunLengthBlackAndWhite:{_hx_index:6,__enum__:"format.tga.ImageType",toString:$estr},Unknown:($_=function(type){return{_hx_index:7,type:type,__enum__:"format.tga.ImageType",toString:$estr}},$_.__params__=["type"],$_)};format_tga_ImageType.__empty_constructs__=[format_tga_ImageType.NoImage,format_tga_ImageType.UncompressedColorMapped,format_tga_ImageType.UncompressedTrueColor,format_tga_ImageType.UncompressedBlackAndWhite,format_tga_ImageType.RunLengthColorMapped,format_tga_ImageType.RunLengthTrueColor,format_tga_ImageType.RunLengthBlackAndWhite];var format_tga_Reader=function(i){this.i=i,i.set_bigEndian(!1)};$hxClasses["format.tga.Reader"]=format_tga_Reader,format_tga_Reader.__name__="format.tga.Reader",format_tga_Reader.prototype={read:function(){var idLength=this.i.readByte(),header=this.readHeader(),id=0==idLength?"":this.i.readString(idLength),colorMap=this.readColorMapData(header);return{header:header,imageId:id,colorMapData:colorMap,imageData:this.readImageData(header,colorMap),developerData:null}},readHeader:function(){var dataType,colorMapType=this.i.readByte(),dataId=this.i.readByte();switch(dataId){case 0:dataType=format_tga_ImageType.NoImage;break;case 1:dataType=format_tga_ImageType.UncompressedColorMapped;break;case 2:dataType=format_tga_ImageType.UncompressedTrueColor;break;case 3:dataType=format_tga_ImageType.UncompressedBlackAndWhite;break;case 9:dataType=format_tga_ImageType.RunLengthColorMapped;break;case 10:dataType=format_tga_ImageType.RunLengthTrueColor;break;case 11:dataType=format_tga_ImageType.RunLengthBlackAndWhite;break;default:dataType=format_tga_ImageType.Unknown(dataId)}var origin,colorMapOrigin=this.i.readInt16(),colorMapLength=this.i.readInt16(),colorMapDepth=this.i.readByte(),xOrigin=this.i.readInt16(),yOrigin=this.i.readInt16(),width=this.i.readInt16(),height=this.i.readInt16(),depth=this.i.readByte(),descriptor=this.i.readByte();switch(48&descriptor){case 16:origin=format_tga_ImageOrigin.BottomRight;break;case 32:origin=format_tga_ImageOrigin.TopLeft;break;case 48:origin=format_tga_ImageOrigin.TopRight;break;default:origin=format_tga_ImageOrigin.BottomLeft}return{colorMapType:colorMapType,imageType:dataType,colorMapFirstIndex:colorMapOrigin,colorMapLength:colorMapLength,colorMapEntrySize:colorMapDepth,xOrigin:xOrigin,yOrigin:yOrigin,width:width,height:height,bitsPerPixel:depth,alphaChannelBits:15&descriptor,imageOrigin:origin}},readColorMapData:function(header){return 0==header.colorMapType?null:this.readPixels(header.colorMapEntrySize,header.colorMapLength,header.alphaChannelBits,!1)},readImageData:function(header,colorMap){switch(header.imageType._hx_index){case 0:return null;case 1:return this.readIndexes(header.bitsPerPixel,header.width*header.height,colorMap,header.colorMapFirstIndex,!1);case 2:return this.readPixels(header.bitsPerPixel,header.width*header.height,header.alphaChannelBits,!1);case 3:return this.readMono(header.bitsPerPixel,header.width*header.height,header.alphaChannelBits,!1);case 4:return this.readIndexes(header.bitsPerPixel,header.width*header.height,colorMap,header.colorMapFirstIndex,!0);case 5:return this.readPixels(header.bitsPerPixel,header.width*header.height,header.alphaChannelBits,!0);case 6:return this.readMono(header.bitsPerPixel,header.width*header.height,header.alphaChannelBits,!0);default:throw haxe_Exception.thrown("Unsupported image data type!")}},readPixels:function(bitsPerPixel,amount,alphaChannelBits,rle){var parsePixel,readEntry,list=new Array(amount),alpha=0!=alphaChannelBits,bitFieldSize=bitsPerPixel/3|0;switch(bitFieldSize>8&&(bitFieldSize=8),bitsPerPixel){case 8:readEntry=$bind($_=this.i,$_.readByte),parsePixel=$bind(this,this.parsePixel1);break;case 16:readEntry=$bind($_=this.i,$_.readUInt16),parsePixel=$bind(this,this.parsePixel2);break;case 24:readEntry=$bind($_=this.i,$_.readUInt24),parsePixel=$bind(this,this.parsePixel3);break;case 32:readEntry=$bind($_=this.i,$_.readInt32),parsePixel=$bind(this,this.parsePixel4);break;default:throw haxe_Exception.thrown("Unsupported bits per pixels amount!")}if(rle)for(var rleChunk,i=0;i<amount;)if(0!=(128&(rleChunk=this.i.readByte()))){rleChunk&=127;for(var pixel=parsePixel(readEntry(),alpha);rleChunk>=0;)list[i++]=pixel,--rleChunk}else for(rleChunk&=127;rleChunk>=0;)list[i++]=parsePixel(readEntry(),alpha),--rleChunk;else for(var _g=0,_g1=amount;_g<_g1;){list[i=_g++]=parsePixel(readEntry(),alpha)}return list},readMono:function(bitsPerPixel,amount,alphaChannelBits,rle){var parsePixel,readEntry,list=new Array(amount),alpha=0!=alphaChannelBits;switch(bitsPerPixel){case 8:readEntry=$bind($_=this.i,$_.readByte),parsePixel=$bind(this,this.parsePixel1);break;case 16:readEntry=$bind($_=this.i,$_.readUInt16),parsePixel=$bind(this,this.parsePixelGreyAlpha);break;default:throw haxe_Exception.thrown("Unsupported bits per pixels amount!")}if(rle)for(var rleChunk,i=0;i<amount;)if(0!=(128&(rleChunk=this.i.readByte()))){rleChunk&=127;for(var pixel=parsePixel(readEntry(),alpha);rleChunk>=0;)list[i++]=pixel,--rleChunk}else for(rleChunk&=127;rleChunk>=0;)list[i++]=parsePixel(readEntry(),alpha),--rleChunk;else for(var _g=0,_g1=amount;_g<_g1;){list[i=_g++]=parsePixel(readEntry(),alpha)}return list},readIndexes:function(bitsPerPixel,amount,colorMap,offset,rle){var readEntry,list=new Array(amount);switch(bitsPerPixel){case 8:readEntry=$bind($_=this.i,$_.readByte);break;case 16:readEntry=$bind($_=this.i,$_.readUInt16);break;case 24:readEntry=$bind($_=this.i,$_.readUInt24);break;case 32:readEntry=$bind($_=this.i,$_.readInt32);break;default:throw haxe_Exception.thrown("Unsupported bits per pixels amount!")}if(rle)for(var rleChunk,i=0;i<amount;)if(0!=(128&(rleChunk=this.i.readByte()))){rleChunk&=127;for(var pixel=colorMap[offset+readEntry()];rleChunk>=0;)list[i++]=pixel,--rleChunk}else for(rleChunk&=127;rleChunk>=0;)list[i++]=colorMap[offset+readEntry()],--rleChunk;else for(var _g=0,_g1=amount;_g<_g1;){list[i=_g++]=colorMap[offset+readEntry()]}return list},parsePixel1:function(value,alpha){return value<<16|value<<8|value},parsePixelGreyAlpha:function(value,alpha){return(alpha?(65280&value)<<16:0)|this.parsePixel1(255&value,!1)},parsePixel2:function(value,alpha){return(alpha&&1==(32768&value)?-16777216:0)|(((31744&value)>>10)/31*255|0)<<16|(((992&value)>>5)/31*255|0)<<8|(31&value)/31*255|0},parsePixel3:function(value,alpha){return value},parsePixel4:function(value,alpha){return value},__class__:format_tga_Reader};var format_tools_BitsInput=function(i){this.i=i,this.nbits=0,this.bits=0};$hxClasses["format.tools.BitsInput"]=format_tools_BitsInput,format_tools_BitsInput.__name__="format.tools.BitsInput",format_tools_BitsInput.prototype={readBits:function(n){if(this.nbits>=n){var c=this.nbits-n,k=this.bits>>>c&(1<<n)-1;return this.nbits=c,k}k=this.i.readByte();if(this.nbits>=24){if(n>31)throw haxe_Exception.thrown("Bits error");c=8+this.nbits-n;var d=this.bits&(1<<this.nbits)-1;return d=d<<8-c|k<<c,this.bits=k,this.nbits=c,d}return this.bits=this.bits<<8|k,this.nbits+=8,this.readBits(n)},readBit:function(){return 0==this.nbits&&(this.bits=this.i.readByte(),this.nbits=8),this.nbits--,1==(this.bits>>>this.nbits&1)},__class__:format_tools_BitsInput};var format_tools_Inflate=function(){};$hxClasses["format.tools.Inflate"]=format_tools_Inflate,format_tools_Inflate.__name__="format.tools.Inflate",format_tools_Inflate.run=function(bytes){return haxe_zip_Uncompress.run(bytes)};var format_wav_WAVEFormat=$hxEnums["format.wav.WAVEFormat"]={__ename__:"format.wav.WAVEFormat",__constructs__:["WF_PCM"],WF_PCM:{_hx_index:0,__enum__:"format.wav.WAVEFormat",toString:$estr}};format_wav_WAVEFormat.__empty_constructs__=[format_wav_WAVEFormat.WF_PCM];var format_wav_Reader=function(i){this.i=i,i.set_bigEndian(!1)};$hxClasses["format.wav.Reader"]=format_wav_Reader,format_wav_Reader.__name__="format.wav.Reader",format_wav_Reader.prototype={read:function(){if("RIFF"!=this.i.readString(4))throw haxe_Exception.thrown("RIFF header expected");this.i.readInt32();if("WAVE"!=this.i.readString(4))throw haxe_Exception.thrown("WAVE signature not found");var fmt=this.i.readString(4);_hx_loop1:for(;"fmt "!=fmt;)switch(fmt){case"JUNK":var junkLen=this.i.readInt32();this.i.read(junkLen),fmt=this.i.readString(4);break;case"bext":var bextLen=this.i.readInt32();this.i.read(bextLen),fmt=this.i.readString(4);break;default:break _hx_loop1}if("fmt "!=fmt)throw haxe_Exception.thrown("unsupported wave chunk "+fmt);var format,fmtlen=this.i.readInt32();switch(this.i.readUInt16()){case 1:case 3:format=format_wav_WAVEFormat.WF_PCM;break;default:throw haxe_Exception.thrown("only PCM (uncompressed) WAV files are supported")}var channels=this.i.readUInt16(),samplingRate=this.i.readInt32(),byteRate=this.i.readInt32(),blockAlign=this.i.readUInt16(),bitsPerSample=this.i.readUInt16();fmtlen>16&&this.i.read(fmtlen-16);for(var nextChunk=this.i.readString(4);"data"!=nextChunk;)this.i.read(this.i.readInt32()),nextChunk=this.i.readString(4);if("data"!=nextChunk)throw haxe_Exception.thrown("expected data subchunk");var data,datalen=this.i.readInt32();try{data=this.i.read(datalen)}catch(_g){throw haxe_Exception.caught(_g).unwrap()instanceof haxe_io_Eof?haxe_Exception.thrown("Invalid chunk data length"):_g}var cuePoints=[];try{for(;;){if("cue "==(nextChunk=this.i.readString(4))){this.i.readInt32();for(var nbCuePoints=this.i.readInt32(),_g=0,_g1=nbCuePoints;_g<_g1;){_g++;var cueId=this.i.readInt32();this.i.readInt32(),this.i.readString(4),this.i.readInt32(),this.i.readInt32();var cueSampleOffset=this.i.readInt32();cuePoints.push({id:cueId,sampleOffset:cueSampleOffset})}}else this.i.read(this.i.readInt32())}}catch(_g){if(!(haxe_Exception.caught(_g).unwrap()instanceof haxe_io_Eof))throw _g}return{header:{format:format,channels:channels,samplingRate:samplingRate,byteRate:byteRate,blockAlign:blockAlign,bitsPerSample:bitsPerSample},data:data,cuePoints:cuePoints}},__class__:format_wav_Reader};var h2d_Object=function(parent){this.alpha=1,this.matA=1,this.matB=0,this.matC=0,this.matD=1,this.absX=0,this.absY=0,this.posChanged=!0,this.x=0,this.posChanged=!0,this.y=0,this.posChanged=!0,this.scaleX=1,this.posChanged=!0,this.scaleY=1,this.posChanged=!0,this.rotation=0,this.blendMode=h2d_BlendMode.Alpha,this.posChanged=null!=parent,this.set_visible(!0),this.children=[],null!=parent&&parent.addChild(this)};$hxClasses["h2d.Object"]=h2d_Object,h2d_Object.__name__="h2d.Object",h2d_Object.prototype={getBounds:function(relativeTo,out){return null==out?out=new h2d_col_Bounds:(out.xMin=1e20,out.yMin=1e20,out.xMax=-1e20,out.yMax=-1e20),null!=relativeTo&&relativeTo.syncPos(),relativeTo!=this&&this.syncPos(),this.getBoundsRec(relativeTo,out,!1),(out.xMax<=out.xMin||out.yMax<=out.yMin)&&(this.addBounds(relativeTo,out,-1,-1,2,2),out.xMax=out.xMin=.5*(out.xMax+out.xMin),out.yMax=out.yMin=.5*(out.yMax+out.yMin)),out},getBoundsRec:function(relativeTo,out,forSize){if(this.posChanged){this.calcAbsPos();for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.posChanged=!0}this.posChanged=!1}var n=this.children.length;if(0==n)return out.xMin=1e20,out.yMin=1e20,out.xMax=-1e20,void(out.yMax=-1e20);if(1!=n){var xmin=1/0,ymin=1/0,xmax=-1/0,ymax=-1/0;for(_g=0,_g1=this.children;_g<_g1.length;){c=_g1[_g];++_g,c.visible&&(c.getBoundsRec(relativeTo,out,forSize),out.xMin<xmin&&(xmin=out.xMin),out.yMin<ymin&&(ymin=out.yMin),out.xMax>xmax&&(xmax=out.xMax),out.yMax>ymax&&(ymax=out.yMax))}out.xMin=xmin,out.yMin=ymin,out.xMax=xmax,out.yMax=ymax}else{(c=this.children[0]).visible?c.getBoundsRec(relativeTo,out,forSize):(out.xMin=1e20,out.yMin=1e20,out.xMax=-1e20,out.yMax=-1e20)}},addBounds:function(relativeTo,out,dx,dy,width,height){if(!(width<=0||height<=0)){if(null==relativeTo){var x=dx*this.matA+dy*this.matC+this.absX,y=dx*this.matB+dy*this.matD+this.absY;x<out.xMin&&(out.xMin=x),x>out.xMax&&(out.xMax=x),y<out.yMin&&(out.yMin=y),y>out.yMax&&(out.yMax=y);x=(dx+width)*this.matA+dy*this.matC+this.absX,y=(dx+width)*this.matB+dy*this.matD+this.absY;x<out.xMin&&(out.xMin=x),x>out.xMax&&(out.xMax=x),y<out.yMin&&(out.yMin=y),y>out.yMax&&(out.yMax=y);x=dx*this.matA+(dy+height)*this.matC+this.absX,y=dx*this.matB+(dy+height)*this.matD+this.absY;x<out.xMin&&(out.xMin=x),x>out.xMax&&(out.xMax=x),y<out.yMin&&(out.yMin=y),y>out.yMax&&(out.yMax=y);x=(dx+width)*this.matA+(dy+height)*this.matC+this.absX,y=(dx+width)*this.matB+(dy+height)*this.matD+this.absY;return x<out.xMin&&(out.xMin=x),x>out.xMax&&(out.xMax=x),y<out.yMin&&(out.yMin=y),void(y>out.yMax&&(out.yMax=y))}if(relativeTo==this)return out.xMin>dx&&(out.xMin=dx),out.yMin>dy&&(out.yMin=dy),out.xMax<dx+width&&(out.xMax=dx+width),void(out.yMax<dy+height&&(out.yMax=dy+height));var r=relativeTo.matA*relativeTo.matD-relativeTo.matB*relativeTo.matC;if(0!=r){var det=1/r,rA=relativeTo.matD*det,rB=-relativeTo.matB*det,rC=-relativeTo.matC*det,rD=relativeTo.matA*det,rX=this.absX-relativeTo.absX,rY=this.absY-relativeTo.absY,y1=(x=dx*this.matA+dy*this.matC+rX)*rB+(y=dx*this.matB+dy*this.matD+rY)*rD;(x1=x*rA+y*rC)<out.xMin&&(out.xMin=x1),x1>out.xMax&&(out.xMax=x1),y1<out.yMin&&(out.yMin=y1),y1>out.yMax&&(out.yMax=y1);y1=(x=(dx+width)*this.matA+dy*this.matC+rX)*rB+(y=(dx+width)*this.matB+dy*this.matD+rY)*rD;(x1=x*rA+y*rC)<out.xMin&&(out.xMin=x1),x1>out.xMax&&(out.xMax=x1),y1<out.yMin&&(out.yMin=y1),y1>out.yMax&&(out.yMax=y1);y1=(x=dx*this.matA+(dy+height)*this.matC+rX)*rB+(y=dx*this.matB+(dy+height)*this.matD+rY)*rD;(x1=x*rA+y*rC)<out.xMin&&(out.xMin=x1),x1>out.xMax&&(out.xMax=x1),y1<out.yMin&&(out.yMin=y1),y1>out.yMax&&(out.yMax=y1);var x1;y1=(x=(dx+width)*this.matA+(dy+height)*this.matC+rX)*rB+(y=(dx+width)*this.matB+(dy+height)*this.matD+rY)*rD;(x1=x*rA+y*rC)<out.xMin&&(out.xMin=x1),x1>out.xMax&&(out.xMax=x1),y1<out.yMin&&(out.yMin=y1),y1>out.yMax&&(out.yMax=y1)}}},localToGlobal:function(pt){this.syncPos(),null==pt&&(pt=new h2d_col_Point);var px=pt.x*this.matA+pt.y*this.matC+this.absX,py=pt.x*this.matB+pt.y*this.matD+this.absY;return pt.x=px,pt.y=py,pt},globalToLocal:function(pt){this.syncPos(),pt.x-=this.absX,pt.y-=this.absY;var invDet=1/(this.matA*this.matD-this.matB*this.matC),px=(pt.x*this.matD-pt.y*this.matC)*invDet,py=(-pt.x*this.matB+pt.y*this.matA)*invDet;return pt.x=px,pt.y=py,pt},getScene:function(){for(var p=this;null!=p.parent;)p=p.parent;return p instanceof h2d_Scene?p:null},set_visible:function(b){return this.visible==b||(this.visible=b,null!=this.parentContainer&&this.parentContainer.contentChanged(this)),b},addChild:function(s){this.addChildAt(s,this.children.length)},addChildAt:function(s,pos){pos<0&&(pos=0),pos>this.children.length&&(pos=this.children.length);for(var p=this;null!=p;){if(p==s)throw haxe_Exception.thrown("Recursive addChild");p=p.parent}if(null!=s.parent){var old=s.allocated;s.allocated=!1,s.parent.removeChild(s),s.allocated=old}this.children.splice(pos,0,s),!this.allocated&&s.allocated&&s.onRemove(),s.parent=this,s.parentContainer=this.parentContainer,s.posChanged=!0,this.allocated&&(s.allocated?s.onHierarchyMoved(!0):s.onAdd()),null!=this.parentContainer&&this.parentContainer.contentChanged(this)},onHierarchyMoved:function(parentChanged){for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.onHierarchyMoved(parentChanged)}},onAdd:function(){this.allocated=!0,null!=this.filter&&this.filter.bind(this);for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.onAdd()}},onRemove:function(){this.allocated=!1,null!=this.filter&&this.filter.unbind(this);for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.onRemove()}},removeChild:function(s){HxOverrides.remove(this.children,s)&&(s.allocated&&s.onRemove(),s.parent=null,null!=s.parentContainer&&s.setParentContainer(null),s.posChanged=!0,null!=this.parentContainer&&this.parentContainer.contentChanged(this))},setParentContainer:function(c){this.parentContainer=c;for(var _g=0,_g1=this.children;_g<_g1.length;){var s=_g1[_g];++_g,s.setParentContainer(c)}},removeChildren:function(){for(;this.children.length>0;)this.removeChild(this.children[0])},draw:function(ctx){},sync:function(ctx){var changed=this.posChanged;changed&&(this.calcAbsPos(),this.posChanged=!1),this.lastFrame=ctx.frame;for(var p=0,len=this.children.length;p<len;){var c=this.children[p];if(null==c)break;c.lastFrame!=ctx.frame&&(changed&&(c.posChanged=!0),c.sync(ctx)),this.children[p]!=c?(p=0,len=this.children.length):++p}},syncPos:function(){if(null!=this.parent&&this.parent.syncPos(),this.posChanged){this.calcAbsPos();for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.posChanged=!0}this.posChanged=!1}},calcAbsPos:function(){if(null==this.parent){0==this.rotation?(cr=1,sr=0,this.matA=this.scaleX,this.matB=0,this.matC=0,this.matD=this.scaleY):(cr=Math.cos(this.rotation),sr=Math.sin(this.rotation),this.matA=this.scaleX*cr,this.matB=this.scaleX*sr,this.matC=this.scaleY*-sr,this.matD=this.scaleY*cr),this.absX=this.x,this.absY=this.y}else{if(0==this.rotation)this.matA=this.scaleX*this.parent.matA,this.matB=this.scaleX*this.parent.matB,this.matC=this.scaleY*this.parent.matC,this.matD=this.scaleY*this.parent.matD;else{var cr=Math.cos(this.rotation),sr=Math.sin(this.rotation),tmpA=this.scaleX*cr,tmpB=this.scaleX*sr,tmpC=this.scaleY*-sr,tmpD=this.scaleY*cr;this.matA=tmpA*this.parent.matA+tmpB*this.parent.matC,this.matB=tmpA*this.parent.matB+tmpB*this.parent.matD,this.matC=tmpC*this.parent.matA+tmpD*this.parent.matC,this.matD=tmpC*this.parent.matB+tmpD*this.parent.matD}this.absX=this.x*this.parent.matA+this.y*this.parent.matC+this.parent.absX,this.absY=this.x*this.parent.matB+this.y*this.parent.matD+this.parent.absY}},emitTile:function(ctx,tile){null==h2d_Object.nullDrawable&&(h2d_Object.nullDrawable=new h2d_Drawable(null)),h2d_Object.nullDrawable.absX=this.absX,h2d_Object.nullDrawable.absY=this.absY,h2d_Object.nullDrawable.matA=this.matA,h2d_Object.nullDrawable.matB=this.matB,h2d_Object.nullDrawable.matC=this.matC,h2d_Object.nullDrawable.matD=this.matD,ctx.drawTile(h2d_Object.nullDrawable,tile)},clipBounds:function(ctx,bounds){var matA,matB,matC,matD,absX,absY,view=ctx.tmpBounds;if(null!=ctx.inFilter){var f1=ctx.baseShader.filterMatrixA__,f2=ctx.baseShader.filterMatrixB__;matA=this.matA*f1.x+this.matB*f1.y,matB=this.matA*f2.x+this.matB*f2.y,matC=this.matC*f1.x+this.matD*f1.y,matD=this.matC*f2.x+this.matD*f2.y,absX=this.absX*f1.x+this.absY*f1.y+f1.z,absY=this.absX*f2.x+this.absY*f2.y+f2.z}else matA=this.matA,matB=this.matB,matC=this.matC,matD=this.matD,absX=this.absX,absY=this.absY;view.xMin=1e20,view.yMin=1e20,view.xMax=-1e20,view.yMax=-1e20;var y1=(x=bounds.xMin)*matB+(y=bounds.yMin)*matD+absY;(x1=x*matA+y*matC+absX)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1);y1=(x=bounds.xMax)*matB+(y=bounds.yMin)*matD+absY;(x1=x*matA+y*matC+absX)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1);y1=(x=bounds.xMin)*matB+(y=bounds.yMax)*matD+absY;(x1=x*matA+y*matC+absX)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1);y1=(x=bounds.xMax)*matB+(y=bounds.yMax)*matD+absY;(x1=x*matA+y*matC+absX)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1),view.xMin<ctx.curX&&(view.xMin=ctx.curX),view.yMin<ctx.curY&&(view.yMin=ctx.curY),view.xMax>ctx.curX+ctx.curWidth&&(view.xMax=ctx.curX+ctx.curWidth),view.yMax>ctx.curY+ctx.curHeight&&(view.yMax=ctx.curY+ctx.curHeight);var invDet=1/(matA*matD-matB*matC),sxMin=view.xMin,syMin=view.yMin,sxMax=view.xMax,syMax=view.yMax;view.xMin=1e20,view.yMin=1e20,view.xMax=-1e20,view.yMax=-1e20;var x=sxMin,y=syMin;y1=(-(x-=absX)*matB+(y-=absY)*matA)*invDet;(x1=(x*matD-y*matC)*invDet)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1);x=sxMax,y=syMin,y1=(-(x-=absX)*matB+(y-=absY)*matA)*invDet;(x1=(x*matD-y*matC)*invDet)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1);x=sxMin,y=syMax,y1=(-(x-=absX)*matB+(y-=absY)*matA)*invDet;(x1=(x*matD-y*matC)*invDet)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1);var x1;x=sxMax,y=syMax,y1=(-(x-=absX)*matB+(y-=absY)*matA)*invDet;(x1=(x*matD-y*matC)*invDet)<view.xMin&&(view.xMin=x1),x1>view.xMax&&(view.xMax=x1),y1<view.yMin&&(view.yMin=y1),y1>view.yMax&&(view.yMax=y1);var a=bounds.xMin,b=view.xMin;bounds.xMin=a<b?b:a;a=bounds.yMin,b=view.yMin;bounds.yMin=a<b?b:a;a=bounds.xMax,b=view.xMax;bounds.xMax=a>b?b:a;a=bounds.yMax,b=view.yMax;bounds.yMax=a>b?b:a},drawFilters:function(ctx){if(ctx.pushFilter(this)){var bounds=ctx.tmpBounds,total=new h2d_col_Bounds,maxExtent=-1;this.filter.sync(ctx,this),this.filter.autoBounds?maxExtent=this.filter.boundsExtend:(this.filter.getBounds(this,bounds),bounds.xMin<total.xMin&&(total.xMin=bounds.xMin),bounds.xMax>total.xMax&&(total.xMax=bounds.xMax),bounds.yMin<total.yMin&&(total.yMin=bounds.yMin),bounds.yMax>total.yMax&&(total.yMax=bounds.yMax)),maxExtent>=0&&(this.getBounds(this,bounds),bounds.xMin-=maxExtent,bounds.yMin-=maxExtent,bounds.xMax+=maxExtent,bounds.yMax+=maxExtent,bounds.xMin<total.xMin&&(total.xMin=bounds.xMin),bounds.xMax>total.xMax&&(total.xMax=bounds.xMax),bounds.yMin<total.yMin&&(total.yMin=bounds.yMin),bounds.yMax>total.yMax&&(total.yMax=bounds.yMax)),this.clipBounds(ctx,total);var xMin=Math.floor(total.xMin+1e-10),yMin=Math.floor(total.yMin+1e-10),width=Math.ceil(total.xMax-xMin-1e-10),height=Math.ceil(total.yMax-yMin-1e-10);if(width<=0||height<=0||total.xMax<total.xMin)ctx.popFilter();else{var t=ctx.textures.allocTarget("filterTemp",width,height,!1);ctx.pushTarget(t,xMin,yMin,width,height),ctx.engine.clear(0);var oldAlpha=ctx.globalAlpha,shader=ctx.baseShader,x=(_this=shader.filterMatrixA__).x,y=_this.y,z=_this.z;null==(w=_this.w)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0);var w,oldA_x=x,oldA_y=y,oldA_z=z,oldA_w=w;x=(_this=shader.filterMatrixB__).x,y=_this.y,z=_this.z;null==(w=_this.w)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0);var oldB_x=x,oldB_y=y,oldB_z=z,oldB_w=w,invDet=(ctx.inFilter,1/(this.matA*this.matD-this.matB*this.matC)),invA=this.matD*invDet,invB=-this.matB*invDet,invC=-this.matC*invDet,invD=this.matA*invDet,invX=-(this.absX*invA+this.absY*invC),invY=-(this.absX*invB+this.absY*invD);null==(z=invX)&&(z=0),null==(y=invC)&&(y=0),null==(x=invA)&&(x=0),(_this=shader.filterMatrixA__).x=x,_this.y=y,_this.z=z,_this.w=1,null==(z=invY)&&(z=0),null==(y=invD)&&(y=0),null==(x=invB)&&(x=0),(_this=shader.filterMatrixB__).x=x,_this.y=y,_this.z=z,_this.w=1,ctx.globalAlpha=1,this.draw(ctx);for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.drawRec(ctx)}var finalTile=h2d_Tile.fromTexture(t);finalTile.dx=xMin,finalTile.dy=yMin;var _this,prev=finalTile;(finalTile=this.filter.draw(ctx,finalTile))!=prev&&null!=finalTile&&(finalTile.dx+=xMin,finalTile.dy+=yMin),(_this=shader.filterMatrixA__).x=oldA_x,_this.y=oldA_y,_this.z=oldA_z,_this.w=oldA_w,(_this=shader.filterMatrixB__).x=oldB_x,_this.y=oldB_y,_this.z=oldB_z,_this.w=oldB_w,ctx.popTarget(),ctx.popFilter(),ctx.globalAlpha=oldAlpha,null!=finalTile&&this.drawFiltered(ctx,finalTile)}}},drawFiltered:function(ctx,tile){var oldAlpha=ctx.globalAlpha;ctx.currentBlend=null,ctx.inFilterBlend=this.blendMode,ctx.globalAlpha*=this.alpha,this.emitTile(ctx,tile),ctx.globalAlpha=oldAlpha,ctx.inFilterBlend=null,ctx.currentBlend=null},drawRec:function(ctx){if(this.visible){if(this.posChanged){this.calcAbsPos();for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.posChanged=!0}this.posChanged=!1}if(null!=this.filter&&this.filter.get_enable())this.drawFilters(ctx);else{var old=ctx.globalAlpha;if(ctx.globalAlpha*=this.alpha,ctx.front2back){var nchilds=this.children.length;for(_g=0,_g1=nchilds;_g<_g1;){var i=_g++;this.children[nchilds-1-i].drawRec(ctx)}this.draw(ctx)}else{this.draw(ctx);for(_g=0,_g1=this.children;_g<_g1.length;){c=_g1[_g];++_g,c.drawRec(ctx)}}ctx.globalAlpha=old}}},contentChanged:function(s){},__class__:h2d_Object};var h2d_Drawable=function(parent){h2d_Object.call(this,parent),this.color=new h3d_Vector(1,1,1,1)};$hxClasses["h2d.Drawable"]=h2d_Drawable,h2d_Drawable.__name__="h2d.Drawable",h2d_Drawable.__super__=h2d_Object,h2d_Drawable.prototype=$extend(h2d_Object.prototype,{drawFiltered:function(ctx,tile){var old=this.shaders;this.shaders=null,h2d_Object.prototype.drawFiltered.call(this,ctx,tile),this.shaders=old},emitTile:function(ctx,tile){null==tile&&(tile=new h2d_Tile(null,0,0,5,5)),ctx.drawTile(this,tile)},__class__:h2d_Drawable});var h2d_Bitmap=function(tile,parent){h2d_Drawable.call(this,parent),this.set_tile(tile)};$hxClasses["h2d.Bitmap"]=h2d_Bitmap,h2d_Bitmap.__name__="h2d.Bitmap",h2d_Bitmap.__super__=h2d_Drawable,h2d_Bitmap.prototype=$extend(h2d_Drawable.prototype,{getBoundsRec:function(relativeTo,out,forSize){h2d_Drawable.prototype.getBoundsRec.call(this,relativeTo,out,forSize),null!=this.tile&&(null==this.width&&null==this.height?this.addBounds(relativeTo,out,this.tile.dx,this.tile.dy,this.tile.width,this.tile.height):this.addBounds(relativeTo,out,this.tile.dx,this.tile.dy,null!=this.width?this.width:this.tile.width*this.height/this.tile.height,null!=this.height?this.height:this.tile.height*this.width/this.tile.width))},set_tile:function(t){return this.tile==t||(this.tile=t,null!=this.parentContainer&&this.parentContainer.contentChanged(this)),t},draw:function(ctx){if(null!=this.width||null!=this.height){null==this.tile&&this.set_tile(h2d_Tile.fromColor(16711935));var ow=this.tile.width,oh=this.tile.height;this.tile.width=null!=this.width?this.width:ow*this.height/oh,this.tile.height=null!=this.height?this.height:oh*this.width/ow,this.emitTile(ctx,this.tile),this.tile.width=ow,this.tile.height=oh}else this.emitTile(ctx,this.tile)},__class__:h2d_Bitmap});var h2d_BlendMode=$hxEnums["h2d.BlendMode"]={__ename__:"h2d.BlendMode",__constructs__:["None","Alpha","Add","AlphaAdd","SoftAdd","Multiply","AlphaMultiply","Erase","Screen","Sub","Max","Min"],None:{_hx_index:0,__enum__:"h2d.BlendMode",toString:$estr},Alpha:{_hx_index:1,__enum__:"h2d.BlendMode",toString:$estr},Add:{_hx_index:2,__enum__:"h2d.BlendMode",toString:$estr},AlphaAdd:{_hx_index:3,__enum__:"h2d.BlendMode",toString:$estr},SoftAdd:{_hx_index:4,__enum__:"h2d.BlendMode",toString:$estr},Multiply:{_hx_index:5,__enum__:"h2d.BlendMode",toString:$estr},AlphaMultiply:{_hx_index:6,__enum__:"h2d.BlendMode",toString:$estr},Erase:{_hx_index:7,__enum__:"h2d.BlendMode",toString:$estr},Screen:{_hx_index:8,__enum__:"h2d.BlendMode",toString:$estr},Sub:{_hx_index:9,__enum__:"h2d.BlendMode",toString:$estr},Max:{_hx_index:10,__enum__:"h2d.BlendMode",toString:$estr},Min:{_hx_index:11,__enum__:"h2d.BlendMode",toString:$estr}};h2d_BlendMode.__empty_constructs__=[h2d_BlendMode.None,h2d_BlendMode.Alpha,h2d_BlendMode.Add,h2d_BlendMode.AlphaAdd,h2d_BlendMode.SoftAdd,h2d_BlendMode.Multiply,h2d_BlendMode.AlphaMultiply,h2d_BlendMode.Erase,h2d_BlendMode.Screen,h2d_BlendMode.Sub,h2d_BlendMode.Max,h2d_BlendMode.Min];var hxd_Interactive=function(){};$hxClasses["hxd.Interactive"]=hxd_Interactive,hxd_Interactive.__name__="hxd.Interactive",hxd_Interactive.__isInterface__=!0,hxd_Interactive.prototype={__class__:hxd_Interactive};var h2d_Interactive=function(width,height,parent,shape){this.shapeY=0,this.shapeX=0,this.mouseDownButton=-1,this.propagateEvents=!1,this.cancelEvents=!1,h2d_Drawable.call(this,parent),this.width=width,this.height=height,this.shape=shape,this.set_cursor(hxd_Cursor.Button)};$hxClasses["h2d.Interactive"]=h2d_Interactive,h2d_Interactive.__name__="h2d.Interactive",h2d_Interactive.__interfaces__=[hxd_Interactive],h2d_Interactive.__super__=h2d_Drawable,h2d_Interactive.prototype=$extend(h2d_Drawable.prototype,{onAdd:function(){this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this),this.updateMask(),h2d_Drawable.prototype.onAdd.call(this)},draw:function(ctx){null!=this.backgroundColor&&this.emitTile(ctx,h2d_Tile.fromColor(this.backgroundColor,0|this.width,0|this.height,(this.backgroundColor>>>24)/255))},getBoundsRec:function(relativeTo,out,forSize){h2d_Drawable.prototype.getBoundsRec.call(this,relativeTo,out,forSize),(null!=this.backgroundColor||forSize)&&this.addBounds(relativeTo,out,0,0,0|this.width,0|this.height)},onHierarchyMoved:function(parentChanged){h2d_Drawable.prototype.onHierarchyMoved.call(this,parentChanged),null!=this.scene&&(this.scene.removeEventTarget(this),this.scene.addEventTarget(this)),parentChanged&&this.updateMask()},updateMask:function(){this.parentMask=null;for(var p=this.parent;null!=p;){var m=p instanceof h2d_Mask?p:null;if(null!=m){this.parentMask=m;break}p=p.parent}},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this,!0),this.scene=null),h2d_Drawable.prototype.onRemove.call(this)},checkBounds:function(e){switch(e.kind._hx_index){case 4:case 6:case 7:case 10:return!1;default:return!0}},getInteractiveScene:function(){return this.scene},handleEvent:function(e){if(null!=this.parentMask&&this.checkBounds(e)){var p=this.parentMask,pt=new h2d_col_Point(e.relX,e.relY);this.localToGlobal(pt);for(var saveX=pt.x,saveY=pt.y;null!=p;){pt.x=saveX,pt.y=saveY;var pt1=p.globalToLocal(pt);if(pt1.x<0||pt1.y<0||pt1.x>p.width||pt1.y>p.height)return void(e.cancel=!0);p=p.parentMask}}if(null==this.shape&&this.isEllipse&&this.checkBounds(e)){var cx=.5*this.width,cy=.5*this.height,dx=(e.relX-cx)/cx,dy=(e.relY-cy)/cy;if(dx*dx+dy*dy>1)return void(e.cancel=!0)}switch(this.propagateEvents&&(e.propagate=!0),this.cancelEvents&&(e.cancel=!0),e.kind._hx_index){case 0:(this.enableRightButton||0==e.button)&&(this.mouseDownButton=e.button,this.onPush(e));break;case 1:(this.enableRightButton||0==e.button)&&(this.onRelease(e),this.mouseDownButton==e.button&&this.onClick(e)),this.mouseDownButton=-1;break;case 2:this.onMove(e);break;case 3:this.onOver(e);break;case 4:this.onOut(e);break;case 5:this.onWheel(e);break;case 6:this.onFocus(e);break;case 7:this.onFocusLost(e);break;case 8:this.onKeyDown(e);break;case 9:this.onKeyUp(e);break;case 10:(this.enableRightButton||0==e.button)&&(this.onRelease(e),this.mouseDownButton==e.button&&this.onReleaseOutside(e)),this.mouseDownButton=-1;break;case 11:this.onTextInput(e);break;case 12:this.onCheck(e)}},calcAbsPos:function(){h2d_Drawable.prototype.calcAbsPos.call(this),this.invDet=1/(this.matA*this.matD-this.matB*this.matC)},set_cursor:function(c){return this.cursor=c,null!=this.scene&&null!=this.scene.events&&this.scene.events.updateCursor(this),c},onOver:function(e){},onOut:function(e){},onPush:function(e){},onRelease:function(e){},onReleaseOutside:function(e){},onClick:function(e){},onMove:function(e){},onWheel:function(e){},onFocus:function(e){},onFocusLost:function(e){},onKeyUp:function(e){},onKeyDown:function(e){},onCheck:function(e){},onTextInput:function(e){},__class__:h2d_Interactive});var h2d_Layers=function(parent){h2d_Object.call(this,parent),this.layersIndexes=[],this.layerCount=0};$hxClasses["h2d.Layers"]=h2d_Layers,h2d_Layers.__name__="h2d.Layers",h2d_Layers.__super__=h2d_Object,h2d_Layers.prototype=$extend(h2d_Object.prototype,{addChild:function(s){this.addChildAt(s,0)},addChildAt:function(s,layer){if(s.parent==this){var old=s.allocated;s.allocated=!1,this.removeChild(s),s.allocated=old}for(;layer>=this.layerCount;)this.layersIndexes[this.layerCount++]=this.children.length;h2d_Object.prototype.addChildAt.call(this,s,this.layersIndexes[layer]);for(var _g=layer,_g1=this.layerCount;_g<_g1;){var i=_g++;this.layersIndexes[i]++}},removeChild:function(s){for(var _g=0,_g1=this.children.length;_g<_g1;){var i=_g++;if(this.children[i]==s){this.children.splice(i,1),s.allocated&&s.onRemove(),s.parent=null,s.posChanged=!0,null!=s.parentContainer&&s.setParentContainer(null);for(var k=this.layerCount-1;k>=0&&this.layersIndexes[k]>i;)this.layersIndexes[k]--,--k;null!=this.parentContainer&&this.parentContainer.contentChanged(this);break}}},__class__:h2d_Layers});var h2d_Mask=function(width,height,parent){this.scrollY=0,this.scrollX=0,h2d_Object.call(this,parent),this.width=width,this.height=height};$hxClasses["h2d.Mask"]=h2d_Mask,h2d_Mask.__name__="h2d.Mask",h2d_Mask.__super__=h2d_Object,h2d_Mask.prototype=$extend(h2d_Object.prototype,{onHierarchyMoved:function(parentChanged){h2d_Object.prototype.onHierarchyMoved.call(this,parentChanged),parentChanged&&this.updateMask()},onAdd:function(){h2d_Object.prototype.onAdd.call(this),this.updateMask()},updateMask:function(){this.parentMask=null;for(var p=this.parent;null!=p;){var m=p instanceof h2d_Mask?p:null;if(null!=m){this.parentMask=m;break}p=p.parent}},calcAbsPos:function(){h2d_Object.prototype.calcAbsPos.call(this),this.absX-=this.scrollX,this.absY-=this.scrollY},getBoundsRec:function(relativeTo,out,forSize){var xMin=out.xMin,yMin=out.yMin,xMax=out.xMax,yMax=out.yMax;if(out.xMin=1e20,out.yMin=1e20,out.xMax=-1e20,out.yMax=-1e20,this.posChanged){this.calcAbsPos();for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.posChanged=!0}this.posChanged=!1}this.addBounds(relativeTo,out,0,0,this.width,this.height);var bxMin=out.xMin,byMin=out.yMin,bxMax=out.xMax,byMax=out.yMax;out.xMin=xMin,out.xMax=xMax,out.yMin=yMin,out.yMax=yMax,h2d_Object.prototype.getBoundsRec.call(this,relativeTo,out,forSize),out.xMin<bxMin&&(out.xMin=xMin>bxMin?bxMin:xMin),out.yMin<byMin&&(out.yMin=yMin>byMin?byMin:yMin),out.xMax>bxMax&&(out.xMax=xMax<bxMax?bxMax:xMax),out.yMax>byMax&&(out.yMax=yMax<byMax?byMax:yMax)},drawRec:function(ctx){var tmp,x1=this.absX+this.scrollX,y1=this.absY+this.scrollY,x2=this.width*this.matA+this.height*this.matC+x1,y2=this.width*this.matB+this.height*this.matD+y1;if(x1>x2&&(tmp=x1,x1=x2,x2=tmp),y1>y2&&(tmp=y1,y1=y2,y2=tmp),ctx.hasRenderZone){var oldX=ctx.renderX,oldY=ctx.renderY,oldW=ctx.renderW,oldH=ctx.renderH;ctx.setRenderZone(x1,y1,x2-x1,y2-y1),h2d_Object.prototype.drawRec.call(this,ctx),ctx.setRenderZone(oldX,oldY,oldW,oldH)}else ctx.setRenderZone(x1,y1,x2-x1,y2-y1),h2d_Object.prototype.drawRec.call(this,ctx),ctx.hasRenderZone=!1,ctx.engine.setRenderZone()},__class__:h2d_Mask});var h3d_impl_RenderContext=function(){this.engine=h3d_Engine.CURRENT,this.frame=0,this.time=0,this.elapsedTime=1/hxd_System.getDefaultFrameRate(),this.textures=new h3d_impl_TextureCache(this)};$hxClasses["h3d.impl.RenderContext"]=h3d_impl_RenderContext,h3d_impl_RenderContext.__name__="h3d.impl.RenderContext",h3d_impl_RenderContext.prototype={dispose:function(){this.textures.dispose()},__class__:h3d_impl_RenderContext};var h2d_RenderContext=function(scene){this.tmpBounds=new h2d_col_Bounds,this.defaultSmooth=!1,this.globalAlpha=1,h3d_impl_RenderContext.call(this),this.scene=scene,this.bufPos=0,this.manager=new h3d_pass_ShaderManager,this.pass=new h3d_mat_Pass("",null),this.pass.depth(!0,h3d_mat_Compare.Always),this.pass.set_culling(h3d_mat_Face.None),this.baseShader=new h3d_shader_Base2d,this.baseShader.setPriority(100),this.baseShader.zValue__=0,this.baseShaderList=new hxsl_ShaderList(this.baseShader),this.targetsStack=[],this.targetsStackIndex=0,this.filterStack=[]};$hxClasses["h2d.RenderContext"]=h2d_RenderContext,h2d_RenderContext.__name__="h2d.RenderContext",h2d_RenderContext.__super__=h3d_impl_RenderContext,h2d_RenderContext.prototype=$extend(h3d_impl_RenderContext.prototype,{dispose:function(){h3d_impl_RenderContext.prototype.dispose.call(this),null!=this.fixedBuffer&&this.fixedBuffer.dispose()},begin:function(){this.texture=null,this.currentObj=null,this.bufPos=0,this.stride=0,this.curX=0,this.curY=0,this.targetFlipY=this.engine.driver.hasFeature(h3d_impl_Feature.BottomLeftCoords)?-1:1,this.baseFlipY=null!=this.engine.getCurrentTarget()?this.targetFlipY:1,this.inFilter=null,this.curWidth=this.scene.width,this.curHeight=this.scene.height,this.manager.globals.set("time",this.time),(_this=this.baseShader).constModified=!0,_this.pixelAlign__=!1;var _this=this.baseShader.halfPixelInverse__,x=.5/this.engine.width;null==(y=.5/this.engine.height)&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=0,_this.w=1;_this=this.baseShader.viewport__,x=.5*-this.scene.width-this.scene.offsetX;var y=.5*-this.scene.height-this.scene.offsetY,z=2/this.scene.width*this.scene.ratioX,w=-2*this.baseFlipY/this.scene.height*this.scene.ratioY;null==w&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w,null==(z=0)&&(z=0),null==(y=0)&&(y=0),null==(x=1)&&(x=0),(_this=this.baseShader.filterMatrixA__).x=x,_this.y=y,_this.z=z,_this.w=1,null==(z=0)&&(z=0),null==(y=1)&&(y=0),null==(x=0)&&(x=0),(_this=this.baseShader.filterMatrixB__).x=x,_this.y=y,_this.z=z,_this.w=1,this.baseShaderList.next=null,this.initShaders(this.baseShaderList),this.engine.selectMaterial(this.pass),this.textures.begin()},initShaders:function(shaders){if(this.currentShaders=shaders,this.compiledShader=this.manager.compileShaders(shaders),null==this.buffers)this.buffers=new h3d_shader_Buffers(this.compiledShader);else{var _this=this.buffers,s=this.compiledShader;_this.vertex.grow(s.vertex),_this.fragment.grow(s.fragment)}this.manager.fillGlobals(this.buffers,this.compiledShader),this.engine.selectShader(this.compiledShader),this.engine.uploadShaderBuffers(this.buffers,0)},end:function(){if(this.texture=null,this.currentObj=null,this.baseShaderList.next=null,0!=this.targetsStackIndex)throw haxe_Exception.thrown("Missing popTarget()")},pushFilter:function(spr){return!(0==this.filterStack.length&&null!=this.onEnterFilter&&!this.onEnterFilter(spr))&&(this.filterStack.push(spr),this.inFilter=spr,!0)},popFilter:function(){var spr=this.filterStack.pop();this.filterStack.length>0?this.inFilter=this.filterStack[this.filterStack.length-1]:(this.inFilter=null,null!=this.onLeaveFilter&&this.onLeaveFilter(spr))},pushTarget:function(t,startX,startY,width,height){null==height&&(height=-1),null==width&&(width=-1),null==startY&&(startY=0),null==startX&&(startX=0),this.engine.pushTarget(t),this.initShaders(this.baseShaderList),width<0&&(width=null==t?this.scene.width:t.width),height<0&&(height=null==t?this.scene.height:t.height);var _this=this.baseShader.halfPixelInverse__,x=.5/(null==t?this.engine.width:t.width);null==(y=.5/(null==t?this.engine.height:t.height))&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=0,_this.w=1;_this=this.baseShader.viewport__,x=.5*-width-startX;var y=.5*-height-startY,z=2/width,w=-2*this.targetFlipY/height;if(null==w&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w,this.targetsStackIndex++,this.targetsStackIndex>this.targetsStack.length)this.targetsStack.push({t:t,x:startX,y:startY,w:width,h:height,hasRZ:this.hasRenderZone,rzX:this.renderX,rzY:this.renderY,rzW:this.renderW,rzH:this.renderH});else{var o=this.targetsStack[this.targetsStackIndex-1];o.t=t,o.x=startX,o.y=startY,o.w=width,o.h=height,o.hasRZ=this.hasRenderZone,o.rzX=this.renderX,o.rzY=this.renderY,o.rzW=this.renderW,o.rzH=this.renderH}this.curX=startX,this.curY=startY,this.curWidth=width,this.curHeight=height,this.currentBlend=null,this.hasRenderZone&&(this.hasRenderZone=!1,this.engine.setRenderZone())},popTarget:function(restore){if(null==restore&&(restore=!0),this.targetsStackIndex<=0)throw haxe_Exception.thrown("Too many popTarget()");var pinf=this.targetsStack[--this.targetsStackIndex];if(this.engine.popTarget(),restore){var t,startX,startY,width,height,ratioX,ratioY,offsetX,offsetY,tinf=this.targetsStack[this.targetsStackIndex-1];null==tinf?(t=null,startX=0,startY=0,width=this.scene.width,height=this.scene.height,ratioX=this.scene.ratioX,ratioY=this.scene.ratioY,offsetX=this.scene.offsetX,offsetY=this.scene.offsetY):(t=tinf.t,startX=tinf.x,startY=tinf.y,width=tinf.w,height=tinf.h,ratioX=1,ratioY=1,offsetX=0,offsetY=0),this.initShaders(this.baseShaderList);var _this=this.baseShader.halfPixelInverse__,x=.5/(null==t?this.engine.width:t.width);null==(y=.5/(null==t?this.engine.height:t.height))&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=0,_this.w=1;_this=this.baseShader.viewport__,x=.5*-width-startX-offsetX;var y=.5*-height-startY-offsetY,z=2/width*ratioX,w=-2*(null==t?this.baseFlipY:this.targetFlipY)/height*ratioY;null==w&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w,this.curX=startX,this.curY=startY,this.curWidth=width,this.curHeight=height}pinf.hasRZ&&this.setRenderZone(pinf.rzX,pinf.rzY,pinf.rzW,pinf.rzH)},setRenderZone:function(x,y,w,h){this.hasRenderZone=!0,this.renderX=x,this.renderY=y,this.renderW=w,this.renderH=h;var scaleX=this.engine.width*this.scene.ratioX/this.scene.width,scaleY=this.engine.height*this.scene.ratioY/this.scene.height;if(null!=this.inFilter){var fa=this.baseShader.filterMatrixA__,fb=this.baseShader.filterMatrixB__,x2=x+w,y2=y+h,rx1=x*fa.x+y*fa.y+fa.z,ry1=x*fb.x+y*fb.y+fb.z;x=rx1,y=ry1,w=x2*fa.x+y2*fa.y+fa.z-rx1,h=x2*fb.x+y2*fb.y+fb.z-ry1}this.engine.setRenderZone((x-this.curX+this.scene.viewportX)*scaleX+1e-10|0,(y-this.curY+this.scene.viewportY)*scaleY+1e-10|0,w*scaleX+1e-10|0,h*scaleY+1e-10|0)},drawScene:function(){this.scene.drawRec(this)},beforeDraw:function(){null==this.texture&&(this.texture=h3d_mat_Texture.fromColor(16711935)),this.baseShader.texture__=this.texture,this.texture.set_filter((null==this.currentObj.smooth?this.defaultSmooth:this.currentObj.smooth)?h3d_mat_Filter.Linear:h3d_mat_Filter.Nearest),this.texture.set_wrap(!this.currentObj.tileWrap||null!=this.currentObj.filter&&null==this.inFilter?h3d_mat_Wrap.Clamp:h3d_mat_Wrap.Repeat);var blend=this.currentObj.blendMode;this.inFilter==this.currentObj&&blend==h2d_BlendMode.Erase&&(blend=h2d_BlendMode.Add),null!=this.inFilterBlend&&(blend=this.inFilterBlend),blend!=this.currentBlend&&(this.currentBlend=blend,this.pass.setBlendMode(blend),blend!=h2d_BlendMode.Alpha&&blend!=h2d_BlendMode.Add||(this.pass.set_blendAlphaSrc(h3d_mat_Blend.One),null!=this.inFilterBlend&&this.pass.set_blendSrc(h3d_mat_Blend.One))),this.manager.fillParams(this.buffers,this.compiledShader,this.currentShaders),this.engine.selectMaterial(this.pass),this.engine.uploadShaderBuffers(this.buffers,1),this.engine.uploadShaderBuffers(this.buffers,2),this.engine.uploadShaderBuffers(this.buffers,3)},beginDrawObject:function(obj,texture){if(!this.beginDraw(obj,texture,!0))return!1;if(this.inFilter==obj){var _this=this.baseShader.color__,x=obj.color.x,y=obj.color.y,z=obj.color.z;null==(w=obj.color.w)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w}else if(null!=this.inFilterBlend){_this=this.baseShader.color__,x=this.globalAlpha,y=this.globalAlpha,z=this.globalAlpha;null==(w=this.globalAlpha)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w}else{var w;_this=this.baseShader.color__,x=obj.color.x,y=obj.color.y,z=obj.color.z;null==(w=obj.color.w*this.globalAlpha)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w}_this=this.baseShader.absoluteMatrixA__,x=obj.matA,y=obj.matC;null==(z=obj.absX)&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=1;_this=this.baseShader.absoluteMatrixB__,x=obj.matB,y=obj.matD;return null==(z=obj.absY)&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=1,this.beforeDraw(),!0},drawTile:function(obj,tile){var matA,matB,matC,matD,absX,absY;if(null!=this.inFilter){var f1=this.baseShader.filterMatrixA__,f2=this.baseShader.filterMatrixB__;matA=obj.matA*f1.x+obj.matB*f1.y,matB=obj.matA*f2.x+obj.matB*f2.y,matC=obj.matC*f1.x+obj.matD*f1.y,matD=obj.matC*f2.x+obj.matD*f2.y,absX=obj.absX*f1.x+obj.absY*f1.y+f1.z,absY=obj.absX*f2.x+obj.absY*f2.y+f2.z}else matA=obj.matA,matB=obj.matB,matC=obj.matC,matD=obj.matD,absX=obj.absX,absY=obj.absY;if(0==matB&&0==matC){var f,tx=tile.dx+.5*tile.width,ty=tile.dy+.5*tile.height,a=(f=obj.matA)<0?-f:f,b=(f=obj.matD)<0?-f:f,tr=1.5*(tile.width>tile.height?tile.width:tile.height)*(a<b?b:a),cx=absX+tx*matA-this.curX,cy=absY+ty*matD-this.curY;if(cx<-tr||cy<-tr||cx-tr>this.curWidth||cy-tr>this.curHeight)return!1}else{var xMin=1e20,yMin=1e20,xMax=-1e20,yMax=-1e20;tile.width,tile.height;(px=tile.dx*matA+tile.dy*matC)<xMin&&(xMin=px),px>xMax&&(xMax=px),(py=tile.dx*matB+tile.dy*matD)<yMin&&(yMin=py),py>yMax&&(yMax=py),(px=((x=tile.width)+tile.dx)*matA+tile.dy*matC)<xMin&&(xMin=px),px>xMax&&(xMax=px),(py=(x+tile.dx)*matB+tile.dy*matD)<yMin&&(yMin=py),py>yMax&&(yMax=py);var y=tile.height;(px=tile.dx*matA+(y+tile.dy)*matC)<xMin&&(xMin=px),px>xMax&&(xMax=px),(py=tile.dx*matB+(y+tile.dy)*matD)<yMin&&(yMin=py),py>yMax&&(yMax=py);var px,py,x=tile.width;y=tile.height;(px=(x+tile.dx)*matA+(y+tile.dy)*matC)<xMin&&(xMin=px),px>xMax&&(xMax=px),(py=(x+tile.dx)*matB+(y+tile.dy)*matD)<yMin&&(yMin=py),py>yMax&&(yMax=py);cx=absX-this.curX,cy=absY-this.curY;if(cx+xMax<0||cy+yMax<0||cx+xMin>this.curWidth||cy+yMin>this.curHeight)return!1}if(!this.beginDraw(obj,tile.innerTex,!0,!0))return!1;if(this.inFilter==obj){var _this=this.baseShader.color__,z=(x=obj.color.x,y=obj.color.y,obj.color.z);null==(w=obj.color.w)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w}else if(null!=this.inFilterBlend){_this=this.baseShader.color__,x=this.globalAlpha,y=this.globalAlpha,z=this.globalAlpha;null==(w=this.globalAlpha)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w}else{_this=this.baseShader.color__,x=obj.color.x,y=obj.color.y,z=obj.color.z;null==(w=obj.color.w*this.globalAlpha)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w}_this=this.baseShader.absoluteMatrixA__,x=tile.width*obj.matA,y=tile.height*obj.matC;null==(z=obj.absX+tile.dx*obj.matA+tile.dy*obj.matC)&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=1;_this=this.baseShader.absoluteMatrixB__,x=tile.width*obj.matB,y=tile.height*obj.matD;null==(z=obj.absY+tile.dx*obj.matB+tile.dy*obj.matD)&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=1;var w;_this=this.baseShader.uvPos__,x=tile.u,y=tile.v,z=tile.u2-tile.u;if(null==(w=tile.v2-tile.v)&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w,this.beforeDraw(),null==this.fixedBuffer||this.fixedBuffer.isDisposed()){this.fixedBuffer=new h3d_Buffer(4,8,[h3d_BufferFlag.Quads,h3d_BufferFlag.RawFormat]);var k=hxd__$FloatBuffer_Float32Expand._new(0),v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=0;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v;var newSize,newArray;v=1;if(k.pos==k.array.length)(newSize=k.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(k.array),k.array=newArray;k.array[k.pos++]=v,this.fixedBuffer.uploadVector(k,0,4)}return(_this=this.engine).renderBuffer(this.fixedBuffer,_this.mem.quadIndexes,2,0,-1),!0},beginDraw:function(obj,texture,isRelative,hasUVPos){if(null==hasUVPos&&(hasUVPos=!1),null!=this.onBeginDraw&&!this.onBeginDraw(obj))return!1;for(var _this,shaderChanged=!1,paramsChanged=!1,objShaders=obj.shaders,curShaders=this.currentShaders.next;null!=objShaders&&null!=curShaders;){var s=objShaders.s,t=curShaders.s;objShaders=objShaders.next,curShaders=curShaders.next;var prevInst=t.instance;s!=t&&(paramsChanged=!0),s.updateConstants(this.manager.globals),s.instance!=prevInst&&(shaderChanged=!0)}if(null==objShaders&&null==curShaders&&this.baseShader.isRelative__==isRelative&&this.baseShader.hasUVPos__==hasUVPos&&this.baseShader.killAlpha__==this.killAlpha||(shaderChanged=!0),shaderChanged)(_this=this.baseShader).constModified=!0,_this.hasUVPos__=hasUVPos,(_this=this.baseShader).constModified=!0,_this.isRelative__=isRelative,(_this=this.baseShader).constModified=!0,_this.killAlpha__=this.killAlpha,this.baseShader.updateConstants(this.manager.globals),this.baseShaderList.next=obj.shaders,this.initShaders(this.baseShaderList);else if(paramsChanged){if(this.currentShaders!=this.baseShaderList)throw haxe_Exception.thrown("!");this.currentShaders.next=obj.shaders}return this.texture=texture,this.stride=8,this.currentObj=obj,!0},__class__:h2d_RenderContext});var h2d_ScaleModeAlign=$hxEnums["h2d.ScaleModeAlign"]={__ename__:"h2d.ScaleModeAlign",__constructs__:["Left","Right","Center","Top","Bottom"],Left:{_hx_index:0,__enum__:"h2d.ScaleModeAlign",toString:$estr},Right:{_hx_index:1,__enum__:"h2d.ScaleModeAlign",toString:$estr},Center:{_hx_index:2,__enum__:"h2d.ScaleModeAlign",toString:$estr},Top:{_hx_index:3,__enum__:"h2d.ScaleModeAlign",toString:$estr},Bottom:{_hx_index:4,__enum__:"h2d.ScaleModeAlign",toString:$estr}};h2d_ScaleModeAlign.__empty_constructs__=[h2d_ScaleModeAlign.Left,h2d_ScaleModeAlign.Right,h2d_ScaleModeAlign.Center,h2d_ScaleModeAlign.Top,h2d_ScaleModeAlign.Bottom];var h2d_ScaleMode=$hxEnums["h2d.ScaleMode"]={__ename__:"h2d.ScaleMode",__constructs__:["Resize","Stretch","LetterBox","Fixed","Zoom","AutoZoom"],Resize:{_hx_index:0,__enum__:"h2d.ScaleMode",toString:$estr},Stretch:($_=function(width,height){return{_hx_index:1,width:width,height:height,__enum__:"h2d.ScaleMode",toString:$estr}},$_.__params__=["width","height"],$_),LetterBox:($_=function(width,height,integerScale,horizontalAlign,verticalAlign){return{_hx_index:2,width:width,height:height,integerScale:integerScale,horizontalAlign:horizontalAlign,verticalAlign:verticalAlign,__enum__:"h2d.ScaleMode",toString:$estr}},$_.__params__=["width","height","integerScale","horizontalAlign","verticalAlign"],$_),Fixed:($_=function(width,height,zoom,horizontalAlign,verticalAlign){return{_hx_index:3,width:width,height:height,zoom:zoom,horizontalAlign:horizontalAlign,verticalAlign:verticalAlign,__enum__:"h2d.ScaleMode",toString:$estr}},$_.__params__=["width","height","zoom","horizontalAlign","verticalAlign"],$_),Zoom:($_=function(level){return{_hx_index:4,level:level,__enum__:"h2d.ScaleMode",toString:$estr}},$_.__params__=["level"],$_),AutoZoom:($_=function(minWidth,minHeight,integerScaling){return{_hx_index:5,minWidth:minWidth,minHeight:minHeight,integerScaling:integerScaling,__enum__:"h2d.ScaleMode",toString:$estr}},$_.__params__=["minWidth","minHeight","integerScaling"],$_)};h2d_ScaleMode.__empty_constructs__=[h2d_ScaleMode.Resize];var hxd_InteractiveScene=function(){};$hxClasses["hxd.InteractiveScene"]=hxd_InteractiveScene,hxd_InteractiveScene.__name__="hxd.InteractiveScene",hxd_InteractiveScene.__isInterface__=!0,hxd_InteractiveScene.prototype={__class__:hxd_InteractiveScene};var h2d_Scene=function(){this.scaleMode=h2d_ScaleMode.Resize,h2d_Layers.call(this,null);var e=h3d_Engine.CURRENT;this.ctx=new h2d_RenderContext(this),this.width=e.width,this.height=e.height,this.offsetX=0,this.offsetY=0,this.ratioX=1,this.ratioY=1,this.viewportX=0,this.viewportY=0,this.interactive=[],this.eventListeners=[],this.shapePoint=new h2d_col_Point,this.window=hxd_Window.getInstance(),this.posChanged=!0};$hxClasses["h2d.Scene"]=h2d_Scene,h2d_Scene.__name__="h2d.Scene",h2d_Scene.__interfaces__=[hxd_InteractiveScene,h3d_IDrawable],h2d_Scene.__super__=h2d_Layers,h2d_Scene.prototype=$extend(h2d_Layers.prototype,{setEvents:function(events){this.events=events},set_scaleMode:function(v){return this.scaleMode=v,this.checkResize(),v},checkResize:function(){var engine=h3d_Engine.CURRENT,_g=this.scaleMode;switch(_g._hx_index){case 0:var w=engine.width,h=engine.height;w==this.width&&h==this.height||(this.width=w,this.height=h,this.posChanged=!0),this.ratioX=1,this.ratioY=1,this.offsetX=0,this.offsetY=0,this.viewportX=0,this.viewportY=0;break;case 1:var _height=_g.height;(_width=_g.width)==this.width&&_height==this.height||(this.width=_width,this.height=_height,this.posChanged=!0),this.ratioX=1,this.ratioY=1,this.offsetX=0,this.offsetY=0,this.viewportX=0,this.viewportY=0;break;case 2:var verticalAlign=_g.verticalAlign,horizontalAlign=_g.horizontalAlign,integerScale=_g.integerScale;_height=_g.height;(_width=_g.width)==this.width&&_height==this.height||(this.width=_width,this.height=_height,this.posChanged=!0);var zoom=(a=engine.width/_width)>(b=engine.height/_height)?b:a;integerScale&&0==(zoom|=0)&&(zoom=1),this.ratioX=this.width*zoom/engine.width,this.ratioY=this.height*zoom/engine.height;var vertical=verticalAlign;switch(null==(horizontal=horizontalAlign)&&(horizontal=h2d_ScaleModeAlign.Center),horizontal._hx_index){case 0:this.offsetX=(engine.width-this.width*zoom)/(2*zoom),this.viewportX=0;break;case 1:this.offsetX=-(engine.width-this.width*zoom)/(2*zoom),this.viewportX=(engine.width-this.width*zoom)/zoom;break;default:this.offsetX=-(engine.width-this.width*zoom)/2%1*.5,this.viewportX=(engine.width-this.width*zoom)/(2*zoom)}switch(null==vertical&&(vertical=h2d_ScaleModeAlign.Center),vertical._hx_index){case 3:this.offsetY=(engine.height-this.height*zoom)/(2*zoom),this.viewportY=0;break;case 4:this.offsetY=-(engine.height-this.height*zoom)/(2*zoom),this.viewportY=(engine.height-this.height*zoom)/zoom;break;default:this.offsetY=-(engine.height-this.height*zoom)/2%1*.5,this.viewportY=(engine.height-this.height*zoom)/(2*zoom)}break;case 3:var _width;verticalAlign=_g.verticalAlign,horizontalAlign=_g.horizontalAlign,zoom=_g.zoom,_height=_g.height;(_width=_g.width)==this.width&&_height==this.height||(this.width=_width,this.height=_height,this.posChanged=!0),this.ratioX=this.width*zoom/engine.width,this.ratioY=this.height*zoom/engine.height;var horizontal;vertical=verticalAlign;switch(null==(horizontal=horizontalAlign)&&(horizontal=h2d_ScaleModeAlign.Center),horizontal._hx_index){case 0:this.offsetX=(engine.width-this.width*zoom)/(2*zoom),this.viewportX=0;break;case 1:this.offsetX=-(engine.width-this.width*zoom)/(2*zoom),this.viewportX=(engine.width-this.width*zoom)/zoom;break;default:this.offsetX=-(engine.width-this.width*zoom)/2%1*.5,this.viewportX=(engine.width-this.width*zoom)/(2*zoom)}switch(null==vertical&&(vertical=h2d_ScaleModeAlign.Center),vertical._hx_index){case 3:this.offsetY=(engine.height-this.height*zoom)/(2*zoom),this.viewportY=0;break;case 4:this.offsetY=-(engine.height-this.height*zoom)/(2*zoom),this.viewportY=(engine.height-this.height*zoom)/zoom;break;default:this.offsetY=-(engine.height-this.height*zoom)/2%1*.5,this.viewportY=(engine.height-this.height*zoom)/(2*zoom)}break;case 4:var level=_g.level;w=Math.ceil(engine.width/level),h=Math.ceil(engine.height/level);w==this.width&&h==this.height||(this.width=w,this.height=h,this.posChanged=!0),this.ratioX=this.width*level/engine.width,this.ratioY=this.height*level/engine.height,this.offsetX=0,this.offsetY=0,this.viewportX=0,this.viewportY=0;break;case 5:var a,b,integerScaling=_g.integerScaling,minHeight=_g.minHeight,minWidth=_g.minWidth;zoom=(a=engine.width/minWidth)>(b=engine.height/minHeight)?b:a;integerScaling&&0==(zoom|=0)&&(zoom=1);w=Math.ceil(engine.width/zoom),h=Math.ceil(engine.height/zoom);w==this.width&&h==this.height||(this.width=w,this.height=h,this.posChanged=!0),this.ratioX=this.width*zoom/engine.width,this.ratioY=this.height*zoom/engine.height,this.offsetX=0,this.offsetY=0,this.viewportX=0,this.viewportY=0}},dispatchListeners:function(event){this.screenToViewport(event);for(var _g=0,_g1=this.eventListeners;_g<_g1.length;){var l=_g1[_g];if(++_g,l(event),!event.propagate)break}},isInteractiveVisible:function(i){for(var s=i;s!=this;){if(null==s||!s.visible)return!1;s=s.parent}return!0},screenToViewport:function(e){e.relX=e.relX*this.width/(this.window.get_width()*this.ratioX)-this.viewportX,e.relY=e.relY*this.height/(this.window.get_height()*this.ratioY)-this.viewportY},dispatchEvent:function(event,to){var i=to;this.screenToViewport(event);var dx=event.relX-i.absX,dy=event.relY-i.absY,rx=(dx*i.matD-dy*i.matC)*i.invDet,ry=(dy*i.matA-dx*i.matB)*i.invDet;event.relX=rx,event.relY=ry,i.handleEvent(event)},handleEvent:function(event,last){this.screenToViewport(event);for(var ex=event.relX,ey=event.relY,index=null==last?0:this.interactive.indexOf(last)+1,pt=this.shapePoint,_g=index,_g1=this.interactive.length;_g<_g1;){var idx=_g++,i=this.interactive[idx];if(null==i)break;if(0!=i.invDet){var dx=ex-i.absX,dy=ey-i.absY,rx=(dx*i.matD-dy*i.matC)*i.invDet,ry=(dy*i.matA-dx*i.matB)*i.invDet;if(null!=i.shape){if(pt.x=rx+i.shapeX,pt.y=ry+i.shapeY,!i.shape.contains(pt))continue}else if(ry<0||rx<0||rx>=i.width||ry>=i.height)continue;for(var visible=!0,p=i;null!=p;){if(!p.visible){visible=!1;break}p=p.parent}if(visible){if(event.relX=rx,event.relY=ry,i.handleEvent(event),!event.cancel)return i;event.cancel=!1,event.propagate=!1}}}return null},addEventTarget:function(i){for(var i1=i,lv=0;null!=i1;)i1=i1.parent,++lv;for(var level=lv,_g=0,_g1=this.interactive.length;_g<_g1;){var index=_g++,i2=(i1=i,this.interactive[index]),lv1=level,i3=i2;for(lv=0;null!=i3;)i3=i3.parent,++lv;for(var lv2=lv,p1=i1,p2=i2;lv1>lv2;)i1=p1,p1=p1.parent,--lv1;for(;lv2>lv1;)i2=p2,p2=p2.parent,--lv2;for(;p1!=p2;)i1=p1,p1=p1.parent,i2=p2,p2=p2.parent;for(var id=-1,_g2=0,_g3=p1.children.length;_g2<_g3;){var k=_g2++;if(p1.children[k]==i1){id=k;break}}for(var tmp=id,id1=-1,_g4=0,_g5=p2.children.length;_g4<_g5;){var k1=_g4++;if(p2.children[k1]==i2){id1=k1;break}}if(tmp>id1)return void this.interactive.splice(index,0,i)}this.interactive.push(i)},removeEventTarget:function(i,notify){null==notify&&(notify=!1),HxOverrides.remove(this.interactive,i),notify&&null!=this.events&&this.events.onRemove(i)},dispose:function(){this.allocated&&this.onRemove(),this.ctx.dispose()},setElapsedTime:function(v){this.ctx.elapsedTime=v},render:function(engine){this.ctx.engine=engine,this.ctx.frame++,this.ctx.time+=this.ctx.elapsedTime,this.ctx.globalAlpha=this.alpha,this.sync(this.ctx),0!=this.children.length&&(this.ctx.begin(),this.ctx.drawScene(),this.ctx.end())},sync:function(ctx){this.allocated||this.onAdd(),h2d_Layers.prototype.sync.call(this,ctx)},onAdd:function(){this.checkResize(),h2d_Layers.prototype.onAdd.call(this),this.window.addResizeEvent($bind(this,this.checkResize))},onRemove:function(){h2d_Layers.prototype.onRemove.call(this),this.window.removeResizeEvent($bind(this,this.checkResize))},__class__:h2d_Scene});var h2d_BatchElement=function(t){this.x=0,this.y=0,this.r=1,this.g=1,this.b=1,this.a=1,this.rotation=0,this.scaleX=this.scaleY=1,this.visible=!0,this.t=t};$hxClasses["h2d.BatchElement"]=h2d_BatchElement,h2d_BatchElement.__name__="h2d.BatchElement",h2d_BatchElement.prototype={update:function(et){return!0},remove:function(){null!=this.batch&&this.batch.delete(this)},__class__:h2d_BatchElement};var h2d_SpriteBatch=function(t,parent){h2d_Drawable.call(this,parent),this.tile=t};$hxClasses["h2d.SpriteBatch"]=h2d_SpriteBatch,h2d_SpriteBatch.__name__="h2d.SpriteBatch",h2d_SpriteBatch.__super__=h2d_Drawable,h2d_SpriteBatch.prototype=$extend(h2d_Drawable.prototype,{delete:function(e){null==e.prev?this.first==e&&(this.first=e.next):e.prev.next=e.next,null==e.next?this.last==e&&(this.last=e.prev):e.next.prev=e.prev,e.batch=null},sync:function(ctx){if(h2d_Drawable.prototype.sync.call(this,ctx),this.hasUpdate)for(var e=this.first;null!=e;)e.update(ctx.elapsedTime)||e.remove(),e=e.next;this.flush()},getBoundsRec:function(relativeTo,out,forSize){h2d_Drawable.prototype.getBoundsRec.call(this,relativeTo,out,forSize);for(var e=this.first;null!=e;){var t=e.t;if(this.hasRotationScale){var ca=Math.cos(e.rotation),sa=Math.sin(e.rotation),hx=t.width,hy=t.height,px=t.dx*e.scaleX,py=t.dy*e.scaleY,x=px*ca-py*sa+e.x,y=py*ca+px*sa+e.y;this.addBounds(relativeTo,out,x,y,1e-10,1e-10);var px1=(t.dx+hx)*e.scaleX,py1=t.dy*e.scaleY;x=px1*ca-py1*sa+e.x,y=py1*ca+px1*sa+e.y,this.addBounds(relativeTo,out,x,y,1e-10,1e-10);var px2=t.dx*e.scaleX,py2=(t.dy+hy)*e.scaleY;x=px2*ca-py2*sa+e.x,y=py2*ca+px2*sa+e.y,this.addBounds(relativeTo,out,x,y,1e-10,1e-10);var px3=(t.dx+hx)*e.scaleX,py3=(t.dy+hy)*e.scaleY;x=px3*ca-py3*sa+e.x,y=py3*ca+px3*sa+e.y,this.addBounds(relativeTo,out,x,y,1e-10,1e-10)}else this.addBounds(relativeTo,out,e.x+t.dx,e.y+t.dy,t.width,t.height);e=e.next}},flush:function(){if(null!=this.first){if(null==this.tmpBuf){var this1=hxd__$FloatBuffer_Float32Expand._new(0);this.tmpBuf=this1}for(var pos=0,e=this.first,tmp=this.tmpBuf;null!=e;)if(e.visible){for(var t=e.t,_g=tmp.pos,_g1=pos+32;_g<_g1;){_g++;if(tmp.pos==tmp.array.length){var newSize=tmp.array.length<<1;newSize<128&&(newSize=128);var newArray=new Float32Array(newSize);newArray.set(tmp.array),tmp.array=newArray}tmp.array[tmp.pos++]=0}if(this.hasRotationScale){var ca=Math.cos(e.rotation),sa=Math.sin(e.rotation),hx=t.width,hy=t.height,px=t.dx*e.scaleX,py=t.dy*e.scaleY;tmp.array[pos++]=px*ca-py*sa+e.x,tmp.array[pos++]=py*ca+px*sa+e.y,tmp.array[pos++]=t.u,tmp.array[pos++]=t.v,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a;var px1=(t.dx+hx)*e.scaleX,py1=t.dy*e.scaleY;tmp.array[pos++]=px1*ca-py1*sa+e.x,tmp.array[pos++]=py1*ca+px1*sa+e.y,tmp.array[pos++]=t.u2,tmp.array[pos++]=t.v,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a;var px2=t.dx*e.scaleX,py2=(t.dy+hy)*e.scaleY;tmp.array[pos++]=px2*ca-py2*sa+e.x,tmp.array[pos++]=py2*ca+px2*sa+e.y,tmp.array[pos++]=t.u,tmp.array[pos++]=t.v2,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a;var px3=(t.dx+hx)*e.scaleX,py3=(t.dy+hy)*e.scaleY;tmp.array[pos++]=px3*ca-py3*sa+e.x,tmp.array[pos++]=py3*ca+px3*sa+e.y,tmp.array[pos++]=t.u2,tmp.array[pos++]=t.v2,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a}else{var sx=e.x+t.dx,sy=e.y+t.dy;tmp.array[pos++]=sx,tmp.array[pos++]=sy,tmp.array[pos++]=t.u,tmp.array[pos++]=t.v,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a,tmp.array[pos++]=sx+t.width+.1,tmp.array[pos++]=sy,tmp.array[pos++]=t.u2,tmp.array[pos++]=t.v,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a,tmp.array[pos++]=sx,tmp.array[pos++]=sy+t.height+.1,tmp.array[pos++]=t.u,tmp.array[pos++]=t.v2,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a,tmp.array[pos++]=sx+t.width+.1,tmp.array[pos++]=sy+t.height+.1,tmp.array[pos++]=t.u2,tmp.array[pos++]=t.v2,tmp.array[pos++]=e.r,tmp.array[pos++]=e.g,tmp.array[pos++]=e.b,tmp.array[pos++]=e.a}e=e.next}else e=e.next;if(this.bufferVertices=pos>>3,null!=this.buffer&&!this.buffer.isDisposed()){if(this.buffer.vertices>=this.bufferVertices)return void this.buffer.uploadVector(this.tmpBuf,0,this.bufferVertices);this.buffer.dispose(),this.buffer=null}this.bufferVertices>0&&(this.buffer=h3d_Buffer.ofSubFloats(this.tmpBuf,8,this.bufferVertices,[h3d_BufferFlag.Dynamic,h3d_BufferFlag.Quads,h3d_BufferFlag.RawFormat]))}else this.bufferVertices=0},draw:function(ctx){this.drawWith(ctx,this)},drawWith:function(ctx,obj){if(null!=this.first&&null!=this.buffer&&!this.buffer.isDisposed()&&0!=this.bufferVertices&&ctx.beginDrawObject(obj,this.tile.innerTex)){var _this=ctx.engine,start=0,max=this.bufferVertices>>1;null==max&&(max=-1),null==start&&(start=0),_this.renderBuffer(this.buffer,_this.mem.quadIndexes,2,start,max)}},onRemove:function(){h2d_Drawable.prototype.onRemove.call(this),null!=this.buffer&&(this.buffer.dispose(),this.buffer=null)},__class__:h2d_SpriteBatch});var h2d_Tile=function(tex,x,y,w,h,dx,dy){null==dy&&(dy=0),null==dx&&(dx=0),this.innerTex=tex,this.x=x,this.y=y,this.width=w,this.height=h,this.dx=dx,this.dy=dy,null!=tex&&this.setTexture(tex)};$hxClasses["h2d.Tile"]=h2d_Tile,h2d_Tile.__name__="h2d.Tile",h2d_Tile.fromColor=function(color,width,height,alpha){null==alpha&&(alpha=1),null==height&&(height=1),null==width&&(width=1);var t=new h2d_Tile(h3d_mat_Texture.fromColor(color,alpha),0,0,1,1);return t.width=width,t.height=height,t},h2d_Tile.fromTexture=function(t){return new h2d_Tile(t,0,0,t.width,t.height)},h2d_Tile.prototype={setTexture:function(tex){this.innerTex=tex,null!=tex&&(this.u=this.x/tex.width,this.v=this.y/tex.height,this.u2=(this.x+this.width)/tex.width,this.v2=(this.y+this.height)/tex.height)},sub:function(x,y,w,h,dx,dy){return null==dy&&(dy=0),null==dx&&(dx=0),new h2d_Tile(this.innerTex,this.x+x,this.y+y,w,h,dx,dy)},center:function(){return this.sub(0,0,this.width,this.height,-.5*this.width,-.5*this.height)},setSize:function(w,h){this.width=w,this.height=h;var tex=this.innerTex;null!=tex&&(this.u2=(this.x+w)/tex.width,this.v2=(this.y+h)/tex.height)},__class__:h2d_Tile};var h2d_col_Bounds=function(){this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20};$hxClasses["h2d.col.Bounds"]=h2d_col_Bounds,h2d_col_Bounds.__name__="h2d.col.Bounds",h2d_col_Bounds.prototype={__class__:h2d_col_Bounds};var h2d_col_Collider=function(){};$hxClasses["h2d.col.Collider"]=h2d_col_Collider,h2d_col_Collider.__name__="h2d.col.Collider",h2d_col_Collider.__isInterface__=!0,h2d_col_Collider.prototype={__class__:h2d_col_Collider};var h2d_col_IBounds=function(){this.xMin=2147483647,this.yMin=2147483647,this.xMax=-2147483648,this.yMax=-2147483648};$hxClasses["h2d.col.IBounds"]=h2d_col_IBounds,h2d_col_IBounds.__name__="h2d.col.IBounds",h2d_col_IBounds.prototype={__class__:h2d_col_IBounds};var h2d_col_Point=function(x,y){null==y&&(y=0),null==x&&(x=0),this.x=x,this.y=y};$hxClasses["h2d.col.Point"]=h2d_col_Point,h2d_col_Point.__name__="h2d.col.Point",h2d_col_Point.prototype={__class__:h2d_col_Point};var h2d_filter_Filter=function(){this.enable=!0,this.boundsExtend=0,this.autoBounds=!0};$hxClasses["h2d.filter.Filter"]=h2d_filter_Filter,h2d_filter_Filter.__name__="h2d.filter.Filter",h2d_filter_Filter.prototype={get_enable:function(){return this.enable},sync:function(ctx,s){},bind:function(s){},unbind:function(s){},getBounds:function(s,bounds){s.getBounds(s,bounds),bounds.xMin-=this.boundsExtend,bounds.yMin-=this.boundsExtend,bounds.xMax+=this.boundsExtend,bounds.yMax+=this.boundsExtend},draw:function(ctx,input){return input},__class__:h2d_filter_Filter};var h3d_BufferFlag=$hxEnums["h3d.BufferFlag"]={__ename__:"h3d.BufferFlag",__constructs__:["Dynamic","Triangles","Quads","Managed","RawFormat","NoAlloc","UniformBuffer"],Dynamic:{_hx_index:0,__enum__:"h3d.BufferFlag",toString:$estr},Triangles:{_hx_index:1,__enum__:"h3d.BufferFlag",toString:$estr},Quads:{_hx_index:2,__enum__:"h3d.BufferFlag",toString:$estr},Managed:{_hx_index:3,__enum__:"h3d.BufferFlag",toString:$estr},RawFormat:{_hx_index:4,__enum__:"h3d.BufferFlag",toString:$estr},NoAlloc:{_hx_index:5,__enum__:"h3d.BufferFlag",toString:$estr},UniformBuffer:{_hx_index:6,__enum__:"h3d.BufferFlag",toString:$estr}};h3d_BufferFlag.__empty_constructs__=[h3d_BufferFlag.Dynamic,h3d_BufferFlag.Triangles,h3d_BufferFlag.Quads,h3d_BufferFlag.Managed,h3d_BufferFlag.RawFormat,h3d_BufferFlag.NoAlloc,h3d_BufferFlag.UniformBuffer];var h3d_Buffer=function(vertices,stride,flags){this.id=h3d_Buffer.GUID++,this.vertices=vertices;if(this.flags=0,null!=flags)for(var _g=0;_g<flags.length;){var f=flags[_g];++_g,this.flags|=1<<f._hx_index}0==(this.flags&1<<h3d_BufferFlag.NoAlloc._hx_index)&&h3d_Engine.CURRENT.mem.allocBuffer(this,stride)};$hxClasses["h3d.Buffer"]=h3d_Buffer,h3d_Buffer.__name__="h3d.Buffer",h3d_Buffer.ofFloats=function(v,stride,flags){var nvert=v.pos/stride|0,b=new h3d_Buffer(nvert,stride,flags);return b.uploadVector(v,0,nvert),b},h3d_Buffer.ofSubFloats=function(v,stride,vertices,flags){var b=new h3d_Buffer(vertices,stride,flags);return b.uploadVector(v,0,vertices),b},h3d_Buffer.prototype={isDisposed:function(){return null==this.buffer||null==this.buffer.vbuf},dispose:function(){null!=this.buffer&&(this.buffer.freeBuffer(this),this.buffer=null,null!=this.next&&this.next.dispose())},uploadVector:function(buf,bufPos,vertices,startVertice){null==startVertice&&(startVertice=0);for(var cur=this;null!=cur&&startVertice>=cur.vertices;)startVertice-=cur.vertices,cur=cur.next;for(;vertices>0;){if(null==cur)throw haxe_Exception.thrown("Too many vertices");var count=vertices+startVertice>cur.vertices?cur.vertices-startVertice:vertices;cur.buffer.uploadVertexBuffer(cur.position+startVertice,count,buf,bufPos),startVertice=0,bufPos+=count*this.buffer.stride,vertices-=count,cur=cur.next}},__class__:h3d_Buffer};var h3d_Camera=function(fovY,zoom,screenRatio,zNear,zFar,rightHanded){null==rightHanded&&(rightHanded=!1),null==zFar&&(zFar=4e3),null==zNear&&(zNear=.02),null==screenRatio&&(screenRatio=1.333333),null==zoom&&(zoom=1),null==fovY&&(fovY=25),this.viewY=0,this.viewX=0,this.fovY=fovY,this.zoom=zoom,this.screenRatio=screenRatio,this.zNear=zNear,this.zFar=zFar,this.rightHanded=rightHanded,this.pos=new h3d_Vector(2,3,4),this.up=new h3d_Vector(0,0,1),this.target=new h3d_Vector(0,0,0),this.m=new h3d_Matrix,this.mcam=new h3d_Matrix,this.mproj=new h3d_Matrix,this.frustum=new h3d_col_Frustum,this.update()};$hxClasses["h3d.Camera"]=h3d_Camera,h3d_Camera.__name__="h3d.Camera",h3d_Camera.prototype={getInverseViewProj:function(){return null==this.minv&&(this.minv=new h3d_Matrix),this.needInv&&(this.minv.initInverse(this.m),this.needInv=!1),this.minv},unproject:function(screenX,screenY,camZ){var p=new h3d_Vector(screenX,screenY,camZ),m=this.getInverseViewProj(),px=p.x*m._11+p.y*m._21+p.z*m._31+p.w*m._41,py=p.x*m._12+p.y*m._22+p.z*m._32+p.w*m._42,pz=p.x*m._13+p.y*m._23+p.z*m._33+p.w*m._43,iw=1/(p.x*m._14+p.y*m._24+p.z*m._34+p.w*m._44);return p.x=px*iw,p.y=py*iw,p.z=pz*iw,p.w=1,p},update:function(){var _this,x,y,z;if(null!=this.follow&&(null==(z=0)&&(z=0),null==(y=0)&&(y=0),null==(x=0)&&(x=0),(_this=this.pos).x=x,_this.y=y,_this.z=z,_this.w=1,null==(z=0)&&(z=0),null==(y=0)&&(y=0),null==(x=0)&&(x=0),(_this=this.target).x=x,_this.y=y,_this.z=z,_this.w=1,this.follow.pos.localToGlobal(this.pos),this.follow.target.localToGlobal(this.target),null!=this.follow.pos.name))for(var p=this.follow.pos;null!=p;){if(null!=p.currentAnimation){var v=p.currentAnimation.getPropValue(this.follow.pos.name,"FOVY");if(null!=v){this.fovY=v;break}}p=p.parent}this.makeCameraMatrix(this.mcam),this.makeFrustumMatrix(this.mproj),this.m.multiply(this.mcam,this.mproj),this.needInv=!0,null!=this.mcamInv&&(this.mcamInv._44=0),null!=this.mprojInv&&(this.mprojInv._44=0),this.frustum.loadMatrix(this.m)},getFrustumCorners:function(zMax){return null==zMax&&(zMax=1),[this.unproject(-1,1,0),this.unproject(1,1,0),this.unproject(1,-1,0),this.unproject(-1,-1,0),this.unproject(-1,1,zMax),this.unproject(1,1,zMax),this.unproject(1,-1,zMax),this.unproject(-1,-1,zMax)]},makeCameraMatrix:function(m){var _this=this.target,v=this.pos,x=_this.x-v.x,y=_this.y-v.y,z=_this.z-v.z;_this.w,v.w,null==z&&(z=0),null==y&&(y=0),null==x&&(x=0);var az_x=x,az_y=y,az_z=z;this.rightHanded&&(az_x*=-1,az_y*=-1,az_z*=-1),az_x*=k=1/Math.sqrt(az_x*az_x+az_y*az_y+az_z*az_z),az_y*=k,az_z*=k;x=(_this=this.up).y*az_z-_this.z*az_y,y=_this.z*az_x-_this.x*az_z;null==(z=_this.x*az_y-_this.y*az_x)&&(z=0),null==y&&(y=0),null==x&&(x=0);var k,ax_x=x,ax_y=y,ax_z=z;ax_x*=k=1/Math.sqrt(ax_x*ax_x+ax_y*ax_y+ax_z*ax_z),ax_y*=k,ax_z*=k,0==Math.sqrt(ax_x*ax_x+ax_y*ax_y+ax_z*ax_z)&&(ax_x=az_y,ax_y=az_z,ax_z=az_x),null==(z=az_x*ax_y-az_y*ax_x)&&(z=0),null==(y=az_z*ax_x-az_x*ax_z)&&(y=0),null==(x=az_y*ax_z-az_z*ax_y)&&(x=0);var ay_x=x,ay_y=y,ay_z=z;m._11=ax_x,m._12=ay_x,m._13=az_x,m._14=0,m._21=ax_y,m._22=ay_y,m._23=az_y,m._24=0,m._31=ax_z,m._32=ay_z,m._33=az_z,m._34=0;v=this.pos;m._41=-(ax_x*v.x+ax_y*v.y+ax_z*v.z);v=this.pos;m._42=-(ay_x*v.x+ay_y*v.y+ay_z*v.z);v=this.pos;m._43=-(az_x*v.x+az_y*v.y+az_z*v.z),m._44=1},makeFrustumMatrix:function(m){m.zero();var bounds=this.orthoBounds;if(null!=bounds){var w=1/(bounds.xMax-bounds.xMin),h=1/(bounds.yMax-bounds.yMin),d=1/(bounds.zMax-bounds.zMin);m._11=2*w,m._22=2*h,m._33=d,m._41=-(bounds.xMin+bounds.xMax)*w,m._42=-(bounds.yMin+bounds.yMax)*h,m._43=-bounds.zMin*d,m._44=1}else{var degToRad=Math.PI/180,halfFovX=Math.atan(Math.tan(.5*this.fovY*degToRad)*this.screenRatio),scale=this.zoom/Math.tan(halfFovX);m._11=scale,m._22=scale*this.screenRatio,m._33=this.zFar/(this.zFar-this.zNear),m._34=1,m._43=-this.zNear*this.zFar/(this.zFar-this.zNear)}m._11+=this.viewX*m._14,m._21+=this.viewX*m._24,m._31+=this.viewX*m._34,m._41+=this.viewX*m._44,m._12+=this.viewY*m._14,m._22+=this.viewY*m._24,m._32+=this.viewY*m._34,m._42+=this.viewY*m._44,this.rightHanded&&(m._33*=-1,m._34*=-1)},__class__:h3d_Camera};var h3d__$Engine_TargetTmp=function(t,n,l,m){this.t=t,this.next=n,this.layer=l,this.mipLevel=m};$hxClasses["h3d._Engine.TargetTmp"]=h3d__$Engine_TargetTmp,h3d__$Engine_TargetTmp.__name__="h3d._Engine.TargetTmp",h3d__$Engine_TargetTmp.prototype={__class__:h3d__$Engine_TargetTmp};var h3d_Engine=function(){this.resCache=new haxe_ds_ObjectMap,this.ready=!1,this.textureColorCache=new haxe_ds_IntMap,this.tmpVector=new h3d_Vector,this.backgroundColor=-16777216,this.hardware=!h3d_Engine.SOFTWARE_DRIVER,this.antiAlias=h3d_Engine.ANTIALIASING,this.autoResize=!0,this.set_fullScreen(!hxd_System.getValue(hxd_SystemValue.IsWindowed)),this.window=hxd_Window.getInstance(),this.realFps=hxd_System.getDefaultFrameRate(),this.lastTime=HxOverrides.now()/1e3,this.window.addResizeEvent($bind(this,this.onWindowResize)),this.driver=new h3d_impl_GlDriver(this.antiAlias),h3d_Engine.CURRENT=this};$hxClasses["h3d.Engine"]=h3d_Engine,h3d_Engine.__name__="h3d.Engine",h3d_Engine.prototype={init:function(){this.driver.init($bind(this,this.onCreate),!this.hardware)},selectShader:function(shader){this.needFlushTarget&&this.doFlushTarget(),this.driver.selectShader(shader)&&this.shaderSwitches++},selectMaterial:function(pass){this.driver.selectMaterial(pass)},uploadShaderBuffers:function(buffers,which){this.driver.uploadShaderBuffers(buffers,which)},selectBuffer:function(buf){return!buf.isDisposed()&&(this.needFlushTarget&&this.doFlushTarget(),this.driver.selectBuffer(buf),!0)},renderBuffer:function(b,indexes,vertPerTri,startTri,drawTri){if(null==drawTri&&(drawTri=-1),null==startTri&&(startTri=0),!indexes.isDisposed())for(;;){var ntri=b.vertices/vertPerTri|0,pos=b.position/vertPerTri|0;if(startTri>0){if(startTri>=ntri){if(startTri-=ntri,null==(b=b.next))break;continue}pos+=startTri,ntri-=startTri,startTri=0}if(drawTri>=0){if(0==drawTri)return;(drawTri-=ntri)<0&&(ntri+=drawTri,drawTri=0)}if(ntri>0&&this.selectBuffer(b)&&(this.driver.draw(indexes.ibuf,3*pos,ntri),this.drawTriangles+=ntri,this.drawCalls++),null==(b=b.next))break}},renderIndexed:function(b,indexes,startTri,drawTri){if(null==drawTri&&(drawTri=-1),null==startTri&&(startTri=0),null!=b.next)throw haxe_Exception.thrown("Buffer is split");if(!indexes.isDisposed()){var maxTri=indexes.count/3|0;drawTri<0&&(drawTri=maxTri-startTri),drawTri>0&&this.selectBuffer(b)&&(this.driver.draw(indexes.ibuf,3*startTri,drawTri),this.drawTriangles+=drawTri,this.drawCalls++)}},set_debug:function(d){return this.debug=d,this.driver.setDebug(this.debug),d},onCreate:function(disposed){h3d_Engine.CURRENT=this,this.autoResize&&(this.width=this.window.get_width(),this.height=this.window.get_height()),disposed?(hxd_impl_Allocator.get().onContextLost(),this.mem.onContextLost()):(this.mem=new h3d_impl_MemoryManager(this.driver),this.mem.init(),this.nullTexture=new h3d_mat_Texture(0,0,[h3d_mat_TextureFlags.NoAlloc])),this.hardware=this.driver.hasFeature(h3d_impl_Feature.HardwareAccelerated),this.set_debug(this.debug),this.set_fullScreen(this.fullScreen),this.resize(this.width,this.height),disposed?this.onContextLost():this.onReady(),this.ready=!0},onContextLost:function(){},onReady:function(){},onWindowResize:function(){if(this.autoResize&&!this.driver.isDisposed()){var w=this.window.get_width(),h=this.window.get_height();w==this.width&&h==this.height||this.resize(w,h),this.onResized()}},set_fullScreen:function(v){return this.fullScreen=v,null!=this.mem&&hxd_System.getValue(hxd_SystemValue.IsWindowed)&&this.window.set_displayMode(v?hxd_DisplayMode.Borderless:hxd_DisplayMode.Windowed),v},onResized:function(){},resize:function(width,height){width<32&&(width=32),height<32&&(height=32),this.width=width,this.height=height,this.driver.isDisposed()||this.driver.resize(width,height)},begin:function(){return!this.driver.isDisposed()&&(this.drawTriangles=0,this.shaderSwitches=0,this.drawCalls=0,this.targetStack=null,this.needFlushTarget=null!=this.currentTargetTex,this.driver.begin(hxd_Timer.frameCount),null!=this.backgroundColor&&this.clear(this.backgroundColor,1,0),!0)},end:function(){this.driver.end()},getCurrentTarget:function(){return null==this.targetStack?null:this.targetStack.t},pushTarget:function(tex,layer,mipLevel){null==mipLevel&&(mipLevel=0),null==layer&&(layer=0);var c=this.targetTmp;null==c?c=new h3d__$Engine_TargetTmp(tex,this.targetStack,layer,mipLevel):(this.targetTmp=c.next,c.t=tex,c.next=this.targetStack,c.mipLevel=mipLevel,c.layer=layer),this.targetStack=c,this.updateNeedFlush()},updateNeedFlush:function(){var t=this.targetStack;this.needFlushTarget=null==t?null!=this.currentTargetTex:this.currentTargetTex!=t.t||this.currentTargetLayer!=t.layer||this.currentTargetMip!=t.mipLevel||null!=t.textures},popTarget:function(){var c=this.targetStack;if(null==c)throw haxe_Exception.thrown("popTarget() with no matching pushTarget()");this.targetStack=c.next,this.updateNeedFlush(),c.t=null,c.textures=null,c.next=this.targetTmp,this.targetTmp=c},doFlushTarget:function(){var t=this.targetStack;null==t?(this.driver.setRenderTarget(null),this.currentTargetTex=null):(null!=t.textures?this.driver.setRenderTargets(t.textures):this.driver.setRenderTarget(t.t,t.layer,t.mipLevel),this.currentTargetTex=t.t,this.currentTargetLayer=t.layer,this.currentTargetMip=t.mipLevel),this.needFlushTarget=!1},clear:function(color,depth,stencil){if(null!=color){var _this=this.tmpVector;_this.x=(color>>16&255)/255,_this.y=(color>>8&255)/255,_this.z=(255&color)/255,_this.w=(color>>>24)/255}this.needFlushTarget&&this.doFlushTarget(),this.driver.clear(null==color?null:this.tmpVector,depth,stencil)},setRenderZone:function(x,y,width,height){null==height&&(height=-1),null==width&&(width=-1),null==y&&(y=0),null==x&&(x=0),this.needFlushTarget&&this.doFlushTarget(),this.driver.setRenderZone(x,y,width,height)},render:function(obj){if(!this.begin())return!1;obj.render(this),this.end();var delta=HxOverrides.now()/1e3-this.lastTime;if(this.lastTime+=delta,delta>0){var curFps=1/delta;curFps>2*this.realFps?curFps=2*this.realFps:curFps<.5*this.realFps&&(curFps=.5*this.realFps);var f=delta/.5;f>.3&&(f=.3),this.realFps=this.realFps*(1-f)+curFps*f}return!0},__class__:h3d_Engine};var h3d_Indexes=function(count,is32){null==is32&&(is32=!1),this.mem=h3d_Engine.CURRENT.mem,this.count=count,this.is32=is32,this.mem.allocIndexes(this)};$hxClasses["h3d.Indexes"]=h3d_Indexes,h3d_Indexes.__name__="h3d.Indexes",h3d_Indexes.alloc=function(i,startPos,length){null==length&&(length=-1),null==startPos&&(startPos=0),length<0&&(length=i.length);var idx=new h3d_Indexes(length);return idx.upload(i,0,length),idx},h3d_Indexes.prototype={isDisposed:function(){return null==this.ibuf},upload:function(indexes,pos,count,bufferPos){null==bufferPos&&(bufferPos=0),this.mem.driver.uploadIndexBuffer(this.ibuf,pos,count,indexes,bufferPos)},dispose:function(){null!=this.ibuf&&this.mem.deleteIndexes(this)},__class__:h3d_Indexes};var h3d_Matrix=function(){};$hxClasses["h3d.Matrix"]=h3d_Matrix,h3d_Matrix.__name__="h3d.Matrix",h3d_Matrix.L=function(a){var m=new h3d_Matrix;return m.loadValues(a),m},h3d_Matrix.prototype={zero:function(){this._11=0,this._12=0,this._13=0,this._14=0,this._21=0,this._22=0,this._23=0,this._24=0,this._31=0,this._32=0,this._33=0,this._34=0,this._41=0,this._42=0,this._43=0,this._44=0},identity:function(){this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},multiply3x4:function(a,b){var m11=a._11,m12=a._12,m13=a._13,m21=a._21,m22=a._22,m23=a._23,a31=a._31,a32=a._32,a33=a._33,a41=a._41,a42=a._42,a43=a._43,b11=b._11,b12=b._12,b13=b._13,b21=b._21,b22=b._22,b23=b._23,b31=b._31,b32=b._32,b33=b._33,b41=b._41,b42=b._42,b43=b._43;this._11=m11*b11+m12*b21+m13*b31,this._12=m11*b12+m12*b22+m13*b32,this._13=m11*b13+m12*b23+m13*b33,this._14=0,this._21=m21*b11+m22*b21+m23*b31,this._22=m21*b12+m22*b22+m23*b32,this._23=m21*b13+m22*b23+m23*b33,this._24=0,this._31=a31*b11+a32*b21+a33*b31,this._32=a31*b12+a32*b22+a33*b32,this._33=a31*b13+a32*b23+a33*b33,this._34=0,this._41=a41*b11+a42*b21+a43*b31+b41,this._42=a41*b12+a42*b22+a43*b32+b42,this._43=a41*b13+a42*b23+a43*b33+b43,this._44=1},multiply:function(a,b){var a11=a._11,a12=a._12,a13=a._13,a14=a._14,a21=a._21,a22=a._22,a23=a._23,a24=a._24,a31=a._31,a32=a._32,a33=a._33,a34=a._34,a41=a._41,a42=a._42,a43=a._43,a44=a._44,b11=b._11,b12=b._12,b13=b._13,b14=b._14,b21=b._21,b22=b._22,b23=b._23,b24=b._24,b31=b._31,b32=b._32,b33=b._33,b34=b._34,b41=b._41,b42=b._42,b43=b._43,b44=b._44;this._11=a11*b11+a12*b21+a13*b31+a14*b41,this._12=a11*b12+a12*b22+a13*b32+a14*b42,this._13=a11*b13+a12*b23+a13*b33+a14*b43,this._14=a11*b14+a12*b24+a13*b34+a14*b44,this._21=a21*b11+a22*b21+a23*b31+a24*b41,this._22=a21*b12+a22*b22+a23*b32+a24*b42,this._23=a21*b13+a22*b23+a23*b33+a24*b43,this._24=a21*b14+a22*b24+a23*b34+a24*b44,this._31=a31*b11+a32*b21+a33*b31+a34*b41,this._32=a31*b12+a32*b22+a33*b32+a34*b42,this._33=a31*b13+a32*b23+a33*b33+a34*b43,this._34=a31*b14+a32*b24+a33*b34+a34*b44,this._41=a41*b11+a42*b21+a43*b31+a44*b41,this._42=a41*b12+a42*b22+a43*b32+a44*b42,this._43=a41*b13+a42*b23+a43*b33+a44*b43,this._44=a41*b14+a42*b24+a43*b34+a44*b44},inverse3x4:function(m){var m11=m._11,m12=m._12,m13=m._13,m21=m._21,m22=m._22,m23=m._23,m31=m._31,m32=m._32,m33=m._33,m41=m._41,m42=m._42,m43=m._43;this._11=m22*m33-m23*m32,this._12=m13*m32-m12*m33,this._13=m12*m23-m13*m22,this._14=0,this._21=m23*m31-m21*m33,this._22=m11*m33-m13*m31,this._23=m13*m21-m11*m23,this._24=0,this._31=m21*m32-m22*m31,this._32=m12*m31-m11*m32,this._33=m11*m22-m12*m21,this._34=0,this._41=-m21*m32*m43+m21*m33*m42+m31*m22*m43-m31*m23*m42-m41*m22*m33+m41*m23*m32,this._42=m11*m32*m43-m11*m33*m42-m31*m12*m43+m31*m13*m42+m41*m12*m33-m41*m13*m32,this._43=-m11*m22*m43+m11*m23*m42+m21*m12*m43-m21*m13*m42-m41*m12*m23+m41*m13*m22,this._44=m11*m22*m33-m11*m23*m32-m21*m12*m33+m21*m13*m32+m31*m12*m23-m31*m13*m22,this._44=1;var det=m11*this._11+m12*this._21+m13*this._31;if((det<0?-det:det)<1e-10)this.zero();else{var invDet=1/det;this._11*=invDet,this._12*=invDet,this._13*=invDet,this._21*=invDet,this._22*=invDet,this._23*=invDet,this._31*=invDet,this._32*=invDet,this._33*=invDet,this._41*=invDet,this._42*=invDet,this._43*=invDet}},initInverse:function(m){var m11=m._11,m12=m._12,m13=m._13,m14=m._14,m21=m._21,m22=m._22,m23=m._23,m24=m._24,m31=m._31,m32=m._32,m33=m._33,m34=m._34,m41=m._41,m42=m._42,m43=m._43,m44=m._44;this._11=m22*m33*m44-m22*m34*m43-m32*m23*m44+m32*m24*m43+m42*m23*m34-m42*m24*m33,this._12=-m12*m33*m44+m12*m34*m43+m32*m13*m44-m32*m14*m43-m42*m13*m34+m42*m14*m33,this._13=m12*m23*m44-m12*m24*m43-m22*m13*m44+m22*m14*m43+m42*m13*m24-m42*m14*m23,this._14=-m12*m23*m34+m12*m24*m33+m22*m13*m34-m22*m14*m33-m32*m13*m24+m32*m14*m23,this._21=-m21*m33*m44+m21*m34*m43+m31*m23*m44-m31*m24*m43-m41*m23*m34+m41*m24*m33,this._22=m11*m33*m44-m11*m34*m43-m31*m13*m44+m31*m14*m43+m41*m13*m34-m41*m14*m33,this._23=-m11*m23*m44+m11*m24*m43+m21*m13*m44-m21*m14*m43-m41*m13*m24+m41*m14*m23,this._24=m11*m23*m34-m11*m24*m33-m21*m13*m34+m21*m14*m33+m31*m13*m24-m31*m14*m23,this._31=m21*m32*m44-m21*m34*m42-m31*m22*m44+m31*m24*m42+m41*m22*m34-m41*m24*m32,this._32=-m11*m32*m44+m11*m34*m42+m31*m12*m44-m31*m14*m42-m41*m12*m34+m41*m14*m32,this._33=m11*m22*m44-m11*m24*m42-m21*m12*m44+m21*m14*m42+m41*m12*m24-m41*m14*m22,this._34=-m11*m22*m34+m11*m24*m32+m21*m12*m34-m21*m14*m32-m31*m12*m24+m31*m14*m22,this._41=-m21*m32*m43+m21*m33*m42+m31*m22*m43-m31*m23*m42-m41*m22*m33+m41*m23*m32,this._42=m11*m32*m43-m11*m33*m42-m31*m12*m43+m31*m13*m42+m41*m12*m33-m41*m13*m32,this._43=-m11*m22*m43+m11*m23*m42+m21*m12*m43-m21*m13*m42-m41*m12*m23+m41*m13*m22,this._44=m11*m22*m33-m11*m23*m32-m21*m12*m33+m21*m13*m32+m31*m12*m23-m31*m13*m22;var det=m11*this._11+m12*this._21+m13*this._31+m14*this._41;(det<0?-det:det)<1e-10?this.zero():(det=1/det,this._11*=det,this._12*=det,this._13*=det,this._14*=det,this._21*=det,this._22*=det,this._23*=det,this._24*=det,this._31*=det,this._32*=det,this._33*=det,this._34*=det,this._41*=det,this._42*=det,this._43*=det,this._44*=det)},loadValues:function(a){this._11=a[0],this._12=a[1],this._13=a[2],this._14=a[3],this._21=a[4],this._22=a[5],this._23=a[6],this._24=a[7],this._31=a[8],this._32=a[9],this._33=a[10],this._34=a[11],this._41=a[12],this._42=a[13],this._43=a[14],this._44=a[15]},__class__:h3d_Matrix};var h3d_Quat=function(x,y,z,w){null==w&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),this.x=x,this.y=y,this.z=z,this.w=w};$hxClasses["h3d.Quat"]=h3d_Quat,h3d_Quat.__name__="h3d.Quat",h3d_Quat.prototype={toMatrix:function(m){null==m&&(m=new h3d_Matrix);var xx=this.x*this.x,xy=this.x*this.y,xz=this.x*this.z,xw=this.x*this.w,yy=this.y*this.y,yz=this.y*this.z,yw=this.y*this.w,zz=this.z*this.z,zw=this.z*this.w;return m._11=1-2*(yy+zz),m._12=2*(xy+zw),m._13=2*(xz-yw),m._14=0,m._21=2*(xy-zw),m._22=1-2*(xx+zz),m._23=2*(yz+xw),m._24=0,m._31=2*(xz+yw),m._32=2*(yz-xw),m._33=1-2*(xx+yy),m._34=0,m._41=0,m._42=0,m._43=0,m._44=1,m},__class__:h3d_Quat};var h3d_Vector=function(x,y,z,w){null==w&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),this.x=x,this.y=y,this.z=z,this.w=w};$hxClasses["h3d.Vector"]=h3d_Vector,h3d_Vector.__name__="h3d.Vector",h3d_Vector.prototype={normalize:function(){var k=this.x*this.x+this.y*this.y+this.z*this.z;k=k<1e-10?0:1/Math.sqrt(k),this.x*=k,this.y*=k,this.z*=k},__class__:h3d_Vector};var h3d_anim_AnimatedObject=function(){};$hxClasses["h3d.anim.AnimatedObject"]=h3d_anim_AnimatedObject,h3d_anim_AnimatedObject.__name__="h3d.anim.AnimatedObject";var hxd_impl__$Serializable_NoSerializeSupport=function(){};$hxClasses["hxd.impl._Serializable.NoSerializeSupport"]=hxd_impl__$Serializable_NoSerializeSupport,hxd_impl__$Serializable_NoSerializeSupport.__name__="hxd.impl._Serializable.NoSerializeSupport",hxd_impl__$Serializable_NoSerializeSupport.__isInterface__=!0;var h3d_anim_Animation=function(name,frameCount,sampling){this.name=name,this.frameCount=frameCount,this.sampling=sampling,this.objects=[],this.lastEvent=-1,this.frame=0,this.speed=1,this.loop=!0,this.pause=!1};$hxClasses["h3d.anim.Animation"]=h3d_anim_Animation,h3d_anim_Animation.__name__="h3d.anim.Animation",h3d_anim_Animation.__interfaces__=[hxd_impl__$Serializable_NoSerializeSupport],h3d_anim_Animation.prototype={getPropValue:function(objectName,propName){return null},sync:function(decompose){throw null==decompose&&(decompose=!1),haxe_Exception.thrown("assert")},isPlaying:function(){return!this.pause&&(this.speed<0?-this.speed:this.speed)>1e-6},endFrame:function(){return this.frameCount},update:function(dt){if(!this.isInstance)throw haxe_Exception.thrown("You must instanciate this animation first");if(!this.isPlaying())return 0;if(null!=this.events&&null!=this.onEvent){var f0=0|this.frame,f1=this.frame+dt*this.speed*this.sampling|0;f1>=this.frameCount&&(f1=this.frameCount-1);for(var _g=f0,_g1=f1+1;_g<_g1;){var f=_g++;if(f!=this.lastEvent&&(this.lastEvent=f,null!=this.events[f])){var oldF=this.frame,oldDT=dt;dt-=(f-this.frame)/(this.speed*this.sampling),this.frame=f;for(var _g2=0,_g3=this.events[f];_g2<_g3.length;){var e=_g3[_g2];++_g2,this.onEvent(e)}if(this.frame==f&&f==this.frameCount-1){this.frame=oldF,dt=oldDT;break}return dt}}}if(null!=this.onAnimEnd){var end=this.endFrame(),et=0==this.speed?0:(end-this.frame)/(this.speed*this.sampling);if(et<=dt&&et>0)return this.frame=end,dt-=et,this.onAnimEnd(),this.frame==end&&this.isPlaying()&&(this.loop?this.frame=0:dt=0),dt}return this.frame+=dt*this.speed*this.sampling,this.frame>=this.frameCount&&(this.loop?this.frame%=this.frameCount:this.frame=this.frameCount),0},__class__:h3d_anim_Animation};var h3d_col_Collider=function(){};$hxClasses["h3d.col.Collider"]=h3d_col_Collider,h3d_col_Collider.__name__="h3d.col.Collider",h3d_col_Collider.__isInterface__=!0,h3d_col_Collider.__interfaces__=[hxd_impl__$Serializable_NoSerializeSupport],h3d_col_Collider.prototype={__class__:h3d_col_Collider};var h3d_col_Bounds=function(){this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20};$hxClasses["h3d.col.Bounds"]=h3d_col_Bounds,h3d_col_Bounds.__name__="h3d.col.Bounds",h3d_col_Bounds.__interfaces__=[h3d_col_Collider],h3d_col_Bounds.prototype={inFrustum:function(f,m){if(null!=m)throw haxe_Exception.thrown("Not implemented");return f.hasBounds(this)},rayIntersection:function(r,bestMatch){var a,minTx=(this.xMin-r.px)/r.lx,minTy=(this.yMin-r.py)/r.ly,minTz=(this.zMin-r.pz)/r.lz,maxTx=(this.xMax-r.px)/r.lx,maxTy=(this.yMax-r.py)/r.ly,maxTz=(this.zMax-r.pz)/r.lz,realMinTx=minTx>maxTx?maxTx:minTx,realMinTy=minTy>maxTy?maxTy:minTy,realMinTz=minTz>maxTz?maxTz:minTz,realMaxTx=minTx<maxTx?maxTx:minTx,realMaxTy=minTy<maxTy?maxTy:minTy,realMaxTz=minTz<maxTz?maxTz:minTz,minmax=(a=realMaxTx>realMaxTy?realMaxTy:realMaxTx)>realMaxTz?realMaxTz:a,maxmin=(a=realMinTx<realMinTy?realMinTy:realMinTx)<realMinTz?realMinTz:a;return minmax<maxmin?-1:maxmin},intersection:function(a,b){var a1,b1,xMin=(a1=a.xMin)<(b1=b.xMin)?b1:a1,yMin=(a1=a.yMin)<(b1=b.yMin)?b1:a1,zMin=(a1=a.zMin)<(b1=b.zMin)?b1:a1,xMax=(a1=a.xMax)>(b1=b.xMax)?b1:a1,yMax=(a1=a.yMax)>(b1=b.yMax)?b1:a1,zMax=(a1=a.zMax)>(b1=b.zMax)?b1:a1;this.xMin=xMin,this.xMax=xMax,this.yMin=yMin,this.yMax=yMax,this.zMin=zMin,this.zMax=zMax},scaleCenter:function(v){var dx=.5*(this.xMax-this.xMin)*v,dy=.5*(this.yMax-this.yMin)*v,dz=.5*(this.zMax-this.zMin)*v,mx=.5*(this.xMax+this.xMin),my=.5*(this.yMax+this.yMin),mz=.5*(this.zMax+this.zMin);this.xMin=mx-dx,this.yMin=my-dy,this.zMin=mz-dz,this.xMax=mx+dx,this.yMax=my+dy,this.zMax=mz+dz},__class__:h3d_col_Bounds};var h3d_col_Frustum=function(mvp){this.checkNearFar=!0,this.pleft=new h3d_col_Plane(1,0,0,0),this.pright=new h3d_col_Plane(1,0,0,0),this.ptop=new h3d_col_Plane(1,0,0,0),this.pbottom=new h3d_col_Plane(1,0,0,0),this.pnear=new h3d_col_Plane(1,0,0,0),this.pfar=new h3d_col_Plane(1,0,0,0),null!=mvp&&this.loadMatrix(mvp)};$hxClasses["h3d.col.Frustum"]=h3d_col_Frustum,h3d_col_Frustum.__name__="h3d.col.Frustum",h3d_col_Frustum.prototype={loadMatrix:function(mvp){var _this=this.pleft,p_nx=mvp._14+mvp._11,p_ny=mvp._24+mvp._21,p_nz=mvp._34+mvp._31,p_d=-(mvp._44+mvp._41);_this.nx=p_nx,_this.ny=p_ny,_this.nz=p_nz,_this.d=p_d;_this=this.pright,p_nx=mvp._14-mvp._11,p_ny=mvp._24-mvp._21,p_nz=mvp._34-mvp._31,p_d=mvp._41-mvp._44;_this.nx=p_nx,_this.ny=p_ny,_this.nz=p_nz,_this.d=p_d;_this=this.ptop,p_nx=mvp._14-mvp._12,p_ny=mvp._24-mvp._22,p_nz=mvp._34-mvp._32,p_d=mvp._42-mvp._44;_this.nx=p_nx,_this.ny=p_ny,_this.nz=p_nz,_this.d=p_d;_this=this.pbottom,p_nx=mvp._14+mvp._12,p_ny=mvp._24+mvp._22,p_nz=mvp._34+mvp._32,p_d=-(mvp._44+mvp._42);_this.nx=p_nx,_this.ny=p_ny,_this.nz=p_nz,_this.d=p_d;_this=this.pnear,p_nx=mvp._13,p_ny=mvp._23,p_nz=mvp._33,p_d=-mvp._43;_this.nx=p_nx,_this.ny=p_ny,_this.nz=p_nz,_this.d=p_d;_this=this.pfar,p_nx=mvp._14-mvp._13,p_ny=mvp._24-mvp._23,p_nz=mvp._34-mvp._33,p_d=mvp._43-mvp._44;_this.nx=p_nx,_this.ny=p_ny,_this.nz=p_nz,_this.d=p_d;_this=this.pleft;var len=1/Math.sqrt(_this.nx*_this.nx+_this.ny*_this.ny+_this.nz*_this.nz);_this.nx*=len,_this.ny*=len,_this.nz*=len,_this.d*=len;_this=this.pright,len=1/Math.sqrt(_this.nx*_this.nx+_this.ny*_this.ny+_this.nz*_this.nz);_this.nx*=len,_this.ny*=len,_this.nz*=len,_this.d*=len;_this=this.ptop,len=1/Math.sqrt(_this.nx*_this.nx+_this.ny*_this.ny+_this.nz*_this.nz);_this.nx*=len,_this.ny*=len,_this.nz*=len,_this.d*=len;_this=this.pbottom,len=1/Math.sqrt(_this.nx*_this.nx+_this.ny*_this.ny+_this.nz*_this.nz);_this.nx*=len,_this.ny*=len,_this.nz*=len,_this.d*=len;_this=this.pnear,len=1/Math.sqrt(_this.nx*_this.nx+_this.ny*_this.ny+_this.nz*_this.nz);_this.nx*=len,_this.ny*=len,_this.nz*=len,_this.d*=len;_this=this.pfar,len=1/Math.sqrt(_this.nx*_this.nx+_this.ny*_this.ny+_this.nz*_this.nz);_this.nx*=len,_this.ny*=len,_this.nz*=len,_this.d*=len},hasSphere:function(s){var x=s.x,y=s.y,z=s.z;null==z&&(z=0),null==y&&(y=0),null==x&&(x=0);var p_x=x,p_y=y,p_z=z;if((_this=this.pleft).nx*p_x+_this.ny*p_y+_this.nz*p_z-_this.d<-s.r)return!1;if((_this=this.pright).nx*p_x+_this.ny*p_y+_this.nz*p_z-_this.d<-s.r)return!1;if((_this=this.ptop).nx*p_x+_this.ny*p_y+_this.nz*p_z-_this.d<-s.r)return!1;if((_this=this.pbottom).nx*p_x+_this.ny*p_y+_this.nz*p_z-_this.d<-s.r)return!1;if(this.checkNearFar){var _this;if((_this=this.pnear).nx*p_x+_this.ny*p_y+_this.nz*p_z-_this.d<-s.r)return!1;if((_this=this.pfar).nx*p_x+_this.ny*p_y+_this.nz*p_z-_this.d<-s.r)return!1}return!0},hasBounds:function(b){var a=(p=this.pleft).nx,b1=p.ny,c=p.nz,dd=a*(b.xMax+b.xMin)+b1*(b.yMax+b.yMin)+c*(b.zMax+b.zMin);if(a<0&&(a=-a),b1<0&&(b1=-b1),c<0&&(c=-c),dd+(a*(b.xMax-b.xMin)+b1*(b.yMax-b.yMin)+c*(b.zMax-b.zMin))-2*p.d<0)return!1;a=(p=this.pright).nx,b1=p.ny,c=p.nz,dd=a*(b.xMax+b.xMin)+b1*(b.yMax+b.yMin)+c*(b.zMax+b.zMin);if(a<0&&(a=-a),b1<0&&(b1=-b1),c<0&&(c=-c),dd+(a*(b.xMax-b.xMin)+b1*(b.yMax-b.yMin)+c*(b.zMax-b.zMin))-2*p.d<0)return!1;a=(p=this.ptop).nx,b1=p.ny,c=p.nz,dd=a*(b.xMax+b.xMin)+b1*(b.yMax+b.yMin)+c*(b.zMax+b.zMin);if(a<0&&(a=-a),b1<0&&(b1=-b1),c<0&&(c=-c),dd+(a*(b.xMax-b.xMin)+b1*(b.yMax-b.yMin)+c*(b.zMax-b.zMin))-2*p.d<0)return!1;a=(p=this.ptop).nx,b1=p.ny,c=p.nz,dd=a*(b.xMax+b.xMin)+b1*(b.yMax+b.yMin)+c*(b.zMax+b.zMin);if(a<0&&(a=-a),b1<0&&(b1=-b1),c<0&&(c=-c),dd+(a*(b.xMax-b.xMin)+b1*(b.yMax-b.yMin)+c*(b.zMax-b.zMin))-2*p.d<0)return!1;a=(p=this.pnear).nx,b1=p.ny,c=p.nz,dd=a*(b.xMax+b.xMin)+b1*(b.yMax+b.yMin)+c*(b.zMax+b.zMin);if(a<0&&(a=-a),b1<0&&(b1=-b1),c<0&&(c=-c),dd+(a*(b.xMax-b.xMin)+b1*(b.yMax-b.yMin)+c*(b.zMax-b.zMin))-2*p.d<0)return!1;var p;a=(p=this.pfar).nx,b1=p.ny,c=p.nz,dd=a*(b.xMax+b.xMin)+b1*(b.yMax+b.yMin)+c*(b.zMax+b.zMin);return a<0&&(a=-a),b1<0&&(b1=-b1),c<0&&(c=-c),!(dd+(a*(b.xMax-b.xMin)+b1*(b.yMax-b.yMin)+c*(b.zMax-b.zMin))-2*p.d<0)},__class__:h3d_col_Frustum};var h3d_col_Ray=function(){};$hxClasses["h3d.col.Ray"]=h3d_col_Ray,h3d_col_Ray.__name__="h3d.col.Ray",h3d_col_Ray.prototype={normalize:function(){var l=this.lx*this.lx+this.ly*this.ly+this.lz*this.lz;1!=l&&(l=l<1e-10?0:1/Math.sqrt(l),this.lx*=l,this.ly*=l,this.lz*=l)},__class__:h3d_col_Ray};var h3d_col_Plane=function(nx,ny,nz,d){this.nx=nx,this.ny=ny,this.nz=nz,this.d=d};$hxClasses["h3d.col.Plane"]=h3d_col_Plane,h3d_col_Plane.__name__="h3d.col.Plane",h3d_col_Plane.prototype={__class__:h3d_col_Plane};var h3d_col_Sphere=function(x,y,z,r){null==r&&(r=0),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0);var sx=x,sy=y,sz=z,sr=r;null==sr&&(sr=0),null==sz&&(sz=0),null==sy&&(sy=0),null==sx&&(sx=0),this.x=sx,this.y=sy,this.z=sz,this.r=sr};$hxClasses["h3d.col.Sphere"]=h3d_col_Sphere,h3d_col_Sphere.__name__="h3d.col.Sphere",h3d_col_Sphere.__interfaces__=[h3d_col_Collider],h3d_col_Sphere.prototype={rayIntersection:function(r,bestMatch){var r2=this.r*this.r,px=r.px+r.lx,py=r.py+r.ly,pz=r.pz+r.lz,a=r.lx*r.lx+r.ly*r.ly+r.lz*r.lz,b=2*r.lx*(this.x-px)+2*r.ly*(this.y-py)+2*r.lz*(this.z-pz),d=b*b-4*a*(this.x*this.x+this.y*this.y+this.z*this.z+(px*px+py*py+pz*pz)-2*(this.x*px+this.y*py+this.z*pz)-r2);return d<0?-1:1-(-b+(d=Math.sqrt(d)))/(2*a)},inFrustum:function(f,m){return null!=m?this.inFrustumMatrix(f,m):f.hasSphere(this)},inFrustumMatrix:function(f,m){var oldX=this.x,oldY=this.y,oldZ=this.z,oldR=this.r,x=this.x,y=this.y,z=this.z;null==z&&(z=0),null==y&&(y=0),null==x&&(x=0);var v_x=x,v_y=y,v_z=z,px=v_x*m._11+v_y*m._21+v_z*m._31+m._41,py=v_x*m._12+v_y*m._22+v_z*m._32+m._42,pz=v_x*m._13+v_y*m._23+v_z*m._33+m._43;v_x=px,v_y=py,v_z=pz,this.x=v_x,this.y=v_y,this.z=v_z;var v=null;null==v&&(v=new h3d_Vector),v.x=Math.sqrt(m._11*m._11+m._12*m._12+m._13*m._13),v.y=Math.sqrt(m._21*m._21+m._22*m._22+m._23*m._23),v.z=Math.sqrt(m._31*m._31+m._32*m._32+m._33*m._33),m._11*(m._22*m._33-m._23*m._32)+m._12*(m._23*m._31-m._21*m._33)+m._13*(m._21*m._32-m._22*m._31)<0&&(v.x*=-1,v.y*=-1,v.z*=-1);var scale=v;this.r*=Math.max(Math.max(scale.x,scale.y),scale.z);var res=f.hasSphere(this);return this.x=oldX,this.y=oldY,this.z=oldZ,this.r=oldR,res},__class__:h3d_col_Sphere};var h3d_impl_Feature=$hxEnums["h3d.impl.Feature"]={__ename__:"h3d.impl.Feature",__constructs__:["StandardDerivatives","FloatTextures","AllocDepthBuffer","HardwareAccelerated","MultipleRenderTargets","Queries","SRGBTextures","ShaderModel3","BottomLeftCoords","Wireframe","InstancedRendering"],StandardDerivatives:{_hx_index:0,__enum__:"h3d.impl.Feature",toString:$estr},FloatTextures:{_hx_index:1,__enum__:"h3d.impl.Feature",toString:$estr},AllocDepthBuffer:{_hx_index:2,__enum__:"h3d.impl.Feature",toString:$estr},HardwareAccelerated:{_hx_index:3,__enum__:"h3d.impl.Feature",toString:$estr},MultipleRenderTargets:{_hx_index:4,__enum__:"h3d.impl.Feature",toString:$estr},Queries:{_hx_index:5,__enum__:"h3d.impl.Feature",toString:$estr},SRGBTextures:{_hx_index:6,__enum__:"h3d.impl.Feature",toString:$estr},ShaderModel3:{_hx_index:7,__enum__:"h3d.impl.Feature",toString:$estr},BottomLeftCoords:{_hx_index:8,__enum__:"h3d.impl.Feature",toString:$estr},Wireframe:{_hx_index:9,__enum__:"h3d.impl.Feature",toString:$estr},InstancedRendering:{_hx_index:10,__enum__:"h3d.impl.Feature",toString:$estr}};h3d_impl_Feature.__empty_constructs__=[h3d_impl_Feature.StandardDerivatives,h3d_impl_Feature.FloatTextures,h3d_impl_Feature.AllocDepthBuffer,h3d_impl_Feature.HardwareAccelerated,h3d_impl_Feature.MultipleRenderTargets,h3d_impl_Feature.Queries,h3d_impl_Feature.SRGBTextures,h3d_impl_Feature.ShaderModel3,h3d_impl_Feature.BottomLeftCoords,h3d_impl_Feature.Wireframe,h3d_impl_Feature.InstancedRendering];var h3d_impl_RenderFlag=$hxEnums["h3d.impl.RenderFlag"]={__ename__:"h3d.impl.RenderFlag",__constructs__:["CameraHandness"],CameraHandness:{_hx_index:0,__enum__:"h3d.impl.RenderFlag",toString:$estr}};h3d_impl_RenderFlag.__empty_constructs__=[h3d_impl_RenderFlag.CameraHandness];var h3d_impl_InputNames=function(names){this.id=h3d_impl_InputNames.UID++,this.names=names};$hxClasses["h3d.impl.InputNames"]=h3d_impl_InputNames,h3d_impl_InputNames.__name__="h3d.impl.InputNames",h3d_impl_InputNames.get=function(names){var key=names.join("|"),i=h3d_impl_InputNames.CACHE.h[key];return null==i&&(i=new h3d_impl_InputNames(names.slice()),h3d_impl_InputNames.CACHE.h[key]=i),i},h3d_impl_InputNames.prototype={__class__:h3d_impl_InputNames};var h3d_impl_Driver=function(){};$hxClasses["h3d.impl.Driver"]=h3d_impl_Driver,h3d_impl_Driver.__name__="h3d.impl.Driver",h3d_impl_Driver.prototype={hasFeature:function(f){return!1},setRenderFlag:function(r,value){},isSupportedFormat:function(fmt){return!1},isDisposed:function(){return!0},begin:function(frame){},generateMipMaps:function(texture){throw haxe_Exception.thrown("Mipmaps auto generation is not supported on this platform")},clear:function(color,depth,stencil){},capturePixels:function(tex,layer,mipLevel,region){throw haxe_Exception.thrown("Can't capture pixels on this platform")},init:function(onCreate,forceSoftware){null==forceSoftware&&(forceSoftware=!1)},resize:function(width,height){},selectShader:function(shader){return!1},selectMaterial:function(pass){},uploadShaderBuffers:function(buffers,which){},selectBuffer:function(buffer){},draw:function(ibuf,startIndex,ntriangles){},setRenderZone:function(x,y,width,height){},setRenderTarget:function(tex,layer,mipLevel){null==mipLevel&&(mipLevel=0),null==layer&&(layer=0)},setRenderTargets:function(textures){},allocDepthBuffer:function(b){return null},disposeDepthBuffer:function(b){},getDefaultDepthBuffer:function(){return null},end:function(){},setDebug:function(b){},allocTexture:function(t){return null},allocIndexes:function(count,is32){return null},allocVertexes:function(m){return null},disposeTexture:function(t){},disposeIndexes:function(i){},disposeVertexes:function(v){},uploadIndexBuffer:function(i,startIndice,indiceCount,buf,bufPos){},uploadVertexBuffer:function(v,startVertex,vertexCount,buf,bufPos){},uploadTextureBitmap:function(t,bmp,mipLevel,side){},uploadTexturePixels:function(t,pixels,mipLevel,side){},copyTexture:function(from,to){return!1},__class__:h3d_impl_Driver};var h3d_impl__$GlDriver_CompiledShader=function(s,vertex,shader){this.s=s,this.vertex=vertex,this.shader=shader};$hxClasses["h3d.impl._GlDriver.CompiledShader"]=h3d_impl__$GlDriver_CompiledShader,h3d_impl__$GlDriver_CompiledShader.__name__="h3d.impl._GlDriver.CompiledShader",h3d_impl__$GlDriver_CompiledShader.prototype={__class__:h3d_impl__$GlDriver_CompiledShader};var h3d_impl__$GlDriver_CompiledAttribute=function(){};$hxClasses["h3d.impl._GlDriver.CompiledAttribute"]=h3d_impl__$GlDriver_CompiledAttribute,h3d_impl__$GlDriver_CompiledAttribute.__name__="h3d.impl._GlDriver.CompiledAttribute",h3d_impl__$GlDriver_CompiledAttribute.prototype={__class__:h3d_impl__$GlDriver_CompiledAttribute};var h3d_impl__$GlDriver_CompiledProgram=function(){};$hxClasses["h3d.impl._GlDriver.CompiledProgram"]=h3d_impl__$GlDriver_CompiledProgram,h3d_impl__$GlDriver_CompiledProgram.__name__="h3d.impl._GlDriver.CompiledProgram",h3d_impl__$GlDriver_CompiledProgram.prototype={__class__:h3d_impl__$GlDriver_CompiledProgram};var h3d_impl_GlDriver=function(antiAlias){null==antiAlias&&(antiAlias=0),this.features=new haxe_ds_EnumValueMap,this.maxCompressedTexturesSupport=0,this.rightHanded=!1,this.firstShader=!0,this.boundTextures=[],this.curTargets=[];var _g=[];_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),_g.push(0),this.currentDivisor=_g,this.curColorMask=-1,this.lastActiveIndex=0,this.curStEnabled=!1,this.curStMaskBits=-1,this.curStOpBits=-1,this.curMatBits=-1,this.maxIdxCurAttribs=0,this.curAttribs=[],this.canvas=hxd_Window.getInstance().canvas;var options={alpha:!1,stencil:!0,antialias:antiAlias>0};if(h3d_impl_GlDriver.ALLOW_WEBGL2&&(this.gl=this.canvas.getContext("webgl2",options)),null==this.gl&&(this.gl=js_html__$CanvasElement_CanvasUtil.getContextWebGL(this.canvas,options)),null==this.gl)throw haxe_Exception.thrown("Could not acquire GL context");"undefined"!=typeof WebGLDebugUtils&&(this.gl=WebGLDebugUtils.makeDebugContext(this.gl),this.glDebug=!0),this.commonFB=this.gl.createFramebuffer(),this.programs=new haxe_ds_IntMap,this.defStencil=new h3d_mat_Stencil;var v=this.gl.getParameter(7938);(reg=new EReg("ES ([0-9]+\\.[0-9]+)","")).match(v)&&(this.glES=parseFloat(reg.matched(1)));var reg=new EReg("[0-9]+\\.[0-9]+","");v=this.gl.getParameter(35724);if(reg.match(v)&&(this.glES=parseFloat(reg.matched(0)),this.shaderVersion=Math.round(100*parseFloat(reg.matched(0)))),this.drawMode=4,this.makeFeatures(),this.hasFeature(h3d_impl_Feature.InstancedRendering)&&this.glES<3){var extension=this.gl.getExtension("ANGLE_instanced_arrays");this.gl.vertexAttribDivisor=$bind(extension,extension.vertexAttribDivisorANGLE),this.gl.drawElementsInstanced=$bind(extension,extension.drawElementsInstancedANGLE)}hxsl_SharedShader.UNROLL_LOOPS=!this.hasFeature(h3d_impl_Feature.ShaderModel3)};$hxClasses["h3d.impl.GlDriver"]=h3d_impl_GlDriver,h3d_impl_GlDriver.__name__="h3d.impl.GlDriver",h3d_impl_GlDriver.__super__=h3d_impl_Driver,h3d_impl_GlDriver.prototype=$extend(h3d_impl_Driver.prototype,{setRenderFlag:function(r,value){this.rightHanded=value>0},setDebug:function(d){this.debug=d},begin:function(frame){this.frame=frame,this.resetStream(),this.gl.useProgram(null),this.curShader=null,this.curBuffer=null},getDriverName:function(details){var render=this.gl.getParameter(7937);return details?render+=" GLv"+Std.string(this.gl.getParameter(7938)):render=render.split("/").shift(),"OpenGL "+(render=render.split("WebGL ").join(""))},compileShader:function(glout,shader){var type=shader.vertex?35633:35632,s=this.gl.createShader(type);null==shader.code&&(shader.code=glout.run(shader.data),shader.data.funs=null),this.gl.shaderSource(s,shader.code),this.gl.compileShader(s);var log=this.gl.getShaderInfoLog(s);if(1!=this.gl.getShaderParameter(s,35713)){log=this.gl.getShaderInfoLog(s);var lid=Std.parseInt(HxOverrides.substr(log,9,null)),line=null==lid?null:shader.code.split("\n")[lid-1];line=null==line?"":"("+StringTools.trim(line)+")";for(var codeLines=shader.code.split("\n"),_g=0,_g1=codeLines.length;_g<_g1;){var i=_g++;codeLines[i]=i+1+"\t"+codeLines[i]}throw haxe_Exception.thrown("An error occurred compiling the shaders: "+log+line+"\n\n"+codeLines.join("\n"))}return new h3d_impl__$GlDriver_CompiledShader(s,shader.vertex,shader)},initShader:function(p,s,shader){var prefix=s.vertex?"vertex":"fragment";s.globals=this.gl.getUniformLocation(p.p,prefix+"Globals"),s.params=this.gl.getUniformLocation(p.p,prefix+"Params"),s.textures=[];for(var index=0,curT=null,mode=0,name="",t=shader.textures;null!=t;){var tmp,tt=t.type;if(17==tt._hx_index){var _g=tt.size;tmp=!0}else tmp=!1;if(tmp&&(tt=hxsl_Type.TSampler2D),tt!=curT){switch(curT=tt,tt._hx_index){case 10:mode=3553,name="Textures";break;case 11:mode=35866,name="TexturesArray";break;case 12:mode=34067,name="TexturesCube";break;default:throw haxe_Exception.thrown("Unsupported texture type "+Std.string(tt))}index=0}s.textures.push({u:this.gl.getUniformLocation(p.p,prefix+name+"["+index+"]"),t:curT,mode:mode}),++index,t=t.next}if(shader.bufferCount>0){_g=[];for(var _g1=0,_g2=shader.bufferCount;_g1<_g2;){var i=_g1++;_g.push(this.gl.getUniformBlockIndex(p.p,"uniform_buffer"+i))}s.buffers=_g;for(_g=0,_g1=shader.bufferCount;_g<_g1;){i=_g++;this.gl.uniformBlockBinding(p.p,s.buffers[i],i)}}},selectShader:function(shader){var p=this.programs.h[shader.id];if(null==p){p=new h3d_impl__$GlDriver_CompiledProgram;var glout=new hxsl_GlslOut;glout.glES=this.glES,glout.version=this.shaderVersion,p.vertex=this.compileShader(glout,shader.vertex),p.fragment=this.compileShader(glout,shader.fragment),p.p=this.gl.createProgram(),this.gl.attachShader(p.p,p.vertex.s),this.gl.attachShader(p.p,p.fragment.s);var log=null;try{this.gl.linkProgram(p.p),1!=this.gl.getProgramParameter(p.p,35714)&&(log=this.gl.getProgramInfoLog(p.p))}catch(_g){var e=haxe_Exception.caught(_g).unwrap();throw haxe_Exception.thrown("Shader linkage error: "+Std.string(e)+" ("+this.getDriverName(!1)+")")}if(this.gl.deleteShader(p.vertex.s),this.gl.deleteShader(p.fragment.s),null!=log)throw this.gl.deleteProgram(p.p),haxe_Exception.thrown("Program linkage failure: "+log+"\nVertex=\n"+shader.vertex.code+"\n\nFragment=\n"+shader.fragment.code);this.firstShader=!1,this.initShader(p,p.vertex,shader.vertex),this.initShader(p,p.fragment,shader.fragment);var attribNames=[];p.attribs=[],p.hasAttribIndex=[],p.stride=0;for(var _g=0,_g1=shader.vertex.data.vars;_g<_g1.length;){var v=_g1[_g];if(++_g,1==v.kind._hx_index){var size,t=5126,_g2=v.type;switch(_g2._hx_index){case 3:size=1;break;case 5:_g2.t;size=_g2.size;break;case 9:t=5120,size=_g2.size;break;default:throw haxe_Exception.thrown("assert "+Std.string(v.type))}var index=this.gl.getAttribLocation(p.p,glout.varNames.h.hasOwnProperty(v.id)?glout.varNames.h[v.id]:v.name);if(index<0){p.stride+=size;continue}if((a=new h3d_impl__$GlDriver_CompiledAttribute).type=t,a.size=size,a.index=index,a.offset=p.stride,a.divisor=0,null!=v.qualifiers)for(var _g4=0,_g5=v.qualifiers;_g4<_g5.length;){var q=_g5[_g4];if(++_g4,9==q._hx_index){var n2=q.v;a.divisor=n2}}p.attribs.push(a),p.hasAttribIndex[a.index]=!0,attribNames.push(v.name),p.stride+=size}}p.inputs=h3d_impl_InputNames.get(attribNames),this.programs.h[shader.id]=p}if(this.curShader==p)return!1;this.gl.useProgram(p.p);for(_g=0,_g1=p.attribs;_g<_g1.length;){var a=_g1[_g];++_g,this.curAttribs[a.index]||(this.gl.enableVertexAttribArray(a.index),this.curAttribs[a.index]=!0,this.maxIdxCurAttribs<a.index&&(this.maxIdxCurAttribs=a.index))}var lastIdxCurAttribTrue=0;for(_g=0,_g1=this.maxIdxCurAttribs+1;_g<_g1;){var i=_g++;this.curAttribs[i]&&!p.hasAttribIndex[i]?(this.gl.disableVertexAttribArray(i),this.curAttribs[i]=!1):this.curAttribs[i]&&(lastIdxCurAttribTrue=i)}this.maxIdxCurAttribs=lastIdxCurAttribTrue,this.curShader=p,this.curBuffer=null;for(_g=0,_g1=this.boundTextures.length;_g<_g1;){i=_g++;this.boundTextures[i]=null}return!0},uploadShaderBuffers:function(buf,which){this.uploadBuffer(this.curShader.vertex,buf.vertex,which),this.uploadBuffer(this.curShader.fragment,buf.fragment,which)},uploadBuffer:function(s,buf,which){switch(which){case 0:if(null!=s.globals){var a=buf.globals.subarray(0,4*s.shader.globalsSize);this.gl.uniform4fv(s.globals,a)}break;case 1:if(null!=s.params){a=buf.params.subarray(0,4*s.shader.paramsSize);this.gl.uniform4fv(s.params,a)}break;case 2:s.textures.length;for(var _g=0,_g1=s.textures.length;_g<_g1;){var i=_g++,t=buf.tex[i],pt=s.textures[i];if(null==t||null==t.t&&null==t.realloc)switch(pt.t._hx_index){case 10:var color=h3d_mat_Defaults.loadingTextureColor;t=h3d_mat_Texture.fromColor(color,(color>>>24)/255);break;case 12:t=h3d_mat_Texture.defaultCubeTexture();break;default:throw haxe_Exception.thrown("Missing texture")}if(null!=t&&null==t.t&&null!=t.realloc&&(t.alloc(),t.realloc()),t.set_lastFrame(this.frame),null!=pt.u){var idx=s.vertex?i:this.curShader.vertex.textures.length+i;if(this.boundTextures[idx]!=t.t){this.boundTextures[idx]=t.t;var mode=this.getBindType(t);if(mode!=pt.mode)throw haxe_Exception.thrown("Texture format mismatch: "+Std.string(t)+" should be "+Std.string(pt.t));this.gl.activeTexture(33984+idx),this.gl.uniform1i(pt.u,idx),this.gl.bindTexture(mode,t.t.t),this.lastActiveIndex=idx}var mip=t.mipMap._hx_index,filter=t.filter._hx_index,wrap=t.wrap._hx_index,bits=mip|filter<<3|wrap<<6;if(bits!=t.t.bits){t.t.bits=bits;var flags=h3d_impl_GlDriver.TFILTERS[mip][filter],mode1=pt.mode;this.gl.texParameteri(mode1,10240,flags[0]),this.gl.texParameteri(mode1,10241,flags[1]);var w=h3d_impl_GlDriver.TWRAP[wrap];this.gl.texParameteri(mode1,10242,w),this.gl.texParameteri(mode1,10243,w)}}}break;case 3:if(null!=s.buffers)for(_g=0,_g1=s.buffers.length;_g<_g1;){i=_g++;this.gl.bindBufferBase(35345,i,buf.buffers[i].buffer.vbuf.b)}}},selectMaterial:function(pass){var bits=pass.bits;if(null==this.curTarget==this.rightHanded)switch(pass.culling._hx_index){case 1:bits=-4&bits|2;break;case 2:bits=-4&bits|1}if(this.selectMaterialBits(bits),this.curColorMask!=pass.colorMask){var m=pass.colorMask;this.gl.colorMask(0!=(1&m),0!=(2&m),0!=(4&m),0!=(8&m)),this.curColorMask=m}var s=this.defStencil;null==pass.stencil?this.curStEnabled&&(this.gl.disable(2960),this.curStEnabled=!1):(s=pass.stencil,this.curStEnabled||(this.gl.enable(2960),this.curStEnabled=!0)),this.selectStencilBits(s.opBits,s.maskBits)},selectMaterialBits:function(bits){var diff=bits^this.curMatBits;if(this.curMatBits<0&&(diff=-1),0!=diff){var wireframe=0!=(268435456&bits);if(this.drawMode=wireframe?3:4,0!=(3&diff)){var cull=3&bits;0==cull?this.gl.disable(2884):((this.curMatBits<0||0==(3&this.curMatBits))&&this.gl.enable(2884),this.gl.cullFace(h3d_impl_GlDriver.FACES[cull]))}if(0!=(4194240&diff)){var csrc=bits>>6&15,cdst=bits>>10&15,asrc=bits>>14&15,adst=bits>>18&15;csrc==asrc&&cdst==adst?0==csrc&&1==cdst?this.gl.disable(3042):((this.curMatBits<0||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),this.gl.blendFunc(h3d_impl_GlDriver.BLEND[csrc],h3d_impl_GlDriver.BLEND[cdst])):((this.curMatBits<0||0==(this.curMatBits>>6&15)&&1==(this.curMatBits>>10&15))&&this.gl.enable(3042),this.gl.blendFuncSeparate(h3d_impl_GlDriver.BLEND[csrc],h3d_impl_GlDriver.BLEND[cdst],h3d_impl_GlDriver.BLEND[asrc],h3d_impl_GlDriver.BLEND[adst]))}if(0!=(264241152&diff)){var cop=bits>>22&7,aop=bits>>25&7;cop==aop?this.gl.blendEquation(h3d_impl_GlDriver.OP[cop]):this.gl.blendEquationSeparate(h3d_impl_GlDriver.OP[cop],h3d_impl_GlDriver.OP[aop])}if(0!=(4&diff)&&this.gl.depthMask(0!=(bits>>2&1)),0!=(56&diff)){var cmp=bits>>3&7;0==cmp?this.gl.disable(2929):((this.curMatBits<0||0==(this.curMatBits>>3&7))&&this.gl.enable(2929),this.gl.depthFunc(h3d_impl_GlDriver.COMPARE[cmp]))}this.curMatBits=bits}},selectStencilBits:function(opBits,maskBits){var diffOp=opBits^this.curStOpBits,diffMask=maskBits^this.curStMaskBits;if(0!=(diffOp|diffMask)){if(0!=(4088&diffOp)&&this.gl.stencilOpSeparate(h3d_impl_GlDriver.FACES[2],h3d_impl_GlDriver.STENCIL_OP[opBits>>6&7],h3d_impl_GlDriver.STENCIL_OP[opBits>>9&7],h3d_impl_GlDriver.STENCIL_OP[opBits>>3&7]),0!=(16744448&diffOp)&&this.gl.stencilOpSeparate(h3d_impl_GlDriver.FACES[1],h3d_impl_GlDriver.STENCIL_OP[opBits>>18&7],h3d_impl_GlDriver.STENCIL_OP[opBits>>21&7],h3d_impl_GlDriver.STENCIL_OP[opBits>>15&7]),0!=(7&diffOp|16711935&diffMask)&&this.gl.stencilFuncSeparate(h3d_impl_GlDriver.FACES[2],h3d_impl_GlDriver.COMPARE[7&opBits],maskBits>>16&255,255&maskBits),0!=(28672&diffOp|16711935&diffMask)&&this.gl.stencilFuncSeparate(h3d_impl_GlDriver.FACES[1],h3d_impl_GlDriver.COMPARE[opBits>>12&7],maskBits>>16&255,255&maskBits),0!=(65280&diffMask)){var w=maskBits>>8&255;this.gl.stencilMaskSeparate(h3d_impl_GlDriver.FACES[2],w),this.gl.stencilMaskSeparate(h3d_impl_GlDriver.FACES[1],w)}this.curStOpBits=opBits,this.curStMaskBits=maskBits}},clear:function(color,depth,stencil){var bits=0;null!=color&&(this.gl.colorMask(!0,!0,!0,!0),this.curColorMask=15,this.gl.clearColor(color.x,color.y,color.z,color.w),bits|=16384),null!=depth&&(this.gl.depthMask(!0),this.curMatBits>=0&&(this.curMatBits|=4),this.gl.clearDepth(depth),bits|=256),null!=stencil&&(this.selectStencilBits(this.defStencil.opBits,this.defStencil.maskBits),this.gl.clearStencil(stencil),bits|=1024),0!=bits&&this.gl.clear(bits),null!=this.curTarget&&(this.curTarget.flags|=1<<h3d_mat_TextureFlags.WasCleared._hx_index)},resize:function(width,height){if(""==this.canvas.style.width){var tmp=width/window.devicePixelRatio|0;this.canvas.style.width=tmp+"px";tmp=height/window.devicePixelRatio|0;this.canvas.style.height=tmp+"px"}this.canvas.width=width,this.canvas.height=height,this.bufferWidth=width,this.bufferHeight=height,this.gl.viewport(0,0,width,height),null!=this.defaultDepth&&(this.disposeDepthBuffer(this.defaultDepth),this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.b=this.allocDepthBuffer(this.defaultDepth))},getChannels:function(t){switch(t.internalFmt){case 6407:return 6407;case 6408:return 6408;case 32856:return 32993;case 32857:return 6408;case 6403:case 33321:case 33325:case 33326:return 6403;case 33319:case 33323:case 33327:case 33328:return 33319;case 33777:case 33778:case 33779:return 6408;case 34837:case 34843:case 35898:return 6407;case 35904:case 35905:return 6407;case 34836:case 34842:case 35906:case 35907:return 6408;default:throw haxe_Exception.thrown("Invalid format "+t.internalFmt)}},isSupportedFormat:function(fmt){switch(fmt._hx_index){case 2:return!0;case 3:case 4:return this.hasFeature(h3d_impl_Feature.FloatTextures);case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 16:case 17:return this.glES>=3;case 14:case 15:return this.hasFeature(h3d_impl_Feature.SRGBTextures);case 18:return fmt.v<=this.maxCompressedTexturesSupport;default:return!1}},getBindType:function(t){var isCube=0!=(t.flags&1<<h3d_mat_TextureFlags.Cube._hx_index),isArray=0!=(t.flags&1<<h3d_mat_TextureFlags.IsArray._hx_index);return isCube?34067:isArray?35866:3553},allocTexture:function(t){h3d_impl_GlDriver.outOfMemoryCheck&&this.gl.getError();var tt=this.gl.createTexture(),bind=this.getBindType(t),tt1={t:tt,width:t.width,height:t.height,internalFmt:6408,pixelFmt:5121,bits:-1,bind:bind};switch((_g=t.format)._hx_index){case 1:tt1.internalFmt=32856;break;case 2:break;case 3:if(!this.hasFeature(h3d_impl_Feature.FloatTextures))throw haxe_Exception.thrown("Unsupported texture format "+Std.string(t.format));tt1.pixelFmt=5131,tt1.internalFmt=34842;break;case 4:if(!this.hasFeature(h3d_impl_Feature.FloatTextures))throw haxe_Exception.thrown("Unsupported texture format "+Std.string(t.format));tt1.internalFmt=34836,tt1.pixelFmt=5126;break;case 5:tt1.internalFmt=33321;break;case 6:tt1.internalFmt=33325,tt1.pixelFmt=5131;break;case 7:tt1.internalFmt=33326,tt1.pixelFmt=5126;break;case 8:tt1.internalFmt=33323;break;case 9:tt1.internalFmt=33327,tt1.pixelFmt=5131;break;case 10:tt1.internalFmt=33328,tt1.pixelFmt=5126;break;case 11:tt1.internalFmt=6407;break;case 12:tt1.internalFmt=34843,tt1.pixelFmt=5131;break;case 13:tt1.internalFmt=34837,tt1.pixelFmt=5126;break;case 14:tt1.internalFmt=35905;break;case 15:tt1.internalFmt=35907;break;case 16:tt1.internalFmt=32857,tt1.pixelFmt=33640;break;case 17:tt1.internalFmt=35898,tt1.pixelFmt=35899;break;case 18:var n=_g.v;if(!(n<=this.maxCompressedTexturesSupport))throw haxe_Exception.thrown("Unsupported texture format "+Std.string(t.format));if(0!=(3&t.width)||0!=(3&t.height))throw haxe_Exception.thrown("Compressed texture "+Std.string(t)+" has size "+t.width+"x"+t.height+" - must be a multiple of 4");switch(n){case 1:tt1.internalFmt=33777;break;case 2:tt1.internalFmt=33778;break;case 3:tt1.internalFmt=33779;break;default:throw haxe_Exception.thrown("Unsupported texture format "+Std.string(t.format))}break;default:throw haxe_Exception.thrown("Unsupported texture format "+Std.string(t.format))}t.set_lastFrame(this.frame),t.flags&=-1-(1<<h3d_mat_TextureFlags.WasCleared._hx_index),this.gl.bindTexture(bind,tt1.t);var outOfMem=!1;if(0!=(t.flags&1<<h3d_mat_TextureFlags.Cube._hx_index))for(var _g=0;_g<6;){var i=_g++;if(this.gl.texImage2D(h3d_impl_GlDriver.CUBE_FACES[i],0,tt1.internalFmt,tt1.width,tt1.height,0,this.getChannels(tt1),tt1.pixelFmt,null),h3d_impl_GlDriver.outOfMemoryCheck)if(1285==(err=this.gl.getError()))outOfMem=!0,tmp=!0;else{if(0!=err)throw haxe_Exception.thrown("Failed to alloc texture "+Std.string(t.format)+"(error "+err+")");tmp=!1}else tmp=!1;if(tmp)break}else if(0!=(t.flags&1<<h3d_mat_TextureFlags.IsArray._hx_index)){if(this.gl.texImage3D(35866,0,tt1.internalFmt,tt1.width,tt1.height,t.get_layerCount(),0,this.getChannels(tt1),tt1.pixelFmt,null),h3d_impl_GlDriver.outOfMemoryCheck)if(1285==(err=this.gl.getError()))outOfMem=!0;else if(0!=err)throw haxe_Exception.thrown("Failed to alloc texture "+Std.string(t.format)+"(error "+err+")")}else{var tmp,err;if(18==(_g=t.format)._hx_index){_g.v;tmp=!0}else tmp=!1;if(tmp||this.gl.texImage2D(bind,0,tt1.internalFmt,tt1.width,tt1.height,0,this.getChannels(tt1),tt1.pixelFmt,null),h3d_impl_GlDriver.outOfMemoryCheck)if(1285==(err=this.gl.getError()))outOfMem=!0;else if(0!=err)throw haxe_Exception.thrown("Failed to alloc texture "+Std.string(t.format)+"(error "+err+")")}return this.restoreBind(),outOfMem?(this.gl.deleteTexture(tt1.t),null):tt1},restoreBind:function(){var t=this.boundTextures[this.lastActiveIndex];null==t?this.gl.bindTexture(3553,null):this.gl.bindTexture(t.bind,t.t)},allocDepthBuffer:function(b){var format,r=this.gl.createRenderbuffer();switch(null==b.format&&(b.format=this.glES>=3?h3d_mat_DepthFormat.Depth24Stencil8:h3d_mat_DepthFormat.Depth16),b.format._hx_index){case 0:format=33189;break;case 1:if(!(this.glES>=3))throw haxe_Exception.thrown("Unsupported depth format "+Std.string(b.format));format=33190;break;case 2:format=34041;break;default:throw haxe_Exception.thrown("Unsupported depth format "+Std.string(b.format))}return this.gl.bindRenderbuffer(36161,r),this.gl.renderbufferStorage(36161,format,b.width,b.height),this.gl.bindRenderbuffer(36161,null),{r:r}},disposeDepthBuffer:function(b){null!=b.b&&null!=b.b.r&&(this.gl.deleteRenderbuffer(b.b.r),b.b=null)},getDefaultDepthBuffer:function(){return null!=this.defaultDepth||(this.defaultDepth=new h3d_mat_DepthBuffer(0,0),this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.b=this.allocDepthBuffer(this.defaultDepth)),this.defaultDepth},allocVertexes:function(m){h3d_impl_GlDriver.outOfMemoryCheck&&this.gl.getError();var b=this.gl.createBuffer();if(this.gl.bindBuffer(34962,b),m.size*m.stride==0)throw haxe_Exception.thrown("assert");this.gl.bufferData(34962,m.size*m.stride*4,0!=(m.flags&1<<h3d_BufferFlag.Dynamic._hx_index)?35048:35044);var outOfMem=h3d_impl_GlDriver.outOfMemoryCheck&&1285==this.gl.getError();return this.gl.bindBuffer(34962,null),outOfMem?(this.gl.deleteBuffer(b),null):{b:b,stride:m.stride}},allocIndexes:function(count,is32){h3d_impl_GlDriver.outOfMemoryCheck&&this.gl.getError();var b=this.gl.createBuffer(),size=is32?4:2;this.gl.bindBuffer(34963,b),this.gl.bufferData(34963,count*size,35044);var outOfMem=h3d_impl_GlDriver.outOfMemoryCheck&&1285==this.gl.getError();return this.gl.bindBuffer(34963,null),this.curIndexBuffer=null,outOfMem?(this.gl.deleteBuffer(b),null):{b:b,is32:is32}},disposeTexture:function(t){var tt=t.t;if(null!=tt){t.t=null;for(var _g=0,_g1=this.boundTextures.length;_g<_g1;){var i=_g++;this.boundTextures[i]==tt&&(this.boundTextures[i]=null)}this.gl.deleteTexture(tt.t)}},disposeIndexes:function(i){this.gl.deleteBuffer(i.b)},disposeVertexes:function(v){this.gl.deleteBuffer(v.b)},generateMipMaps:function(t){var bind=this.getBindType(t);this.gl.bindTexture(bind,t.t.t),this.gl.generateMipmap(bind),this.restoreBind()},uploadTextureBitmap:function(t,bmp,mipLevel,side){if(t.format!=hxd_PixelFormat.RGBA||0!=(t.flags&1<<h3d_mat_TextureFlags.Cube._hx_index)){var pixels=bmp.getPixels();this.uploadTexturePixels(t,pixels,mipLevel,side),pixels.dispose()}else{var img=bmp.ctx;this.gl.bindTexture(3553,t.t.t),this.gl.texImage2D(3553,mipLevel,t.t.internalFmt,this.getChannels(t.t),t.t.pixelFmt,img.getImageData(0,0,bmp.ctx.canvas.width,bmp.ctx.canvas.height)),this.restoreBind()}},resetStream:function(){},uploadTexturePixels:function(t,pixels,mipLevel,side){var cubic=0!=(t.flags&1<<h3d_mat_TextureFlags.Cube._hx_index),bind=this.getBindType(t);if(0!=(t.flags&1<<h3d_mat_TextureFlags.IsArray._hx_index))throw haxe_Exception.thrown("TODO:texImage3D");var face=cubic?h3d_impl_GlDriver.CUBE_FACES[side]:3553;this.gl.bindTexture(bind,t.t.t),pixels.convert(t.format),pixels.setFlip(!1);var buffer,bufLen=pixels.stride*pixels.height;switch(t.format._hx_index){case 4:case 7:case 10:case 13:buffer=new Float32Array(pixels.bytes.b.buffer,pixels.offset,bufLen>>2);break;case 3:case 6:case 9:case 12:buffer=new Uint16Array(pixels.bytes.b.buffer,pixels.offset,bufLen>>1);break;case 16:case 17:buffer=new Uint32Array(pixels.bytes.b.buffer,pixels.offset,bufLen>>2);break;default:buffer=new Uint8Array(pixels.bytes.b.buffer,pixels.offset,bufLen)}var tmp,_g=t.format;if(18==_g._hx_index){_g.v;tmp=!0}else tmp=!1;tmp?this.gl.compressedTexImage2D(face,mipLevel,t.t.internalFmt,pixels.width,pixels.height,0,buffer):this.gl.texImage2D(face,mipLevel,t.t.internalFmt,pixels.width,pixels.height,0,this.getChannels(t.t),t.t.pixelFmt,buffer),t.flags|=1<<h3d_mat_TextureFlags.WasCleared._hx_index,this.restoreBind()},uploadVertexBuffer:function(v,startVertex,vertexCount,buf,bufPos){var stride=v.stride;this.gl.bindBuffer(34962,v.b);var buf1=buf.array,sub=new Float32Array(buf1.buffer,4*bufPos,vertexCount*stride);this.gl.bufferSubData(34962,startVertex*stride*4,sub),this.gl.bindBuffer(34962,null)},uploadIndexBuffer:function(i,startIndice,indiceCount,buf,bufPos){var bits=i.is32?2:1;this.gl.bindBuffer(34963,i.b);var buf1=new Uint16Array(buf),sub=new Uint16Array(buf1.buffer,bufPos<<bits,indiceCount);this.gl.bufferSubData(34963,startIndice<<bits,sub),this.gl.bindBuffer(34963,null),this.curIndexBuffer=null},selectBuffer:function(v){if(v!=this.curBuffer)if(null==this.curBuffer||v.buffer!=this.curBuffer.buffer||0!=(v.buffer.flags&1<<h3d_BufferFlag.RawFormat._hx_index)!=(0!=(this.curBuffer.flags&1<<h3d_BufferFlag.RawFormat._hx_index))){if(null==this.curShader)throw haxe_Exception.thrown("No shader selected");this.curBuffer=v;var m=v.buffer.vbuf;if(m.stride<this.curShader.stride)throw haxe_Exception.thrown("Buffer stride ("+m.stride+") and shader stride ("+this.curShader.stride+") mismatch");if(this.gl.bindBuffer(34962,m.b),0!=(v.flags&1<<h3d_BufferFlag.RawFormat._hx_index))for(var _g=0,_g1=this.curShader.attribs;_g<_g1.length;){var a=_g1[_g];++_g;var pos=a.offset;this.gl.vertexAttribPointer(a.index,a.size,a.type,!1,4*m.stride,4*pos),this.currentDivisor[a.index]!=a.divisor&&(this.currentDivisor[a.index]=a.divisor,this.gl.vertexAttribDivisor(a.index,a.divisor))}else{var offset=8;for(_g=0,_g1=this.curShader.attribs.length;_g<_g1;){var i=_g++,_g2=(a=this.curShader.attribs[i],this.curShader.inputs.names[i]);switch(_g2){case"normal":if(m.stride<6)throw haxe_Exception.thrown("Buffer is missing NORMAL data, set it to RAW format ?");pos=3;break;case"position":pos=0;break;case"uv":if(m.stride<8)throw haxe_Exception.thrown("Buffer is missing UV data, set it to RAW format ?");pos=6;break;default:var s=_g2;if(pos=offset,(offset+=a.size)>m.stride)throw haxe_Exception.thrown("Buffer is missing '"+s+"' data, set it to RAW format ?")}this.gl.vertexAttribPointer(a.index,a.size,a.type,!1,4*m.stride,4*pos),this.currentDivisor[a.index]!=a.divisor&&(this.currentDivisor[a.index]=a.divisor,this.gl.vertexAttribDivisor(a.index,a.divisor))}}}else this.curBuffer=v},draw:function(ibuf,startIndex,ntriangles){ibuf!=this.curIndexBuffer&&(this.curIndexBuffer=ibuf,this.gl.bindBuffer(34963,ibuf.b)),ibuf.is32?this.gl.drawElements(this.drawMode,3*ntriangles,5125,4*startIndex):this.gl.drawElements(this.drawMode,3*ntriangles,5123,2*startIndex)},end:function(){},isDisposed:function(){return this.gl.isContextLost()},setRenderZone:function(x,y,width,height){0==x&&0==y&&width<0&&height<0?this.gl.disable(3089):(this.gl.enable(3089),null==this.curTarget&&(y=this.bufferHeight-(y+height)),this.gl.scissor(x,y,width,height))},setDrawBuffers:function(k){this.glES>=3?this.gl.drawBuffers(h3d_impl_GlDriver.CBUFFERS[k]):null!=this.mrtExt&&this.mrtExt.drawBuffersWEBGL(h3d_impl_GlDriver.CBUFFERS[k])},unbindTargets:function(){if(null!=this.curTarget&&this.numTargets>1){for(;this.numTargets>1;)this.gl.framebufferTexture2D(36160,36064+--this.numTargets,3553,null,0),this.curTargets[this.numTargets]=null;this.setDrawBuffers(1)}},capturePixels:function(tex,layer,mipLevel,region){var pixels,x,y;null!=region?(region.xMax>tex.width&&(region.xMax=tex.width),region.yMax>tex.height&&(region.yMax=tex.height),region.xMin<0&&(region.xMin=0),region.yMin<0&&(region.yMin=0),pixels=hxd_Pixels.alloc(region.xMax-region.xMin>>mipLevel,region.yMax-region.yMin>>mipLevel,tex.format),x=region.xMin,y=region.yMin):(pixels=hxd_Pixels.alloc(tex.width>>mipLevel,tex.height>>mipLevel,tex.format),x=0,y=0);var old=this.curTarget,oldCount=this.numTargets,oldLayer=this.curTargetLayer,oldMip=this.curTargetMip;if(oldCount>1){this.numTargets=1;for(var _g=1,_g1=oldCount;_g<_g1;){var i=_g++;this.curTargets[i]==tex&&this.gl.framebufferTexture2D(36160,36064+i,3553,null,0)}}if(this.setRenderTarget(tex,layer,mipLevel),this.captureSubRenderBuffer(pixels,x,y),this.setRenderTarget(old,oldLayer,oldMip),oldCount>1){for(_g=1,_g1=oldCount;_g<_g1;){i=_g++;this.curTargets[i]==tex&&this.gl.framebufferTexture2D(36160,36064+i,3553,tex.t.t,0)}this.setDrawBuffers(oldCount),this.numTargets=oldCount}return pixels},setRenderTarget:function(tex,layer,mipLevel){if(null==mipLevel&&(mipLevel=0),null==layer&&(layer=0),this.unbindTargets(),this.curTarget=tex,null==tex)return this.gl.bindFramebuffer(36160,null),void this.gl.viewport(0,0,this.bufferWidth,this.bufferHeight);if(null!=tex.depthBuffer&&(tex.depthBuffer.width!=tex.width||tex.depthBuffer.height!=tex.height))throw haxe_Exception.thrown("Invalid depth buffer size : does not match render target size");if(mipLevel>0&&1==this.glES)throw haxe_Exception.thrown("Cannot render to mipLevel in WebGL1, use upload() instead");if(null==tex.t&&tex.alloc(),0!=(tex.flags&1<<h3d_mat_TextureFlags.MipMapped._hx_index)&&0==(tex.flags&1<<h3d_mat_TextureFlags.WasCleared._hx_index)){var bind=this.getBindType(tex);this.gl.bindTexture(bind,tex.t.t),this.gl.generateMipmap(bind),this.restoreBind()}tex.flags|=1<<h3d_mat_TextureFlags.WasCleared._hx_index,tex.set_lastFrame(this.frame),this.curTargetLayer=layer,this.curTargetMip=mipLevel,this.gl.bindFramebuffer(36160,this.commonFB),0!=(tex.flags&1<<h3d_mat_TextureFlags.IsArray._hx_index)?this.gl.framebufferTextureLayer(36160,36064,tex.t.t,mipLevel,layer):this.gl.framebufferTexture2D(36160,36064,0!=(tex.flags&1<<h3d_mat_TextureFlags.Cube._hx_index)?h3d_impl_GlDriver.CUBE_FACES[layer]:3553,tex.t.t,mipLevel),null!=tex.depthBuffer?(this.gl.framebufferRenderbuffer(36160,36096,36161,tex.depthBuffer.b.r),this.gl.framebufferRenderbuffer(36160,36128,36161,tex.depthBuffer.hasStencil()?tex.depthBuffer.b.r:null)):(this.gl.framebufferRenderbuffer(36160,36096,36161,null),this.gl.framebufferRenderbuffer(36160,36128,36161,null)),this.gl.viewport(0,0,tex.width>>mipLevel,tex.height>>mipLevel);for(var _g=0,_g1=this.boundTextures.length;_g<_g1;){var i=_g++;this.boundTextures[i]=null}if(this.glDebug){var code=this.gl.checkFramebufferStatus(36160);if(36053!=code)throw haxe_Exception.thrown("Invalid frame buffer: "+code)}},setRenderTargets:function(textures){if(this.unbindTargets(),this.setRenderTarget(textures[0]),!(textures.length<2)){this.numTargets=textures.length;for(var _g=1,_g1=textures.length;_g<_g1;){var i=_g++,tex=textures[i];null==tex.t&&tex.alloc(),this.gl.framebufferTexture2D(36160,36064+i,3553,tex.t.t,0),this.curTargets[i]=tex,tex.set_lastFrame(this.frame),tex.flags|=1<<h3d_mat_TextureFlags.WasCleared._hx_index}this.setDrawBuffers(textures.length)}},init:function(onCreate,forceSoftware){null==forceSoftware&&(forceSoftware=!1);var ready=!1;if("complete"==window.document.readyState){var _g=onCreate;haxe_Timer.delay((function(){_g(!1)}),1)}else window.addEventListener("load",(function(_){ready||(ready=!0,onCreate(!1))}))},hasFeature:function(f){return this.features.get(f)},makeFeatures:function(){for(var _g=0,_g1=h3d_impl_Feature.__empty_constructs__.slice();_g<_g1.length;){var f=_g1[_g];++_g,this.features.set(f,this.checkFeature(f))}null!=this.gl.getExtension("WEBGL_compressed_texture_s3tc")&&(this.maxCompressedTexturesSupport=3)},checkFeature:function(f){switch(f._hx_index){case 0:return this.glES>=3||null!=this.gl.getExtension("OES_standard_derivatives");case 1:return this.glES>=3?null!=this.gl.getExtension("EXT_color_buffer_float")&&null!=this.gl.getExtension("OES_texture_float_linear"):null!=this.gl.getExtension("OES_texture_float")&&null!=this.gl.getExtension("OES_texture_float_linear")&&null!=this.gl.getExtension("OES_texture_half_float")&&null!=this.gl.getExtension("OES_texture_half_float_linear");case 4:return this.glES>=3||(null!=this.mrtExt||null!=(this.mrtExt=this.gl.getExtension("WEBGL_draw_buffers")));case 6:return this.glES>=3||null!=this.gl.getExtension("EXT_sRGB");case 7:return this.glES>=3;case 2:case 3:case 8:case 9:return!0;case 10:return this.glES>=3||null!=this.gl.getExtension("ANGLE_instanced_arrays");default:return!1}},captureSubRenderBuffer:function(pixels,x,y){if(null==this.curTarget)throw haxe_Exception.thrown("Can't capture main render buffer in GL");h3d_impl_GlDriver.outOfMemoryCheck&&this.gl.getError();var buffer=pixels.bytes.b;switch(this.curTarget.format._hx_index){case 4:case 7:case 10:case 13:buffer=new Float32Array(buffer.buffer);break;case 3:case 6:case 9:case 12:buffer=new Uint16Array(buffer.buffer);break;case 16:case 17:buffer=new Uint32Array(buffer.buffer)}this.gl.readPixels(x,y,pixels.width,pixels.height,this.getChannels(this.curTarget.t),this.curTarget.t.pixelFmt,buffer);var error=this.gl.getError();if(0!=error)throw haxe_Exception.thrown("Failed to capture pixels (error "+error+")");pixels.set_innerFormat(this.curTarget.format)},__class__:h3d_impl_GlDriver});var h3d_impl__$ManagedBuffer_FreeCell=function(pos,count,next){this.pos=pos,this.count=count,this.next=next};$hxClasses["h3d.impl._ManagedBuffer.FreeCell"]=h3d_impl__$ManagedBuffer_FreeCell,h3d_impl__$ManagedBuffer_FreeCell.__name__="h3d.impl._ManagedBuffer.FreeCell",h3d_impl__$ManagedBuffer_FreeCell.prototype={__class__:h3d_impl__$ManagedBuffer_FreeCell};var h3d_impl_ManagedBuffer=function(stride,size,flags){if(this.flags=0,null!=flags)for(var _g=0;_g<flags.length;){var f=flags[_g];++_g,this.flags|=1<<f._hx_index}this.size=size,this.stride=stride,this.freeList=new h3d_impl__$ManagedBuffer_FreeCell(0,size,null),this.mem=h3d_Engine.CURRENT.mem,this.mem.allocManaged(this)};$hxClasses["h3d.impl.ManagedBuffer"]=h3d_impl_ManagedBuffer,h3d_impl_ManagedBuffer.__name__="h3d.impl.ManagedBuffer",h3d_impl_ManagedBuffer.prototype={uploadVertexBuffer:function(start,vertices,buf,bufPos){null==bufPos&&(bufPos=0),this.mem.driver.uploadVertexBuffer(this.vbuf,start,vertices,buf,bufPos)},allocPosition:function(nvert,align){for(var free=this.freeList;null!=free;){if(free.count>=nvert){var d=(align-free.pos%align)%align;if(0==d)break;if(free.count>=nvert+d){free.next=new h3d_impl__$ManagedBuffer_FreeCell(free.pos+d,free.count-d,free.next),free.count=d,free=free.next;break}}free=free.next}if(null==free)return-1;var pos=free.pos;return free.pos+=nvert,free.count-=nvert,pos},allocBuffer:function(b){var align=0!=(b.flags&1<<h3d_BufferFlag.Quads._hx_index)?4:0!=(b.flags&1<<h3d_BufferFlag.Triangles._hx_index)?3:1,p=this.allocPosition(b.vertices,align);return!(p<0)&&(b.position=p,b.buffer=this,!0)},freeBuffer:function(b){for(var prev=null,f=this.freeList,nvert=b.vertices,end=b.position+nvert;null!=f;){if(f.pos==end){f.pos-=nvert,f.count+=nvert,null!=prev&&prev.pos+prev.count==f.pos&&(prev.count+=f.count,prev.next=f.next),nvert=0;break}if(f.pos>end){if(null!=prev&&prev.pos+prev.count==b.position)prev.count+=nvert;else{var n=new h3d_impl__$ManagedBuffer_FreeCell(b.position,nvert,f);null==prev?this.freeList=n:prev.next=n}nvert=0;break}prev=f,f=f.next}if(0!=nvert)throw haxe_Exception.thrown("assert");this.freeList.count==this.size&&0==(this.flags&1<<h3d_BufferFlag.Managed._hx_index)&&this.dispose()},dispose:function(){this.mem.freeManaged(this)},__class__:h3d_impl_ManagedBuffer};var h3d_impl_MemoryManager=function(driver){this.bufferCount=0,this.texMemory=0,this.usedMemory=0,this.driver=driver};$hxClasses["h3d.impl.MemoryManager"]=h3d_impl_MemoryManager,h3d_impl_MemoryManager.__name__="h3d.impl.MemoryManager",h3d_impl_MemoryManager.prototype={init:function(){this.indexes=[],this.textures=[],this.buffers=[],this.depths=[],this.initIndexes()},initIndexes:function(){for(var indices=new Array(0),_g=0;_g<65533;){var i=_g++;indices.push(i)}this.triIndexes=h3d_Indexes.alloc(indices);for(indices=new Array(0),_g=0;_g<16383;){var k=(i=_g++)<<2;indices.push(k),indices.push(k+1),indices.push(k+2),indices.push(k+2),indices.push(k+1),indices.push(k+3)}indices.push(65533),this.quadIndexes=h3d_Indexes.alloc(indices)},garbage:function(){},cleanManagedBuffers:function(){for(var _g=1,_g1=this.buffers.length;_g<_g1;)for(var i=_g++,b=this.buffers[i],prev=null;null!=b;)b.freeList.count==b.size?(b.dispose(),null==prev?this.buffers[i]=b.next:prev.next=b.next):prev=b,b=b.next},allocManaged:function(m){if(null==m.vbuf){var mem=m.size*m.stride*4;if(0!=mem){for(;this.usedMemory+mem>4294967296||this.bufferCount>=65536||null==(m.vbuf=this.driver.allocVertexes(m));){if(this.driver.isDisposed())return;var size=this.usedMemory-this.freeMemorySize();if(this.garbage(),this.cleanManagedBuffers(),this.usedMemory-this.freeMemorySize()==size){if(this.bufferCount>=65536)throw haxe_Exception.thrown("Too many buffers");throw haxe_Exception.thrown("Memory full ("+Math.ceil(size/1024)+" KB,"+this.bufferCount+" buffers)")}}this.usedMemory+=mem,this.bufferCount++}}},freeManaged:function(m){if(null!=m.vbuf&&(this.driver.disposeVertexes(m.vbuf),m.vbuf=null,this.usedMemory-=m.size*m.stride*4,this.bufferCount--,0==(m.flags&1<<h3d_BufferFlag.Managed._hx_index)))for(var c=this.buffers[0],prev=null;null!=c;){if(c==m){null==prev?this.buffers[0]=m.next:prev.next=m.next;break}prev=c,c=c.next}},allocBuffer:function(b,stride){var max=0!=(b.flags&1<<h3d_BufferFlag.Quads._hx_index)?65532:0!=(b.flags&1<<h3d_BufferFlag.Triangles._hx_index)?65533:65534;if(b.vertices>max){if(65534==max)throw haxe_Exception.thrown("Cannot split buffer with "+b.vertices+" vertices if it's not Quads/Triangles");var rem=b.vertices-max;b.vertices=max,this.allocBuffer(b,stride);for(var n=b;null!=n.next;)n=n.next;for(var flags=[],_g=0,_g1=h3d_impl_MemoryManager.ALL_FLAGS;_g<_g1.length;){var f=_g1[_g];++_g,0!=(b.flags&1<<f._hx_index)&&flags.push(f)}n.next=new h3d_Buffer(rem,stride,flags)}else if(0!=(b.flags&1<<h3d_BufferFlag.Managed._hx_index)){m=this.buffers[stride];for(var prev=null;null!=m;){if(m.allocBuffer(b))return;prev=m,m=m.next}var align=0!=(b.flags&1<<h3d_BufferFlag.Triangles._hx_index)?3:0!=(b.flags&1<<h3d_BufferFlag.Quads._hx_index)?4:0;if(null==m&&align>0){for(var total=b.vertices,size=total;size>2048;)for(m=this.buffers[stride],size>>=1,size-=size%align,b.vertices=size;null!=m;){if(m.allocBuffer(b)){for(flags=[],_g=0,_g1=h3d_impl_MemoryManager.ALL_FLAGS;_g<_g1.length;){f=_g1[_g];++_g,0!=(b.flags&1<<f._hx_index)&&flags.push(f)}return void(b.next=new h3d_Buffer(total-size,stride,flags))}m=m.next}b.vertices=total}if(m=new h3d_impl_ManagedBuffer(stride,65533,[h3d_BufferFlag.Managed]),null==prev?this.buffers[stride]=m:prev.next=m,!m.allocBuffer(b))throw haxe_Exception.thrown("assert")}else{var m,flags=null;if(0!=(b.flags&1<<h3d_BufferFlag.Dynamic._hx_index)&&(null==flags&&(flags=[]),flags.push(h3d_BufferFlag.Dynamic)),0!=(b.flags&1<<h3d_BufferFlag.UniformBuffer._hx_index)&&(null==flags&&(flags=[]),flags.push(h3d_BufferFlag.UniformBuffer)),(m=new h3d_impl_ManagedBuffer(stride,b.vertices,flags)).next=this.buffers[0],this.buffers[0]=m,!m.allocBuffer(b))throw haxe_Exception.thrown("assert")}},deleteIndexes:function(i){HxOverrides.remove(this.indexes,i),this.driver.disposeIndexes(i.ibuf),i.ibuf=null,this.usedMemory-=i.count*(i.is32?4:2)},allocIndexes:function(i){i.ibuf=this.driver.allocIndexes(i.count,i.is32),this.indexes.push(i),this.usedMemory+=i.count*(i.is32?4:2)},bpp:function(t){return 4},cleanTextures:function(force){null==force&&(force=!0),this.textures.sort($bind(this,this.sortByLRU));for(var _g=0,_g1=this.textures;_g<_g1.length;){var t=_g1[_g];if(++_g,null!=t.realloc&&(null!=t.t||null!=t.realloc)&&(force||t.get_lastFrame()<hxd_Timer.frameCount-3600))return t.dispose(),!0}return!1},sortByLRU:function(t1,t2){return t1.get_lastFrame()-t2.get_lastFrame()},deleteTexture:function(t){HxOverrides.remove(this.textures,t)&&(this.driver.disposeTexture(t),this.texMemory-=t.width*t.height*this.bpp(t))},allocTexture:function(t){this.cleanTextures(!1);if(t.t=this.driver.allocTexture(t),null!=t.t)this.textures.push(t),this.texMemory+=t.width*t.height*this.bpp(t);else{if(this.driver.isDisposed())return;if(!this.cleanTextures(!0))throw haxe_Exception.thrown("Maximum texture memory reached");this.allocTexture(t)}},allocDepth:function(b){this.cleanTextures(!1);if(b.b=this.driver.allocDepthBuffer(b),null!=b.b)this.depths.push(b),this.texMemory+=b.width*b.height*4;else{if(this.driver.isDisposed())return;if(!this.cleanTextures(!0))throw haxe_Exception.thrown("Maximum texture memory reached");this.allocDepth(b)}},deleteDepth:function(b){HxOverrides.remove(this.depths,b)&&(this.driver.disposeDepthBuffer(b),this.texMemory-=b.width*b.height*4)},onContextLost:function(){this.dispose(),this.initIndexes()},dispose:function(){null!=this.triIndexes&&this.triIndexes.dispose(),null!=this.quadIndexes&&this.quadIndexes.dispose(),this.triIndexes=null,this.quadIndexes=null;for(var _g=0,_g1=this.textures.slice();_g<_g1.length;){var t=_g1[_g];++_g,t.dispose()}for(_g=0,_g1=this.depths.slice();_g<_g1.length;){var b=_g1[_g];++_g,b.dispose()}for(_g=0,_g1=this.buffers.slice();_g<_g1.length;){b=_g1[_g];++_g;for(var b1=b;null!=b1;)b1.dispose(),b1=b1.next}for(_g=0,_g1=this.indexes.slice();_g<_g1.length;){var i=_g1[_g];++_g,i.dispose()}this.buffers=[],this.indexes=[],this.textures=[],this.bufferCount=0,this.usedMemory=0,this.texMemory=0},freeMemorySize:function(){for(var size=0,_g=0,_g1=this.buffers;_g<_g1.length;){var b=_g1[_g];++_g;for(var b1=b;null!=b1;){for(var free=b1.freeList;null!=free;)size+=free.count*b1.stride*4,free=free.next;b1=b1.next}}return size},__class__:h3d_impl_MemoryManager};var h3d_impl_RendererFX=function(){};$hxClasses["h3d.impl.RendererFX"]=h3d_impl_RendererFX,h3d_impl_RendererFX.__name__="h3d.impl.RendererFX",h3d_impl_RendererFX.__isInterface__=!0,h3d_impl_RendererFX.prototype={__class__:h3d_impl_RendererFX};var h3d_impl_TextureCache=function(ctx){this.position=0,this.ctx=ctx,this.cache=[];h3d_Engine.CURRENT;this.defaultFormat=h3d_mat_Texture.nativeFormat,this.defaultDepthBuffer=h3d_mat_DepthBuffer.getDefault()};$hxClasses["h3d.impl.TextureCache"]=h3d_impl_TextureCache,h3d_impl_TextureCache.__name__="h3d.impl.TextureCache",h3d_impl_TextureCache.prototype={begin:function(){for(;this.cache.length>this.position;){var t=this.cache.pop();null!=t&&t.dispose()}this.position=0},lookupTarget:function(name,width,height,format,isCube){for(var t=this.cache[this.position],_g=this.position+1,_g1=this.cache.length;_g<_g1;){var i=_g++,t2=this.cache[i];if(null!=t2&&(null!=t2.t||null!=t2.realloc)&&t2.width==width&&t2.height==height&&t2.format==format&&isCube==(0!=(t2.flags&1<<h3d_mat_TextureFlags.Cube._hx_index)))return this.cache[this.position]=t2,this.cache[i]=t,t2}null!=t&&t.name==name&&(t.dispose(),t=null);var flags=[h3d_mat_TextureFlags.Target];isCube&&flags.push(h3d_mat_TextureFlags.Cube);var newt=new h3d_mat_Texture(width,height,flags,format);return null!=t?this.cache.splice(this.position,0,newt):this.cache[this.position]=newt,newt},allocTarget:function(name,width,height,defaultDepth,format,isCube){null==isCube&&(isCube=!1),null==defaultDepth&&(defaultDepth=!0);var t=this.cache[this.position];return null==format&&(format=this.defaultFormat),(null==t||null==t.t&&null==t.realloc||t.width!=width||t.height!=height||t.format!=format||isCube!=(0!=(t.flags&1<<h3d_mat_TextureFlags.Cube._hx_index)))&&(t=this.lookupTarget(name,width,height,format,isCube)),t.depthBuffer=defaultDepth?this.defaultDepthBuffer:null,t.setName(name),this.position++,t},dispose:function(){for(var _g=0,_g1=this.cache;_g<_g1.length;){var t=_g1[_g];++_g,t.dispose()}this.cache=[]},__class__:h3d_impl_TextureCache};var hxd_impl_AnyProps=function(){};$hxClasses["hxd.impl.AnyProps"]=hxd_impl_AnyProps,hxd_impl_AnyProps.__name__="hxd.impl.AnyProps",hxd_impl_AnyProps.prototype={set_props:function(p){return this.props=p,this.refreshProps(),p},getDefaultProps:function(kind){return{}},refreshProps:function(){},__class__:hxd_impl_AnyProps};var h3d_mat_BaseMaterial=function(shader){null!=shader&&this.addPass(new h3d_mat_Pass("default",null)).addShader(shader)};$hxClasses["h3d.mat.BaseMaterial"]=h3d_mat_BaseMaterial,h3d_mat_BaseMaterial.__name__="h3d.mat.BaseMaterial",h3d_mat_BaseMaterial.__interfaces__=[hxd_impl__$Serializable_NoSerializeSupport],h3d_mat_BaseMaterial.__super__=hxd_impl_AnyProps,h3d_mat_BaseMaterial.prototype=$extend(hxd_impl_AnyProps.prototype,{addPass:function(p){for(var prev=null,cur=this.passes;null!=cur;)prev=cur,cur=cur.nextPass;return null==prev?this.passes=p:prev.nextPass=p,p.nextPass=null,p},removePass:function(p){for(var prev=null,cur=this.passes;null!=cur;){if(cur==p)return null==prev?this.passes=p.nextPass:prev.nextPass=p.nextPass,p.nextPass=null,!0;prev=cur,cur=cur.nextPass}return!1},getPass:function(name){for(var p=this.passes;null!=p;){if(p.name==name)return p;p=p.nextPass}return null},__class__:h3d_mat_BaseMaterial});var h3d_mat_Face=$hxEnums["h3d.mat.Face"]={__ename__:"h3d.mat.Face",__constructs__:["None","Back","Front","Both"],None:{_hx_index:0,__enum__:"h3d.mat.Face",toString:$estr},Back:{_hx_index:1,__enum__:"h3d.mat.Face",toString:$estr},Front:{_hx_index:2,__enum__:"h3d.mat.Face",toString:$estr},Both:{_hx_index:3,__enum__:"h3d.mat.Face",toString:$estr}};h3d_mat_Face.__empty_constructs__=[h3d_mat_Face.None,h3d_mat_Face.Back,h3d_mat_Face.Front,h3d_mat_Face.Both];var h3d_mat_Blend=$hxEnums["h3d.mat.Blend"]={__ename__:"h3d.mat.Blend",__constructs__:["One","Zero","SrcAlpha","SrcColor","DstAlpha","DstColor","OneMinusSrcAlpha","OneMinusSrcColor","OneMinusDstAlpha","OneMinusDstColor","ConstantColor","ConstantAlpha","OneMinusConstantColor","OneMinusConstantAlpha","SrcAlphaSaturate"],One:{_hx_index:0,__enum__:"h3d.mat.Blend",toString:$estr},Zero:{_hx_index:1,__enum__:"h3d.mat.Blend",toString:$estr},SrcAlpha:{_hx_index:2,__enum__:"h3d.mat.Blend",toString:$estr},SrcColor:{_hx_index:3,__enum__:"h3d.mat.Blend",toString:$estr},DstAlpha:{_hx_index:4,__enum__:"h3d.mat.Blend",toString:$estr},DstColor:{_hx_index:5,__enum__:"h3d.mat.Blend",toString:$estr},OneMinusSrcAlpha:{_hx_index:6,__enum__:"h3d.mat.Blend",toString:$estr},OneMinusSrcColor:{_hx_index:7,__enum__:"h3d.mat.Blend",toString:$estr},OneMinusDstAlpha:{_hx_index:8,__enum__:"h3d.mat.Blend",toString:$estr},OneMinusDstColor:{_hx_index:9,__enum__:"h3d.mat.Blend",toString:$estr},ConstantColor:{_hx_index:10,__enum__:"h3d.mat.Blend",toString:$estr},ConstantAlpha:{_hx_index:11,__enum__:"h3d.mat.Blend",toString:$estr},OneMinusConstantColor:{_hx_index:12,__enum__:"h3d.mat.Blend",toString:$estr},OneMinusConstantAlpha:{_hx_index:13,__enum__:"h3d.mat.Blend",toString:$estr},SrcAlphaSaturate:{_hx_index:14,__enum__:"h3d.mat.Blend",toString:$estr}};h3d_mat_Blend.__empty_constructs__=[h3d_mat_Blend.One,h3d_mat_Blend.Zero,h3d_mat_Blend.SrcAlpha,h3d_mat_Blend.SrcColor,h3d_mat_Blend.DstAlpha,h3d_mat_Blend.DstColor,h3d_mat_Blend.OneMinusSrcAlpha,h3d_mat_Blend.OneMinusSrcColor,h3d_mat_Blend.OneMinusDstAlpha,h3d_mat_Blend.OneMinusDstColor,h3d_mat_Blend.ConstantColor,h3d_mat_Blend.ConstantAlpha,h3d_mat_Blend.OneMinusConstantColor,h3d_mat_Blend.OneMinusConstantAlpha,h3d_mat_Blend.SrcAlphaSaturate];var h3d_mat_Compare=$hxEnums["h3d.mat.Compare"]={__ename__:"h3d.mat.Compare",__constructs__:["Always","Never","Equal","NotEqual","Greater","GreaterEqual","Less","LessEqual"],Always:{_hx_index:0,__enum__:"h3d.mat.Compare",toString:$estr},Never:{_hx_index:1,__enum__:"h3d.mat.Compare",toString:$estr},Equal:{_hx_index:2,__enum__:"h3d.mat.Compare",toString:$estr},NotEqual:{_hx_index:3,__enum__:"h3d.mat.Compare",toString:$estr},Greater:{_hx_index:4,__enum__:"h3d.mat.Compare",toString:$estr},GreaterEqual:{_hx_index:5,__enum__:"h3d.mat.Compare",toString:$estr},Less:{_hx_index:6,__enum__:"h3d.mat.Compare",toString:$estr},LessEqual:{_hx_index:7,__enum__:"h3d.mat.Compare",toString:$estr}};h3d_mat_Compare.__empty_constructs__=[h3d_mat_Compare.Always,h3d_mat_Compare.Never,h3d_mat_Compare.Equal,h3d_mat_Compare.NotEqual,h3d_mat_Compare.Greater,h3d_mat_Compare.GreaterEqual,h3d_mat_Compare.Less,h3d_mat_Compare.LessEqual];var h3d_mat_StencilOp=$hxEnums["h3d.mat.StencilOp"]={__ename__:"h3d.mat.StencilOp",__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"],Keep:{_hx_index:0,__enum__:"h3d.mat.StencilOp",toString:$estr},Zero:{_hx_index:1,__enum__:"h3d.mat.StencilOp",toString:$estr},Replace:{_hx_index:2,__enum__:"h3d.mat.StencilOp",toString:$estr},Increment:{_hx_index:3,__enum__:"h3d.mat.StencilOp",toString:$estr},IncrementWrap:{_hx_index:4,__enum__:"h3d.mat.StencilOp",toString:$estr},Decrement:{_hx_index:5,__enum__:"h3d.mat.StencilOp",toString:$estr},DecrementWrap:{_hx_index:6,__enum__:"h3d.mat.StencilOp",toString:$estr},Invert:{_hx_index:7,__enum__:"h3d.mat.StencilOp",toString:$estr}};h3d_mat_StencilOp.__empty_constructs__=[h3d_mat_StencilOp.Keep,h3d_mat_StencilOp.Zero,h3d_mat_StencilOp.Replace,h3d_mat_StencilOp.Increment,h3d_mat_StencilOp.IncrementWrap,h3d_mat_StencilOp.Decrement,h3d_mat_StencilOp.DecrementWrap,h3d_mat_StencilOp.Invert];var h3d_mat_MipMap=$hxEnums["h3d.mat.MipMap"]={__ename__:"h3d.mat.MipMap",__constructs__:["None","Nearest","Linear"],None:{_hx_index:0,__enum__:"h3d.mat.MipMap",toString:$estr},Nearest:{_hx_index:1,__enum__:"h3d.mat.MipMap",toString:$estr},Linear:{_hx_index:2,__enum__:"h3d.mat.MipMap",toString:$estr}};h3d_mat_MipMap.__empty_constructs__=[h3d_mat_MipMap.None,h3d_mat_MipMap.Nearest,h3d_mat_MipMap.Linear];var h3d_mat_Filter=$hxEnums["h3d.mat.Filter"]={__ename__:"h3d.mat.Filter",__constructs__:["Nearest","Linear"],Nearest:{_hx_index:0,__enum__:"h3d.mat.Filter",toString:$estr},Linear:{_hx_index:1,__enum__:"h3d.mat.Filter",toString:$estr}};h3d_mat_Filter.__empty_constructs__=[h3d_mat_Filter.Nearest,h3d_mat_Filter.Linear];var h3d_mat_Wrap=$hxEnums["h3d.mat.Wrap"]={__ename__:"h3d.mat.Wrap",__constructs__:["Clamp","Repeat"],Clamp:{_hx_index:0,__enum__:"h3d.mat.Wrap",toString:$estr},Repeat:{_hx_index:1,__enum__:"h3d.mat.Wrap",toString:$estr}};h3d_mat_Wrap.__empty_constructs__=[h3d_mat_Wrap.Clamp,h3d_mat_Wrap.Repeat];var h3d_mat_Operation=$hxEnums["h3d.mat.Operation"]={__ename__:"h3d.mat.Operation",__constructs__:["Add","Sub","ReverseSub","Min","Max"],Add:{_hx_index:0,__enum__:"h3d.mat.Operation",toString:$estr},Sub:{_hx_index:1,__enum__:"h3d.mat.Operation",toString:$estr},ReverseSub:{_hx_index:2,__enum__:"h3d.mat.Operation",toString:$estr},Min:{_hx_index:3,__enum__:"h3d.mat.Operation",toString:$estr},Max:{_hx_index:4,__enum__:"h3d.mat.Operation",toString:$estr}};h3d_mat_Operation.__empty_constructs__=[h3d_mat_Operation.Add,h3d_mat_Operation.Sub,h3d_mat_Operation.ReverseSub,h3d_mat_Operation.Min,h3d_mat_Operation.Max];var h3d_mat_TextureFlags=$hxEnums["h3d.mat.TextureFlags"]={__ename__:"h3d.mat.TextureFlags",__constructs__:["Target","Cube","MipMapped","ManualMipMapGen","IsNPOT","NoAlloc","Dynamic","AlphaPremultiplied","WasCleared","Loading","Serialize","IsArray"],Target:{_hx_index:0,__enum__:"h3d.mat.TextureFlags",toString:$estr},Cube:{_hx_index:1,__enum__:"h3d.mat.TextureFlags",toString:$estr},MipMapped:{_hx_index:2,__enum__:"h3d.mat.TextureFlags",toString:$estr},ManualMipMapGen:{_hx_index:3,__enum__:"h3d.mat.TextureFlags",toString:$estr},IsNPOT:{_hx_index:4,__enum__:"h3d.mat.TextureFlags",toString:$estr},NoAlloc:{_hx_index:5,__enum__:"h3d.mat.TextureFlags",toString:$estr},Dynamic:{_hx_index:6,__enum__:"h3d.mat.TextureFlags",toString:$estr},AlphaPremultiplied:{_hx_index:7,__enum__:"h3d.mat.TextureFlags",toString:$estr},WasCleared:{_hx_index:8,__enum__:"h3d.mat.TextureFlags",toString:$estr},Loading:{_hx_index:9,__enum__:"h3d.mat.TextureFlags",toString:$estr},Serialize:{_hx_index:10,__enum__:"h3d.mat.TextureFlags",toString:$estr},IsArray:{_hx_index:11,__enum__:"h3d.mat.TextureFlags",toString:$estr}};h3d_mat_TextureFlags.__empty_constructs__=[h3d_mat_TextureFlags.Target,h3d_mat_TextureFlags.Cube,h3d_mat_TextureFlags.MipMapped,h3d_mat_TextureFlags.ManualMipMapGen,h3d_mat_TextureFlags.IsNPOT,h3d_mat_TextureFlags.NoAlloc,h3d_mat_TextureFlags.Dynamic,h3d_mat_TextureFlags.AlphaPremultiplied,h3d_mat_TextureFlags.WasCleared,h3d_mat_TextureFlags.Loading,h3d_mat_TextureFlags.Serialize,h3d_mat_TextureFlags.IsArray];var h3d_mat_Defaults=function(){};$hxClasses["h3d.mat.Defaults"]=h3d_mat_Defaults,h3d_mat_Defaults.__name__="h3d.mat.Defaults",h3d_mat_Defaults.get_shadowShader=function(){var s=h3d_mat_Defaults.shadowShader;return null==s&&(s=new h3d_shader_Shadow,h3d_mat_Defaults.set_shadowShader(s),h3d_mat_Defaults.shadowShader.setPriority(-1)),s},h3d_mat_Defaults.set_shadowShader=function(s){return h3d_mat_Defaults.shadowShader=s};var h3d_mat_DepthFormat=$hxEnums["h3d.mat.DepthFormat"]={__ename__:"h3d.mat.DepthFormat",__constructs__:["Depth16","Depth24","Depth24Stencil8"],Depth16:{_hx_index:0,__enum__:"h3d.mat.DepthFormat",toString:$estr},Depth24:{_hx_index:1,__enum__:"h3d.mat.DepthFormat",toString:$estr},Depth24Stencil8:{_hx_index:2,__enum__:"h3d.mat.DepthFormat",toString:$estr}};h3d_mat_DepthFormat.__empty_constructs__=[h3d_mat_DepthFormat.Depth16,h3d_mat_DepthFormat.Depth24,h3d_mat_DepthFormat.Depth24Stencil8];var h3d_mat_DepthBuffer=function(width,height,format){this.width=width,this.height=height,this.format=format,width>0&&this.alloc()};$hxClasses["h3d.mat.DepthBuffer"]=h3d_mat_DepthBuffer,h3d_mat_DepthBuffer.__name__="h3d.mat.DepthBuffer",h3d_mat_DepthBuffer.getDefault=function(){return h3d_Engine.CURRENT.driver.getDefaultDepthBuffer()},h3d_mat_DepthBuffer.prototype={hasStencil:function(){switch(this.format._hx_index){case 0:case 1:return!1;case 2:return!0}},alloc:function(){h3d_Engine.CURRENT.mem.allocDepth(this)},dispose:function(){null!=this.b&&(h3d_Engine.CURRENT.mem.deleteDepth(this),this.b=null)},isDisposed:function(){return null==this.b},__class__:h3d_mat_DepthBuffer};var h3d_mat_Material=function(texture){this.mshader=new h3d_shader_BaseMesh,this.set_blendMode(h2d_BlendMode.None),h3d_mat_BaseMaterial.call(this,this.mshader),this.set_texture(texture)};$hxClasses["h3d.mat.Material"]=h3d_mat_Material,h3d_mat_Material.__name__="h3d.mat.Material",h3d_mat_Material.__super__=h3d_mat_BaseMaterial,h3d_mat_Material.prototype=$extend(h3d_mat_BaseMaterial.prototype,{set_castShadows:function(v){return this.castShadows==v?v:(null!=this.passes&&(v?this.addPass(new h3d_mat_Pass("shadow",null,this.passes)).set_isStatic(this.staticShadows):this.removePass(this.getPass("shadow"))),this.castShadows=v)},set_receiveShadows:function(v){if(v==this.receiveShadows)return v;if(null!=this.passes){var shadows=h3d_mat_Defaults.get_shadowShader();v?this.passes.addShader(shadows):this.passes.removeShader(shadows)}return this.receiveShadows=v},set_blendMode:function(v){if(null!=this.passes)switch(this.passes.setBlendMode(v),v._hx_index){case 0:this.passes.set_depthWrite(!0),this.passes.setPassName("default");break;case 1:this.passes.set_depthWrite(!0),this.passes.setPassName("alpha");break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:this.passes.set_depthWrite(!1),this.passes.setPassName("additive")}return this.blendMode=v},set_texture:function(t){return null==t?null!=this.textureShader&&(this.passes.removeShader(this.textureShader),this.textureShader=null):(null==this.textureShader&&(this.textureShader=new h3d_shader_Texture,this.passes.addShader(this.textureShader)),this.textureShader.texture__=t),t},getDefaultProps:function(type){var props;if(null==type)props={kind:"Opaque",shadows:!0,culling:!0,light:!0};else switch(type){case"particles3D":case"trail3D":props={kind:"Alpha",shadows:!1,culling:!1,light:!0};break;case"ui":props={kind:"Alpha",shadows:!1,culling:!1,light:!1};break;default:props={kind:"Opaque",shadows:!0,culling:!0,light:!0}}return props},refreshProps:function(){if(null!=this.props&&null!=this.passes){var props=this.props;switch(props.kind){case"Add":this.set_blendMode(h2d_BlendMode.Add);break;case"Alpha":this.set_blendMode(h2d_BlendMode.Alpha);break;case"AlphaKill":case"Hidden":case"Opaque":this.set_blendMode(h2d_BlendMode.None);break;case"SoftAdd":this.set_blendMode(h2d_BlendMode.SoftAdd)}var tshader=this.textureShader;null!=tshader&&(tshader.constModified=!0,tshader.killAlpha__="AlphaKill"==props.kind,tshader.killAlphaThreshold__=.5),this.passes.set_culling("Hidden"==props.kind?h3d_mat_Face.Both:props.culling?h3d_mat_Face.Back:h3d_mat_Face.None),this.passes.set_enableLights(props.light);var v=props.shadows;this.set_castShadows(v),this.set_receiveShadows(v),this.castShadows&&this.receiveShadows&&this.getPass("shadow").set_culling(this.passes.culling)}},__class__:h3d_mat_Material});var h3d_mat_MaterialDatabase=function(){};$hxClasses["h3d.mat.MaterialDatabase"]=h3d_mat_MaterialDatabase,h3d_mat_MaterialDatabase.__name__="h3d.mat.MaterialDatabase",h3d_mat_MaterialDatabase.prototype={__class__:h3d_mat_MaterialDatabase};var h3d_mat_MaterialSetup=function(name){null==this.database&&(this.database=new h3d_mat_MaterialDatabase),this.name=name};$hxClasses["h3d.mat.MaterialSetup"]=h3d_mat_MaterialSetup,h3d_mat_MaterialSetup.__name__="h3d.mat.MaterialSetup",h3d_mat_MaterialSetup.prototype={createRenderer:function(){return new h3d_scene_fwd_Renderer},createLightSystem:function(){return new h3d_scene_fwd_LightSystem},createMaterial:function(){return new h3d_mat_Material},__class__:h3d_mat_MaterialSetup};var h3d_mat_Pass=function(name,shaders,parent){this.layer=0,this.bits=0,this.parentPass=parent,this.shaders=shaders,this.setPassName(name),this.set_culling(h3d_mat_Face.Back);var src=h3d_mat_Blend.One,dst=h3d_mat_Blend.Zero;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.depth(!0,h3d_mat_Compare.Less),this.set_blendOp(this.set_blendAlphaOp(h3d_mat_Operation.Add)),this.colorMask=15};$hxClasses["h3d.mat.Pass"]=h3d_mat_Pass,h3d_mat_Pass.__name__="h3d.mat.Pass",h3d_mat_Pass.__interfaces__=[hxd_impl__$Serializable_NoSerializeSupport],h3d_mat_Pass.prototype={setPassName:function(name){this.name=name,this.passId=hxsl_Globals.allocID(name)},setBlendMode:function(b){switch(b._hx_index){case 0:var src=h3d_mat_Blend.One,dst=h3d_mat_Blend.Zero;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 1:src=h3d_mat_Blend.SrcAlpha,dst=h3d_mat_Blend.OneMinusSrcAlpha;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 2:src=h3d_mat_Blend.SrcAlpha,dst=h3d_mat_Blend.One;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 3:src=h3d_mat_Blend.One,dst=h3d_mat_Blend.OneMinusSrcAlpha;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 4:src=h3d_mat_Blend.OneMinusDstColor,dst=h3d_mat_Blend.One;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 5:src=h3d_mat_Blend.DstColor,dst=h3d_mat_Blend.Zero;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 6:src=h3d_mat_Blend.DstColor,dst=h3d_mat_Blend.OneMinusSrcAlpha;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 7:src=h3d_mat_Blend.Zero,dst=h3d_mat_Blend.OneMinusSrcColor;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 8:src=h3d_mat_Blend.One,dst=h3d_mat_Blend.OneMinusSrcColor;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.Add),this.set_blendAlphaOp(h3d_mat_Operation.Add);break;case 9:src=h3d_mat_Blend.SrcAlpha,dst=h3d_mat_Blend.One;this.set_blendSrc(src),this.set_blendAlphaSrc(src),this.set_blendDst(dst),this.set_blendAlphaDst(dst),this.set_blendOp(h3d_mat_Operation.ReverseSub),this.set_blendAlphaOp(h3d_mat_Operation.ReverseSub);break;case 10:this.set_blendSrc(h3d_mat_Blend.Zero),this.set_blendAlphaSrc(h3d_mat_Blend.Zero),this.set_blendDst(h3d_mat_Blend.Zero),this.set_blendAlphaDst(h3d_mat_Blend.Zero),this.set_blendAlphaSrc(h3d_mat_Blend.Zero),this.set_blendAlphaDst(h3d_mat_Blend.Zero),this.set_blendAlphaOp(h3d_mat_Operation.Max),this.set_blendOp(h3d_mat_Operation.Max);break;case 11:this.set_blendSrc(h3d_mat_Blend.Zero),this.set_blendAlphaSrc(h3d_mat_Blend.Zero),this.set_blendDst(h3d_mat_Blend.Zero),this.set_blendAlphaDst(h3d_mat_Blend.Zero),this.set_blendAlphaSrc(h3d_mat_Blend.Zero),this.set_blendAlphaDst(h3d_mat_Blend.Zero),this.set_blendAlphaOp(h3d_mat_Operation.Min),this.set_blendOp(h3d_mat_Operation.Min)}},depth:function(write,test){this.set_depthWrite(write),this.set_depthTest(test)},addShader:function(s){return null==s?null:(this.shaders=hxsl_ShaderList.addSort(s,this.shaders),s)},removeShader:function(s){for(var sl=this.shaders,prev=null;null!=sl;){if(sl.s==s)return null==prev?this.shaders=sl.next:prev.next=sl.next,!0;prev=sl,sl=sl.next}return!1},getShadersRec:function(){if(null==this.parentPass||this.parentShaders==this.parentPass.shaders)return this.shaders;for(var s=this.shaders,prev=null;null!=s&&s!=this.parentShaders;)prev=s,s=s.next;return this.parentShaders=this.parentPass.shaders,null==prev?this.shaders=this.parentShaders:prev.next=this.parentShaders,this.shaders},set_enableLights:function(v){return this.flags=-2&this.flags|(v?1:0),this.enableLights=v},set_isStatic:function(v){return this.flags=-5&this.flags|(v?1:0)<<2,this.isStatic=v},set_culling:function(v){return this.bits=-4&this.bits|v._hx_index,this.culling=v},set_depthWrite:function(v){return this.bits=-5&this.bits|(v?1:0)<<2,this.depthWrite=v},set_depthTest:function(v){return this.bits=-57&this.bits|v._hx_index<<3,this.depthTest=v},set_blendSrc:function(v){return this.bits=-961&this.bits|v._hx_index<<6,this.blendSrc=v},set_blendDst:function(v){return this.bits=-15361&this.bits|v._hx_index<<10,this.blendDst=v},set_blendAlphaSrc:function(v){return this.bits=-245761&this.bits|v._hx_index<<14,this.blendAlphaSrc=v},set_blendAlphaDst:function(v){return this.bits=-3932161&this.bits|v._hx_index<<18,this.blendAlphaDst=v},set_blendOp:function(v){return this.bits=-29360129&this.bits|v._hx_index<<22,this.blendOp=v},set_blendAlphaOp:function(v){return this.bits=-234881025&this.bits|v._hx_index<<25,this.blendAlphaOp=v},__class__:h3d_mat_Pass};var h3d_mat_Stencil=function(){this.opBits=0,this.maskBits=0,this.setOp(h3d_mat_StencilOp.Keep,h3d_mat_StencilOp.Keep,h3d_mat_StencilOp.Keep),this.setFunc(h3d_mat_Compare.Always)};$hxClasses["h3d.mat.Stencil"]=h3d_mat_Stencil,h3d_mat_Stencil.__name__="h3d.mat.Stencil",h3d_mat_Stencil.__interfaces__=[hxd_impl__$Serializable_NoSerializeSupport],h3d_mat_Stencil.prototype={setFront:function(stfail,dpfail,pass){this.set_frontSTfail(stfail),this.set_frontDPfail(dpfail),this.set_frontPass(pass)},setBack:function(stfail,dpfail,pass){this.set_backSTfail(stfail),this.set_backDPfail(dpfail),this.set_backPass(pass)},setOp:function(stfail,dpfail,pass){this.setFront(stfail,dpfail,pass),this.setBack(stfail,dpfail,pass)},setFunc:function(f,reference,readMask,writeMask){null==writeMask&&(writeMask=255),null==readMask&&(readMask=255),null==reference&&(reference=0),this.set_frontTest(this.set_backTest(f)),this.set_reference(reference),this.set_readMask(readMask),this.set_writeMask(writeMask)},set_readMask:function(v){return this.maskBits=-256&this.maskBits|255&v,this.readMask=v},set_writeMask:function(v){return this.maskBits=-65281&this.maskBits|(255&v)<<8,this.writeMask=v},set_reference:function(v){return this.maskBits=-16711681&this.maskBits|(255&v)<<16,this.reference=v},set_frontTest:function(v){return this.opBits=-8&this.opBits|v._hx_index,this.frontTest=v},set_frontPass:function(v){return this.opBits=-57&this.opBits|v._hx_index<<3,this.frontPass=v},set_frontSTfail:function(v){return this.opBits=-449&this.opBits|v._hx_index<<6,this.frontSTfail=v},set_frontDPfail:function(v){return this.opBits=-3585&this.opBits|v._hx_index<<9,this.frontDPfail=v},set_backTest:function(v){return this.opBits=-28673&this.opBits|v._hx_index<<12,this.backTest=v},set_backPass:function(v){return this.opBits=-229377&this.opBits|v._hx_index<<15,this.backPass=v},set_backSTfail:function(v){return this.opBits=-1835009&this.opBits|v._hx_index<<18,this.backSTfail=v},set_backDPfail:function(v){return this.opBits=-14680065&this.opBits|v._hx_index<<21,this.backDPfail=v},__class__:h3d_mat_Stencil};var hxd_PixelFormat=$hxEnums["hxd.PixelFormat"]={__ename__:"hxd.PixelFormat",__constructs__:["ARGB","BGRA","RGBA","RGBA16F","RGBA32F","R8","R16F","R32F","RG8","RG16F","RG32F","RGB8","RGB16F","RGB32F","SRGB","SRGB_ALPHA","RGB10A2","RG11B10UF","S3TC"],ARGB:{_hx_index:0,__enum__:"hxd.PixelFormat",toString:$estr},BGRA:{_hx_index:1,__enum__:"hxd.PixelFormat",toString:$estr},RGBA:{_hx_index:2,__enum__:"hxd.PixelFormat",toString:$estr},RGBA16F:{_hx_index:3,__enum__:"hxd.PixelFormat",toString:$estr},RGBA32F:{_hx_index:4,__enum__:"hxd.PixelFormat",toString:$estr},R8:{_hx_index:5,__enum__:"hxd.PixelFormat",toString:$estr},R16F:{_hx_index:6,__enum__:"hxd.PixelFormat",toString:$estr},R32F:{_hx_index:7,__enum__:"hxd.PixelFormat",toString:$estr},RG8:{_hx_index:8,__enum__:"hxd.PixelFormat",toString:$estr},RG16F:{_hx_index:9,__enum__:"hxd.PixelFormat",toString:$estr},RG32F:{_hx_index:10,__enum__:"hxd.PixelFormat",toString:$estr},RGB8:{_hx_index:11,__enum__:"hxd.PixelFormat",toString:$estr},RGB16F:{_hx_index:12,__enum__:"hxd.PixelFormat",toString:$estr},RGB32F:{_hx_index:13,__enum__:"hxd.PixelFormat",toString:$estr},SRGB:{_hx_index:14,__enum__:"hxd.PixelFormat",toString:$estr},SRGB_ALPHA:{_hx_index:15,__enum__:"hxd.PixelFormat",toString:$estr},RGB10A2:{_hx_index:16,__enum__:"hxd.PixelFormat",toString:$estr},RG11B10UF:{_hx_index:17,__enum__:"hxd.PixelFormat",toString:$estr},S3TC:($_=function(v){return{_hx_index:18,v:v,__enum__:"hxd.PixelFormat",toString:$estr}},$_.__params__=["v"],$_)};hxd_PixelFormat.__empty_constructs__=[hxd_PixelFormat.ARGB,hxd_PixelFormat.BGRA,hxd_PixelFormat.RGBA,hxd_PixelFormat.RGBA16F,hxd_PixelFormat.RGBA32F,hxd_PixelFormat.R8,hxd_PixelFormat.R16F,hxd_PixelFormat.R32F,hxd_PixelFormat.RG8,hxd_PixelFormat.RG16F,hxd_PixelFormat.RG32F,hxd_PixelFormat.RGB8,hxd_PixelFormat.RGB16F,hxd_PixelFormat.RGB32F,hxd_PixelFormat.SRGB,hxd_PixelFormat.SRGB_ALPHA,hxd_PixelFormat.RGB10A2,hxd_PixelFormat.RG11B10UF];var h3d_mat_Texture=function(w,h,flags,format){var engine=h3d_Engine.CURRENT;this.mem=engine.mem,null==format&&(format=h3d_mat_Texture.nativeFormat),this.id=++h3d_mat_Texture.UID,this.format=format;if(this.flags=0,null!=flags)for(var _g=0;_g<flags.length;){var f=flags[_g];++_g,this.flags|=1<<f._hx_index}for(var tw=1,th=1;tw<w;)tw<<=1;for(;th<h;)th<<=1;tw==w&&th==h||(this.flags|=1<<h3d_mat_TextureFlags.IsNPOT._hx_index),0!=(this.flags&1<<h3d_mat_TextureFlags.Target._hx_index)&&(this.realloc=function(){}),this.width=w,this.height=h,this.set_mipMap(0!=(this.flags&1<<h3d_mat_TextureFlags.MipMapped._hx_index)?h3d_mat_MipMap.Nearest:h3d_mat_MipMap.None),this.set_filter(h3d_mat_Filter.Linear),this.set_wrap(h3d_mat_Wrap.Clamp),this.bits&=32767,0==(this.flags&1<<h3d_mat_TextureFlags.NoAlloc._hx_index)&&this.alloc()};$hxClasses["h3d.mat.Texture"]=h3d_mat_Texture,h3d_mat_Texture.__name__="h3d.mat.Texture",h3d_mat_Texture.fromColor=function(color,alpha){null==alpha&&(alpha=1);var engine=h3d_Engine.CURRENT,aval=255*alpha|0;aval<0?aval=0:aval>255&&(aval=255);var t,key=16777215&color|aval<<24;return null!=(t=engine.textureColorCache.h[key])||((t=new h3d_mat_Texture(1,1,null)).clear(color,alpha),t.realloc=function(){t.clear(color,alpha)},engine.textureColorCache.h[key]=t),t},h3d_mat_Texture.defaultCubeTexture=function(){var engine=h3d_Engine.CURRENT,t=engine.resCache.h[h3d_mat_Texture.__id__];return null!=t||((t=new h3d_mat_Texture(1,1,[h3d_mat_TextureFlags.Cube])).clear(2105376),t.realloc=function(){t.clear(2105376)},engine.resCache.set(h3d_mat_Texture,t)),t},h3d_mat_Texture.prototype={set_lastFrame:function(lf){return this._lastFrame!=h3d_mat_Texture.PREVENT_AUTO_DISPOSE&&(this._lastFrame=lf),this._lastFrame},get_lastFrame:function(){return this._lastFrame},get_layerCount:function(){return 0!=(this.flags&1<<h3d_mat_TextureFlags.Cube._hx_index)?6:1},alloc:function(){null==this.t&&this.mem.allocTexture(this)},preventAutoDispose:function(){this.set_lastFrame(h3d_mat_Texture.PREVENT_AUTO_DISPOSE)},toString:function(){var str=this.name;return null==this.name&&(str="Texture_"+this.id),str+"("+this.width+"x"+this.height+")"},setName:function(n){this.name=n},set_mipMap:function(m){return this.bits=-4&this.bits|m._hx_index,this.mipMap=m},set_filter:function(f){return this.bits=-25&this.bits|f._hx_index<<3,this.filter=f},set_wrap:function(w){return this.bits=-193&this.bits|w._hx_index<<6,this.wrap=w},resize:function(width,height){this.dispose();for(var tw=1,th=1;tw<width;)tw<<=1;for(;th<height;)th<<=1;tw!=width||th!=height?this.flags|=1<<h3d_mat_TextureFlags.IsNPOT._hx_index:this.flags&=-1-(1<<h3d_mat_TextureFlags.IsNPOT._hx_index),this.width=width,this.height=height,0==(this.flags&1<<h3d_mat_TextureFlags.NoAlloc._hx_index)&&this.alloc()},clear:function(color,alpha,layer){if(null==layer&&(layer=-1),null==alpha&&(alpha=1),this.alloc(),1!=this.width||1!=this.height){var engine=h3d_Engine.CURRENT;if(color|=(255*(alpha<0?0:alpha>1?1:alpha)|0)<<24,layer<0)for(var _g=0,_g1=this.get_layerCount();_g<_g1;){var i=_g++;engine.pushTarget(this,i),engine.clear(color),engine.popTarget()}else engine.pushTarget(this,layer),engine.clear(color),engine.popTarget()}else{var p=hxd_Pixels.alloc(this.width,this.height,h3d_mat_Texture.nativeFormat),k=0,b=255&color,g=color>>8&255,r=color>>16&255,a=255*alpha|0;switch(a<0?a=0:a>255&&(a=255),h3d_mat_Texture.nativeFormat._hx_index){case 1:var tmp=r;r=b,b=tmp;break;case 2:break;default:throw haxe_Exception.thrown("TODO")}for(_g=0,_g1=this.width*this.height;_g<_g1;){i=_g++;p.bytes.b[k++]=r,p.bytes.b[k++]=g,p.bytes.b[k++]=b,p.bytes.b[k++]=a}if(layer<0)for(_g=0,_g1=this.get_layerCount();_g<_g1;){i=_g++;this.uploadPixels(p,0,i)}else this.uploadPixels(p,0,layer);p.dispose()}},checkMipMapGen:function(mipLevel,layer){0!=mipLevel||0==(this.flags&1<<h3d_mat_TextureFlags.MipMapped._hx_index)||0!=(this.flags&1<<h3d_mat_TextureFlags.ManualMipMapGen._hx_index)||0!=(this.flags&1<<h3d_mat_TextureFlags.Cube._hx_index)&&5!=layer||this.mem.driver.generateMipMaps(this)},uploadBitmap:function(bmp,mipLevel,layer){null==layer&&(layer=0),null==mipLevel&&(mipLevel=0),this.alloc();var width=bmp.ctx.canvas.width,height=bmp.ctx.canvas.height;if(width!=this.width>>mipLevel||height!=this.height>>mipLevel)throw haxe_Exception.thrown("Invalid upload size : "+width+"x"+height+" should be "+(this.width>>mipLevel)+"x"+(this.height>>mipLevel));this.mem.driver.uploadTextureBitmap(this,bmp,mipLevel,layer),this.flags|=1<<h3d_mat_TextureFlags.WasCleared._hx_index,this.checkMipMapGen(mipLevel,layer)},uploadPixels:function(pixels,mipLevel,layer){null==layer&&(layer=0),null==mipLevel&&(mipLevel=0),this.alloc();var width=pixels.width,height=pixels.height;if(width!=this.width>>mipLevel||height!=this.height>>mipLevel)throw haxe_Exception.thrown("Invalid upload size : "+width+"x"+height+" should be "+(this.width>>mipLevel)+"x"+(this.height>>mipLevel));this.mem.driver.uploadTexturePixels(this,pixels,mipLevel,layer),this.flags|=1<<h3d_mat_TextureFlags.WasCleared._hx_index,this.checkMipMapGen(mipLevel,layer)},dispose:function(){null!=this.t&&this.mem.deleteTexture(this)},capturePixels:function(face,mipLevel,region){null==mipLevel&&(mipLevel=0),null==face&&(face=0);var old=this.get_lastFrame();this.preventAutoDispose();var pix=this.mem.driver.capturePixels(this,face,mipLevel,region);return this.set_lastFrame(old),pix},__class__:h3d_mat_Texture};var h3d_mat_TextureArray=function(w,h,layers,flags,format){this.layers=layers,null==flags&&(flags=[]),flags.push(h3d_mat_TextureFlags.IsArray),h3d_mat_Texture.call(this,w,h,flags,format)};$hxClasses["h3d.mat.TextureArray"]=h3d_mat_TextureArray,h3d_mat_TextureArray.__name__="h3d.mat.TextureArray",h3d_mat_TextureArray.__super__=h3d_mat_Texture,h3d_mat_TextureArray.prototype=$extend(h3d_mat_Texture.prototype,{get_layerCount:function(){return this.layers},toString:function(){return h3d_mat_Texture.prototype.toString.call(this)+"["+this.layers+"]"},__class__:h3d_mat_TextureArray});var h3d_pass_Base=function(name){this.name=name};$hxClasses["h3d.pass.Base"]=h3d_pass_Base,h3d_pass_Base.__name__="h3d.pass.Base",h3d_pass_Base.prototype={setContext:function(ctx){this.ctx=ctx},dispose:function(){},draw:function(passes,sort){},__class__:h3d_pass_Base};var h3d_pass_ScreenFx=function(shader,output){this.shader=shader,this.shaders=new hxsl_ShaderList(shader),this.manager=new h3d_pass_ShaderManager(output),this.pass=new h3d_mat_Pass("screenfx",new hxsl_ShaderList(shader)),this.pass.set_culling(h3d_mat_Face.None),this.pass.depth(!1,h3d_mat_Compare.Always)};$hxClasses["h3d.pass.ScreenFx"]=h3d_pass_ScreenFx,h3d_pass_ScreenFx.__name__="h3d.pass.ScreenFx",h3d_pass_ScreenFx.prototype={get_engine:function(){return null==this._engine&&(this._engine=h3d_Engine.CURRENT),this._engine},render:function(){null==this.primitive&&(this.primitive=h3d_prim_Plane2D.get()),this.shader.flipY__=this.get_engine().driver.hasFeature(h3d_impl_Feature.BottomLeftCoords)&&null!=this.get_engine().getCurrentTarget()?-1:1;var rts=this.manager.compileShaders(this.shaders);if(this.get_engine().selectMaterial(this.pass),this.get_engine().selectShader(rts),null==this.buffers)this.buffers=new h3d_shader_Buffers(rts);else{var _this=this.buffers;_this.vertex.grow(rts.vertex),_this.fragment.grow(rts.fragment)}this.manager.fillGlobals(this.buffers,rts),this.manager.fillParams(this.buffers,rts,this.shaders),this.get_engine().uploadShaderBuffers(this.buffers,0),this.get_engine().uploadShaderBuffers(this.buffers,1),this.get_engine().uploadShaderBuffers(this.buffers,2),this.primitive.render(this.get_engine())},dispose:function(){},__class__:h3d_pass_ScreenFx};var h3d_pass_Blur=function(radius,gain,linear,quality){null==quality&&(quality=1),null==linear&&(linear=0),null==gain&&(gain=1),null==radius&&(radius=1),this.cubeDir=[h3d_Matrix.L([0,0,-1,0,0,-1,0,0,1,0,0,0]),h3d_Matrix.L([0,0,1,0,0,-1,0,0,-1,0,0,0]),h3d_Matrix.L([1,0,0,0,0,0,1,0,0,1,0,0]),h3d_Matrix.L([1,0,0,0,0,0,-1,0,0,-1,0,0]),h3d_Matrix.L([1,0,0,0,0,-1,0,0,0,1,0,0]),h3d_Matrix.L([-1,0,0,0,0,-1,0,0,0,0,-1,0])],h3d_pass_ScreenFx.call(this,new h3d_shader_Blur),this.set_radius(radius),this.set_quality(quality),this.set_gain(gain),this.set_linear(linear)};$hxClasses["h3d.pass.Blur"]=h3d_pass_Blur,h3d_pass_Blur.__name__="h3d.pass.Blur",h3d_pass_Blur.__super__=h3d_pass_ScreenFx,h3d_pass_Blur.prototype=$extend(h3d_pass_ScreenFx.prototype,{set_radius:function(r){return this.radius==r?r:(this.values=null,this.radius=r)},set_quality:function(q){return this.quality==q?q:(this.values=null,this.quality=q)},set_gain:function(s){return this.gain==s?s:(this.values=null,this.gain=s)},set_linear:function(b){return this.linear==b?b:(this.values=null,this.linear=b)},gauss:function(x,s){if(s<=0)return 0==x?1:0;var sq=s*s;return Math.pow(2.718281828459,-x*x/(2*sq))/Math.sqrt(2*Math.PI*sq)},calcValues:function(){this.values=[],this.offsets=[];var width,tot=0,f=this.quality,qadj=.7*(f<0?0:f>1?1:f)+.3;if(this.radius>0){var a=this.radius-1;width=Math.ceil((a<1?1:a)*qadj/2)}else width=0;for(var sigma=Math.sqrt(this.radius),_g=0,_g1=width+1;_g<_g1;){var i1=2*(i=_g++),i2=0==i?0:2*i-1,g1=this.gauss(i1,sigma),g2=this.gauss(i2,sigma),g=g1+g2;this.values[i]=g,this.offsets[i]=0==i?0:(g1*i1+g2*i2)/(g*i*Math.sqrt(qadj)),tot+=g,i>0&&(tot+=g)}for(var minVal=this.values[0]*(.01/qadj);this.values.length>2;){var last=this.values[this.values.length-1];if(last>minVal)break;tot-=2*last,this.values.pop()}tot/=this.gain;for(_g=0,_g1=this.values.length;_g<_g1;){var i=_g++;this.values[i]/=tot}if(this.linear>0){var m=this.gain/(2*this.values.length-1);for(_g=0,_g1=this.values.length;_g<_g1;){i=_g++,a=this.values[i];this.values[i]=a+this.linear*(m-a);var a1=this.offsets[i];this.offsets[i]=a1+this.linear*((0==i?0:(2*i-.5)/(i*qadj))-a1)}}},apply:function(ctx,src,output){if(this.radius<=0&&null==this.shader.fixedColor__)null!=output&&h3d_pass_Copy.run(src,output);else{null==output&&(output=src),null==this.values&&this.calcValues();var isCube=0!=(src.flags&1<<h3d_mat_TextureFlags.Cube._hx_index),faceCount=isCube?6:1,tmp=ctx.textures.allocTarget(src.name+"BlurTmp",src.width,src.height,!1,src.format,isCube);if((_this=this.shader).constModified=!0,_this.Quality__=this.values.length,this.shader.values__=this.values,this.shader.offsets__=this.offsets,isCube)this.shader.cubeTexture__=src,(_this=this.shader).constModified=!0,_this.isCube__=!0;else this.shader.texture__=src,(_this=this.shader).constModified=!0,_this.isCube__=!1;var _this=this.shader.pixel__;null==(y=0)&&(y=0),null==(x=1/src.width)&&(x=0),_this.x=x,_this.y=y,_this.z=0,_this.w=1;for(var _g=0,_g1=faceCount;_g<_g1;){var i=_g++;this.get_engine().pushTarget(tmp,i),isCube&&(this.shader.cubeDir__=this.cubeDir[i]),this.render(),this.get_engine().popTarget()}isCube?this.shader.cubeTexture__=tmp:this.shader.texture__=tmp;_this=this.shader.pixel__;var y,x=0;null==(y=1/src.height)&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=0,_this.w=1;var outDepth=output.depthBuffer;output.depthBuffer=null;for(_g=0,_g1=faceCount;_g<_g1;){i=_g++;this.get_engine().pushTarget(output,i),isCube&&(this.shader.cubeDir__=this.cubeDir[i]),this.render(),this.get_engine().popTarget()}output.depthBuffer=outDepth}},__class__:h3d_pass_Blur});var hxsl_Shader=function(){this.priority=0,this.initialize()};$hxClasses["hxsl.Shader"]=hxsl_Shader,hxsl_Shader.__name__="hxsl.Shader",hxsl_Shader.prototype={initialize:function(){if(this.constModified=!0,null==this.shader){var cl=js_Boot.getClass(this);if(this.shader=cl._SHADER,null==this.shader){for(var curClass=cl;null!=curClass&&null==curClass.SRC;)curClass=curClass.__super__;if(null==curClass)throw haxe_Exception.thrown(cl.__name__+" has no shader source");this.shader=curClass._SHADER,null==this.shader&&(this.shader=new hxsl_SharedShader(curClass.SRC),curClass._SHADER=this.shader)}}},setPriority:function(v){this.priority=v},getParamValue:function(index){throw haxe_Exception.thrown("assert")},getParamFloatValue:function(index){throw haxe_Exception.thrown("assert")},updateConstants:function(globals){throw haxe_Exception.thrown("assert")},updateConstantsFinal:function(globals){for(var c=this.shader.consts;null!=c;)if(0!=c.globalId){var v=globals.map.h[c.globalId],_g=c.v.type;switch(_g._hx_index){case 1:var v1=v;if(v1>>>c.bits!=0)throw haxe_Exception.thrown("Constant "+c.v.name+" is outside range ("+v1+" > "+((1<<c.bits)-1)+")");this.constBits|=v1<<c.pos;break;case 2:v&&(this.constBits|=1<<c.pos);break;case 17:var count=_g.size;if(null==v){c=c.next;continue}var v3=v,sel=v3.channel;if(null==v3.texture)sel=hxsl_Channel.Unknown;else if(null==sel||sel==hxsl_Channel.Unknown)switch(count){case 1:if(v3.texture.format!=h3d_mat_Texture.nativeFormat)throw haxe_Exception.thrown("Constant "+c.v.name+" does not define channel select value");sel=hxsl_Channel.PackedFloat;break;case 3:if(v3.texture.format!=h3d_mat_Texture.nativeFormat)throw haxe_Exception.thrown("Constant "+c.v.name+" does not define channel select value");sel=hxsl_Channel.PackedNormal;break;default:throw haxe_Exception.thrown("Constant "+c.v.name+" does not define channel select value")}this.constBits|=(globals.allocChannelID(v3.texture)<<3|sel._hx_index)<<c.pos;break;default:throw haxe_Exception.thrown("assert")}c=c.next}else c=c.next;var _this=this.shader,constBits=this.constBits,i=_this.instanceCache.h[constBits];this.instance=null==i?_this.makeInstance(constBits):i},toString:function(){return js_Boot.getClass(this).__name__},__class__:hxsl_Shader};var h3d_shader_ScreenShader=function(){this.flipY__=0,hxsl_Shader.call(this)};$hxClasses["h3d.shader.ScreenShader"]=h3d_shader_ScreenShader,h3d_shader_ScreenShader.__name__="h3d.shader.ScreenShader",h3d_shader_ScreenShader.__super__=hxsl_Shader,h3d_shader_ScreenShader.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.flipY__:null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_shader_ScreenShader});var h3d_pass__$Border_BorderShader=function(){this.color__=new h3d_Vector,h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.pass._Border.BorderShader"]=h3d_pass__$Border_BorderShader,h3d_pass__$Border_BorderShader.__name__="h3d.pass._Border.BorderShader",h3d_pass__$Border_BorderShader.__super__=h3d_shader_ScreenShader,h3d_pass__$Border_BorderShader.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.color__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_pass__$Border_BorderShader});var h3d_pass_Border=function(width,height,size){null==size&&(size=1),h3d_pass_ScreenFx.call(this,new h3d_pass__$Border_BorderShader);var newSize,newArray,bbuf=hxd__$FloatBuffer_Float32Expand._new(0);bbuf.pos==bbuf.array.length&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=0/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-0/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=width/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-0/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=0/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-size/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=width/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-size/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=0/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-0/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=size/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-0/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=0/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-height/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=size/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-height/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=0/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-(height-size)/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=width/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-(height-size)/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=0/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-height/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=width/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-height/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=(width-size)/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-0/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=width/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-0/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=(width-size)/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=1-height/height*2,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);(bbuf.array[bbuf.pos++]=width/width*2-1,bbuf.pos==bbuf.array.length)&&((newSize=bbuf.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(bbuf.array),bbuf.array=newArray);bbuf.array[bbuf.pos++]=1-height/height*2,this.primitive=new h3d_prim_RawPrimitive({vbuf:bbuf,stride:2,quads:!0},!0);var _this=this.shader.color__,x=1,y=1,z=1,w=1;null==w&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w};$hxClasses["h3d.pass.Border"]=h3d_pass_Border,h3d_pass_Border.__name__="h3d.pass.Border",h3d_pass_Border.__super__=h3d_pass_ScreenFx,h3d_pass_Border.prototype=$extend(h3d_pass_ScreenFx.prototype,{dispose:function(){h3d_pass_ScreenFx.prototype.dispose.call(this),this.primitive.dispose()},__class__:h3d_pass_Border});var h3d_pass__$Copy_ArrayCopyShader=function(){this.layer__=0,h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.pass._Copy.ArrayCopyShader"]=h3d_pass__$Copy_ArrayCopyShader,h3d_pass__$Copy_ArrayCopyShader.__name__="h3d.pass._Copy.ArrayCopyShader",h3d_pass__$Copy_ArrayCopyShader.__super__=h3d_shader_ScreenShader,h3d_pass__$Copy_ArrayCopyShader.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.layer__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_pass__$Copy_ArrayCopyShader});var h3d_pass__$Copy_CopyShader=function(){h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.pass._Copy.CopyShader"]=h3d_pass__$Copy_CopyShader,h3d_pass__$Copy_CopyShader.__name__="h3d.pass._Copy.CopyShader",h3d_pass__$Copy_CopyShader.__super__=h3d_shader_ScreenShader,h3d_pass__$Copy_CopyShader.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.texture__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_pass__$Copy_CopyShader});var h3d_pass_Copy=function(){h3d_pass_ScreenFx.call(this,new h3d_pass__$Copy_CopyShader)};$hxClasses["h3d.pass.Copy"]=h3d_pass_Copy,h3d_pass_Copy.__name__="h3d.pass.Copy",h3d_pass_Copy.run=function(from,to,blend,pass,layer){var engine=h3d_Engine.CURRENT;if(null==to||null==from||null!=blend&&blend!=h2d_BlendMode.None||null!=pass||!engine.driver.copyTexture(from,to)){var inst=engine.resCache.h[h3d_pass_Copy.__id__];null==inst&&(inst=new h3d_pass_Copy,engine.resCache.set(h3d_pass_Copy,inst)),inst.apply(from,to,blend,pass,layer)}},h3d_pass_Copy.__super__=h3d_pass_ScreenFx,h3d_pass_Copy.prototype=$extend(h3d_pass_ScreenFx.prototype,{apply:function(from,to,blend,customPass,layer){if(null!=to&&this.get_engine().pushTarget(to,null!=layer?layer:0),this.shader.texture__=from,null!=customPass){var old=this.pass;this.pass=customPass,null!=blend&&this.pass.setBlendMode(blend);for(var h=this.shaders;null!=h.next;)h=h.next;h.next=this.pass.shaders,this.render(),this.pass=old,h.next=null}else this.pass.setBlendMode(null==blend?h2d_BlendMode.None:blend),this.render();this.shader.texture__=null,null!=to&&this.get_engine().popTarget()},__class__:h3d_pass_Copy});var h3d_pass__$CubeCopy_CubeCopyShader=function(){this.mat__=new h3d_Matrix,h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.pass._CubeCopy.CubeCopyShader"]=h3d_pass__$CubeCopy_CubeCopyShader,h3d_pass__$CubeCopy_CubeCopyShader.__name__="h3d.pass._CubeCopy.CubeCopyShader",h3d_pass__$CubeCopy_CubeCopyShader.__super__=h3d_shader_ScreenShader,h3d_pass__$CubeCopy_CubeCopyShader.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.mat__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_pass__$CubeCopy_CubeCopyShader});var h3d_pass_Default=function(name){this.defaultSort=$bind($_=new h3d_pass_SortByMaterial,$_.sort),h3d_pass_Base.call(this,name),this.manager=new h3d_pass_ShaderManager(this.getOutputs()),this.initGlobals()};$hxClasses["h3d.pass.Default"]=h3d_pass_Default,h3d_pass_Default.__name__="h3d.pass.Default",h3d_pass_Default.__super__=h3d_pass_Base,h3d_pass_Default.prototype=$extend(h3d_pass_Base.prototype,{getOutputs:function(){return[hxsl_Output.Value("output.color")]},processShaders:function(p,shaders){for(p=this.ctx.extraShaders;null!=p;)shaders=this.ctx.allocShaderList(p.s,shaders),p=p.next;return shaders},setupShaders:function(passes){for(var lightInit=!1,_g_o=passes.current;null!=_g_o;){var tmp=_g_o;_g_o=_g_o.next;var p=tmp,shaders=p.pass.getShadersRec();shaders=this.processShaders(p,shaders),p.pass.enableLights&&null!=this.ctx.lightSystem&&(lightInit||(this.ctx.lightSystem.initGlobals(this.manager.globals),lightInit=!0),shaders=this.ctx.lightSystem.computeLight(p.obj,shaders)),p.shader=this.manager.compileShaders(shaders,p.pass.batchMode),p.shaders=shaders;var t=p.shader.fragment.textures;if(null==t)p.texture=0;else{var t1,_this=this.manager,opt=!0;if(null==opt&&(opt=!1),null!=t.perObjectGlobal){var v=_this.globals.map.h[t.perObjectGlobal.gid];if(null==v)throw haxe_Exception.thrown("Missing global value "+t.perObjectGlobal.path+" for shader "+_this.shaderInfo(shaders,t.perObjectGlobal.path));var t2,_g=t.type;if(17==_g._hx_index){_g.size;t2=!0}else t2=!1;t1=t2?v.texture:v}else{for(var si=shaders,n=t.instance;--n>0;)si=si.next;var v1=si.s.getParamValue(t.index);if(null==v1&&!opt)throw haxe_Exception.thrown("Missing param value "+Std.string(si.s)+"."+t.name);t1=v1}p.texture=null==t1?0:t1.id}}},drawObject:function(p){this.ctx.drawPass=p,this.ctx.engine.selectMaterial(p.pass),p.obj.draw(this.ctx)},draw:function(passes,sort){if(null!=passes.current){for(var _g=0,_g1=this.ctx.sharedGlobals;_g<_g1.length;){var g=_g1[_g];++_g,this.manager.globals.map.h[g.gid]=g.value}this.setGlobals(),this.setupShaders(passes),null==sort?this.defaultSort(passes):sort(passes),this.ctx.currentManager=this.manager;for(var buf=this.ctx.shaderBuffers,prevShader=null,_g2_o=passes.current;null!=_g2_o;){var tmp=_g2_o;_g2_o=_g2_o.next;var p=tmp,v=p.obj.absPos;if(this.manager.globals.map.h[this.globalModelView_id]=v,p.shader.globals.h.hasOwnProperty(this.globalModelViewInverse_id)){var v1=p.obj.getInvPos();this.manager.globals.map.h[this.globalModelViewInverse_id]=v1}if(prevShader!=p.shader){if(prevShader=p.shader,this.ctx.engine.selectShader(p.shader),null==buf)buf=this.ctx.shaderBuffers=new h3d_shader_Buffers(p.shader);else{var s=p.shader;buf.vertex.grow(s.vertex),buf.fragment.grow(s.fragment)}this.manager.fillGlobals(buf,p.shader),this.ctx.engine.uploadShaderBuffers(buf,0)}p.pass.dynamicParameters||(this.manager.fillParams(buf,p.shader,p.shaders),this.ctx.engine.uploadShaderBuffers(buf,1),this.ctx.engine.uploadShaderBuffers(buf,2),this.ctx.engine.uploadShaderBuffers(buf,3)),this.drawObject(p)}var _this=this.ctx;_this.cachedPos=0,_this.drawPass=null}},initGlobals:function(){var this1=hxsl_Globals.allocID("camera.view");this.cameraView_id=this1;this1=hxsl_Globals.allocID("camera.zNear");this.cameraNear_id=this1;this1=hxsl_Globals.allocID("camera.zFar");this.cameraFar_id=this1;this1=hxsl_Globals.allocID("camera.proj");this.cameraProj_id=this1;this1=hxsl_Globals.allocID("camera.position");this.cameraPos_id=this1;this1=hxsl_Globals.allocID("camera.projDiag");this.cameraProjDiag_id=this1;this1=hxsl_Globals.allocID("camera.projFlip");this.cameraProjFlip_id=this1;this1=hxsl_Globals.allocID("camera.viewProj");this.cameraViewProj_id=this1;this1=hxsl_Globals.allocID("camera.inverseViewProj");this.cameraInverseViewProj_id=this1;this1=hxsl_Globals.allocID("global.time");this.globalTime_id=this1;this1=hxsl_Globals.allocID("global.pixelSize");this.pixelSize_id=this1;this1=hxsl_Globals.allocID("global.modelView");this.globalModelView_id=this1;this1=hxsl_Globals.allocID("global.modelViewInverse");this.globalModelViewInverse_id=this1},setGlobals:function(){var v=this.ctx.camera.mcam;this.manager.globals.map.h[this.cameraView_id]=v;v=this.ctx.camera.zNear;this.manager.globals.map.h[this.cameraNear_id]=v;v=this.ctx.camera.zFar;this.manager.globals.map.h[this.cameraFar_id]=v;v=this.ctx.camera.mproj;this.manager.globals.map.h[this.cameraProj_id]=v;v=this.ctx.camera.pos;this.manager.globals.map.h[this.cameraPos_id]=v;v=new h3d_Vector(this.ctx.camera.mproj._11,this.ctx.camera.mproj._22,this.ctx.camera.mproj._33,this.ctx.camera.mproj._44);this.manager.globals.map.h[this.cameraProjDiag_id]=v;v=this.ctx.engine.driver.hasFeature(h3d_impl_Feature.BottomLeftCoords)&&null!=this.ctx.engine.getCurrentTarget()?-1:1;this.manager.globals.map.h[this.cameraProjFlip_id]=v;v=this.ctx.camera.m;this.manager.globals.map.h[this.cameraViewProj_id]=v;v=this.ctx.camera.getInverseViewProj();this.manager.globals.map.h[this.cameraInverseViewProj_id]=v;v=this.ctx.time;this.manager.globals.map.h[this.globalTime_id]=v;v=new h3d_Vector(2/this.ctx.engine.width,2/this.ctx.engine.height);this.manager.globals.map.h[this.pixelSize_id]=v},__class__:h3d_pass_Default});var h3d_pass_Shadows=function(light){this.pcfScale=1,this.pcfQuality=1,this.bias=.01,this.power=30,this.samplingKind=h3d_pass_ShadowSamplingKind.None,this.size=1024,this.mode=h3d_pass_RenderMode.None,this.enabled=!0,null==this.format&&(this.format=hxd_PixelFormat.R16F),h3d_Engine.CURRENT.driver.isSupportedFormat(this.format)||(this.format=h3d_mat_Texture.nativeFormat),h3d_pass_Default.call(this,"shadow"),this.light=light,this.blur=new h3d_pass_Blur(5),this.blur.set_quality(.5);var _this=this.blur.shader;_this.constModified=!0,_this.isDepth__=this.format==h3d_mat_Texture.nativeFormat};$hxClasses["h3d.pass.Shadows"]=h3d_pass_Shadows,h3d_pass_Shadows.__name__="h3d.pass.Shadows",h3d_pass_Shadows.__super__=h3d_pass_Default,h3d_pass_Shadows.prototype=$extend(h3d_pass_Default.prototype,{set_size:function(s){return s!=this.size&&null!=this.staticTexture&&(this.staticTexture.dispose(),this.staticTexture=null),this.size=s},dispose:function(){h3d_pass_Default.prototype.dispose.call(this),this.blur.dispose(),null!=this.staticTexture&&this.staticTexture.dispose()},getShadowProj:function(){return this.lightCamera.m},isUsingWorldDist:function(){return!1},getOutputs:function(){return this.isUsingWorldDist()?[hxsl_Output.Swiz(hxsl_Output.Value("output.worldDist",1),[hxsl_Component.X,hxsl_Component.X,hxsl_Component.X,hxsl_Component.X])]:this.format==h3d_mat_Texture.nativeFormat?[hxsl_Output.PackFloat(hxsl_Output.Value("output.depth"))]:[hxsl_Output.Swiz(hxsl_Output.Value("output.depth",1),[hxsl_Component.X,hxsl_Component.X,hxsl_Component.X,hxsl_Component.X])]},createDefaultShadowMap:function(){var tex=h3d_mat_Texture.fromColor(16777215);return tex.name="defaultShadowMap",tex},syncShader:function(texture){},filterPasses:function(passes){if(this.ctx.computingStatic)switch(this.mode._hx_index){case 0:return!1;case 1:for(var head=null,prev=null,disc=passes.discarded,discQueue=passes.lastDisc,cur=passes.current;null!=cur;)1==cur.pass.isStatic?null==head?head=prev=cur:(prev.next=cur,prev=cur):null==disc?disc=discQueue=cur:(discQueue.next=cur,discQueue=cur),cur=cur.next;return null!=prev&&(prev.next=null),null!=discQueue&&(discQueue.next=null),passes.current=head,passes.discarded=disc,passes.lastDisc=discQueue,!0;case 2:return!1;case 3:for(head=null,prev=null,disc=passes.discarded,discQueue=passes.lastDisc,cur=passes.current;null!=cur;)1==cur.pass.isStatic?null==head?head=prev=cur:(prev.next=cur,prev=cur):null==disc?disc=discQueue=cur:(discQueue.next=cur,discQueue=cur),cur=cur.next;return null!=prev&&(prev.next=null),null!=discQueue&&(discQueue.next=null),passes.current=head,passes.discarded=disc,passes.lastDisc=discQueue,!0}else switch(this.mode._hx_index){case 0:return!1;case 1:if(null!=this.staticTexture)tmp=null==(_this=this.staticTexture).t&&null==_this.realloc;else tmp=!0;return tmp&&(this.staticTexture=this.createDefaultShadowMap()),this.syncShader(this.staticTexture),!1;case 2:return!0;case 3:var tmp,_this;if(null!=this.staticTexture)tmp=null==(_this=this.staticTexture).t&&null==_this.realloc;else tmp=!0;return tmp&&(this.staticTexture=this.createDefaultShadowMap()),!0}},__class__:h3d_pass_Shadows});var h3d_pass_DirShadowMap=function(light){this.mergePass=new h3d_pass_ScreenFx(new h3d_shader_MinMaxShader),h3d_pass_Shadows.call(this,light),this.lightCamera=new h3d_Camera,this.lightCamera.orthoBounds=new h3d_col_Bounds,this.shader=this.dshader=new h3d_shader_DirShadow,this.border=new h3d_pass_Border(this.size,this.size),this.customDepth=h3d_Engine.CURRENT.driver.hasFeature(h3d_impl_Feature.AllocDepthBuffer),this.customDepth||(this.depth=h3d_mat_DepthBuffer.getDefault())};$hxClasses["h3d.pass.DirShadowMap"]=h3d_pass_DirShadowMap,h3d_pass_DirShadowMap.__name__="h3d.pass.DirShadowMap",h3d_pass_DirShadowMap.__super__=h3d_pass_Shadows,h3d_pass_DirShadowMap.prototype=$extend(h3d_pass_Shadows.prototype,{set_mode:function(m){var _this=this.dshader;return _this.constModified=!0,_this.enable__=m!=h3d_pass_RenderMode.None,this.mode=m},set_size:function(s){return null!=this.border&&this.size!=s&&(this.border.dispose(),this.border=new h3d_pass_Border(s,s)),h3d_pass_Shadows.prototype.set_size.call(this,s)},dispose:function(){h3d_pass_Shadows.prototype.dispose.call(this),this.customDepth&&null!=this.depth&&this.depth.dispose(),this.border.dispose()},calcShadowBounds:function(camera){var bounds=camera.orthoBounds,mtmp=new h3d_Matrix;if(this.ctx.scene.iterVisibleMeshes((function(m){if(null!=m.primitive&&m.material.castShadows){var b=m.primitive.getBounds();if(!(b.xMin>b.xMax)){mtmp.multiply3x4(m.getAbsPos(),camera.mcam);var x=b.xMin,y=b.yMin;null==(z=b.zMin)&&(z=0),null==y&&(y=0),null==x&&(x=0);var p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z);x=b.xMin,y=b.yMin;null==(z=b.zMax)&&(z=0),null==y&&(y=0),null==x&&(x=0);p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z);x=b.xMin,y=b.yMax;null==(z=b.zMin)&&(z=0),null==y&&(y=0),null==x&&(x=0);p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z);x=b.xMin,y=b.yMax;null==(z=b.zMax)&&(z=0),null==y&&(y=0),null==x&&(x=0);p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z);x=b.xMax,y=b.yMin;null==(z=b.zMin)&&(z=0),null==y&&(y=0),null==x&&(x=0);p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z);x=b.xMax,y=b.yMin;null==(z=b.zMax)&&(z=0),null==y&&(y=0),null==x&&(x=0);p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z);x=b.xMax,y=b.yMax;null==(z=b.zMin)&&(z=0),null==y&&(y=0),null==x&&(x=0);p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z);var z;x=b.xMax,y=b.yMax;null==(z=b.zMax)&&(z=0),null==y&&(y=0),null==x&&(x=0);var p_x;p_y=y,p_z=z,px=(p_x=x)*mtmp._11+p_y*mtmp._21+p_z*mtmp._31+mtmp._41,py=p_x*mtmp._12+p_y*mtmp._22+p_z*mtmp._32+mtmp._42,pz=p_x*mtmp._13+p_y*mtmp._23+p_z*mtmp._33+mtmp._43;p_y=py,p_z=pz,(p_x=px)<bounds.xMin&&(bounds.xMin=p_x),p_x>bounds.xMax&&(bounds.xMax=p_x),p_y<bounds.yMin&&(bounds.yMin=p_y),p_y>bounds.yMax&&(bounds.yMax=p_y),p_z<bounds.zMin&&(bounds.zMin=p_z),p_z>bounds.zMax&&(bounds.zMax=p_z)}}})),this.mode==h3d_pass_RenderMode.Dynamic){for(var cameraBounds=new h3d_col_Bounds,_g=0,_g1=this.ctx.camera.getFrustumCorners();_g<_g1.length;){var pt=_g1[_g];++_g;var m=camera.mcam,px=pt.x*m._11+pt.y*m._21+pt.z*m._31+pt.w*m._41,py=pt.x*m._12+pt.y*m._22+pt.z*m._32+pt.w*m._42,pz=pt.x*m._13+pt.y*m._23+pt.z*m._33+pt.w*m._43,pw=pt.x*m._14+pt.y*m._24+pt.z*m._34+pt.w*m._44;pt.x=px,pt.y=py,pt.z=pz,pt.w=pw;var x=pt.x,y=pt.y,z=pt.z;x<cameraBounds.xMin&&(cameraBounds.xMin=x),x>cameraBounds.xMax&&(cameraBounds.xMax=x),y<cameraBounds.yMin&&(cameraBounds.yMin=y),y>cameraBounds.yMax&&(cameraBounds.yMax=y),z<cameraBounds.zMin&&(cameraBounds.zMin=z),z>cameraBounds.zMax&&(cameraBounds.zMax=z)}cameraBounds.zMin=bounds.zMin,bounds.intersection(bounds,cameraBounds)}bounds.scaleCenter(1.01)},setGlobals:function(){if(h3d_pass_Shadows.prototype.setGlobals.call(this),this.mode!=h3d_pass_RenderMode.Mixed||this.ctx.computingStatic){var _this=this.lightCamera.orthoBounds;_this.xMin=1e20,_this.xMax=-1e20,_this.yMin=1e20,_this.yMax=-1e20,_this.zMin=1e20,_this.zMax=-1e20,this.calcShadowBounds(this.lightCamera),this.lightCamera.update()}var v=this.getShadowProj();this.manager.globals.map.h[this.cameraViewProj_id]=v},syncShader:function(texture){(_this=this.dshader).constModified=!0,_this.shadowMap__=texture,(_this=this.dshader).constModified=!0,_this.shadowMapChannel__=this.format==h3d_mat_Texture.nativeFormat?hxsl_Channel.PackedFloat:hxsl_Channel.R,this.dshader.shadowBias__=this.bias,this.dshader.shadowPower__=this.power,this.dshader.shadowProj__=this.getShadowProj(),(_this=this.dshader).constModified=!0,_this.USE_ESM__=this.samplingKind==h3d_pass_ShadowSamplingKind.ESM,this.dshader.shadowPower__=this.power,(_this=this.dshader).constModified=!0,_this.USE_PCF__=this.samplingKind==h3d_pass_ShadowSamplingKind.PCF;var _this=this.dshader.shadowRes__,x=texture.width,y=texture.height;null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=0,_this.w=1,this.dshader.pcfScale__=this.pcfScale,(_this=this.dshader).constModified=!0,_this.pcfQuality__=this.pcfQuality},draw:function(passes,sort){var _gthis=this;if(this.enabled&&this.filterPasses(passes)){for(var f=function(col){return col.inFrustum(_gthis.lightCamera.frustum)},prevCollider=null,prevResult=!0,head=null,prev=null,disc=passes.discarded,discQueue=passes.lastDisc,cur=passes.current;null!=cur;){var tmp,col=cur.obj.cullingCollider;null==col?tmp=!0:(col!=prevCollider&&(prevCollider=col,prevResult=f(col)),tmp=prevResult),tmp?null==head?head=prev=cur:(prev.next=cur,prev=cur):null==disc?disc=discQueue=cur:(discQueue.next=cur,discQueue=cur),cur=cur.next}null!=prev&&(prev.next=null),null!=discQueue&&(discQueue.next=null),passes.current=head,passes.discarded=disc,passes.lastDisc=discQueue;var texture=this.ctx.textures.allocTarget("dirShadowMap",this.size,this.size,!1,this.format);if(this.customDepth&&(null==this.depth||this.depth.width!=this.size||this.depth.height!=this.size||this.depth.isDisposed())&&(null!=this.depth&&this.depth.dispose(),this.depth=new h3d_mat_DepthBuffer(this.size,this.size)),texture.depthBuffer=this.depth,this.mode!=h3d_pass_RenderMode.Mixed||this.ctx.computingStatic){var ct=this.ctx.camera.target,slight=null==this.light?this.ctx.lightSystem.shadowLight:this.light,ldir=null==slight?null:slight.getShadowDirection();if(null==ldir){null==(z=-1)&&(z=0),null==(y=0)&&(y=0),null==(x=0)&&(x=0),(_this=this.lightCamera.target).x=x,_this.y=y,_this.z=z,_this.w=1}else{var z,_this=this.lightCamera.target,x=ldir.x,y=ldir.y;null==(z=ldir.z)&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=1,this.lightCamera.target.normalize()}this.lightCamera.target.x+=ct.x,this.lightCamera.target.y+=ct.y,this.lightCamera.target.z+=ct.z,(_this=this.lightCamera.pos).x=ct.x,_this.y=ct.y,_this.z=ct.z,_this.w=ct.w,this.lightCamera.update()}if(this.ctx.engine.pushTarget(texture),this.ctx.engine.clear(16777215,1),h3d_pass_Shadows.prototype.draw.call(this,passes,sort),null!=this.border&&this.border.render(),this.ctx.engine.popTarget(),this.mode==h3d_pass_RenderMode.Mixed&&!this.ctx.computingStatic){var merge=this.ctx.textures.allocTarget("mergedDirShadowMap",this.size,this.size,!1,this.format);this.mergePass.shader.texA__=texture,this.mergePass.shader.texB__=this.staticTexture,this.ctx.engine.pushTarget(merge),this.mergePass.render(),this.ctx.engine.popTarget(),texture=merge}this.blur.radius>0&&(this.mode!=h3d_pass_RenderMode.Mixed||!this.ctx.computingStatic)&&this.blur.apply(this.ctx,texture),this.syncShader(texture)}},__class__:h3d_pass_DirShadowMap});var h3d_pass_DefaultShadowMap=function(size,format){null==size&&(size=1024),null!=format&&(this.format=format),h3d_pass_DirShadowMap.call(this,null),this.set_size(size),this.color=new h3d_Vector,this.set_mode(h3d_pass_RenderMode.Dynamic),this.shadowMapId=hxsl_Globals.allocID("shadow.map"),this.shadowProjId=hxsl_Globals.allocID("shadow.proj"),this.shadowColorId=hxsl_Globals.allocID("shadow.color"),this.shadowPowerId=hxsl_Globals.allocID("shadow.power"),this.shadowBiasId=hxsl_Globals.allocID("shadow.bias")};$hxClasses["h3d.pass.DefaultShadowMap"]=h3d_pass_DefaultShadowMap,h3d_pass_DefaultShadowMap.__name__="h3d.pass.DefaultShadowMap",h3d_pass_DefaultShadowMap.__super__=h3d_pass_DirShadowMap,h3d_pass_DefaultShadowMap.prototype=$extend(h3d_pass_DirShadowMap.prototype,{draw:function(passes,sort){h3d_pass_DirShadowMap.prototype.draw.call(this,passes,sort),this.ctx.setGlobalID(this.shadowMapId,{texture:this.dshader.shadowMap__,channel:this.format==h3d_mat_Texture.nativeFormat?hxsl_Channel.PackedFloat:hxsl_Channel.R}),this.ctx.setGlobalID(this.shadowProjId,this.getShadowProj()),this.ctx.setGlobalID(this.shadowColorId,this.color),this.ctx.setGlobalID(this.shadowPowerId,this.power),this.ctx.setGlobalID(this.shadowBiasId,this.bias)},__class__:h3d_pass_DefaultShadowMap});var h3d_pass__$HardwarePick_FixedColor=function(){this.viewport__=new h3d_Vector,this.colorID__=new h3d_Vector,hxsl_Shader.call(this)};$hxClasses["h3d.pass._HardwarePick.FixedColor"]=h3d_pass__$HardwarePick_FixedColor,h3d_pass__$HardwarePick_FixedColor.__name__="h3d.pass._HardwarePick.FixedColor",h3d_pass__$HardwarePick_FixedColor.__super__=hxsl_Shader,h3d_pass__$HardwarePick_FixedColor.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.colorID__;case 1:return this.viewport__}return null},getParamFloatValue:function(index){return 0},__class__:h3d_pass__$HardwarePick_FixedColor});var h3d_pass_HardwarePick=function(){this.pickedIndex=-1,this.fixedColor=new h3d_pass__$HardwarePick_FixedColor,h3d_pass_Default.call(this,"hwpick"),this.material=new h3d_mat_Pass("");var _this=this.material,src=h3d_mat_Blend.One,dst=h3d_mat_Blend.Zero;_this.set_blendSrc(src),_this.set_blendAlphaSrc(src),_this.set_blendDst(dst),_this.set_blendAlphaDst(dst),this.texOut=new h3d_mat_Texture(3,3,[h3d_mat_TextureFlags.Target]),this.texOut.depthBuffer=new h3d_mat_DepthBuffer(3,3)};$hxClasses["h3d.pass.HardwarePick"]=h3d_pass_HardwarePick,h3d_pass_HardwarePick.__name__="h3d.pass.HardwarePick",h3d_pass_HardwarePick.__super__=h3d_pass_Default,h3d_pass_HardwarePick.prototype=$extend(h3d_pass_Default.prototype,{dispose:function(){h3d_pass_Default.prototype.dispose.call(this),this.texOut.dispose(),this.texOut.depthBuffer.dispose()},getOutputs:function(){return[hxsl_Output.Value("output.colorID")]},drawObject:function(p){h3d_pass_Default.prototype.drawObject.call(this,p);var _this=this.fixedColor.colorID__,c=-16777216|++this.colorID;_this.x=(c>>16&255)/255,_this.y=(c>>8&255)/255,_this.z=(255&c)/255,_this.w=(c>>>24)/255},draw:function(passes,sort){for(var _g_o=passes.current;null!=_g_o;){var tmp=_g_o;_g_o=_g_o.next;(cur=tmp).pass.bits&=-268435393,cur.pass.bits|=268435392&this.material.bits}this.colorID=0;var _this=this.fixedColor.colorID__,c=-16777216|++this.colorID;_this.x=(c>>16&255)/255,_this.y=(c>>8&255)/255,_this.z=(255&c)/255,_this.w=(c>>>24)/255;_this=this.fixedColor.viewport__;var x=-(2*this.pickX/this.ctx.engine.width-1),y=2*this.pickY/this.ctx.engine.height-1,z=this.ctx.engine.width/this.texOut.width,w=this.ctx.engine.height/this.texOut.height;null==w&&(w=1),null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=w,this.ctx.engine.pushTarget(this.texOut),this.ctx.engine.clear(-16777216,1),this.ctx.extraShaders=this.ctx.allocShaderList(this.fixedColor),h3d_pass_Default.prototype.draw.call(this,passes,sort),this.ctx.extraShaders=null,this.ctx.engine.popTarget();for(var _g1_o=passes.current;null!=_g1_o;){var cur;tmp=_g1_o;_g1_o=_g1_o.next,(cur=tmp).pass.set_blendSrc(cur.pass.blendSrc),cur.pass.set_blendDst(cur.pass.blendDst),cur.pass.set_blendOp(cur.pass.blendOp),cur.pass.set_blendAlphaSrc(cur.pass.blendAlphaSrc),cur.pass.set_blendAlphaDst(cur.pass.blendAlphaDst),cur.pass.set_blendAlphaOp(cur.pass.blendAlphaOp),cur.pass.colorMask=cur.pass.colorMask}this.ctx.engine.clear(null,null,0);var pix=this.texOut.capturePixels();this.pickedIndex=(16777215&pix.getPixel(pix.width>>1,pix.height>>1))-1},__class__:h3d_pass_HardwarePick});var h3d_pass_PassList=function(current){this.current=current,this.discarded=this.lastDisc=null};$hxClasses["h3d.pass.PassList"]=h3d_pass_PassList,h3d_pass_PassList.__name__="h3d.pass.PassList",h3d_pass_PassList.prototype={__class__:h3d_pass_PassList};var h3d_pass_PassObject=function(){this.texture=0};$hxClasses["h3d.pass.PassObject"]=h3d_pass_PassObject,h3d_pass_PassObject.__name__="h3d.pass.PassObject",h3d_pass_PassObject.prototype={__class__:h3d_pass_PassObject};var h3d_pass_ShaderManager=function(output){this.shaderCache=hxsl_Cache.get(),this.globals=new hxsl_Globals,this.currentOutput=new hxsl_ShaderList(null),this.setOutput(output)};$hxClasses["h3d.pass.ShaderManager"]=h3d_pass_ShaderManager,h3d_pass_ShaderManager.__name__="h3d.pass.ShaderManager",h3d_pass_ShaderManager.prototype={setOutput:function(output){null==output&&(output=[hxsl_Output.Value("output.color")]),this.currentOutput.s=this.shaderCache.getLinkShader(output)},fillRec:function(v,type,out,pos){switch(type._hx_index){case 1:case 3:return out[pos]=v,1;case 5:var _g=type.t,n=type.size,v1=v;switch(out[pos++]=v1.x,out[pos++]=v1.y,n){case 3:out[pos++]=v1.z;break;case 4:out[pos++]=v1.z,out[pos++]=v1.w}return n;case 6:var m=v;return out[pos++]=m._11,out[pos++]=m._21,out[pos++]=m._31,out[pos++]=0,out[pos++]=m._12,out[pos++]=m._22,out[pos++]=m._32,out[pos++]=0,out[pos++]=m._13,out[pos++]=m._23,out[pos++]=m._33,out[pos++]=0,12;case 7:m=v;return out[pos++]=m._11,out[pos++]=m._21,out[pos++]=m._31,out[pos++]=m._41,out[pos++]=m._12,out[pos++]=m._22,out[pos++]=m._32,out[pos++]=m._42,out[pos++]=m._13,out[pos++]=m._23,out[pos++]=m._33,out[pos++]=m._43,out[pos++]=m._14,out[pos++]=m._24,out[pos++]=m._34,out[pos++]=m._44,16;case 8:m=v;return out[pos++]=m._11,out[pos++]=m._21,out[pos++]=m._31,out[pos++]=m._41,out[pos++]=m._12,out[pos++]=m._22,out[pos++]=m._32,out[pos++]=m._42,out[pos++]=m._13,out[pos++]=m._23,out[pos++]=m._33,out[pos++]=m._43,12;case 13:var vl=type.vl,tot=0;for(_g=0;_g<vl.length;){var vv=vl[_g];++_g,tot+=this.fillRec(Reflect.field(v,vv.name),vv.type,out,pos+tot)}return tot;case 15:_g=type.size;switch((_g1=type.t)._hx_index){case 3:if(0==_g._hx_index){for(var len=_g.v,size=0,_g2=0,_g3=(v1=v).length<len?v1.length:len;_g2<_g3;){var i=_g2++;out[pos++]=v1[i]}return len}throw haxe_Exception.thrown("assert "+Std.string(type));case 5:if(4==_g1.size){if(1==_g1.t._hx_index){if(0==_g._hx_index){for(v1=v,_g2=0,_g3=len=_g.v;_g2<_g3;){if(null==(n=v1[i=_g2++]))break;out[pos++]=n.x,out[pos++]=n.y,out[pos++]=n.z,out[pos++]=n.w}return 4*len}throw haxe_Exception.thrown("assert "+Std.string(type))}if(0==_g._hx_index){var t=_g1;for(v1=v,size=0,_g2=0,_g3=len=_g.v;_g2<_g3;){if(null==(n=v1[i=_g2++]))break;pos+=size=this.fillRec(n,t,out,pos)}return len*size}throw haxe_Exception.thrown("assert "+Std.string(type))}if(0==_g._hx_index){for(t=_g1,v1=v,size=0,_g2=0,_g3=len=_g.v;_g2<_g3;){if(null==(n=v1[i=_g2++]))break;pos+=size=this.fillRec(n,t,out,pos)}return len*size}throw haxe_Exception.thrown("assert "+Std.string(type));case 8:if(0==_g._hx_index){for(v1=v,_g2=0,_g3=len=_g.v;_g2<_g3;){if(null==(m=v1[i=_g2++]))break;out[pos++]=m._11,out[pos++]=m._21,out[pos++]=m._31,out[pos++]=m._41,out[pos++]=m._12,out[pos++]=m._22,out[pos++]=m._32,out[pos++]=m._42,out[pos++]=m._13,out[pos++]=m._23,out[pos++]=m._33,out[pos++]=m._43}return 12*len}throw haxe_Exception.thrown("assert "+Std.string(type));default:if(0==_g._hx_index){len=_g.v,t=_g1,v1=v,size=0,_g=0;for(var _g1=len;_g<_g1;){if(null==(n=v1[i=_g++]))break;pos+=size=this.fillRec(n,t,out,pos)}return len*size}throw haxe_Exception.thrown("assert "+Std.string(type))}break;default:throw haxe_Exception.thrown("assert "+Std.string(type))}},shaderInfo:function(shaders,path){for(var name=path.split(".").pop();null!=shaders;){for(var _g=0,_g1=shaders.s.instance.shader.vars;_g<_g1.length;){var v=_g1[_g];if(++_g,v.name==name)return shaders.s.toString()}shaders=shaders.next}return"(not found)"},fillGlobals:function(buf,s){for(var g=(s1=s.vertex).globals,ptr=buf.vertex.globals;null!=g;){if(null==(v=this.globals.map.h[g.gid])){if("__consts__"==g.path){this.fillRec(s1.consts,g.type,ptr,g.pos),g=g.next;continue}throw haxe_Exception.thrown("Missing global value "+g.path)}this.fillRec(v,g.type,ptr,g.pos),g=g.next}var s1;for(g=(s1=s.fragment).globals,ptr=buf.fragment.globals;null!=g;){var v;if(null==(v=this.globals.map.h[g.gid])){if("__consts__"==g.path){this.fillRec(s1.consts,g.type,ptr,g.pos),g=g.next;continue}throw haxe_Exception.thrown("Missing global value "+g.path)}this.fillRec(v,g.type,ptr,g.pos),g=g.next}},fillParams:function(buf,s,shaders){for(var curInstance=-1,curInstanceValue=null,buf1=buf.vertex,p=(s1=s.vertex).params,ptr=buf1.params;null!=p;){if(null==p.perObjectGlobal){if(p.type==hxsl_Type.TFloat){if(curInstance==(index=p.instance))i=curInstanceValue;else{var si=shaders;for(curInstance=index;--index>0;)si=si.next;i=curInstanceValue=si.s}ptr[p.pos]=i.getParamFloatValue(p.index),p=p.next;continue}if(curInstance==(index1=p.instance))v1=curInstanceValue;else{var si1=shaders;for(curInstance=index1;--index1>0;)si1=si1.next;v1=curInstanceValue=si1.s}if(null==(v=v1.getParamValue(p.index)))throw haxe_Exception.thrown("Missing param value "+Std.string(curInstanceValue)+"."+p.name)}else if(null!=p.perObjectGlobal){if(null==(v2=this.globals.map.h[p.perObjectGlobal.gid]))throw haxe_Exception.thrown("Missing global value "+p.perObjectGlobal.path+" for shader "+this.shaderInfo(shaders,p.perObjectGlobal.path));if(17==(_g=p.type)._hx_index){_g.size;v3=!0}else v3=!1;v=v3?v2.texture:v2}else{for(var si2=shaders,n=p.instance;--n>0;)si2=si2.next;if(null==(v4=si2.s.getParamValue(p.index)))throw haxe_Exception.thrown("Missing param value "+Std.string(si2.s)+"."+p.name);v=v4}this.fillRec(v,p.type,ptr,p.pos),p=p.next}var tid=0;for(p=s1.textures;null!=p;){var this1=buf1.tex,index=tid++;if(null==(opt=!h3d_pass_ShaderManager.STRICT)&&(opt=!1),null!=p.perObjectGlobal){if(null==(v=this.globals.map.h[p.perObjectGlobal.gid]))throw haxe_Exception.thrown("Missing global value "+p.perObjectGlobal.path+" for shader "+this.shaderInfo(shaders,p.perObjectGlobal.path));if(17==(_g=p.type)._hx_index){_g.size;val1=!0}else val1=!1;val=val1?v.texture:v}else{for(si=shaders,n=p.instance;--n>0;)si=si.next;if(null==(v1=si.s.getParamValue(p.index))&&!opt)throw haxe_Exception.thrown("Missing param value "+Std.string(si.s)+"."+p.name);val=v1}this1[index]=val,p=p.next}p=s1.buffers;for(var bid=0;null!=p;){if(null==(opt=!h3d_pass_ShaderManager.STRICT)&&(opt=!1),null!=p.perObjectGlobal){if(null==(v=this.globals.map.h[p.perObjectGlobal.gid]))throw haxe_Exception.thrown("Missing global value "+p.perObjectGlobal.path+" for shader "+this.shaderInfo(shaders,p.perObjectGlobal.path));if(17==(_g=p.type)._hx_index){_g.size;b1=!0}else b1=!1;b=b1?v.texture:v}else{for(si=shaders,n=p.instance;--n>0;)si=si.next;if(null==(v1=si.s.getParamValue(p.index))&&!opt)throw haxe_Exception.thrown("Missing param value "+Std.string(si.s)+"."+p.name);b=v1}buf1.buffers[bid++]=b,p=p.next}var s1;for(buf1=buf.fragment,p=(s1=s.fragment).params,ptr=buf1.params;null!=p;){if(null==p.perObjectGlobal){if(p.type==hxsl_Type.TFloat){var i;if(curInstance==(index=p.instance))i=curInstanceValue;else{si=shaders;for(curInstance=index;--index>0;)si=si.next;i=curInstanceValue=si.s}ptr[p.pos]=i.getParamFloatValue(p.index),p=p.next;continue}var index1;if(curInstance==(index1=p.instance))v1=curInstanceValue;else{si1=shaders;for(curInstance=index1;--index1>0;)si1=si1.next;v1=curInstanceValue=si1.s}if(null==(v=v1.getParamValue(p.index)))throw haxe_Exception.thrown("Missing param value "+Std.string(curInstanceValue)+"."+p.name)}else if(null!=p.perObjectGlobal){var v2,v3;if(null==(v2=this.globals.map.h[p.perObjectGlobal.gid]))throw haxe_Exception.thrown("Missing global value "+p.perObjectGlobal.path+" for shader "+this.shaderInfo(shaders,p.perObjectGlobal.path));if(17==(_g=p.type)._hx_index){_g.size;v3=!0}else v3=!1;v=v3?v2.texture:v2}else{for(si2=shaders,n=p.instance;--n>0;)si2=si2.next;var v4;if(null==(v4=si2.s.getParamValue(p.index)))throw haxe_Exception.thrown("Missing param value "+Std.string(si2.s)+"."+p.name);v=v4}this.fillRec(v,p.type,ptr,p.pos),p=p.next}for(tid=0,p=s1.textures;null!=p;){var val;this1=buf1.tex,index=tid++;if(null==(opt=!h3d_pass_ShaderManager.STRICT)&&(opt=!1),null!=p.perObjectGlobal){var val1;if(null==(v=this.globals.map.h[p.perObjectGlobal.gid]))throw haxe_Exception.thrown("Missing global value "+p.perObjectGlobal.path+" for shader "+this.shaderInfo(shaders,p.perObjectGlobal.path));if(17==(_g=p.type)._hx_index){_g.size;val1=!0}else val1=!1;val=val1?v.texture:v}else{for(si=shaders,n=p.instance;--n>0;)si=si.next;if(null==(v1=si.s.getParamValue(p.index))&&!opt)throw haxe_Exception.thrown("Missing param value "+Std.string(si.s)+"."+p.name);val=v1}this1[index]=val,p=p.next}for(p=s1.buffers,bid=0;null!=p;){var opt,b;if(null==(opt=!h3d_pass_ShaderManager.STRICT)&&(opt=!1),null!=p.perObjectGlobal){var v,_g,b1;if(null==(v=this.globals.map.h[p.perObjectGlobal.gid]))throw haxe_Exception.thrown("Missing global value "+p.perObjectGlobal.path+" for shader "+this.shaderInfo(shaders,p.perObjectGlobal.path));if(17==(_g=p.type)._hx_index){_g.size;b1=!0}else b1=!1;b=b1?v.texture:v}else{for(si=shaders,n=p.instance;--n>0;)si=si.next;var v1;if(null==(v1=si.s.getParamValue(p.index))&&!opt)throw haxe_Exception.thrown("Missing param value "+Std.string(si.s)+"."+p.name);b=v1}buf1.buffers[bid++]=b,p=p.next}},compileShaders:function(shaders,batchMode){null==batchMode&&(batchMode=!1),this.globals.maxChannels=0;for(var _g_l=shaders;null!=_g_l;){var s=_g_l.s;_g_l=_g_l.next,s.updateConstants(this.globals)}this.currentOutput.next=shaders;s=this.shaderCache.link(this.currentOutput,batchMode);return this.currentOutput.next=null,s},__class__:h3d_pass_ShaderManager};var h3d_pass_RenderMode=$hxEnums["h3d.pass.RenderMode"]={__ename__:"h3d.pass.RenderMode",__constructs__:["None","Static","Dynamic","Mixed"],None:{_hx_index:0,__enum__:"h3d.pass.RenderMode",toString:$estr},Static:{_hx_index:1,__enum__:"h3d.pass.RenderMode",toString:$estr},Dynamic:{_hx_index:2,__enum__:"h3d.pass.RenderMode",toString:$estr},Mixed:{_hx_index:3,__enum__:"h3d.pass.RenderMode",toString:$estr}};h3d_pass_RenderMode.__empty_constructs__=[h3d_pass_RenderMode.None,h3d_pass_RenderMode.Static,h3d_pass_RenderMode.Dynamic,h3d_pass_RenderMode.Mixed];var h3d_pass_ShadowSamplingKind=$hxEnums["h3d.pass.ShadowSamplingKind"]={__ename__:"h3d.pass.ShadowSamplingKind",__constructs__:["None","PCF","ESM"],None:{_hx_index:0,__enum__:"h3d.pass.ShadowSamplingKind",toString:$estr},PCF:{_hx_index:1,__enum__:"h3d.pass.ShadowSamplingKind",toString:$estr},ESM:{_hx_index:2,__enum__:"h3d.pass.ShadowSamplingKind",toString:$estr}};h3d_pass_ShadowSamplingKind.__empty_constructs__=[h3d_pass_ShadowSamplingKind.None,h3d_pass_ShadowSamplingKind.PCF,h3d_pass_ShadowSamplingKind.ESM];var h3d_pass_SortByMaterial=function(){this.textureCount=1,this.shaderCount=1,this.shaderIdMap=[],this.textureIdMap=[]};$hxClasses["h3d.pass.SortByMaterial"]=h3d_pass_SortByMaterial,h3d_pass_SortByMaterial.__name__="h3d.pass.SortByMaterial",h3d_pass_SortByMaterial.prototype={sort:function(passes){for(var shaderStart=this.shaderCount,textureStart=this.textureCount,_g_o=passes.current;null!=_g_o;){var tmp=_g_o;_g_o=_g_o.next;var p=tmp;(this.shaderIdMap[p.shader.id]<shaderStart||null==this.shaderIdMap[p.shader.id])&&(this.shaderIdMap[p.shader.id]=this.shaderCount++),(this.textureIdMap[p.texture]<textureStart||null==this.textureIdMap[p.shader.id])&&(this.textureIdMap[p.texture]=this.textureCount++)}var list=passes.current;if(null==list)tmp=null;else{for(var nmerges,q,e,tail,insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(var _g=0,_g1=insize;_g<_g1;){_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;){if(0==psize)e=q,q=q.next,--qsize;else{var tmp1;if(0!=qsize&&null!=q){var d=this.shaderIdMap[p.shader.id]-this.shaderIdMap[q.shader.id];tmp1=(0!=d?d:this.textureIdMap[p.texture]-this.textureIdMap[q.texture])<=0}else tmp1=!0;tmp1?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize)}null!=tail?tail.next=e:list=e,tail=e}p=q}if(tail.next=null,nmerges<=1)break;insize*=2}tmp=list}passes.current=tmp},__class__:h3d_pass_SortByMaterial};var h3d_prim_Primitive=function(){this.refCount=0};$hxClasses["h3d.prim.Primitive"]=h3d_prim_Primitive,h3d_prim_Primitive.__name__="h3d.prim.Primitive",h3d_prim_Primitive.__interfaces__=[hxd_impl__$Serializable_NoSerializeSupport],h3d_prim_Primitive.prototype={getBounds:function(){throw haxe_Exception.thrown("not implemented for "+Std.string(this))},incref:function(){this.refCount++},decref:function(){this.refCount--,this.refCount<=0&&(this.refCount=0,this.dispose())},alloc:function(engine){throw haxe_Exception.thrown("not implemented")},render:function(engine){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(engine),null==this.indexes?0!=(this.buffer.flags&1<<h3d_BufferFlag.Quads._hx_index)?engine.renderBuffer(this.buffer,engine.mem.quadIndexes,2,0,-1):engine.renderBuffer(this.buffer,engine.mem.triIndexes,3,0,-1):engine.renderIndexed(this.buffer,this.indexes)},dispose:function(){null!=this.buffer&&(this.buffer.dispose(),this.buffer=null),null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},toString:function(){return js_Boot.getClass(this).__name__.split(".").pop()},__class__:h3d_prim_Primitive};var h3d_prim_Plane2D=function(){h3d_prim_Primitive.call(this)};$hxClasses["h3d.prim.Plane2D"]=h3d_prim_Plane2D,h3d_prim_Plane2D.__name__="h3d.prim.Plane2D",h3d_prim_Plane2D.get=function(){var engine=h3d_Engine.CURRENT,inst=engine.resCache.h[h3d_prim_Plane2D.__id__];return null==inst&&(inst=new h3d_prim_Plane2D,engine.resCache.set(h3d_prim_Plane2D,inst)),inst},h3d_prim_Plane2D.__super__=h3d_prim_Primitive,h3d_prim_Plane2D.prototype=$extend(h3d_prim_Primitive.prototype,{alloc:function(engine){var newSize,newArray,v=hxd__$FloatBuffer_Float32Expand._new(0);v.pos==v.array.length&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=-1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=-1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=0,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=-1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=0,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=0,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=-1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);(v.array[v.pos++]=1,v.pos==v.array.length)&&((newSize=v.array.length<<1)<128&&(newSize=128),(newArray=new Float32Array(newSize)).set(v.array),v.array=newArray);v.array[v.pos++]=0,this.buffer=h3d_Buffer.ofFloats(v,4,[h3d_BufferFlag.Quads,h3d_BufferFlag.RawFormat])},render:function(engine){(null==this.buffer||this.buffer.isDisposed())&&this.alloc(engine),engine.renderBuffer(this.buffer,engine.mem.quadIndexes,2,0,-1)},__class__:h3d_prim_Plane2D});var h3d_prim_RawPrimitive=function(inf,persist){null==persist&&(persist=!1),h3d_prim_Primitive.call(this),this.onContextLost=function(){return inf},this.bounds=inf.bounds,this.alloc(null),persist||(this.onContextLost=null)};$hxClasses["h3d.prim.RawPrimitive"]=h3d_prim_RawPrimitive,h3d_prim_RawPrimitive.__name__="h3d.prim.RawPrimitive",h3d_prim_RawPrimitive.__super__=h3d_prim_Primitive,h3d_prim_RawPrimitive.prototype=$extend(h3d_prim_Primitive.prototype,{alloc:function(engine){if(null==this.onContextLost)throw haxe_Exception.thrown("Cannot realloc "+Std.string(this));var inf=this.onContextLost(),flags=[];null==inf.ibuf&&flags.push(inf.quads?h3d_BufferFlag.Quads:h3d_BufferFlag.Triangles),inf.stride<8&&flags.push(h3d_BufferFlag.RawFormat),this.buffer=h3d_Buffer.ofFloats(inf.vbuf,inf.stride,flags),this.vcount=this.buffer.vertices,this.tcount=null!=inf.ibuf?inf.ibuf.length/3|0:inf.quads?this.vcount>>1:this.vcount/3|0,null!=inf.ibuf?this.indexes=h3d_Indexes.alloc(inf.ibuf):null!=this.indexes&&(this.indexes.dispose(),this.indexes=null)},getBounds:function(){if(null==this.bounds)throw haxe_Exception.thrown("Bounds not defined for "+Std.string(this));return this.bounds},__class__:h3d_prim_RawPrimitive});var h3d_scene_Object=function(parent){this.flags=0,this.absPos=new h3d_Matrix,this.absPos.identity(),this.x=0;var f=1;!0?this.flags|=f:this.flags&=~f,this.y=0;f=1;!0?this.flags|=f:this.flags&=~f,this.z=0;f=1;!0?this.flags|=f:this.flags&=~f,this.scaleX=1;f=1;!0?this.flags|=f:this.flags&=~f,this.scaleY=1;f=1;!0?this.flags|=f:this.flags&=~f,this.scaleZ=1;f=1;!0?this.flags|=f:this.flags&=~f,this.qRot=new h3d_Quat;f=1;null!=this.follow?this.flags|=f:this.flags&=~f;f=2;this.flags|=f,this.children=[],null!=parent&&parent.addChild(this)};$hxClasses["h3d.scene.Object"]=h3d_scene_Object,h3d_scene_Object.__name__="h3d.scene.Object",h3d_scene_Object.__interfaces__=[hxd_impl__$Serializable_NoSerializeSupport],h3d_scene_Object.prototype={set_cullingCollider:function(c){this.cullingCollider=c;return this.flags&=-4097,c},localToGlobal:function(pt){this.syncPos(),null==pt&&(pt=new h3d_Vector);var m=this.absPos,px=pt.x*m._11+pt.y*m._21+pt.z*m._31+pt.w*m._41,py=pt.x*m._12+pt.y*m._22+pt.z*m._32+pt.w*m._42,pz=pt.x*m._13+pt.y*m._23+pt.z*m._33+pt.w*m._43;return pt.x=px,pt.y=py,pt.z=pz,pt},getInvPos:function(){return this.syncPos(),null==this.invPos&&(this.invPos=new h3d_Matrix,this.invPos._44=0),0==this.invPos._44&&this.invPos.inverse3x4(this.absPos),this.invPos},addChild:function(o){this.addChildAt(o,this.children.length)},addChildAt:function(o,pos){pos<0&&(pos=0),pos>this.children.length&&(pos=this.children.length);for(var p=this;null!=p;){if(p==o)throw haxe_Exception.thrown("Recursive addChild");p=p.parent}if(null!=o.parent){var old=0!=(32&o.flags),f=32;o.flags&=~f,o.parent.removeChild(o);f=32;old?o.flags|=f:o.flags&=~f}this.children.splice(pos,0,o),0==(32&this.flags)&&0!=(32&o.flags)&&o.onRemove(),o.parent=this;f=1;o.flags|=f,0!=(32&this.flags)&&(0==(32&o.flags)?o.onAdd():o.onParentChanged())},iterVisibleMeshes:function(callb){if(0!=(2&this.flags)&&(0==(4&this.flags)||0==(128&this.flags))){if(0==(4&this.flags)){var m=this instanceof h3d_scene_Mesh?this:null;null!=m&&callb(m)}for(var _g=0,_g1=this.children;_g<_g1.length;){var o=_g1[_g];++_g,o.iterVisibleMeshes(callb)}}},onParentChanged:function(){for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.onParentChanged()}},onAdd:function(){this.flags|=32;for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.onAdd()}},onRemove:function(){this.flags&=-33;for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g,c.onRemove()}},removeChild:function(o){if(HxOverrides.remove(this.children,o)){0!=(32&o.flags)&&o.onRemove(),o.parent=null;o.flags|=1}},getScene:function(){for(var p=this;null!=p.parent;)p=p.parent;return p instanceof h3d_scene_Scene?p:null},getAbsPos:function(){return this.syncPos(),this.absPos},draw:function(ctx){},calcAbsPos:function(){if(this.qRot.toMatrix(this.absPos),this.absPos._11*=this.scaleX,this.absPos._12*=this.scaleX,this.absPos._13*=this.scaleX,this.absPos._21*=this.scaleY,this.absPos._22*=this.scaleY,this.absPos._23*=this.scaleY,this.absPos._31*=this.scaleZ,this.absPos._32*=this.scaleZ,this.absPos._33*=this.scaleZ,this.absPos._41=this.x,this.absPos._42=this.y,this.absPos._43=this.z,null!=this.follow)if(this.follow.syncPos(),0!=(8&this.flags)){var _this=this.absPos,a=this.absPos,b=this.parent.absPos,m11=a._11,m12=a._12,m13=a._13,m21=a._21,m22=a._22,m23=a._23,a31=a._31,a32=a._32,a33=a._33,a41=a._41,a42=a._42,a43=a._43,b11=b._11,b12=b._12,b13=b._13,b21=b._21,b22=b._22,b23=b._23,b31=b._31,b32=b._32,b33=b._33,b41=b._41,b42=b._42,b43=b._43;_this._11=m11*b11+m12*b21+m13*b31,_this._12=m11*b12+m12*b22+m13*b32,_this._13=m11*b13+m12*b23+m13*b33,_this._14=0,_this._21=m21*b11+m22*b21+m23*b31,_this._22=m21*b12+m22*b22+m23*b32,_this._23=m21*b13+m22*b23+m23*b33,_this._24=0,_this._31=a31*b11+a32*b21+a33*b31,_this._32=a31*b12+a32*b22+a33*b32,_this._33=a31*b13+a32*b23+a33*b33,_this._34=0,_this._41=a41*b11+a42*b21+a43*b31+b41,_this._42=a41*b12+a42*b22+a43*b32+b42,_this._43=a41*b13+a42*b23+a43*b33+b43,_this._44=1,this.absPos._41=this.x+this.follow.absPos._41,this.absPos._42=this.y+this.follow.absPos._42,this.absPos._43=this.z+this.follow.absPos._43}else this.absPos.multiply3x4(this.absPos,this.follow.absPos);else if(null!=this.parent&&0==(2048&this.flags)){_this=this.absPos,a=this.absPos,b=this.parent.absPos,m11=a._11,m12=a._12,m13=a._13,m21=a._21,m22=a._22,m23=a._23,a31=a._31,a32=a._32,a33=a._33,a41=a._41,a42=a._42,a43=a._43,b11=b._11,b12=b._12,b13=b._13,b21=b._21,b22=b._22,b23=b._23,b31=b._31,b32=b._32,b33=b._33,b41=b._41,b42=b._42,b43=b._43;_this._11=m11*b11+m12*b21+m13*b31,_this._12=m11*b12+m12*b22+m13*b32,_this._13=m11*b13+m12*b23+m13*b33,_this._14=0,_this._21=m21*b11+m22*b21+m23*b31,_this._22=m21*b12+m22*b22+m23*b32,_this._23=m21*b13+m22*b23+m23*b33,_this._24=0,_this._31=a31*b11+a32*b21+a33*b31,_this._32=a31*b12+a32*b22+a33*b32,_this._33=a31*b13+a32*b23+a33*b33,_this._34=0,_this._41=a41*b11+a42*b21+a43*b31+b41,_this._42=a41*b12+a42*b22+a43*b32+b42,_this._43=a41*b13+a42*b23+a43*b33+b43,_this._44=1}if(null!=this.defaultTransform){_this=this.absPos,a=this.defaultTransform,b=this.absPos,m11=a._11,m12=a._12,m13=a._13,m21=a._21,m22=a._22,m23=a._23,a31=a._31,a32=a._32,a33=a._33,a41=a._41,a42=a._42,a43=a._43,b11=b._11,b12=b._12,b13=b._13,b21=b._21,b22=b._22,b23=b._23,b31=b._31,b32=b._32,b33=b._33,b41=b._41,b42=b._42,b43=b._43;_this._11=m11*b11+m12*b21+m13*b31,_this._12=m11*b12+m12*b22+m13*b32,_this._13=m11*b13+m12*b23+m13*b33,_this._14=0,_this._21=m21*b11+m22*b21+m23*b31,_this._22=m21*b12+m22*b22+m23*b32,_this._23=m21*b13+m22*b23+m23*b33,_this._24=0,_this._31=a31*b11+a32*b21+a33*b31,_this._32=a31*b12+a32*b22+a33*b32,_this._33=a31*b13+a32*b23+a33*b33,_this._34=0,_this._41=a41*b11+a42*b21+a43*b31+b41,_this._42=a41*b12+a42*b22+a43*b32+b42,_this._43=a41*b13+a42*b23+a43*b33+b43,_this._44=1}null!=this.invPos&&(this.invPos._44=0)},sync:function(ctx){},syncRec:function(ctx){if(null!=this.currentAnimation){for(var old=this.parent,dt=ctx.elapsedTime;dt>0&&null!=this.currentAnimation;)dt=this.currentAnimation.update(dt);if(null!=this.currentAnimation&&(ctx.visibleFlag&&0!=(2&this.flags)&&0==(4&this.flags)||0!=(64&this.flags))&&this.currentAnimation.sync(),null==this.parent&&null!=old)return}old=ctx.visibleFlag;if((0==(2&this.flags)||0!=(4&this.flags)&&0!=(128&this.flags))&&(ctx.visibleFlag=!1),null==ctx.cullingCollider||null!=this.cullingCollider&&0==(4096&this.flags))0!=(4096&this.flags)&&this.set_cullingCollider(null);else{this.set_cullingCollider(ctx.cullingCollider);var f=4096;this.flags|=f}var prevCollider=ctx.cullingCollider;0!=(128&this.flags)&&(ctx.cullingCollider=this.cullingCollider);var changed=0!=(1&this.flags);changed&&this.calcAbsPos(),this.sync(ctx);f=1;null!=this.follow?this.flags|=f:this.flags&=~f,this.lastFrame=ctx.frame;for(var p=0,len=this.children.length;p<len;){var c=this.children[p];if(null==c)break;if(c.lastFrame!=ctx.frame){if(changed){f=1;!0?c.flags|=f:c.flags&=~f}c.syncRec(ctx)}this.children[p]!=c?(p=0,len=this.children.length):++p}ctx.visibleFlag=old,ctx.cullingCollider=prevCollider},syncPos:function(){if(null!=this.parent&&this.parent.syncPos(),0!=(1&this.flags)){var f=1;null!=this.follow?this.flags|=f:this.flags&=~f,this.calcAbsPos();for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g;f=1;!0?c.flags|=f:c.flags&=~f}}},emit:function(ctx){},emitRec:function(ctx){if(0!=(2&this.flags)&&(0==(4&this.flags)||0==(128&this.flags)||ctx.computingStatic)){if(0!=(1&this.flags)){null!=this.currentAnimation&&this.currentAnimation.sync();var f=1;null!=this.follow?this.flags|=f:this.flags&=~f,this.calcAbsPos();for(var _g=0,_g1=this.children;_g<_g1.length;){var c=_g1[_g];++_g;f=1;!0?c.flags|=f:c.flags&=~f}}(0==(4&this.flags)||ctx.computingStatic)&&this.emit(ctx);for(_g=0,_g1=this.children;_g<_g1.length;){c=_g1[_g];++_g,c.emitRec(ctx)}}},__class__:h3d_scene_Object};var h3d_scene_Mesh=function(primitive,material,parent){h3d_scene_Object.call(this,parent),this.set_primitive(primitive),null==material&&(material=h3d_mat_MaterialSetup.current.createMaterial()).set_props(material.getDefaultProps()),this.material=material};$hxClasses["h3d.scene.Mesh"]=h3d_scene_Mesh,h3d_scene_Mesh.__name__="h3d.scene.Mesh",h3d_scene_Mesh.__super__=h3d_scene_Object,h3d_scene_Mesh.prototype=$extend(h3d_scene_Object.prototype,{draw:function(ctx){this.primitive.render(ctx.engine)},emit:function(ctx){for(var p=this.material.passes;null!=p;)ctx.emitPass(p,this).index=0,p=p.nextPass},onAdd:function(){h3d_scene_Object.prototype.onAdd.call(this),null!=this.primitive&&this.primitive.incref()},onRemove:function(){null!=this.primitive&&this.primitive.decref(),h3d_scene_Object.prototype.onRemove.call(this)},set_primitive:function(prim){return prim!=this.primitive&&0!=(32&this.flags)&&(null!=this.primitive&&this.primitive.decref(),null!=prim&&prim.incref()),this.primitive=prim},__class__:h3d_scene_Mesh});var h3d_scene_Interactive=function(shape,parent){this.hitPoint=new h3d_Vector,this.mouseDownButton=-1,this.propagateEvents=!1,this.cancelEvents=!1,h3d_scene_Object.call(this,parent),this.shape=shape,this.set_cursor(hxd_Cursor.Button)};$hxClasses["h3d.scene.Interactive"]=h3d_scene_Interactive,h3d_scene_Interactive.__name__="h3d.scene.Interactive",h3d_scene_Interactive.__interfaces__=[hxd_Interactive],h3d_scene_Interactive.__super__=h3d_scene_Object,h3d_scene_Interactive.prototype=$extend(h3d_scene_Object.prototype,{onAdd:function(){this.scene=this.getScene(),null!=this.scene&&this.scene.addEventTarget(this),h3d_scene_Object.prototype.onAdd.call(this)},onRemove:function(){null!=this.scene&&(this.scene.removeEventTarget(this),this.scene=null),h3d_scene_Object.prototype.onRemove.call(this)},getInteractiveScene:function(){return this.scene},handleEvent:function(e){switch(this.propagateEvents&&(e.propagate=!0),this.cancelEvents&&(e.cancel=!0),e.kind._hx_index){case 0:(this.enableRightButton||0==e.button)&&(this.mouseDownButton=e.button,this.onPush(e));break;case 1:(this.enableRightButton||0==e.button)&&(this.onRelease(e),this.mouseDownButton==e.button&&this.onClick(e)),this.mouseDownButton=-1;break;case 2:this.onMove(e);break;case 3:this.onOver(e);break;case 4:this.onOut(e);break;case 5:this.onWheel(e);break;case 6:this.onFocus(e);break;case 7:this.onFocusLost(e);break;case 8:this.onKeyDown(e);break;case 9:this.onKeyUp(e);break;case 10:(this.enableRightButton||0==e.button)&&(this.onRelease(e),this.mouseDownButton==e.button&&this.onReleaseOutside(e)),this.mouseDownButton=-1;break;case 11:this.onTextInput(e);break;case 12:this.onCheck(e)}},set_cursor:function(c){return this.cursor=c,null!=this.scene&&null!=this.scene.events&&this.scene.events.updateCursor(this),c},onOver:function(e){},onOut:function(e){},onPush:function(e){},onRelease:function(e){},onReleaseOutside:function(e){},onClick:function(e){},onMove:function(e){},onWheel:function(e){},onFocus:function(e){},onFocusLost:function(e){},onKeyUp:function(e){},onKeyDown:function(e){},onCheck:function(e){},onTextInput:function(e){},__class__:h3d_scene_Interactive});var h3d_scene_Light=function(shader,parent){this.priority=0,this.cullingDistance=-1,h3d_scene_Object.call(this,parent),this.shader=shader};$hxClasses["h3d.scene.Light"]=h3d_scene_Light,h3d_scene_Light.__name__="h3d.scene.Light",h3d_scene_Light.__super__=h3d_scene_Object,h3d_scene_Light.prototype=$extend(h3d_scene_Object.prototype,{emit:function(ctx){ctx.emitLight(this)},getShadowDirection:function(){return null},__class__:h3d_scene_Light});var h3d_scene_LightSystem=function(){this.ambientLight=new h3d_Vector(1,1,1)};$hxClasses["h3d.scene.LightSystem"]=h3d_scene_LightSystem,h3d_scene_LightSystem.__name__="h3d.scene.LightSystem",h3d_scene_LightSystem.prototype={initGlobals:function(globals){},cullLights:function(){for(var l=this.ctx.lights,prev=null,s=new h3d_col_Sphere;null!=l;)s.x=l.absPos._41,s.y=l.absPos._42,s.z=l.absPos._43,s.r=l.cullingDistance,l.cullingDistance>0&&!this.ctx.computingStatic&&!this.ctx.camera.frustum.hasSphere(s)?(null==prev?this.ctx.lights=l.next:prev.next=l.next,l=l.next):(this.lightCount++,l.objectDistance=0,prev=l,l=l.next)},initLights:function(ctx){if(this.lightCount=0,this.ctx=ctx,this.cullLights(),null==this.shadowLight||0==(32&this.shadowLight.flags))for(var l=ctx.lights;null!=l;){if(null!=l.getShadowDirection()){this.shadowLight=l;break}l=l.next}},computeLight:function(obj,shaders){return shaders},__class__:h3d_scene_LightSystem};var h3d_scene__$RenderContext_SharedGlobal=function(gid,value){this.gid=gid,this.value=value};$hxClasses["h3d.scene._RenderContext.SharedGlobal"]=h3d_scene__$RenderContext_SharedGlobal,h3d_scene__$RenderContext_SharedGlobal.__name__="h3d.scene._RenderContext.SharedGlobal",h3d_scene__$RenderContext_SharedGlobal.prototype={__class__:h3d_scene__$RenderContext_SharedGlobal};var h3d_scene_RenderContext=function(){h3d_impl_RenderContext.call(this),this.cachedShaderList=[],this.cachedPassObjects=[]};$hxClasses["h3d.scene.RenderContext"]=h3d_scene_RenderContext,h3d_scene_RenderContext.__name__="h3d.scene.RenderContext",h3d_scene_RenderContext.__super__=h3d_impl_RenderContext,h3d_scene_RenderContext.prototype=$extend(h3d_impl_RenderContext.prototype,{start:function(){this.sharedGlobals=[],this.lights=null,this.drawPass=null,this.passes=null,this.lights=null,this.cachedPos=0,this.visibleFlag=!0,this.time+=this.elapsedTime,this.frame++},setGlobalID:function(gid,value){for(var _g=0,_g1=this.sharedGlobals;_g<_g1.length;){var g=_g1[_g];if(++_g,g.gid==gid)return void(g.value=value)}this.sharedGlobals.push(new h3d_scene__$RenderContext_SharedGlobal(gid,value))},emitPass:function(pass,obj){var o=this.allocPool;return null==o?((o=new h3d_pass_PassObject).nextAlloc=this.allocFirst,this.allocFirst=o):this.allocPool=o.nextAlloc,o.pass=pass,o.obj=obj,o.next=this.passes,this.passes=o,o},allocShaderList:function(s,next){var sl=this.cachedShaderList[this.cachedPos++];return null==sl&&(sl=new hxsl_ShaderList(null),this.cachedShaderList[this.cachedPos-1]=sl),sl.s=s,sl.next=next,sl},emitLight:function(l){l.next=this.lights,this.lights=l},done:function(){this.drawPass=null;for(var p=this.allocFirst;null!=p&&p!=this.allocPool;)p.obj=null,p.pass=null,p.shader=null,p.shaders=null,p.next=null,p.index=0,p.texture=0,p=p.nextAlloc;null!=this.allocPool&&(this.allocFirst=this.allocFirst.nextAlloc),this.allocPool=this.allocFirst;for(var _g=0,_g1=this.cachedShaderList;_g<_g1.length;){var c=_g1[_g];++_g,c.s=null,c.next=null}this.passes=null,this.lights=null},__class__:h3d_scene_RenderContext});var h3d_scene_PassObjects=function(){this.passes=new h3d_pass_PassList};$hxClasses["h3d.scene.PassObjects"]=h3d_scene_PassObjects,h3d_scene_PassObjects.__name__="h3d.scene.PassObjects",h3d_scene_PassObjects.prototype={__class__:h3d_scene_PassObjects};var h3d_scene_Renderer=function(){this.effects=[],this.hasSetTarget=!1,this.emptyPasses=new h3d_pass_PassList,this.allPasses=[],this.passObjects=new haxe_ds_StringMap,this.set_props(this.getDefaultProps());var _g=$bind(this,this.depthSort);this.frontToBack=function(passes){_g(!0,passes)};var _g1=$bind(this,this.depthSort);this.backToFront=function(passes){_g1(!1,passes)}};$hxClasses["h3d.scene.Renderer"]=h3d_scene_Renderer,h3d_scene_Renderer.__name__="h3d.scene.Renderer",h3d_scene_Renderer.__super__=hxd_impl_AnyProps,h3d_scene_Renderer.prototype=$extend(hxd_impl_AnyProps.prototype,{dispose:function(){for(var _g=0,_g1=this.allPasses;_g<_g1.length;){var p=_g1[_g];++_g,p.dispose()}for(_g=0,_g1=this.effects;_g<_g1.length;){var f=_g1[_g];++_g,f.dispose()}this.passObjects=new haxe_ds_StringMap},depthSort:function(frontToBack,passes){for(var cam=this.ctx.camera.m,_g_o=passes.current;null!=_g_o;){var tmp=_g_o;_g_o=_g_o.next;var z=(p=tmp).obj.absPos._41*cam._13+p.obj.absPos._42*cam._23+p.obj.absPos._43*cam._33+cam._43,w=p.obj.absPos._41*cam._14+p.obj.absPos._42*cam._24+p.obj.absPos._43*cam._34+cam._44;p.depth=z/w}if(frontToBack){if(null==(list=passes.current))tmp=null;else{for(var insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(var _g=0,_g1=insize;_g<_g1;){_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||(p.pass.layer==q.pass.layer?p.depth>q.depth?1:-1:p.pass.layer-q.pass.layer)<=0?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}tmp=list}passes.current=tmp}else{var list;if(null==(list=passes.current))tmp=null;else{var nmerges,p,q,e,tail;for(insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(_g=0,_g1=insize;_g<_g1;){_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||(p.pass.layer==q.pass.layer?p.depth>q.depth?-1:1:p.pass.layer-q.pass.layer)<=0?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}tmp=list}passes.current=tmp}},resetTarget:function(){this.hasSetTarget&&(this.ctx.engine.popTarget(),this.hasSetTarget=!1)},has:function(name){return null!=this.passObjects.h[name]},get:function(name){var p=this.passObjects.h[name];return null==p?this.emptyPasses:(p.rendered=!0,p.passes)},render:function(){throw haxe_Exception.thrown("Not implemented")},computeStatic:function(){throw haxe_Exception.thrown("Not implemented")},start:function(){},process:function(passes){this.hasSetTarget=!1;for(var _g=0,_g1=this.allPasses;_g<_g1.length;){var p=_g1[_g];++_g,p.setContext(this.ctx)}for(_g=0;_g<passes.length;){p=passes[_g];++_g,this.passObjects.h[p.name]=p}this.ctx.textures.begin(),this.ctx.computingStatic?this.computeStatic():this.render(),this.resetTarget();for(_g=0;_g<passes.length;){p=passes[_g];++_g,this.passObjects.h[p.name]=null}},__class__:h3d_scene_Renderer});var h3d_scene_Scene=function(createRenderer,createLightSystem){null==createLightSystem&&(createLightSystem=!0),null==createRenderer&&(createRenderer=!0),h3d_scene_Object.call(this,null),this.window=hxd_Window.getInstance(),this.eventListeners=[],this.hitInteractives=[],this.interactives=[],this.camera=new h3d_Camera;var engine=h3d_Engine.CURRENT;null!=engine&&(this.camera.screenRatio=engine.width/engine.height),this.ctx=new h3d_scene_RenderContext,createRenderer&&this.set_renderer(h3d_mat_MaterialSetup.current.createRenderer()),createLightSystem&&(this.lightSystem=h3d_mat_MaterialSetup.current.createLightSystem())};$hxClasses["h3d.scene.Scene"]=h3d_scene_Scene,h3d_scene_Scene.__name__="h3d.scene.Scene",h3d_scene_Scene.__interfaces__=[hxd_InteractiveScene,h3d_IDrawable],h3d_scene_Scene.__super__=h3d_scene_Object,h3d_scene_Scene.prototype=$extend(h3d_scene_Object.prototype,{setEvents:function(events){this.events=events},dispatchListeners:function(event){for(var _g=0,_g1=this.eventListeners;_g<_g1.length;){var l=_g1[_g];if(++_g,l(event),!event.propagate)break}},set_renderer:function(r){return this.renderer=r,null!=r&&(r.ctx=this.ctx),r},sortHitPointByCameraDistance:function(i1,i2){return i1.hitPoint.w>i2.hitPoint.w?-1:1},dispatchEvent:function(event,to){to.handleEvent(event)},isInteractiveVisible:function(i){for(var o=i;o!=this;){if(null==o||0==(2&o.flags))return!1;o=o.parent}return!0},handleEvent:function(event,last){if(0==this.interactives.length)return null;if(0==this.hitInteractives.length){var screenX=2*(event.relX/this.window.get_width()-.5),screenY=2*-(event.relY/this.window.get_height()-.5),p0=this.camera.unproject(screenX,screenY,0),p1=this.camera.unproject(screenX,screenY,1),x=p0.x,y=p0.y;null==(z=p0.z)&&(z=0),null==y&&(y=0),null==x&&(x=0);var p1_x=x,p1_y=y,p1_z=z;x=p1.x,y=p1.y;null==(z=p1.z)&&(z=0),null==y&&(y=0),null==x&&(x=0);var p2_x=x,p2_y=y,p2_z=z,r=new h3d_col_Ray;r.px=p1_x,r.py=p1_y,r.pz=p1_z,r.lx=p2_x-p1_x,r.ly=p2_y-p1_y,r.lz=p2_z-p1_z,r.normalize();for(var r1=r,saveR_px=r1.px,saveR_py=r1.py,saveR_pz=r1.pz,saveR_lx=r1.lx,saveR_ly=r1.ly,saveR_lz=r1.lz,priority=-2147483648,_g=0,_g1=this.interactives;_g<_g1.length;){var i=_g1[_g];if(++_g,!(i.priority<priority)){for(var p=i;null!=p&&0!=(2&p.flags);)p=p.parent;if(null==p){var minv=i.getInvPos();x=r1.px,y=r1.py;null==(z=r1.pz)&&(z=0),null==y&&(y=0),null==x&&(x=0);var p_y=y,p_z=z,p_w=1,px=(p_x=x)*minv._11+p_y*minv._21+p_z*minv._31+p_w*minv._41,py=p_x*minv._12+p_y*minv._22+p_z*minv._32+p_w*minv._42,pz=p_x*minv._13+p_y*minv._23+p_z*minv._33+p_w*minv._43;p_x=px,p_y=py,p_z=pz,r1.px=p_x,r1.py=p_y,r1.pz=p_z;var x1=r1.lx,y1=r1.ly;null==(z1=r1.lz)&&(z1=0),null==y1&&(y1=0),null==x1&&(x1=0);var l_y=y1,l_z=z1,px1=(l_x=x1)*minv._11+l_y*minv._21+l_z*minv._31,py1=l_x*minv._12+l_y*minv._22+l_z*minv._32,pz1=l_x*minv._13+l_y*minv._23+l_z*minv._33;if(l_x=px1,l_y=py1,l_z=pz1,r1.lx=l_x,r1.ly=l_y,r1.lz=l_z,r1.normalize(),r1.lx==r1.lx)if((hit=i.shape.rayIntersection(r1,i.bestMatch))<0)r1.px=saveR_px,r1.py=saveR_py,r1.pz=saveR_pz,r1.lx=saveR_lx,r1.ly=saveR_ly,r1.lz=saveR_lz;else{var x2=r1.px+hit*r1.lx,y2=r1.py+hit*r1.ly;null==(z2=r1.pz+hit*r1.lz)&&(z2=0),null==y2&&(y2=0),null==x2&&(x2=0);var hitPoint_x=x2,hitPoint_y=y2,hitPoint_z=z2;if(r1.px=saveR_px,r1.py=saveR_py,r1.pz=saveR_pz,r1.lx=saveR_lx,r1.ly=saveR_ly,r1.lz=saveR_lz,i.hitPoint.x=hitPoint_x,i.hitPoint.y=hitPoint_y,i.hitPoint.z=hitPoint_z,i.priority>priority){for(;this.hitInteractives.length>0;)this.hitInteractives.pop();priority=i.priority}this.hitInteractives.push(i)}else r1.px=saveR_px,r1.py=saveR_py,r1.pz=saveR_pz,r1.lx=saveR_lx,r1.ly=saveR_ly,r1.lz=saveR_lz}}}if(0==this.hitInteractives.length)return null;if(this.hitInteractives.length>1){for(_g=0,_g1=this.hitInteractives;_g<_g1.length;){i=_g1[_g];++_g;var m=i.invPos,wfactor=0;if(null!=i.preciseShape){var z;x=r1.px,y=r1.py;null==(z=r1.pz)&&(z=0),null==y&&(y=0),null==x&&(x=0);var p_x;p_y=y,p_z=z,p_w=1,px=(p_x=x)*m._11+p_y*m._21+p_z*m._31+p_w*m._41,py=p_x*m._12+p_y*m._22+p_z*m._32+p_w*m._42,pz=p_x*m._13+p_y*m._23+p_z*m._33+p_w*m._43;p_x=px,p_y=py,p_z=pz,r1.px=p_x,r1.py=p_y,r1.pz=p_z;var z1;x1=r1.lx,y1=r1.ly;null==(z1=r1.lz)&&(z1=0),null==y1&&(y1=0),null==x1&&(x1=0);var l_x,hit;l_y=y1,l_z=z1,px1=(l_x=x1)*m._11+l_y*m._21+l_z*m._31,py1=l_x*m._12+l_y*m._22+l_z*m._32,pz1=l_x*m._13+l_y*m._23+l_z*m._33;if(l_x=px1,l_y=py1,l_z=pz1,r1.lx=l_x,r1.ly=l_y,r1.lz=l_z,r1.normalize(),(hit=i.preciseShape.rayIntersection(r1,i.bestMatch))>0){var z2;x2=r1.px+hit*r1.lx,y2=r1.py+hit*r1.ly;null==(z2=r1.pz+hit*r1.lz)&&(z2=0),null==y2&&(y2=0),null==x2&&(x2=0);hitPoint_x=x2,hitPoint_y=y2,hitPoint_z=z2;i.hitPoint.x=hitPoint_x,i.hitPoint.y=hitPoint_y,i.hitPoint.z=hitPoint_z}else wfactor=1;r1.px=saveR_px,r1.py=saveR_py,r1.pz=saveR_pz,r1.lx=saveR_lx,r1.ly=saveR_ly,r1.lz=saveR_lz}var _this=i.hitPoint,x3=_this.x,y3=_this.y,z3=_this.z,w=_this.w;null==w&&(w=1),null==z3&&(z3=0),null==y3&&(y3=0),null==x3&&(x3=0);var p_x1=x3,p_y1=y3,p_z1=z3,p_w1=w;p_w1=1;var m1=i.absPos,px2=p_x1*m1._11+p_y1*m1._21+p_z1*m1._31+p_w1*m1._41,py2=p_x1*m1._12+p_y1*m1._22+p_z1*m1._32+p_w1*m1._42,pz2=p_x1*m1._13+p_y1*m1._23+p_z1*m1._33+p_w1*m1._43;p_x1=px2,p_y1=py2,p_z1=pz2;var m2=this.camera.m,px3=p_x1*m2._11+p_y1*m2._21+p_z1*m2._31+p_w1*m2._41,py3=p_x1*m2._12+p_y1*m2._22+p_z1*m2._32+p_w1*m2._42,pz3=p_x1*m2._13+p_y1*m2._23+p_z1*m2._33+p_w1*m2._43,iw=1/(p_x1*m2._14+p_y1*m2._24+p_z1*m2._34+p_w1*m2._44);p_x1=px3*iw,p_y1=py3*iw,p_z1=pz3*iw,p_w1=1,i.hitPoint.w=p_z1+wfactor}this.hitInteractives.sort($bind(this,this.sortHitPointByCameraDistance))}this.hitInteractives.unshift(null)}for(;this.hitInteractives.length>0;){if(null==(i=this.hitInteractives.pop()))return null;if(event.relX=i.hitPoint.x,event.relY=i.hitPoint.y,event.relZ=i.hitPoint.z,i.handleEvent(event),!event.cancel){if(!event.propagate)for(;this.hitInteractives.length>0;)this.hitInteractives.pop();return i}event.cancel=!1,event.propagate=!1}return null},dispose:function(){0!=(32&this.flags)&&this.onRemove(),null!=this.hardwarePass&&(this.hardwarePass.dispose(),this.hardwarePass=null),this.ctx.dispose(),null!=this.renderer&&(this.renderer.dispose(),this.set_renderer(new h3d_scene_Renderer))},addEventTarget:function(i){if(this.interactives.indexOf(i)>=0)throw haxe_Exception.thrown("assert");this.interactives.push(i)},removeEventTarget:function(i){HxOverrides.remove(this.interactives,i)&&(null!=this.events&&this.events.onRemove(i),HxOverrides.remove(this.hitInteractives,i))},setElapsedTime:function(elapsedTime){this.ctx.elapsedTime=elapsedTime},render:function(engine){0==(32&this.flags)&&this.onAdd();var t=engine.getCurrentTarget();this.camera.screenRatio=null==t?engine.width/engine.height:t.width/t.height,this.camera.update(),this.camera.rightHanded&&engine.driver.setRenderFlag(h3d_impl_RenderFlag.CameraHandness,1),this.ctx.camera=this.camera,this.ctx.engine=engine,this.ctx.scene=this,this.ctx.start(),this.renderer.start(),this.syncRec(this.ctx),this.emitRec(this.ctx);var tmp,list=this.ctx.passes;if(null==list)tmp=null;else{for(var nmerges,q,e,tail,insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(var _g=0,_g1=insize;_g<_g1;){var i=_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||p.pass.passId-q.pass.passId<=0?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}tmp=list}this.ctx.passes=tmp;for(var curPass=this.ctx.passes,passes=[],passIndex=-1;null!=curPass;){for(var passId=curPass.pass.passId,p=curPass,prev=null;null!=p&&p.pass.passId==passId;)prev=p,p=p.next;prev.next=null;var pobjs=this.ctx.cachedPassObjects[++passIndex];null==pobjs&&(pobjs=new h3d_scene_PassObjects,this.ctx.cachedPassObjects[passIndex]=pobjs),pobjs.name=curPass.pass.name,(_this=pobjs.passes).current=curPass,_this.discarded=_this.lastDisc=null,passes.push(pobjs),curPass=p}null!=this.lightSystem&&(this.ctx.lightSystem=this.lightSystem,this.lightSystem.initLights(this.ctx)),this.renderer.process(passes),this.camera.rightHanded&&engine.driver.setRenderFlag(h3d_impl_RenderFlag.CameraHandness,0),this.ctx.done(),this.ctx.scene=null,this.ctx.camera=null,this.ctx.engine=null;for(_g=0,_g1=passIndex;_g<_g1;){var _this;i=_g++;(p=this.ctx.cachedPassObjects[i]).name=null,(_this=p.passes).current=null,_this.discarded=_this.lastDisc=null}},__class__:h3d_scene_Scene});var h3d_scene_fwd_LightSystem=function(){this.perPixelLighting=!0,this.maxLightsPerObject=6,h3d_scene_LightSystem.call(this);var _this=this.ambientLight,x=.5,y=.5,z=.5;null==z&&(z=0),null==y&&(y=0),null==x&&(x=0),_this.x=x,_this.y=y,_this.z=z,_this.w=1,this.ambientShader=new h3d_shader_AmbientLight,this.set_additiveLighting(!0)};$hxClasses["h3d.scene.fwd.LightSystem"]=h3d_scene_fwd_LightSystem,h3d_scene_fwd_LightSystem.__name__="h3d.scene.fwd.LightSystem",h3d_scene_fwd_LightSystem.__super__=h3d_scene_LightSystem,h3d_scene_fwd_LightSystem.prototype=$extend(h3d_scene_LightSystem.prototype,{set_additiveLighting:function(b){var value=this.ambientShader,_this=value instanceof h3d_shader_AmbientLight?value:null;return _this.constModified=!0,_this.additive__=b},initLights:function(ctx){if(h3d_scene_LightSystem.prototype.initLights.call(this,ctx),this.lightCount<=this.maxLightsPerObject){var tmp,list=ctx.lights,cmp=$bind(this,this.sortLight);if(null==list)tmp=null;else{for(var nmerges,p,q,e,tail,insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(var _g=0,_g1=insize;_g<_g1;){_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||cmp(p,q)<=0?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}tmp=list}ctx.lights=tmp}},initGlobals:function(globals){globals.set("global.ambientLight",this.ambientLight),globals.set("global.perPixelLighting",this.perPixelLighting)},sortLight:function(l1,l2){var p=l1.priority-l2.priority;return 0!=p?-p:l1.objectDistance<l2.objectDistance?-1:1},computeLight:function(obj,shaders){if(this.lightCount>this.maxLightsPerObject){for(var l=this.ctx.lights;null!=l;){if(0!=(16&obj.flags)){var dx=l.absPos._41-this.ctx.camera.target.x,dy=l.absPos._42-this.ctx.camera.target.y,dz=l.absPos._43-this.ctx.camera.target.z;null==dz&&(dz=0),l.objectDistance=dx*dx+dy*dy+dz*dz}else{var dx1=l.absPos._41-obj.absPos._41,dy1=l.absPos._42-obj.absPos._42,dz1=l.absPos._43-obj.absPos._43;null==dz1&&(dz1=0),l.objectDistance=dx1*dx1+dy1*dy1+dz1*dz1}l=l.next}var tmp,list=this.ctx.lights,cmp=$bind(this,this.sortLight);if(null==list)tmp=null;else{for(var nmerges,p,q,e,tail,insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(var _g=0,_g1=insize;_g<_g1;){var i=_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||cmp(p,q)<=0?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}tmp=list}this.ctx.lights=tmp}shaders=this.ctx.allocShaderList(this.ambientShader,shaders);for(l=this.ctx.lights,i=0;null!=l&&i++!=this.maxLightsPerObject;)shaders=this.ctx.allocShaderList(l.shader,shaders),l=l.next;return shaders},__class__:h3d_scene_fwd_LightSystem});var h3d_scene_fwd_DepthPass=function(){this.enableSky=!1,h3d_pass_Default.call(this,"depth"),this.depthMapId=hxsl_Globals.allocID("depthMap")};$hxClasses["h3d.scene.fwd.DepthPass"]=h3d_scene_fwd_DepthPass,h3d_scene_fwd_DepthPass.__name__="h3d.scene.fwd.DepthPass",h3d_scene_fwd_DepthPass.__super__=h3d_pass_Default,h3d_scene_fwd_DepthPass.prototype=$extend(h3d_pass_Default.prototype,{getOutputs:function(){return[hxsl_Output.PackFloat(hxsl_Output.Value("output.depth"))]},draw:function(passes,sort){var texture=this.ctx.textures.allocTarget("depthMap",this.ctx.engine.width,this.ctx.engine.height,!0);this.ctx.engine.pushTarget(texture),this.ctx.engine.clear(this.enableSky?0:16711680,1),h3d_pass_Default.prototype.draw.call(this,passes,sort),this.ctx.engine.popTarget(),this.ctx.setGlobalID(this.depthMapId,{texture:texture})},__class__:h3d_scene_fwd_DepthPass});var h3d_scene_fwd_NormalPass=function(){h3d_pass_Default.call(this,"normal"),this.normalMapId=hxsl_Globals.allocID("normalMap")};$hxClasses["h3d.scene.fwd.NormalPass"]=h3d_scene_fwd_NormalPass,h3d_scene_fwd_NormalPass.__name__="h3d.scene.fwd.NormalPass",h3d_scene_fwd_NormalPass.__super__=h3d_pass_Default,h3d_scene_fwd_NormalPass.prototype=$extend(h3d_pass_Default.prototype,{getOutputs:function(){return[hxsl_Output.PackNormal(hxsl_Output.Value("output.normal"))]},draw:function(passes,sort){var texture=this.ctx.textures.allocTarget("normalMap",this.ctx.engine.width,this.ctx.engine.height);this.ctx.engine.pushTarget(texture),this.ctx.engine.clear(8421504,1),h3d_pass_Default.prototype.draw.call(this,passes,sort),this.ctx.engine.popTarget(),this.ctx.setGlobalID(this.normalMapId,texture)},__class__:h3d_scene_fwd_NormalPass});var h3d_scene_fwd_Renderer=function(){this.shadow=new h3d_pass_DefaultShadowMap(1024),this.normal=new h3d_scene_fwd_NormalPass,this.depth=new h3d_scene_fwd_DepthPass,h3d_scene_Renderer.call(this),this.defaultPass=new h3d_pass_Default("default"),this.allPasses=[this.defaultPass,this.depth,this.normal,this.shadow]};$hxClasses["h3d.scene.fwd.Renderer"]=h3d_scene_fwd_Renderer,h3d_scene_fwd_Renderer.__name__="h3d.scene.fwd.Renderer",h3d_scene_fwd_Renderer.__super__=h3d_scene_Renderer,h3d_scene_fwd_Renderer.prototype=$extend(h3d_scene_Renderer.prototype,{renderPass:function(p,passes,sort){p.draw(passes,sort)},render:function(){this.has("shadow")&&this.renderPass(this.shadow,this.get("shadow")),this.has("depth")&&this.renderPass(this.depth,this.get("depth")),this.has("normal")&&this.renderPass(this.normal,this.get("normal")),this.renderPass(this.defaultPass,this.get("default")),this.renderPass(this.defaultPass,this.get("alpha"),this.backToFront),this.renderPass(this.defaultPass,this.get("additive"))},__class__:h3d_scene_fwd_Renderer});var h3d_shader_AmbientLight=function(){hxsl_Shader.call(this)};$hxClasses["h3d.shader.AmbientLight"]=h3d_shader_AmbientLight,h3d_shader_AmbientLight.__name__="h3d.shader.AmbientLight",h3d_shader_AmbientLight.__super__=hxsl_Shader,h3d_shader_AmbientLight.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.additive__&&(this.constBits|=2),this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.additive__:null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_AmbientLight});var h3d_shader_Base2d=function(){this.viewport__=new h3d_Vector,this.halfPixelInverse__=new h3d_Vector,this.uvPos__=new h3d_Vector,this.filterMatrixB__=new h3d_Vector,this.filterMatrixA__=new h3d_Vector,this.absoluteMatrixB__=new h3d_Vector,this.absoluteMatrixA__=new h3d_Vector,this.color__=new h3d_Vector,this.zValue__=0,hxsl_Shader.call(this)};$hxClasses["h3d.shader.Base2d"]=h3d_shader_Base2d,h3d_shader_Base2d.__name__="h3d.shader.Base2d",h3d_shader_Base2d.__super__=hxsl_Shader,h3d_shader_Base2d.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.isRelative__&&(this.constBits|=1),this.hasUVPos__&&(this.constBits|=2),this.killAlpha__&&(this.constBits|=4),this.pixelAlign__&&(this.constBits|=8),this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.zValue__;case 1:return this.texture__;case 2:return this.isRelative__;case 3:return this.color__;case 4:return this.absoluteMatrixA__;case 5:return this.absoluteMatrixB__;case 6:return this.filterMatrixA__;case 7:return this.filterMatrixB__;case 8:return this.hasUVPos__;case 9:return this.uvPos__;case 10:return this.killAlpha__;case 11:return this.pixelAlign__;case 12:return this.halfPixelInverse__;case 13:return this.viewport__}return null},getParamFloatValue:function(index){return 0==index?this.zValue__:0},__class__:h3d_shader_Base2d});var h3d_shader_BaseMesh=function(){var _this,x,y,z;this.specularColor__=new h3d_Vector,this.specularAmount__=0,this.specularPower__=0,this.color__=new h3d_Vector,hxsl_Shader.call(this),null==(z=1)&&(z=0),null==(y=1)&&(y=0),null==(x=1)&&(x=0),(_this=this.color__).x=x,_this.y=y,_this.z=z,_this.w=1,null==(z=1)&&(z=0),null==(y=1)&&(y=0),null==(x=1)&&(x=0),(_this=this.specularColor__).x=x,_this.y=y,_this.z=z,_this.w=1,this.specularPower__=50,this.specularAmount__=1};$hxClasses["h3d.shader.BaseMesh"]=h3d_shader_BaseMesh,h3d_shader_BaseMesh.__name__="h3d.shader.BaseMesh",h3d_shader_BaseMesh.__super__=hxsl_Shader,h3d_shader_BaseMesh.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.color__;case 1:return this.specularPower__;case 2:return this.specularAmount__;case 3:return this.specularColor__}return null},getParamFloatValue:function(index){switch(index){case 1:return this.specularPower__;case 2:return this.specularAmount__}return 0},__class__:h3d_shader_BaseMesh});var h3d_shader_Blur=function(){this.cubeDir__=new h3d_Matrix,this.fixedColor__=new h3d_Vector,this.pixel__=new h3d_Vector,this.offsets__=[],this.values__=[],this.Quality__=0,this.cameraInverseViewProj__=new h3d_Matrix,h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.shader.Blur"]=h3d_shader_Blur,h3d_shader_Blur.__name__="h3d.shader.Blur",h3d_shader_Blur.__super__=h3d_shader_ScreenShader,h3d_shader_Blur.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0;var v=this.Quality__;if(v>>>8!=0)throw haxe_Exception.thrown("Quality is out of range "+v+">255");this.constBits|=v,this.isDepth__&&(this.constBits|=256),this.hasFixedColor__&&(this.constBits|=512),this.smoothFixedColor__&&(this.constBits|=1024),this.isDepthDependant__&&(this.constBits|=2048),this.hasNormal__&&(this.constBits|=4096),this.isCube__&&(this.constBits|=8192),this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.cameraInverseViewProj__;case 2:return this.texture__;case 3:return this.depthTexture__;case 4:return this.Quality__;case 5:return this.isDepth__;case 6:return this.values__;case 7:return this.offsets__;case 8:return this.pixel__;case 9:return this.hasFixedColor__;case 10:return this.smoothFixedColor__;case 11:return this.fixedColor__;case 12:return this.isDepthDependant__;case 13:return this.hasNormal__;case 14:return this.normalTexture__;case 15:return this.isCube__;case 16:return this.cubeTexture__;case 17:return this.cubeDir__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_shader_Blur});var h3d_shader_ShaderBuffers=function(s){this.globals=new Float32Array(s.globalsSize<<2),this.params=new Float32Array(s.paramsSize<<2);var tmp,this1=new Array(s.texturesCount);(this.tex=this1,s.bufferCount>0)?tmp=this1=new Array(s.bufferCount):tmp=null;this.buffers=tmp};$hxClasses["h3d.shader.ShaderBuffers"]=h3d_shader_ShaderBuffers,h3d_shader_ShaderBuffers.__name__="h3d.shader.ShaderBuffers",h3d_shader_ShaderBuffers.prototype={grow:function(s){var ng=s.globalsSize<<2,np=s.paramsSize<<2,nt=s.texturesCount,nb=s.bufferCount;if(this.globals.length<ng&&(this.globals=new Float32Array(ng)),this.params.length<np&&(this.params=new Float32Array(np)),this.tex.length<nt){var this1=new Array(nt);this.tex=this1}if(nb>0&&(null==this.buffers||this.buffers.length<nb)){this1=new Array(nb);this.buffers=this1}},__class__:h3d_shader_ShaderBuffers};var h3d_shader_Buffers=function(s){this.vertex=new h3d_shader_ShaderBuffers(s.vertex),this.fragment=new h3d_shader_ShaderBuffers(s.fragment)};$hxClasses["h3d.shader.Buffers"]=h3d_shader_Buffers,h3d_shader_Buffers.__name__="h3d.shader.Buffers",h3d_shader_Buffers.prototype={__class__:h3d_shader_Buffers};var h3d_shader_ColorAdd=function(color){null==color&&(color=0),this.color__=new h3d_Vector,hxsl_Shader.call(this);var _this=this.color__;_this.x=(color>>16&255)/255,_this.y=(color>>8&255)/255,_this.z=(255&color)/255,_this.w=(color>>>24)/255};$hxClasses["h3d.shader.ColorAdd"]=h3d_shader_ColorAdd,h3d_shader_ColorAdd.__name__="h3d.shader.ColorAdd",h3d_shader_ColorAdd.__super__=hxsl_Shader,h3d_shader_ColorAdd.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.color__:null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_ColorAdd});var h3d_shader_ColorKey=function(v){null==v&&(v=0),this.colorKey__=new h3d_Vector,hxsl_Shader.call(this);var _this=this.colorKey__;_this.x=(v>>16&255)/255,_this.y=(v>>8&255)/255,_this.z=(255&v)/255,_this.w=(v>>>24)/255};$hxClasses["h3d.shader.ColorKey"]=h3d_shader_ColorKey,h3d_shader_ColorKey.__name__="h3d.shader.ColorKey",h3d_shader_ColorKey.__super__=hxsl_Shader,h3d_shader_ColorKey.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.colorKey__:null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_ColorKey});var h3d_shader_ColorMatrix=function(m){this.matrix__=new h3d_Matrix,hxsl_Shader.call(this),null!=m?this.matrix__.loadValues(m):this.matrix__.identity()};$hxClasses["h3d.shader.ColorMatrix"]=h3d_shader_ColorMatrix,h3d_shader_ColorMatrix.__name__="h3d.shader.ColorMatrix",h3d_shader_ColorMatrix.__super__=hxsl_Shader,h3d_shader_ColorMatrix.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.matrix__:null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_ColorMatrix});var h3d_shader_DirShadow=function(){this.poissonDiskVeryHigh__=[],this.poissonDiskHigh__=[],this.poissonDiskLow__=[],this.shadowBias__=0,this.shadowProj__=new h3d_Matrix,this.shadowMapChannel__=hxsl_Channel.Unknown,this.shadowRes__=new h3d_Vector,this.pcfScale__=0,this.pcfQuality__=0,this.shadowPower__=0,hxsl_Shader.call(this),this.poissonDiskLow__=[new h3d_Vector(-.942,-.399),new h3d_Vector(.945,-.768),new h3d_Vector(-.094,-.929),new h3d_Vector(.344,.293)],this.poissonDiskHigh__=[new h3d_Vector(-.326,-.406),new h3d_Vector(-.84,-.074),new h3d_Vector(-.696,.457),new h3d_Vector(-.203,.621),new h3d_Vector(.962,-.195),new h3d_Vector(.473,-.48),new h3d_Vector(.519,.767),new h3d_Vector(.185,-.893),new h3d_Vector(.507,.064),new h3d_Vector(.896,.412),new h3d_Vector(-.322,-.933),new h3d_Vector(-.792,-.598)],this.poissonDiskVeryHigh__=[new h3d_Vector(-.613392,.617481),new h3d_Vector(.170019,-.040254),new h3d_Vector(-.299417,.791925),new h3d_Vector(.64568,.49321),new h3d_Vector(-.651784,.717887),new h3d_Vector(.421003,.02707),new h3d_Vector(-.817194,-.271096),new h3d_Vector(-.705374,-.668203),new h3d_Vector(.97705,-.108615),new h3d_Vector(.063326,.142369),new h3d_Vector(.203528,.214331),new h3d_Vector(-.667531,.32609),new h3d_Vector(-.098422,-.295755),new h3d_Vector(-.885922,.215369),new h3d_Vector(.566637,.605213),new h3d_Vector(.039766,-.3961),new h3d_Vector(.751946,.453352),new h3d_Vector(.078707,-.715323),new h3d_Vector(-.075838,-.529344),new h3d_Vector(.724479,-.580798),new h3d_Vector(.222999,-.215125),new h3d_Vector(-.467574,-.405438),new h3d_Vector(-.248268,-.814753),new h3d_Vector(.354411,-.88757),new h3d_Vector(.175817,.382366),new h3d_Vector(.487472,-.063082),new h3d_Vector(-.084078,.898312),new h3d_Vector(.488876,-.783441),new h3d_Vector(.470016,.217933),new h3d_Vector(-.69689,-.549791),new h3d_Vector(-.149693,.605762),new h3d_Vector(.034211,.97998),new h3d_Vector(.503098,-.308878),new h3d_Vector(-.016205,-.872921),new h3d_Vector(.385784,-.393902),new h3d_Vector(-.146886,-.859249),new h3d_Vector(.643361,.164098),new h3d_Vector(.634388,-.049471),new h3d_Vector(-.688894,.007843),new h3d_Vector(.464034,-.188818),new h3d_Vector(-.44084,.137486),new h3d_Vector(.364483,.511704),new h3d_Vector(.034028,.325968),new h3d_Vector(.099094,-.308023),new h3d_Vector(.69396,-.366253),new h3d_Vector(.678884,-.204688),new h3d_Vector(.001801,.780328),new h3d_Vector(.145177,-.898984),new h3d_Vector(.062655,-.611866),new h3d_Vector(.315226,-.604297),new h3d_Vector(-.780145,.486251),new h3d_Vector(-.371868,.882138),new h3d_Vector(.200476,.49443),new h3d_Vector(-.494552,-.711051),new h3d_Vector(.612476,.705252),new h3d_Vector(-.578845,-.768792),new h3d_Vector(-.772454,-.090976),new h3d_Vector(.50444,.372295),new h3d_Vector(.155736,.065157),new h3d_Vector(.391522,.849605),new h3d_Vector(-.620106,-.328104),new h3d_Vector(.789239,-.419965),new h3d_Vector(-.545396,.538133),new h3d_Vector(-.178564,-.596057)]};$hxClasses["h3d.shader.DirShadow"]=h3d_shader_DirShadow,h3d_shader_DirShadow.__name__="h3d.shader.DirShadow",h3d_shader_DirShadow.__super__=hxsl_Shader,h3d_shader_DirShadow.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.enable__&&(this.constBits|=1),this.USE_ESM__&&(this.constBits|=2),this.USE_PCF__&&(this.constBits|=4);var v=this.pcfQuality__;if(v>>>8!=0)throw haxe_Exception.thrown("pcfQuality is out of range "+v+">255");if(this.constBits|=v<<3,null==this.shadowMap__)this.shadowMapChannel__=hxsl_Channel.Unknown;else if(this.shadowMapChannel__==hxsl_Channel.Unknown){if(this.shadowMap__.format!=h3d_mat_Texture.nativeFormat)throw haxe_Exception.thrown("shadowMapChannel is not set");this.shadowMapChannel__=hxsl_Channel.PackedFloat}this.constBits|=(globals.allocChannelID(this.shadowMap__)<<3|this.shadowMapChannel__._hx_index)<<11,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.enable__;case 1:return this.USE_ESM__;case 2:return this.shadowPower__;case 3:return this.USE_PCF__;case 4:return this.pcfQuality__;case 5:return this.pcfScale__;case 6:return this.shadowRes__;case 7:return this.shadowMap__;case 8:return this.shadowProj__;case 9:return this.shadowBias__;case 10:return this.poissonDiskLow__;case 11:return this.poissonDiskHigh__;case 12:return this.poissonDiskVeryHigh__}return null},getParamFloatValue:function(index){switch(index){case 2:return this.shadowPower__;case 5:return this.pcfScale__;case 9:return this.shadowBias__}return 0},__class__:h3d_shader_DirShadow});var h3d_shader_GenTexture=function(){this.color__=new h3d_Vector,this.mode__=0,h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.shader.GenTexture"]=h3d_shader_GenTexture,h3d_shader_GenTexture.__name__="h3d.shader.GenTexture",h3d_shader_GenTexture.__super__=h3d_shader_ScreenShader,h3d_shader_GenTexture.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0;var v=this.mode__;if(v>>>8!=0)throw haxe_Exception.thrown("mode is out of range "+v+">255");this.constBits|=v,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.mode__;case 2:return this.color__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_shader_GenTexture});var h3d_shader_LineShader=function(width,lengthScale){null==lengthScale&&(lengthScale=1),null==width&&(width=1.5),this.width__=0,this.lengthScale__=0,hxsl_Shader.call(this),this.width__=width,this.lengthScale__=lengthScale};$hxClasses["h3d.shader.LineShader"]=h3d_shader_LineShader,h3d_shader_LineShader.__name__="h3d.shader.LineShader",h3d_shader_LineShader.__super__=hxsl_Shader,h3d_shader_LineShader.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.lengthScale__;case 1:return this.width__}return null},getParamFloatValue:function(index){switch(index){case 0:return this.lengthScale__;case 1:return this.width__}return 0},__class__:h3d_shader_LineShader});var h3d_shader_MinMaxShader=function(){h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.shader.MinMaxShader"]=h3d_shader_MinMaxShader,h3d_shader_MinMaxShader.__name__="h3d.shader.MinMaxShader",h3d_shader_MinMaxShader.__super__=h3d_shader_ScreenShader,h3d_shader_MinMaxShader.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0,this.isMax__&&(this.constBits|=1),this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_shader_MinMaxShader});var h3d_shader_CubeMinMaxShader=function(){this.mat__=new h3d_Matrix,h3d_shader_ScreenShader.call(this)};$hxClasses["h3d.shader.CubeMinMaxShader"]=h3d_shader_CubeMinMaxShader,h3d_shader_CubeMinMaxShader.__name__="h3d.shader.CubeMinMaxShader",h3d_shader_CubeMinMaxShader.__super__=h3d_shader_ScreenShader,h3d_shader_CubeMinMaxShader.prototype=$extend(h3d_shader_ScreenShader.prototype,{updateConstants:function(globals){this.constBits=0,this.isMax__&&(this.constBits|=1),this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__;case 4:return this.mat__}return null},getParamFloatValue:function(index){return 0==index?this.flipY__:0},__class__:h3d_shader_CubeMinMaxShader});var h3d_shader_NormalMap=function(texture){hxsl_Shader.call(this),this.texture__=texture};$hxClasses["h3d.shader.NormalMap"]=h3d_shader_NormalMap,h3d_shader_NormalMap.__name__="h3d.shader.NormalMap",h3d_shader_NormalMap.__super__=hxsl_Shader,h3d_shader_NormalMap.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.texture__:null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_NormalMap});var h3d_shader_Shadow=function(){hxsl_Shader.call(this)};$hxClasses["h3d.shader.Shadow"]=h3d_shader_Shadow,h3d_shader_Shadow.__name__="h3d.shader.Shadow",h3d_shader_Shadow.__super__=hxsl_Shader,h3d_shader_Shadow.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){return null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_Shadow});var h3d_shader_SkinBase=function(){this.bonesMatrixes__=[],this.MaxBones__=0,hxsl_Shader.call(this),this.constModified=!0,this.MaxBones__=34};$hxClasses["h3d.shader.SkinBase"]=h3d_shader_SkinBase,h3d_shader_SkinBase.__name__="h3d.shader.SkinBase",h3d_shader_SkinBase.__super__=hxsl_Shader,h3d_shader_SkinBase.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0;var v=this.MaxBones__;if(v>>>8!=0)throw haxe_Exception.thrown("MaxBones is out of range "+v+">255");this.constBits|=v,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_SkinBase});var h3d_shader_Skin=function(){h3d_shader_SkinBase.call(this)};$hxClasses["h3d.shader.Skin"]=h3d_shader_Skin,h3d_shader_Skin.__name__="h3d.shader.Skin",h3d_shader_Skin.__super__=h3d_shader_SkinBase,h3d_shader_Skin.prototype=$extend(h3d_shader_SkinBase.prototype,{updateConstants:function(globals){this.constBits=0;var v=this.MaxBones__;if(v>>>8!=0)throw haxe_Exception.thrown("MaxBones is out of range "+v+">255");this.constBits|=v,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_Skin});var h3d_shader_SkinTangent=function(){h3d_shader_SkinBase.call(this)};$hxClasses["h3d.shader.SkinTangent"]=h3d_shader_SkinTangent,h3d_shader_SkinTangent.__name__="h3d.shader.SkinTangent",h3d_shader_SkinTangent.__super__=h3d_shader_SkinBase,h3d_shader_SkinTangent.prototype=$extend(h3d_shader_SkinBase.prototype,{updateConstants:function(globals){this.constBits=0;var v=this.MaxBones__;if(v>>>8!=0)throw haxe_Exception.thrown("MaxBones is out of range "+v+">255");this.constBits|=v,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.MaxBones__;case 1:return this.bonesMatrixes__}return null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_SkinTangent});var h3d_shader_SpecularTexture=function(tex){hxsl_Shader.call(this),this.texture__=tex};$hxClasses["h3d.shader.SpecularTexture"]=h3d_shader_SpecularTexture,h3d_shader_SpecularTexture.__name__="h3d.shader.SpecularTexture",h3d_shader_SpecularTexture.__super__=hxsl_Shader,h3d_shader_SpecularTexture.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.texture__:null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_SpecularTexture});var h3d_shader_Texture=function(tex){this.killAlphaThreshold__=0,hxsl_Shader.call(this),this.texture__=tex,this.killAlphaThreshold__=h3d_mat_Defaults.defaultKillAlphaThreshold};$hxClasses["h3d.shader.Texture"]=h3d_shader_Texture,h3d_shader_Texture.__name__="h3d.shader.Texture",h3d_shader_Texture.__super__=hxsl_Shader,h3d_shader_Texture.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.additive__&&(this.constBits|=1),this.killAlpha__&&(this.constBits|=2),this.specularAlpha__&&(this.constBits|=4),this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.additive__;case 1:return this.killAlpha__;case 2:return this.specularAlpha__;case 3:return this.killAlphaThreshold__;case 4:return this.texture__}return null},getParamFloatValue:function(index){return 3==index?this.killAlphaThreshold__:0},__class__:h3d_shader_Texture});var h3d_shader_UVDelta=function(dx,dy,sx,sy){var _this,x,y;null==sy&&(sy=1),null==sx&&(sx=1),null==dy&&(dy=0),null==dx&&(dx=0),this.uvScale__=new h3d_Vector,this.uvDelta__=new h3d_Vector,hxsl_Shader.call(this),null==(y=dy)&&(y=0),null==(x=dx)&&(x=0),(_this=this.uvDelta__).x=x,_this.y=y,_this.z=0,_this.w=1,null==(y=sy)&&(y=0),null==(x=sx)&&(x=0),(_this=this.uvScale__).x=x,_this.y=y,_this.z=0,_this.w=1};$hxClasses["h3d.shader.UVDelta"]=h3d_shader_UVDelta,h3d_shader_UVDelta.__name__="h3d.shader.UVDelta",h3d_shader_UVDelta.__super__=hxsl_Shader,h3d_shader_UVDelta.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.uvDelta__;case 1:return this.uvScale__}return null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_UVDelta});var h3d_shader_VertexColorAlpha=function(){hxsl_Shader.call(this)};$hxClasses["h3d.shader.VertexColorAlpha"]=h3d_shader_VertexColorAlpha,h3d_shader_VertexColorAlpha.__name__="h3d.shader.VertexColorAlpha",h3d_shader_VertexColorAlpha.__super__=hxsl_Shader,h3d_shader_VertexColorAlpha.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.additive__&&(this.constBits|=1),this.updateConstantsFinal(globals)},getParamValue:function(index){return 0==index?this.additive__:null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_VertexColorAlpha});var h3d_shader_VolumeDecal=function(objectWidth,objectHeight){var z,_this,x,y;this.isCentered__=!0,this.tangent__=new h3d_Vector,this.normal__=new h3d_Vector,this.scale__=new h3d_Vector,hxsl_Shader.call(this),null==(z=1)&&(z=0),null==(y=0)&&(y=0),null==(x=0)&&(x=0),(_this=this.normal__).x=x,_this.y=y,_this.z=z,_this.w=1,null==(z=0)&&(z=0),null==(y=0)&&(y=0),null==(x=1)&&(x=0),(_this=this.tangent__).x=x,_this.y=y,_this.z=z,_this.w=1,null==(y=1/objectHeight)&&(y=0),null==(x=1/objectWidth)&&(x=0),(_this=this.scale__).x=x,_this.y=y,_this.z=0,_this.w=1};$hxClasses["h3d.shader.VolumeDecal"]=h3d_shader_VolumeDecal,h3d_shader_VolumeDecal.__name__="h3d.shader.VolumeDecal",h3d_shader_VolumeDecal.__super__=hxsl_Shader,h3d_shader_VolumeDecal.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0,this.isCentered__&&(this.constBits|=64),this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.scale__;case 1:return this.normal__;case 2:return this.tangent__;case 3:return this.isCentered__}return null},getParamFloatValue:function(index){return 0},__class__:h3d_shader_VolumeDecal});var haxe_StackItem=$hxEnums["haxe.StackItem"]={__ename__:"haxe.StackItem",__constructs__:["CFunction","Module","FilePos","Method","LocalFunction"],CFunction:{_hx_index:0,__enum__:"haxe.StackItem",toString:$estr},Module:($_=function(m){return{_hx_index:1,m:m,__enum__:"haxe.StackItem",toString:$estr}},$_.__params__=["m"],$_),FilePos:($_=function(s,file,line,column){return{_hx_index:2,s:s,file:file,line:line,column:column,__enum__:"haxe.StackItem",toString:$estr}},$_.__params__=["s","file","line","column"],$_),Method:($_=function(classname,method){return{_hx_index:3,classname:classname,method:method,__enum__:"haxe.StackItem",toString:$estr}},$_.__params__=["classname","method"],$_),LocalFunction:($_=function(v){return{_hx_index:4,v:v,__enum__:"haxe.StackItem",toString:$estr}},$_.__params__=["v"],$_)};haxe_StackItem.__empty_constructs__=[haxe_StackItem.CFunction];var haxe_CallStack={callStack:function(){return haxe_NativeStackTrace.toHaxe(haxe_NativeStackTrace.callStack())}},haxe_IMap=function(){};$hxClasses["haxe.IMap"]=haxe_IMap,haxe_IMap.__name__="haxe.IMap",haxe_IMap.__isInterface__=!0;var haxe_EntryPoint=function(){};$hxClasses["haxe.EntryPoint"]=haxe_EntryPoint,haxe_EntryPoint.__name__="haxe.EntryPoint",haxe_EntryPoint.processEvents=function(){for(;;){var f=haxe_EntryPoint.pending.shift();if(null==f)break;f()}var time=haxe_MainLoop.tick();return haxe_MainLoop.hasEvents()||0!=haxe_EntryPoint.threadCount?time:-1},haxe_EntryPoint.run=function(){var nextTick=haxe_EntryPoint.processEvents();if("undefined"!=typeof window){var $window=window,rqf=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame||$window.mozRequestAnimationFrame;null!=rqf?rqf(haxe_EntryPoint.run):nextTick>=0&&setTimeout(haxe_EntryPoint.run,1e3*nextTick)}else nextTick>=0&&setTimeout(haxe_EntryPoint.run,1e3*nextTick)};var haxe_Exception=function(message,previous,native){Error.call(this,message),this.message=message,this.__previousException=previous,this.__nativeException=null!=native?native:this};$hxClasses["haxe.Exception"]=haxe_Exception,haxe_Exception.__name__="haxe.Exception",haxe_Exception.caught=function(value){return value instanceof haxe_Exception?value:value instanceof Error?new haxe_Exception(value.message,null,value):new haxe_ValueException(value,null,value)},haxe_Exception.thrown=function(value){return value instanceof haxe_Exception?value.get_native():value instanceof Error?value:new haxe_ValueException(value)},haxe_Exception.__super__=Error,haxe_Exception.prototype=$extend(Error.prototype,{unwrap:function(){return this.__nativeException},get_native:function(){return this.__nativeException},__class__:haxe_Exception});var haxe_Int32={},haxe__$Int64__$_$_$Int64=function(){};$hxClasses["haxe._Int64.___Int64"]=haxe__$Int64__$_$_$Int64,haxe__$Int64__$_$_$Int64.__name__="haxe._Int64.___Int64";var haxe_Log=function(){};$hxClasses["haxe.Log"]=haxe_Log,haxe_Log.__name__="haxe.Log",haxe_Log.formatOutput=function(v,infos){var str=Std.string(v);if(null==infos)return str;var pstr=infos.fileName+":"+infos.lineNumber;if(null!=infos.customParams)for(var _g=0,_g1=infos.customParams;_g<_g1.length;){v=_g1[_g];++_g,str+=", "+Std.string(v)}return pstr+": "+str},haxe_Log.trace=function(v,infos){var str=haxe_Log.formatOutput(v,infos);"undefined"!=typeof console&&null!=console.log&&console.log(str)};var haxe_MainEvent=function(f,p){this.isBlocking=!0,this.f=f,this.priority=p,this.nextRun=-1/0};$hxClasses["haxe.MainEvent"]=haxe_MainEvent,haxe_MainEvent.__name__="haxe.MainEvent",haxe_MainEvent.prototype={stop:function(){null!=this.f&&(this.f=null,this.nextRun=-1/0,null==this.prev?haxe_MainLoop.pending=this.next:this.prev.next=this.next,null!=this.next&&(this.next.prev=this.prev))},__class__:haxe_MainEvent};var haxe_MainLoop=function(){};$hxClasses["haxe.MainLoop"]=haxe_MainLoop,haxe_MainLoop.__name__="haxe.MainLoop",haxe_MainLoop.hasEvents=function(){for(var p=haxe_MainLoop.pending;null!=p;){if(p.isBlocking)return!0;p=p.next}return!1},haxe_MainLoop.add=function(f,priority){if(null==priority&&(priority=0),null==f)throw haxe_Exception.thrown("Event function is null");var e=new haxe_MainEvent(f,priority),head=haxe_MainLoop.pending;return null!=head&&(head.prev=e),e.next=head,haxe_MainLoop.pending=e,e},haxe_MainLoop.sortEvents=function(){var list=haxe_MainLoop.pending;if(null!=list){for(var nmerges,p,q,e,tail,insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(var _g=0,_g1=insize;_g<_g1;){_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||p.priority>q.priority||p.priority==q.priority&&p.nextRun<=q.nextRun?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,e.prev=tail,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}list.prev=null,haxe_MainLoop.pending=list}},haxe_MainLoop.tick=function(){haxe_MainLoop.sortEvents();for(var e=haxe_MainLoop.pending,now=HxOverrides.now()/1e3,wait=1e9;null!=e;){var next=e.next,wt=e.nextRun-now;wt<=0?(wait=0,null!=e.f&&e.f()):wait>wt&&(wait=wt),e=next}return wait};var haxe_NativeStackTrace=function(){};$hxClasses["haxe.NativeStackTrace"]=haxe_NativeStackTrace,haxe_NativeStackTrace.__name__="haxe.NativeStackTrace",haxe_NativeStackTrace.callStack=function(){var e=new Error(""),stack=haxe_NativeStackTrace.tryHaxeStack(e);if(void 0===stack){try{throw e}catch(_g){}stack=e.stack}return haxe_NativeStackTrace.normalize(stack,2)},haxe_NativeStackTrace.toHaxe=function(s,skip){if(null==skip&&(skip=0),null==s)return[];if("string"==typeof s){var stack=s.split("\n");"Error"==stack[0]&&stack.shift();for(var m=[],_g=0,_g1=stack.length;_g<_g1;){var i=_g++;if(!(skip>i)){var line=stack[i],matched=line.match(/^    at ([A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=matched){var path=matched[1].split(".");"$hxClasses"==path[0]&&path.shift();var meth=path.pop(),file=matched[2],line1=Std.parseInt(matched[3]),column=Std.parseInt(matched[4]);m.push(haxe_StackItem.FilePos("Anonymous function"==meth?haxe_StackItem.LocalFunction():"Global code"==meth?null:haxe_StackItem.Method(path.join("."),meth),file,line1,column))}else m.push(haxe_StackItem.Module(StringTools.trim(line)))}}return m}return skip>0&&Array.isArray(s)?s.slice(skip):s},haxe_NativeStackTrace.tryHaxeStack=function(e){if(null==e)return[];var oldValue=Error.prepareStackTrace;Error.prepareStackTrace=haxe_NativeStackTrace.prepareHxStackTrace;var stack=e.stack;return Error.prepareStackTrace=oldValue,stack},haxe_NativeStackTrace.prepareHxStackTrace=function(e,callsites){for(var stack=[],_g=0;_g<callsites.length;){var site=callsites[_g];++_g,null!=haxe_NativeStackTrace.wrapCallSite&&(site=haxe_NativeStackTrace.wrapCallSite(site));var method=null,fullName=site.getFunctionName();if(null!=fullName){var idx=fullName.lastIndexOf(".");if(idx>=0){var className=fullName.substring(0,idx),methodName=fullName.substring(idx+1);method=haxe_StackItem.Method(className,methodName)}else method=haxe_StackItem.Method(null,fullName)}var fileName=site.getFileName(),fileAddr=null==fileName?-1:fileName.indexOf("file:");null!=haxe_NativeStackTrace.wrapCallSite&&fileAddr>0&&(fileName=fileName.substring(fileAddr+6)),stack.push(haxe_StackItem.FilePos(method,fileName,site.getLineNumber(),site.getColumnNumber()))}return stack},haxe_NativeStackTrace.normalize=function(stack,skipItems){if(null==skipItems&&(skipItems=0),Array.isArray(stack)&&skipItems>0)return stack.slice(skipItems);if("string"==typeof stack){switch(stack.substring(0,6)){case"Error\n":case"Error:":++skipItems}return haxe_NativeStackTrace.skipLines(stack,skipItems)}return stack},haxe_NativeStackTrace.skipLines=function(stack,skip,pos){return null==pos&&(pos=0),skip>0?(pos=stack.indexOf("\n",pos))<0?"":haxe_NativeStackTrace.skipLines(stack,--skip,pos+1):stack.substring(pos)};var haxe_Resource=function(){};$hxClasses["haxe.Resource"]=haxe_Resource,haxe_Resource.__name__="haxe.Resource",haxe_Resource.getBytes=function(name){for(var _g=0,_g1=haxe_Resource.content;_g<_g1.length;){var x=_g1[_g];if(++_g,x.name==name)return null!=x.str?haxe_io_Bytes.ofString(x.str):haxe_crypto_Base64.decode(x.data)}return null};var haxe_Serializer=function(){this.buf=new StringBuf,this.cache=[],this.useCache=haxe_Serializer.USE_CACHE,this.useEnumIndex=haxe_Serializer.USE_ENUM_INDEX,this.shash=new haxe_ds_StringMap,this.scount=0};$hxClasses["haxe.Serializer"]=haxe_Serializer,haxe_Serializer.__name__="haxe.Serializer",haxe_Serializer.prototype={toString:function(){return this.buf.b},serializeString:function(s){var x=this.shash.h[s];if(null!=x)return this.buf.b+="R",void(this.buf.b+=null==x?"null":""+x);this.shash.h[s]=this.scount++,this.buf.b+="y",s=encodeURIComponent(s),this.buf.b+=Std.string(s.length),this.buf.b+=":",this.buf.b+=null==s?"null":""+s},serializeRef:function(v){for(var vt=typeof v,_g=0,_g1=this.cache.length;_g<_g1;){var i=_g++,ci=this.cache[i];if(typeof ci==vt&&ci==v)return this.buf.b+="r",this.buf.b+=null==i?"null":""+i,!0}return this.cache.push(v),!1},serializeFields:function(v){for(var _g=0,_g1=Reflect.fields(v);_g<_g1.length;){var f=_g1[_g];++_g,this.serializeString(f),this.serialize(Reflect.field(v,f))}this.buf.b+="g"},serialize:function(v){switch((_g=Type.typeof(v))._hx_index){case 0:this.buf.b+="n";break;case 1:if(0==(v1=v))return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==v1?"null":""+v1;break;case 2:var v1=v;isNaN(v1)?this.buf.b+="k":isFinite(v1)?(this.buf.b+="d",this.buf.b+=null==v1?"null":""+v1):this.buf.b+=v1<0?"m":"p";break;case 3:this.buf.b+=v?"t":"f";break;case 4:if(js_Boot.__instanceof(v,Class)){var className=v.__name__;this.buf.b+="A",this.serializeString(className)}else if(js_Boot.__instanceof(v,Enum))this.buf.b+="B",this.serializeString(v.__ename__);else{if(this.useCache&&this.serializeRef(v))return;this.buf.b+="o",this.serializeFields(v)}break;case 5:throw haxe_Exception.thrown("Cannot serialize function");case 6:var c=_g.c;if(c==String)return void this.serializeString(v);if(this.useCache&&this.serializeRef(v))return;switch(c){case Array:var ucount=0;this.buf.b+="a";for(var _g1=0,_g2=v.length;_g1<_g2;){null==v[i=_g1++]?++ucount:(ucount>0&&(1==ucount?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==ucount?"null":""+ucount),ucount=0),this.serialize(v[i]))}ucount>0&&(1==ucount?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==ucount?"null":""+ucount)),this.buf.b+="h";break;case Date:var d=v;this.buf.b+="v",this.buf.b+=Std.string(d.getTime());break;case haxe_ds_IntMap:this.buf.b+="q";for(var k=(v1=v).keys();k.hasNext();){var k1=k.next();this.buf.b+=":",this.buf.b+=null==k1?"null":""+k1,this.serialize(v1.h[k1])}this.buf.b+="h";break;case haxe_ds_List:this.buf.b+="l";for(var _g_head=(v1=v).h;null!=_g_head;){var val=_g_head.item;_g_head=_g_head.next;var i=val;this.serialize(i)}this.buf.b+="h";break;case haxe_ds_ObjectMap:this.buf.b+="M";for(k=(v1=v).keys();k.hasNext();){k1=k.next();var id=Reflect.field(k1,"__id__");Reflect.deleteField(k1,"__id__"),this.serialize(k1),k1.__id__=id,this.serialize(v1.h[k1.__id__])}this.buf.b+="h";break;case haxe_ds_StringMap:this.buf.b+="b";for(v1=v,k=haxe_ds_StringMap.keysIterator(v1.h);k.hasNext();){k1=k.next();this.serializeString(k1),this.serialize(v1.h[k1])}this.buf.b+="h";break;case haxe_io_Bytes:v1=v;this.buf.b+="s",this.buf.b+=Std.string(Math.ceil(8*v1.length/6)),this.buf.b+=":";i=0;var max=v1.length-2,b64=haxe_Serializer.BASE64_CODES;if(null==b64){b64=new Array(haxe_Serializer.BASE64.length);for(_g1=0,_g2=haxe_Serializer.BASE64.length;_g1<_g2;){var i1=_g1++;b64[i1]=HxOverrides.cca(haxe_Serializer.BASE64,i1)}haxe_Serializer.BASE64_CODES=b64}for(;i<max;){var b1=v1.b[i++],b2=v1.b[i++],b3=v1.b[i++];this.buf.b+=String.fromCodePoint(b64[b1>>2]),this.buf.b+=String.fromCodePoint(b64[63&(b1<<4|b2>>4)]),this.buf.b+=String.fromCodePoint(b64[63&(b2<<2|b3>>6)]),this.buf.b+=String.fromCodePoint(b64[63&b3])}if(i==max){b1=v1.b[i++],b2=v1.b[i++];this.buf.b+=String.fromCodePoint(b64[b1>>2]),this.buf.b+=String.fromCodePoint(b64[63&(b1<<4|b2>>4)]),this.buf.b+=String.fromCodePoint(b64[b2<<2&63])}else if(i==max+1){b1=v1.b[i++];this.buf.b+=String.fromCodePoint(b64[b1>>2]),this.buf.b+=String.fromCodePoint(b64[b1<<4&63])}break;default:this.useCache&&this.cache.pop(),null!=v.hxSerialize?(this.buf.b+="C",this.serializeString(c.__name__),this.useCache&&this.cache.push(v),v.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(c.__name__),this.useCache&&this.cache.push(v),this.serializeFields(v))}break;case 7:var e=_g.e;if(this.useCache){if(this.serializeRef(v))return;this.cache.pop()}if(this.buf.b+=Std.string(this.useEnumIndex?"j":"w"),this.serializeString(e.__ename__),this.useEnumIndex)this.buf.b+=":",this.buf.b+=Std.string(v._hx_index);else{e=v;this.serializeString($hxEnums[e.__enum__].__constructs__[e._hx_index])}this.buf.b+=":";var params=Type.enumParameters(v);this.buf.b+=Std.string(params.length);for(var _g=0;_g<params.length;){var p=params[_g];++_g,this.serialize(p)}this.useCache&&this.cache.push(v);break;default:throw haxe_Exception.thrown("Cannot serialize "+Std.string(v))}},__class__:haxe_Serializer};var haxe_Timer=function(time_ms){var me=this;this.id=setInterval((function(){me.run()}),time_ms)};$hxClasses["haxe.Timer"]=haxe_Timer,haxe_Timer.__name__="haxe.Timer",haxe_Timer.delay=function(f,time_ms){var t=new haxe_Timer(time_ms);return t.run=function(){t.stop(),f()},t},haxe_Timer.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:haxe_Timer};var haxe__$Unserializer_DefaultResolver=function(){};$hxClasses["haxe._Unserializer.DefaultResolver"]=haxe__$Unserializer_DefaultResolver,haxe__$Unserializer_DefaultResolver.__name__="haxe._Unserializer.DefaultResolver",haxe__$Unserializer_DefaultResolver.prototype={resolveClass:function(name){return $hxClasses[name]},resolveEnum:function(name){return $hxEnums[name]},__class__:haxe__$Unserializer_DefaultResolver};var haxe_Unserializer=function(buf){this.buf=buf,this.length=buf.length,this.pos=0,this.scache=[],this.cache=[];var r=haxe_Unserializer.DEFAULT_RESOLVER;null==r&&(r=new haxe__$Unserializer_DefaultResolver,haxe_Unserializer.DEFAULT_RESOLVER=r),this.resolver=r};$hxClasses["haxe.Unserializer"]=haxe_Unserializer,haxe_Unserializer.__name__="haxe.Unserializer",haxe_Unserializer.initCodes=function(){for(var codes=[],_g=0,_g1=haxe_Unserializer.BASE64.length;_g<_g1;){var i=_g++;codes[haxe_Unserializer.BASE64.charCodeAt(i)]=i}return codes},haxe_Unserializer.run=function(v){return new haxe_Unserializer(v).unserialize()},haxe_Unserializer.prototype={readDigits:function(){for(var k=0,s=!1,fpos=this.pos;;){var c=this.buf.charCodeAt(this.pos);if(c!=c)break;if(45!=c){if(c<48||c>57)break;k=10*k+(c-48),this.pos++}else{if(this.pos!=fpos)break;s=!0,this.pos++}}return s&&(k*=-1),k},readFloat:function(){for(var p1=this.pos;;){var c=this.buf.charCodeAt(this.pos);if(c!=c)break;if(!(c>=43&&c<58||101==c||69==c))break;this.pos++}return parseFloat(HxOverrides.substr(this.buf,p1,this.pos-p1))},unserializeObject:function(o){for(;;){if(this.pos>=this.length)throw haxe_Exception.thrown("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var k=this.unserialize();if("string"!=typeof k)throw haxe_Exception.thrown("Invalid object key");var v=this.unserialize();o[k]=v}this.pos++},unserializeEnum:function(edecl,tag){if(58!=this.buf.charCodeAt(this.pos++))throw haxe_Exception.thrown("Invalid enum format");var nargs=this.readDigits();if(0==nargs)return Type.createEnum(edecl,tag);for(var args=[];nargs-- >0;)args.push(this.unserialize());return Type.createEnum(edecl,tag,args)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var name=this.unserialize();if(null==(cl=this.resolver.resolveClass(name)))throw haxe_Exception.thrown("Class not found "+name);return cl;case 66:name=this.unserialize();if(null==(e=this.resolver.resolveEnum(name)))throw haxe_Exception.thrown("Enum not found "+name);return e;case 67:name=this.unserialize();if(null==(cl=this.resolver.resolveClass(name)))throw haxe_Exception.thrown("Class not found "+name);var o=Object.create(cl.prototype);if(this.cache.push(o),o.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw haxe_Exception.thrown("Invalid custom data");return o;case 77:var h=new haxe_ds_ObjectMap;this.cache.push(h);for(var buf=this.buf;104!=this.buf.charCodeAt(this.pos);){var s=this.unserialize();h.set(s,this.unserialize())}return this.pos++,h;case 82:if((n=this.readDigits())<0||n>=this.scache.length)throw haxe_Exception.thrown("Invalid string reference");return this.scache[n];case 97:buf=this.buf;var a=[];for(this.cache.push(a);;){if(104==(c=this.buf.charCodeAt(this.pos))){this.pos++;break}if(117==c){this.pos++;var n=this.readDigits();a[a.length+n-1]=null}else a.push(this.unserialize())}return a;case 98:h=new haxe_ds_StringMap;this.cache.push(h);for(buf=this.buf;104!=this.buf.charCodeAt(this.pos);){s=this.unserialize();var value=this.unserialize();h.h[s]=value}return this.pos++,h;case 99:var cl;name=this.unserialize();if(null==(cl=this.resolver.resolveClass(name)))throw haxe_Exception.thrown("Class not found "+name);o=Object.create(cl.prototype);return this.cache.push(o),this.unserializeObject(o),o;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:name=this.unserialize();if(null==(edecl=this.resolver.resolveEnum(name)))throw haxe_Exception.thrown("Enum not found "+name);this.pos++;var index=this.readDigits(),tag=edecl.__constructs__.slice()[index];if(null==tag)throw haxe_Exception.thrown("Unknown enum index "+name+"@"+index);var e=this.unserializeEnum(edecl,tag);return this.cache.push(e),e;case 107:return NaN;case 108:var l=new haxe_ds_List;this.cache.push(l);for(buf=this.buf;104!=this.buf.charCodeAt(this.pos);)l.add(this.unserialize());return this.pos++,l;case 109:return-1/0;case 110:return null;case 111:o={};return this.cache.push(o),this.unserializeObject(o),o;case 112:return 1/0;case 113:h=new haxe_ds_IntMap;this.cache.push(h);buf=this.buf;for(var c=this.buf.charCodeAt(this.pos++);58==c;){var i=this.readDigits();value=this.unserialize();h.h[i]=value,c=this.buf.charCodeAt(this.pos++)}if(104!=c)throw haxe_Exception.thrown("Invalid IntMap format");return h;case 114:if((n=this.readDigits())<0||n>=this.cache.length)throw haxe_Exception.thrown("Invalid reference");return this.cache[n];case 115:var len=this.readDigits();buf=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<len)throw haxe_Exception.thrown("Invalid bytes length");var codes=haxe_Unserializer.CODES;null==codes&&(codes=haxe_Unserializer.initCodes(),haxe_Unserializer.CODES=codes);for(var rest=3&len,max=(i=this.pos)+(len-rest),bytes=new haxe_io_Bytes(new ArrayBuffer(3*(len>>2)+(rest>=2?rest-1:0))),bpos=0;i<max;){var c1=codes[buf.charCodeAt(i++)],c2=codes[buf.charCodeAt(i++)];bytes.b[bpos++]=c1<<2|c2>>4;var c3=codes[buf.charCodeAt(i++)];bytes.b[bpos++]=c2<<4|c3>>2;var c4=codes[buf.charCodeAt(i++)];bytes.b[bpos++]=c3<<6|c4}if(rest>=2){c1=codes[buf.charCodeAt(i++)],c2=codes[buf.charCodeAt(i++)];if(bytes.b[bpos++]=c1<<2|c2>>4,3==rest){c3=codes[buf.charCodeAt(i++)];bytes.b[bpos++]=c2<<4|c3>>2}}return this.pos+=len,this.cache.push(bytes),bytes;case 116:return!0;case 118:var d;return this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(d=HxOverrides.strDate(HxOverrides.substr(this.buf,this.pos,19)),this.pos+=19):d=new Date(this.readFloat()),this.cache.push(d),d;case 119:var edecl;name=this.unserialize();if(null==(edecl=this.resolver.resolveEnum(name)))throw haxe_Exception.thrown("Enum not found "+name);e=this.unserializeEnum(edecl,this.unserialize());return this.cache.push(e),e;case 120:throw haxe_Exception.thrown(this.unserialize());case 121:len=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<len)throw haxe_Exception.thrown("Invalid string length");s=HxOverrides.substr(this.buf,this.pos,len);return this.pos+=len,s=decodeURIComponent(s.split("+").join(" ")),this.scache.push(s),s;case 122:return 0}throw this.pos--,haxe_Exception.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:haxe_Unserializer};var haxe_ValueException=function(value,previous,native){haxe_Exception.call(this,String(value),previous,native),this.value=value};$hxClasses["haxe.ValueException"]=haxe_ValueException,haxe_ValueException.__name__="haxe.ValueException",haxe_ValueException.__super__=haxe_Exception,haxe_ValueException.prototype=$extend(haxe_Exception.prototype,{unwrap:function(){return this.value},__class__:haxe_ValueException});var haxe_crypto_Adler32=function(){this.a1=1,this.a2=0};$hxClasses["haxe.crypto.Adler32"]=haxe_crypto_Adler32,haxe_crypto_Adler32.__name__="haxe.crypto.Adler32",haxe_crypto_Adler32.read=function(i){var a=new haxe_crypto_Adler32,a2a=i.readByte(),a2b=i.readByte(),a1a=i.readByte(),a1b=i.readByte();return a.a1=a1a<<8|a1b,a.a2=a2a<<8|a2b,a},haxe_crypto_Adler32.prototype={update:function(b,pos,len){for(var a1=this.a1,a2=this.a2,_g=pos,_g1=pos+len;_g<_g1;){var p=_g++;a2=(a2+(a1=(a1+b.b[p])%65521))%65521}this.a1=a1,this.a2=a2},equals:function(a){return a.a1==this.a1&&a.a2==this.a2},__class__:haxe_crypto_Adler32};var haxe_io_Bytes=function(data){this.length=data.byteLength,this.b=new Uint8Array(data),this.b.bufferValue=data,data.hxBytes=this,data.bytes=this.b};$hxClasses["haxe.io.Bytes"]=haxe_io_Bytes,haxe_io_Bytes.__name__="haxe.io.Bytes",haxe_io_Bytes.ofString=function(s,encoding){if(encoding==haxe_io_Encoding.RawNative){for(var buf=new Uint8Array(s.length<<1),_g=0,_g1=s.length;_g<_g1;){var i=_g++,c=s.charCodeAt(i);buf[i<<1]=255&c,buf[i<<1|1]=c>>8}return new haxe_io_Bytes(buf.buffer)}var a=[];for(i=0;i<s.length;){55296<=(c=s.charCodeAt(i++))&&c<=56319&&(c=c-55232<<10|1023&s.charCodeAt(i++)),c<=127?a.push(c):c<=2047?(a.push(192|c>>6),a.push(128|63&c)):c<=65535?(a.push(224|c>>12),a.push(128|c>>6&63),a.push(128|63&c)):(a.push(240|c>>18),a.push(128|c>>12&63),a.push(128|c>>6&63),a.push(128|63&c))}return new haxe_io_Bytes(new Uint8Array(a).buffer)},haxe_io_Bytes.ofData=function(b){var hb=b.hxBytes;return null!=hb?hb:new haxe_io_Bytes(b)},haxe_io_Bytes.prototype={blit:function(pos,src,srcpos,len){if(pos<0||srcpos<0||len<0||pos+len>this.length||srcpos+len>src.length)throw haxe_Exception.thrown(haxe_io_Error.OutsideBounds);0==srcpos&&len==src.b.byteLength?this.b.set(src.b,pos):this.b.set(src.b.subarray(srcpos,srcpos+len),pos)},fill:function(pos,len,value){for(var _g=0,_g1=len;_g<_g1;){_g++;this.b[pos++]=value}},getDouble:function(pos){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(pos,!0)},getFloat:function(pos){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(pos,!0)},setDouble:function(pos,v){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(pos,v,!0)},setFloat:function(pos,v){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(pos,v,!0)},getUInt16:function(pos){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(pos,!0)},setUInt16:function(pos,v){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setUint16(pos,v,!0)},getInt32:function(pos){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(pos,!0)},setInt32:function(pos,v){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(pos,v,!0)},getString:function(pos,len,encoding){if(pos<0||len<0||pos+len>this.length)throw haxe_Exception.thrown(haxe_io_Error.OutsideBounds);null==encoding&&(encoding=haxe_io_Encoding.UTF8);var s="",b=this.b,i=pos,max=pos+len;switch(encoding._hx_index){case 0:for(;i<max;){if((c=b[i++])<128){if(0==c)break;s+=String.fromCodePoint(c)}else if(c<224){var code=(63&c)<<6|127&b[i++];s+=String.fromCodePoint(code)}else if(c<240){var code1=(31&c)<<12|(127&b[i++])<<6|127&b[i++];s+=String.fromCodePoint(code1)}else{var u=(15&c)<<18|(127&b[i++])<<12|(127&b[i++])<<6|127&b[i++];s+=String.fromCodePoint(u)}}break;case 1:for(;i<max;){var c=b[i++]|b[i++]<<8;s+=String.fromCodePoint(c)}}return s},toString:function(){return this.getString(0,this.length)},__class__:haxe_io_Bytes};var haxe_io_Encoding=$hxEnums["haxe.io.Encoding"]={__ename__:"haxe.io.Encoding",__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:$estr},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:$estr}};haxe_io_Encoding.__empty_constructs__=[haxe_io_Encoding.UTF8,haxe_io_Encoding.RawNative];var haxe_crypto_Base64=function(){};$hxClasses["haxe.crypto.Base64"]=haxe_crypto_Base64,haxe_crypto_Base64.__name__="haxe.crypto.Base64",haxe_crypto_Base64.decode=function(str,complement){if(null==complement&&(complement=!0),complement)for(;61==HxOverrides.cca(str,str.length-1);)str=HxOverrides.substr(str,0,-1);return new haxe_crypto_BaseCode(haxe_crypto_Base64.BYTES).decodeBytes(haxe_io_Bytes.ofString(str))};var haxe_crypto_BaseCode=function(base){for(var len=base.length,nbits=1;len>1<<nbits;)++nbits;if(nbits>8||len!=1<<nbits)throw haxe_Exception.thrown("BaseCode : base length must be a power of two.");this.base=base,this.nbits=nbits};$hxClasses["haxe.crypto.BaseCode"]=haxe_crypto_BaseCode,haxe_crypto_BaseCode.__name__="haxe.crypto.BaseCode",haxe_crypto_BaseCode.prototype={initTable:function(){for(var tbl=[],_g=0;_g<256;){tbl[i=_g++]=-1}_g=0;for(var _g1=this.base.length;_g<_g1;){var i=_g++;tbl[this.base.b[i]]=i}this.tbl=tbl},decodeBytes:function(b){var nbits=this.nbits;this.base;null==this.tbl&&this.initTable();for(var tbl=this.tbl,size=b.length*nbits>>3,out=new haxe_io_Bytes(new ArrayBuffer(size)),buf=0,curbits=0,pin=0,pout=0;pout<size;){for(;curbits<8;){curbits+=nbits,buf<<=nbits;var i=tbl[b.b[pin++]];if(-1==i)throw haxe_Exception.thrown("BaseCode : invalid encoded char");buf|=i}curbits-=8,out.b[pout++]=buf>>curbits&255}return out},__class__:haxe_crypto_BaseCode};var haxe_crypto_Md5=function(){};$hxClasses["haxe.crypto.Md5"]=haxe_crypto_Md5,haxe_crypto_Md5.__name__="haxe.crypto.Md5",haxe_crypto_Md5.encode=function(s){var m=new haxe_crypto_Md5,h=m.doEncode(haxe_crypto_Md5.str2blks(s));return m.hex(h)},haxe_crypto_Md5.str2blks=function(str){for(var str1=haxe_io_Bytes.ofString(str),nblk=1+(str1.length+8>>6),blks=[],_g=0,_g1=16*nblk;_g<_g1;){blks[i=_g++]=0}for(var i=0,max=str1.length,l=8*max;i<max;)blks[i>>2]|=str1.b[i]<<(l+i)%4*8,++i;blks[i>>2]|=128<<(l+i)%4*8;var k=16*nblk-2;return blks[k]=255&l,blks[k]|=(l>>>8&255)<<8,blks[k]|=(l>>>16&255)<<16,blks[k]|=(l>>>24&255)<<24,blks},haxe_crypto_Md5.prototype={bitOR:function(a,b){return(a>>>1|b>>>1)<<1|(1&a|1&b)},bitXOR:function(a,b){return(a>>>1^b>>>1)<<1|1&a^1&b},bitAND:function(a,b){return(a>>>1&b>>>1)<<1|1&a&b},addme:function(x,y){var lsw=(65535&x)+(65535&y);return(x>>16)+(y>>16)+(lsw>>16)<<16|65535&lsw},hex:function(a){for(var str="",hex_chr="0123456789abcdef",_g=0;_g<a.length;){var num=a[_g];++_g,str+=hex_chr.charAt(num>>4&15)+hex_chr.charAt(15&num),str+=hex_chr.charAt(num>>12&15)+hex_chr.charAt(num>>8&15),str+=hex_chr.charAt(num>>20&15)+hex_chr.charAt(num>>16&15),str+=hex_chr.charAt(num>>28&15)+hex_chr.charAt(num>>24&15)}return str},rol:function(num,cnt){return num<<cnt|num>>>32-cnt},cmn:function(q,a,b,x,s,t){return this.addme(this.rol(this.addme(this.addme(a,q),this.addme(x,t)),s),b)},ff:function(a,b,c,d,x,s,t){return this.cmn(this.bitOR(this.bitAND(b,c),this.bitAND(~b,d)),a,b,x,s,t)},gg:function(a,b,c,d,x,s,t){return this.cmn(this.bitOR(this.bitAND(b,d),this.bitAND(c,~d)),a,b,x,s,t)},hh:function(a,b,c,d,x,s,t){return this.cmn(this.bitXOR(this.bitXOR(b,c),d),a,b,x,s,t)},ii:function(a,b,c,d,x,s,t){return this.cmn(this.bitXOR(c,this.bitOR(b,~d)),a,b,x,s,t)},doEncode:function(x){for(var a=1732584193,b=-271733879,c=-1732584194,d=271733878,i=0;i<x.length;){var olda=a,oldb=b,oldc=c,oldd=d;0,a=this.ff(a,b,c,d,x[i],7,-680876936),d=this.ff(d,a,b,c,x[i+1],12,-389564586),c=this.ff(c,d,a,b,x[i+2],17,606105819),b=this.ff(b,c,d,a,x[i+3],22,-1044525330),a=this.ff(a,b,c,d,x[i+4],7,-176418897),d=this.ff(d,a,b,c,x[i+5],12,1200080426),c=this.ff(c,d,a,b,x[i+6],17,-1473231341),b=this.ff(b,c,d,a,x[i+7],22,-45705983),a=this.ff(a,b,c,d,x[i+8],7,1770035416),d=this.ff(d,a,b,c,x[i+9],12,-1958414417),c=this.ff(c,d,a,b,x[i+10],17,-42063),b=this.ff(b,c,d,a,x[i+11],22,-1990404162),a=this.ff(a,b,c,d,x[i+12],7,1804603682),d=this.ff(d,a,b,c,x[i+13],12,-40341101),c=this.ff(c,d,a,b,x[i+14],17,-1502002290),b=this.ff(b,c,d,a,x[i+15],22,1236535329),a=this.gg(a,b,c,d,x[i+1],5,-165796510),d=this.gg(d,a,b,c,x[i+6],9,-1069501632),c=this.gg(c,d,a,b,x[i+11],14,643717713),b=this.gg(b,c,d,a,x[i],20,-373897302),a=this.gg(a,b,c,d,x[i+5],5,-701558691),d=this.gg(d,a,b,c,x[i+10],9,38016083),c=this.gg(c,d,a,b,x[i+15],14,-660478335),b=this.gg(b,c,d,a,x[i+4],20,-405537848),a=this.gg(a,b,c,d,x[i+9],5,568446438),d=this.gg(d,a,b,c,x[i+14],9,-1019803690),c=this.gg(c,d,a,b,x[i+3],14,-187363961),b=this.gg(b,c,d,a,x[i+8],20,1163531501),a=this.gg(a,b,c,d,x[i+13],5,-1444681467),d=this.gg(d,a,b,c,x[i+2],9,-51403784),c=this.gg(c,d,a,b,x[i+7],14,1735328473),b=this.gg(b,c,d,a,x[i+12],20,-1926607734),a=this.hh(a,b,c,d,x[i+5],4,-378558),d=this.hh(d,a,b,c,x[i+8],11,-2022574463),c=this.hh(c,d,a,b,x[i+11],16,1839030562),b=this.hh(b,c,d,a,x[i+14],23,-35309556),a=this.hh(a,b,c,d,x[i+1],4,-1530992060),d=this.hh(d,a,b,c,x[i+4],11,1272893353),c=this.hh(c,d,a,b,x[i+7],16,-155497632),b=this.hh(b,c,d,a,x[i+10],23,-1094730640),a=this.hh(a,b,c,d,x[i+13],4,681279174),d=this.hh(d,a,b,c,x[i],11,-358537222),c=this.hh(c,d,a,b,x[i+3],16,-722521979),b=this.hh(b,c,d,a,x[i+6],23,76029189),a=this.hh(a,b,c,d,x[i+9],4,-640364487),d=this.hh(d,a,b,c,x[i+12],11,-421815835),c=this.hh(c,d,a,b,x[i+15],16,530742520),b=this.hh(b,c,d,a,x[i+2],23,-995338651),a=this.ii(a,b,c,d,x[i],6,-198630844),d=this.ii(d,a,b,c,x[i+7],10,1126891415),c=this.ii(c,d,a,b,x[i+14],15,-1416354905),b=this.ii(b,c,d,a,x[i+5],21,-57434055),a=this.ii(a,b,c,d,x[i+12],6,1700485571),d=this.ii(d,a,b,c,x[i+3],10,-1894986606),c=this.ii(c,d,a,b,x[i+10],15,-1051523),b=this.ii(b,c,d,a,x[i+1],21,-2054922799),a=this.ii(a,b,c,d,x[i+8],6,1873313359),d=this.ii(d,a,b,c,x[i+15],10,-30611744),c=this.ii(c,d,a,b,x[i+6],15,-1560198380),b=this.ii(b,c,d,a,x[i+13],21,1309151649),a=this.ii(a,b,c,d,x[i+4],6,-145523070),d=this.ii(d,a,b,c,x[i+11],10,-1120210379),c=this.ii(c,d,a,b,x[i+2],15,718787259),b=this.ii(b,c,d,a,x[i+9],21,-343485551),a=this.addme(a,olda),b=this.addme(b,oldb),c=this.addme(c,oldc),d=this.addme(d,oldd),i+=16}return[a,b,c,d]},__class__:haxe_crypto_Md5};var haxe_ds_ArraySort=function(){};$hxClasses["haxe.ds.ArraySort"]=haxe_ds_ArraySort,haxe_ds_ArraySort.__name__="haxe.ds.ArraySort",haxe_ds_ArraySort.sort=function(a,cmp){haxe_ds_ArraySort.rec(a,cmp,0,a.length)},haxe_ds_ArraySort.rec=function(a,cmp,from,to){var middle=from+to>>1;if(to-from<12){if(to<=from)return;for(var _g=from+1,_g1=to;_g<_g1;)for(var j=_g++;j>from&&cmp(a[j],a[j-1])<0;)haxe_ds_ArraySort.swap(a,j-1,j),--j}else haxe_ds_ArraySort.rec(a,cmp,from,middle),haxe_ds_ArraySort.rec(a,cmp,middle,to),haxe_ds_ArraySort.doMerge(a,cmp,from,middle,to,middle-from,to-middle)},haxe_ds_ArraySort.doMerge=function(a,cmp,from,pivot,to,len1,len2){var first_cut,second_cut,len11,len22;if(0!=len1&&0!=len2)if(len1+len2!=2){len1>len2?len22=(second_cut=haxe_ds_ArraySort.lower(a,cmp,pivot,to,first_cut=from+(len11=len1>>1)))-pivot:len11=(first_cut=haxe_ds_ArraySort.upper(a,cmp,from,pivot,second_cut=pivot+(len22=len2>>1)))-from,haxe_ds_ArraySort.rotate(a,cmp,first_cut,pivot,second_cut);var new_mid=first_cut+len22;haxe_ds_ArraySort.doMerge(a,cmp,from,first_cut,new_mid,len11,len22),haxe_ds_ArraySort.doMerge(a,cmp,new_mid,second_cut,to,len1-len11,len2-len22)}else cmp(a[pivot],a[from])<0&&haxe_ds_ArraySort.swap(a,pivot,from)},haxe_ds_ArraySort.rotate=function(a,cmp,from,mid,to){if(from!=mid&&mid!=to)for(var n=haxe_ds_ArraySort.gcd(to-from,mid-from);0!=n--;){for(var val=a[from+n],shift=mid-from,p1=from+n,p2=from+n+shift;p2!=from+n;)a[p1]=a[p2],p1=p2,to-p2>shift?p2+=shift:p2=from+(shift-(to-p2));a[p1]=val}},haxe_ds_ArraySort.gcd=function(m,n){for(;0!=n;){var t=m%n;m=n,n=t}return m},haxe_ds_ArraySort.upper=function(a,cmp,from,to,val){for(var half,mid,len=to-from;len>0;)mid=from+(half=len>>1),cmp(a[val],a[mid])<0?len=half:(from=mid+1,len=len-half-1);return from},haxe_ds_ArraySort.lower=function(a,cmp,from,to,val){for(var half,mid,len=to-from;len>0;)cmp(a[mid=from+(half=len>>1)],a[val])<0?(from=mid+1,len=len-half-1):len=half;return from},haxe_ds_ArraySort.swap=function(a,i,j){var tmp=a[i];a[i]=a[j],a[j]=tmp};var haxe_ds_BalancedTree=function(){};$hxClasses["haxe.ds.BalancedTree"]=haxe_ds_BalancedTree,haxe_ds_BalancedTree.__name__="haxe.ds.BalancedTree",haxe_ds_BalancedTree.__interfaces__=[haxe_IMap],haxe_ds_BalancedTree.iteratorLoop=function(node,acc){null!=node&&(haxe_ds_BalancedTree.iteratorLoop(node.left,acc),acc.push(node.value),haxe_ds_BalancedTree.iteratorLoop(node.right,acc))},haxe_ds_BalancedTree.prototype={set:function(key,value){this.root=this.setLoop(key,value,this.root)},get:function(key){for(var node=this.root;null!=node;){var c=this.compare(key,node.key);if(0==c)return node.value;node=c<0?node.left:node.right}return null},iterator:function(){var ret=[];return haxe_ds_BalancedTree.iteratorLoop(this.root,ret),new haxe_iterators_ArrayIterator(ret)},setLoop:function(k,v,node){if(null==node)return new haxe_ds_TreeNode(null,k,v,null);var c=this.compare(k,node.key);if(0==c)return new haxe_ds_TreeNode(node.left,k,v,node.right,null==node?0:node._height);if(c<0){var nl=this.setLoop(k,v,node.left);return this.balance(nl,node.key,node.value,node.right)}var nr=this.setLoop(k,v,node.right);return this.balance(node.left,node.key,node.value,nr)},balance:function(l,k,v,r){var hl=null==l?0:l._height,hr=null==r?0:r._height;if(hl>hr+2){var _this=l.left,_this1=l.right;return(null==_this?0:_this._height)>=(null==_this1?0:_this1._height)?new haxe_ds_TreeNode(l.left,l.key,l.value,new haxe_ds_TreeNode(l.right,k,v,r)):new haxe_ds_TreeNode(new haxe_ds_TreeNode(l.left,l.key,l.value,l.right.left),l.right.key,l.right.value,new haxe_ds_TreeNode(l.right.right,k,v,r))}if(hr>hl+2){_this=r.right,_this1=r.left;return(null==_this?0:_this._height)>(null==_this1?0:_this1._height)?new haxe_ds_TreeNode(new haxe_ds_TreeNode(l,k,v,r.left),r.key,r.value,r.right):new haxe_ds_TreeNode(new haxe_ds_TreeNode(l,k,v,r.left.left),r.left.key,r.left.value,new haxe_ds_TreeNode(r.left.right,r.key,r.value,r.right))}return new haxe_ds_TreeNode(l,k,v,r,(hl>hr?hl:hr)+1)},compare:function(k1,k2){return Reflect.compare(k1,k2)},__class__:haxe_ds_BalancedTree};var haxe_ds_TreeNode=function(l,k,v,r,h){if(null==h&&(h=-1),this.left=l,this.key=k,this.value=v,this.right=r,-1==h){var tmp,_this=this.left,_this1=this.right;if((null==_this?0:_this._height)>(null==_this1?0:_this1._height))tmp=null==(_this=this.left)?0:_this._height;else tmp=null==(_this=this.right)?0:_this._height;this._height=tmp+1}else this._height=h};$hxClasses["haxe.ds.TreeNode"]=haxe_ds_TreeNode,haxe_ds_TreeNode.__name__="haxe.ds.TreeNode",haxe_ds_TreeNode.prototype={__class__:haxe_ds_TreeNode};var haxe_ds_EnumValueMap=function(){haxe_ds_BalancedTree.call(this)};$hxClasses["haxe.ds.EnumValueMap"]=haxe_ds_EnumValueMap,haxe_ds_EnumValueMap.__name__="haxe.ds.EnumValueMap",haxe_ds_EnumValueMap.__interfaces__=[haxe_IMap],haxe_ds_EnumValueMap.__super__=haxe_ds_BalancedTree,haxe_ds_EnumValueMap.prototype=$extend(haxe_ds_BalancedTree.prototype,{compare:function(k1,k2){var d=k1._hx_index-k2._hx_index;if(0!=d)return d;var p1=Type.enumParameters(k1),p2=Type.enumParameters(k2);return 0==p1.length&&0==p2.length?0:this.compareArgs(p1,p2)},compareArgs:function(a1,a2){var ld=a1.length-a2.length;if(0!=ld)return ld;for(var _g=0,_g1=a1.length;_g<_g1;){var i=_g++,d=this.compareArg(a1[i],a2[i]);if(0!=d)return d}return 0},compareArg:function(v1,v2){return Reflect.isEnumValue(v1)&&Reflect.isEnumValue(v2)?this.compare(v1,v2):v1 instanceof Array&&v2 instanceof Array?this.compareArgs(v1,v2):Reflect.compare(v1,v2)},__class__:haxe_ds_EnumValueMap});var haxe_ds_IntMap=function(){this.h={}};$hxClasses["haxe.ds.IntMap"]=haxe_ds_IntMap,haxe_ds_IntMap.__name__="haxe.ds.IntMap",haxe_ds_IntMap.__interfaces__=[haxe_IMap],haxe_ds_IntMap.prototype={remove:function(key){return!!this.h.hasOwnProperty(key)&&(delete this.h[key],!0)},keys:function(){var a=[];for(var key in this.h)this.h.hasOwnProperty(key)&&a.push(0|key);return new haxe_iterators_ArrayIterator(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var i=this.it.next();return this.ref[i]}}},__class__:haxe_ds_IntMap};var haxe_ds_List=function(){this.length=0};$hxClasses["haxe.ds.List"]=haxe_ds_List,haxe_ds_List.__name__="haxe.ds.List",haxe_ds_List.prototype={add:function(item){var x=new haxe_ds__$List_ListNode(item,null);null==this.h?this.h=x:this.q.next=x,this.q=x,this.length++},push:function(item){var x=new haxe_ds__$List_ListNode(item,this.h);this.h=x,null==this.q&&(this.q=x),this.length++},remove:function(v){for(var prev=null,l=this.h;null!=l;){if(l.item==v)return null==prev?this.h=l.next:prev.next=l.next,this.q==l&&(this.q=prev),this.length--,!0;prev=l,l=l.next}return!1},__class__:haxe_ds_List};var haxe_ds__$List_ListNode=function(item,next){this.item=item,this.next=next};$hxClasses["haxe.ds._List.ListNode"]=haxe_ds__$List_ListNode,haxe_ds__$List_ListNode.__name__="haxe.ds._List.ListNode",haxe_ds__$List_ListNode.prototype={__class__:haxe_ds__$List_ListNode};var haxe_ds_ObjectMap=function(){this.h={__keys__:{}}};$hxClasses["haxe.ds.ObjectMap"]=haxe_ds_ObjectMap,haxe_ds_ObjectMap.__name__="haxe.ds.ObjectMap",haxe_ds_ObjectMap.__interfaces__=[haxe_IMap],haxe_ds_ObjectMap.prototype={set:function(key,value){var id=key.__id__;null==id&&(id=key.__id__=$global.$haxeUID++),this.h[id]=value,this.h.__keys__[id]=key},remove:function(key){var id=key.__id__;return null!=this.h.__keys__[id]&&(delete this.h[id],delete this.h.__keys__[id],!0)},keys:function(){var a=[];for(var key in this.h.__keys__)this.h.hasOwnProperty(key)&&a.push(this.h.__keys__[key]);return new haxe_iterators_ArrayIterator(a)},__class__:haxe_ds_ObjectMap};var haxe_ds_StringMap=function(){this.h=Object.create(null)};$hxClasses["haxe.ds.StringMap"]=haxe_ds_StringMap,haxe_ds_StringMap.__name__="haxe.ds.StringMap",haxe_ds_StringMap.__interfaces__=[haxe_IMap],haxe_ds_StringMap.keysIterator=function(h){var keys=Object.keys(h),len=keys.length,idx=0;return{hasNext:function(){return idx<len},next:function(){return keys[(idx+=1)-1]}}},haxe_ds_StringMap.valueIterator=function(h){var keys=Object.keys(h),len=keys.length,idx=0;return{hasNext:function(){return idx<len},next:function(){return h[keys[(idx+=1)-1]]}}},haxe_ds_StringMap.kvIterator=function(h){var keys=Object.keys(h),len=keys.length,idx=0;return{hasNext:function(){return idx<len},next:function(){var k=keys[(idx+=1)-1];return{key:k,value:h[k]}}}},haxe_ds_StringMap.prototype={__class__:haxe_ds_StringMap};var haxe_ds_Vector={blit:function(src,srcPos,dest,destPos,len){if(src==dest){if(srcPos<destPos)for(var i=srcPos+len,j=destPos+len,_g=0,_g1=len;_g<_g1;){_g++;--i,src[--j]=src[i]}else if(srcPos>destPos)for(i=srcPos,j=destPos,_g=0,_g1=len;_g<_g1;){_g++;src[j]=src[i],++i,++j}}else for(_g=0,_g1=len;_g<_g1;){dest[destPos+(i=_g++)]=src[srcPos+i]}}},haxe_io_BytesBuffer=function(){this.pos=0,this.size=0};$hxClasses["haxe.io.BytesBuffer"]=haxe_io_BytesBuffer,haxe_io_BytesBuffer.__name__="haxe.io.BytesBuffer",haxe_io_BytesBuffer.prototype={add:function(src){if(this.pos+src.length>this.size&&this.grow(src.length),0!=this.size){var sub=new Uint8Array(src.b.buffer,src.b.byteOffset,src.length);this.u8.set(sub,this.pos),this.pos+=src.length}},addBytes:function(src,pos,len){if(pos<0||len<0||pos+len>src.length)throw haxe_Exception.thrown(haxe_io_Error.OutsideBounds);if(this.pos+len>this.size&&this.grow(len),0!=this.size){var sub=new Uint8Array(src.b.buffer,src.b.byteOffset+pos,len);this.u8.set(sub,this.pos),this.pos+=len}},grow:function(delta){for(var req=this.pos+delta,nsize=0==this.size?16:this.size;nsize<req;)nsize=3*nsize>>1;var nbuf=new ArrayBuffer(nsize),nu8=new Uint8Array(nbuf);this.size>0&&nu8.set(this.u8),this.size=nsize,this.buffer=nbuf,this.u8=nu8,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new haxe_io_Bytes(new ArrayBuffer(0));var b=new haxe_io_Bytes(this.buffer);return b.length=this.pos,b},__class__:haxe_io_BytesBuffer};var haxe_io_Input=function(){};$hxClasses["haxe.io.Input"]=haxe_io_Input,haxe_io_Input.__name__="haxe.io.Input",haxe_io_Input.prototype={readByte:function(){throw haxe_Exception.thrown("Not implemented")},readBytes:function(s,pos,len){var k=len,b=s.b;if(pos<0||len<0||pos+len>s.length)throw haxe_Exception.thrown(haxe_io_Error.OutsideBounds);try{for(;k>0;)b[pos]=this.readByte(),++pos,--k}catch(_g){if(!(haxe_Exception.caught(_g).unwrap()instanceof haxe_io_Eof))throw _g}return len-k},set_bigEndian:function(b){return this.bigEndian=b,b},readFullBytes:function(s,pos,len){for(;len>0;){var k=this.readBytes(s,pos,len);if(0==k)throw haxe_Exception.thrown(haxe_io_Error.Blocked);pos+=k,len-=k}},read:function(nbytes){for(var s=new haxe_io_Bytes(new ArrayBuffer(nbytes)),p=0;nbytes>0;){var k=this.readBytes(s,p,nbytes);if(0==k)throw haxe_Exception.thrown(haxe_io_Error.Blocked);p+=k,nbytes-=k}return s},readDouble:function(){var i1=this.readInt32(),i2=this.readInt32();return this.bigEndian?haxe_io_FPHelper.i64ToDouble(i2,i1):haxe_io_FPHelper.i64ToDouble(i1,i2)},readInt16:function(){var ch1=this.readByte(),ch2=this.readByte(),n=this.bigEndian?ch2|ch1<<8:ch1|ch2<<8;return 0!=(32768&n)?n-65536:n},readUInt16:function(){var ch1=this.readByte(),ch2=this.readByte();return this.bigEndian?ch2|ch1<<8:ch1|ch2<<8},readUInt24:function(){var ch1=this.readByte(),ch2=this.readByte(),ch3=this.readByte();return this.bigEndian?ch3|ch2<<8|ch1<<16:ch1|ch2<<8|ch3<<16},readInt32:function(){var ch1=this.readByte(),ch2=this.readByte(),ch3=this.readByte(),ch4=this.readByte();return this.bigEndian?ch4|ch3<<8|ch2<<16|ch1<<24:ch1|ch2<<8|ch3<<16|ch4<<24},readString:function(len,encoding){var b=new haxe_io_Bytes(new ArrayBuffer(len));return this.readFullBytes(b,0,len),b.getString(0,len,encoding)},__class__:haxe_io_Input};var haxe_io_BytesInput=function(b,pos,len){if(null==pos&&(pos=0),null==len&&(len=b.length-pos),pos<0||len<0||pos+len>b.length)throw haxe_Exception.thrown(haxe_io_Error.OutsideBounds);this.b=b.b,this.pos=pos,this.len=len,this.totlen=len};$hxClasses["haxe.io.BytesInput"]=haxe_io_BytesInput,haxe_io_BytesInput.__name__="haxe.io.BytesInput",haxe_io_BytesInput.__super__=haxe_io_Input,haxe_io_BytesInput.prototype=$extend(haxe_io_Input.prototype,{readByte:function(){if(0==this.len)throw haxe_Exception.thrown(new haxe_io_Eof);return this.len--,this.b[this.pos++]},readBytes:function(buf,pos,len){if(pos<0||len<0||pos+len>buf.length)throw haxe_Exception.thrown(haxe_io_Error.OutsideBounds);if(0==this.len&&len>0)throw haxe_Exception.thrown(new haxe_io_Eof);this.len<len&&(len=this.len);for(var b1=this.b,b2=buf.b,_g=0,_g1=len;_g<_g1;){var i=_g++;b2[pos+i]=b1[this.pos+i]}return this.pos+=len,this.len-=len,len},__class__:haxe_io_BytesInput});var haxe_io_Output=function(){};$hxClasses["haxe.io.Output"]=haxe_io_Output,haxe_io_Output.__name__="haxe.io.Output",haxe_io_Output.prototype={flush:function(){},close:function(){},__class__:haxe_io_Output};var haxe_io_BytesOutput=function(){this.b=new haxe_io_BytesBuffer};$hxClasses["haxe.io.BytesOutput"]=haxe_io_BytesOutput,haxe_io_BytesOutput.__name__="haxe.io.BytesOutput",haxe_io_BytesOutput.__super__=haxe_io_Output,haxe_io_BytesOutput.prototype=$extend(haxe_io_Output.prototype,{writeBytes:function(buf,pos,len){return this.b.addBytes(buf,pos,len),len},getBytes:function(){return this.b.getBytes()},__class__:haxe_io_BytesOutput});var haxe_io_Eof=function(){};$hxClasses["haxe.io.Eof"]=haxe_io_Eof,haxe_io_Eof.__name__="haxe.io.Eof",haxe_io_Eof.prototype={toString:function(){return"Eof"},__class__:haxe_io_Eof};var haxe_io_Error=$hxEnums["haxe.io.Error"]={__ename__:"haxe.io.Error",__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:$estr},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:$estr},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:$estr},Custom:($_=function(e){return{_hx_index:3,e:e,__enum__:"haxe.io.Error",toString:$estr}},$_.__params__=["e"],$_)};haxe_io_Error.__empty_constructs__=[haxe_io_Error.Blocked,haxe_io_Error.Overflow,haxe_io_Error.OutsideBounds];var haxe_io_FPHelper=function(){};$hxClasses["haxe.io.FPHelper"]=haxe_io_FPHelper,haxe_io_FPHelper.__name__="haxe.io.FPHelper",haxe_io_FPHelper.i64ToDouble=function(low,high){return haxe_io_FPHelper.helper.setInt32(0,low,!0),haxe_io_FPHelper.helper.setInt32(4,high,!0),haxe_io_FPHelper.helper.getFloat64(0,!0)};var haxe_iterators_ArrayIterator=function(array){this.current=0,this.array=array};$hxClasses["haxe.iterators.ArrayIterator"]=haxe_iterators_ArrayIterator,haxe_iterators_ArrayIterator.__name__="haxe.iterators.ArrayIterator",haxe_iterators_ArrayIterator.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:haxe_iterators_ArrayIterator};var haxe_macro_Binop=$hxEnums["haxe.macro.Binop"]={__ename__:"haxe.macro.Binop",__constructs__:["OpAdd","OpMult","OpDiv","OpSub","OpAssign","OpEq","OpNotEq","OpGt","OpGte","OpLt","OpLte","OpAnd","OpOr","OpXor","OpBoolAnd","OpBoolOr","OpShl","OpShr","OpUShr","OpMod","OpAssignOp","OpInterval","OpArrow","OpIn"],OpAdd:{_hx_index:0,__enum__:"haxe.macro.Binop",toString:$estr},OpMult:{_hx_index:1,__enum__:"haxe.macro.Binop",toString:$estr},OpDiv:{_hx_index:2,__enum__:"haxe.macro.Binop",toString:$estr},OpSub:{_hx_index:3,__enum__:"haxe.macro.Binop",toString:$estr},OpAssign:{_hx_index:4,__enum__:"haxe.macro.Binop",toString:$estr},OpEq:{_hx_index:5,__enum__:"haxe.macro.Binop",toString:$estr},OpNotEq:{_hx_index:6,__enum__:"haxe.macro.Binop",toString:$estr},OpGt:{_hx_index:7,__enum__:"haxe.macro.Binop",toString:$estr},OpGte:{_hx_index:8,__enum__:"haxe.macro.Binop",toString:$estr},OpLt:{_hx_index:9,__enum__:"haxe.macro.Binop",toString:$estr},OpLte:{_hx_index:10,__enum__:"haxe.macro.Binop",toString:$estr},OpAnd:{_hx_index:11,__enum__:"haxe.macro.Binop",toString:$estr},OpOr:{_hx_index:12,__enum__:"haxe.macro.Binop",toString:$estr},OpXor:{_hx_index:13,__enum__:"haxe.macro.Binop",toString:$estr},OpBoolAnd:{_hx_index:14,__enum__:"haxe.macro.Binop",toString:$estr},OpBoolOr:{_hx_index:15,__enum__:"haxe.macro.Binop",toString:$estr},OpShl:{_hx_index:16,__enum__:"haxe.macro.Binop",toString:$estr},OpShr:{_hx_index:17,__enum__:"haxe.macro.Binop",toString:$estr},OpUShr:{_hx_index:18,__enum__:"haxe.macro.Binop",toString:$estr},OpMod:{_hx_index:19,__enum__:"haxe.macro.Binop",toString:$estr},OpAssignOp:($_=function(op){return{_hx_index:20,op:op,__enum__:"haxe.macro.Binop",toString:$estr}},$_.__params__=["op"],$_),OpInterval:{_hx_index:21,__enum__:"haxe.macro.Binop",toString:$estr},OpArrow:{_hx_index:22,__enum__:"haxe.macro.Binop",toString:$estr},OpIn:{_hx_index:23,__enum__:"haxe.macro.Binop",toString:$estr}};haxe_macro_Binop.__empty_constructs__=[haxe_macro_Binop.OpAdd,haxe_macro_Binop.OpMult,haxe_macro_Binop.OpDiv,haxe_macro_Binop.OpSub,haxe_macro_Binop.OpAssign,haxe_macro_Binop.OpEq,haxe_macro_Binop.OpNotEq,haxe_macro_Binop.OpGt,haxe_macro_Binop.OpGte,haxe_macro_Binop.OpLt,haxe_macro_Binop.OpLte,haxe_macro_Binop.OpAnd,haxe_macro_Binop.OpOr,haxe_macro_Binop.OpXor,haxe_macro_Binop.OpBoolAnd,haxe_macro_Binop.OpBoolOr,haxe_macro_Binop.OpShl,haxe_macro_Binop.OpShr,haxe_macro_Binop.OpUShr,haxe_macro_Binop.OpMod,haxe_macro_Binop.OpInterval,haxe_macro_Binop.OpArrow,haxe_macro_Binop.OpIn];var haxe_macro_Unop=$hxEnums["haxe.macro.Unop"]={__ename__:"haxe.macro.Unop",__constructs__:["OpIncrement","OpDecrement","OpNot","OpNeg","OpNegBits"],OpIncrement:{_hx_index:0,__enum__:"haxe.macro.Unop",toString:$estr},OpDecrement:{_hx_index:1,__enum__:"haxe.macro.Unop",toString:$estr},OpNot:{_hx_index:2,__enum__:"haxe.macro.Unop",toString:$estr},OpNeg:{_hx_index:3,__enum__:"haxe.macro.Unop",toString:$estr},OpNegBits:{_hx_index:4,__enum__:"haxe.macro.Unop",toString:$estr}};haxe_macro_Unop.__empty_constructs__=[haxe_macro_Unop.OpIncrement,haxe_macro_Unop.OpDecrement,haxe_macro_Unop.OpNot,haxe_macro_Unop.OpNeg,haxe_macro_Unop.OpNegBits];var haxe_zip_Huffman=$hxEnums["haxe.zip.Huffman"]={__ename__:"haxe.zip.Huffman",__constructs__:["Found","NeedBit","NeedBits"],Found:($_=function(i){return{_hx_index:0,i:i,__enum__:"haxe.zip.Huffman",toString:$estr}},$_.__params__=["i"],$_),NeedBit:($_=function(left,right){return{_hx_index:1,left:left,right:right,__enum__:"haxe.zip.Huffman",toString:$estr}},$_.__params__=["left","right"],$_),NeedBits:($_=function(n,table){return{_hx_index:2,n:n,table:table,__enum__:"haxe.zip.Huffman",toString:$estr}},$_.__params__=["n","table"],$_)};haxe_zip_Huffman.__empty_constructs__=[];var haxe_zip_HuffTools=function(){};$hxClasses["haxe.zip.HuffTools"]=haxe_zip_HuffTools,haxe_zip_HuffTools.__name__="haxe.zip.HuffTools",haxe_zip_HuffTools.prototype={treeDepth:function(t){switch(t._hx_index){case 0:t.i;return 0;case 1:var b=t.right,a=t.left,da=this.treeDepth(a),db=this.treeDepth(b);return 1+(da<db?da:db);case 2:t.table,t.n;throw haxe_Exception.thrown("assert")}},treeCompress:function(t){var d=this.treeDepth(t);if(0==d)return t;if(1==d){if(1==t._hx_index){var b=t.right,a=t.left;return haxe_zip_Huffman.NeedBit(this.treeCompress(a),this.treeCompress(b))}throw haxe_Exception.thrown("assert")}for(var table=[],_g=0,_g1=1<<d;_g<_g1;){_g++;table.push(haxe_zip_Huffman.Found(-1))}return this.treeWalk(table,0,0,d,t),haxe_zip_Huffman.NeedBits(d,table)},treeWalk:function(table,p,cd,d,t){if(1==t._hx_index){var b=t.right,a=t.left;d>0?(this.treeWalk(table,p,cd+1,d-1,a),this.treeWalk(table,p|1<<cd,cd+1,d-1,b)):table[p]=this.treeCompress(t)}else table[p]=this.treeCompress(t)},treeMake:function(bits,maxbits,v,len){if(len>maxbits)throw haxe_Exception.thrown("Invalid huffman");var idx=v<<5|len;return bits.h.hasOwnProperty(idx)?haxe_zip_Huffman.Found(bits.h[idx]):(v<<=1,++len,haxe_zip_Huffman.NeedBit(this.treeMake(bits,maxbits,v,len),this.treeMake(bits,maxbits,1|v,len)))},make:function(lengths,pos,nlengths,maxbits){if(1==nlengths)return haxe_zip_Huffman.NeedBit(haxe_zip_Huffman.Found(0),haxe_zip_Huffman.Found(0));var counts=[],tmp=[];if(maxbits>32)throw haxe_Exception.thrown("Invalid huffman");for(var _g=0,_g1=maxbits;_g<_g1;){var i=_g++;counts.push(0),tmp.push(0)}for(_g=0,_g1=nlengths;_g<_g1;){var p=lengths[(i=_g++)+pos];if(p>=maxbits)throw haxe_Exception.thrown("Invalid huffman");counts[p]++}var code=0;for(_g=1,_g1=maxbits-1;_g<_g1;){code=code+counts[i=_g++]<<1,tmp[i]=code}var bits=new haxe_ds_IntMap;for(_g=0,_g1=nlengths;_g<_g1;){var l=lengths[(i=_g++)+pos];if(0!=l){var n=tmp[l-1];tmp[l-1]=n+1,bits.h[n<<5|l]=i}}return this.treeCompress(haxe_zip_Huffman.NeedBit(this.treeMake(bits,maxbits,0,1),this.treeMake(bits,maxbits,1,1)))},__class__:haxe_zip_HuffTools};var haxe_zip__$InflateImpl_Window=function(hasCrc){this.buffer=new haxe_io_Bytes(new ArrayBuffer(65536)),this.pos=0,hasCrc&&(this.crc=new haxe_crypto_Adler32)};$hxClasses["haxe.zip._InflateImpl.Window"]=haxe_zip__$InflateImpl_Window,haxe_zip__$InflateImpl_Window.__name__="haxe.zip._InflateImpl.Window",haxe_zip__$InflateImpl_Window.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var b=new haxe_io_Bytes(new ArrayBuffer(65536));this.pos-=32768,b.blit(0,this.buffer,32768,this.pos),this.buffer=b},addBytes:function(b,p,len){this.pos+len>65536&&this.slide(),this.buffer.blit(this.pos,b,p,len),this.pos+=len},addByte:function(c){65536==this.pos&&this.slide(),this.buffer.b[this.pos]=c,this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){return null!=this.crc&&this.crc.update(this.buffer,0,this.pos),this.crc},__class__:haxe_zip__$InflateImpl_Window};var haxe_zip__$InflateImpl_State=$hxEnums["haxe.zip._InflateImpl.State"]={__ename__:"haxe.zip._InflateImpl.State",__constructs__:["Head","Block","CData","Flat","Crc","Dist","DistOne","Done"],Head:{_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:$estr},Block:{_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:$estr},CData:{_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:$estr},Flat:{_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:$estr},Crc:{_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:$estr},Dist:{_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:$estr},DistOne:{_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:$estr},Done:{_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:$estr}};haxe_zip__$InflateImpl_State.__empty_constructs__=[haxe_zip__$InflateImpl_State.Head,haxe_zip__$InflateImpl_State.Block,haxe_zip__$InflateImpl_State.CData,haxe_zip__$InflateImpl_State.Flat,haxe_zip__$InflateImpl_State.Crc,haxe_zip__$InflateImpl_State.Dist,haxe_zip__$InflateImpl_State.DistOne,haxe_zip__$InflateImpl_State.Done];var haxe_zip_InflateImpl=function(i,header,crc){null==crc&&(crc=!0),null==header&&(header=!0),this.isFinal=!1,this.htools=new haxe_zip_HuffTools,this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.len=0,this.dist=0,this.state=header?haxe_zip__$InflateImpl_State.Head:haxe_zip__$InflateImpl_State.Block,this.input=i,this.bits=0,this.nbits=0,this.needed=0,this.output=null,this.outpos=0,this.lengths=[],this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.window=new haxe_zip__$InflateImpl_Window(crc)};$hxClasses["haxe.zip.InflateImpl"]=haxe_zip_InflateImpl,haxe_zip_InflateImpl.__name__="haxe.zip.InflateImpl",haxe_zip_InflateImpl.run=function(i,bufsize){null==bufsize&&(bufsize=65536);for(var buf=new haxe_io_Bytes(new ArrayBuffer(bufsize)),output=new haxe_io_BytesBuffer,inflate=new haxe_zip_InflateImpl(i);;){var len=inflate.readBytes(buf,0,bufsize);if(output.addBytes(buf,0,len),len<bufsize)break}return output.getBytes()},haxe_zip_InflateImpl.prototype={buildFixedHuffman:function(){if(null!=haxe_zip_InflateImpl.FIXED_HUFFMAN)return haxe_zip_InflateImpl.FIXED_HUFFMAN;for(var a=[],_g=0;_g<288;){var n=_g++;a.push(n<=143?8:n<=255?9:n<=279?7:8)}return haxe_zip_InflateImpl.FIXED_HUFFMAN=this.htools.make(a,0,288,10)},readBytes:function(b,pos,len){if(this.needed=len,this.outpos=pos,this.output=b,len>0)for(;this.inflateLoop(););return len-this.needed},getBits:function(n){for(;this.nbits<n;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var b=this.bits&(1<<n)-1;return this.nbits-=n,this.bits>>=n,b},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var b=1==(1&this.bits);return this.nbits--,this.bits>>=1,b},getRevBits:function(n){return 0==n?0:this.getBit()?1<<n-1|this.getRevBits(n-1):this.getRevBits(n-1)},resetBits:function(){this.bits=0,this.nbits=0},addBytes:function(b,p,len){this.window.addBytes(b,p,len),this.output.blit(this.outpos,b,p,len),this.needed-=len,this.outpos+=len},addByte:function(b){this.window.addByte(b),this.output.b[this.outpos]=b,this.needed--,this.outpos++},addDistOne:function(n){for(var c=this.window.getLastChar(),_g=0,_g1=n;_g<_g1;){_g++;this.addByte(c)}},addDist:function(d,len){this.addBytes(this.window.buffer,this.window.pos-d,len)},applyHuffman:function(h){switch(h._hx_index){case 0:return n=h.i;case 1:var b=h.right,a=h.left;return this.applyHuffman(this.getBit()?b:a);case 2:var tbl=h.table,n=h.n;return this.applyHuffman(tbl[this.getBits(n)])}},inflateLengths:function(a,max){for(var i=0,prev=0;i<max;){var n=this.applyHuffman(this.huffman);switch(n){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:prev=n,a[i]=n,++i;break;case 16:var end=i+3+this.getBits(2);if(end>max)throw haxe_Exception.thrown("Invalid data");for(;i<end;)a[i]=prev,++i;break;case 17:if((i+=3+this.getBits(3))>max)throw haxe_Exception.thrown("Invalid data");break;case 18:if((i+=11+this.getBits(7))>max)throw haxe_Exception.thrown("Invalid data");break;default:throw haxe_Exception.thrown("Invalid data")}}},inflateLoop:function(){switch(this.state._hx_index){case 0:var cmf=this.input.readByte();if(8!=(15&cmf))throw haxe_Exception.thrown("Invalid data");var flg=this.input.readByte(),fdict=0!=(32&flg);if(((cmf<<8)+flg)%31!=0)throw haxe_Exception.thrown("Invalid data");if(fdict)throw haxe_Exception.thrown("Unsupported dictionary");return this.state=haxe_zip__$InflateImpl_State.Block,!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:if(this.len=this.input.readUInt16(),this.input.readUInt16()!=65535-this.len)throw haxe_Exception.thrown("Invalid data");this.state=haxe_zip__$InflateImpl_State.Flat;var r=this.inflateLoop();return this.resetBits(),r;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=haxe_zip__$InflateImpl_State.CData,!0;case 2:for(var hlit=this.getBits(5)+257,hdist=this.getBits(5)+1,hclen=this.getBits(4)+4,_g=0,_g1=hclen;_g<_g1;){var i=_g++;this.lengths[haxe_zip_InflateImpl.CODE_LENGTHS_POS[i]]=this.getBits(3)}for(_g=hclen,_g1=19;_g<_g1;){i=_g++;this.lengths[haxe_zip_InflateImpl.CODE_LENGTHS_POS[i]]=0}this.huffman=this.htools.make(this.lengths,0,19,8);var lengths=[];for(_g=0,_g1=hlit+hdist;_g<_g1;){i=_g++;lengths.push(0)}return this.inflateLengths(lengths,hlit+hdist),this.huffdist=this.htools.make(lengths,hlit,hdist,16),this.huffman=this.htools.make(lengths,0,hlit,16),this.state=haxe_zip__$InflateImpl_State.CData,!0;default:throw haxe_Exception.thrown("Invalid data")}break;case 2:var n=this.applyHuffman(this.huffman);if(n<256)return this.addByte(n),this.needed>0;if(256==n)return this.state=this.isFinal?haxe_zip__$InflateImpl_State.Crc:haxe_zip__$InflateImpl_State.Block,!0;var extra_bits=haxe_zip_InflateImpl.LEN_EXTRA_BITS_TBL[n-=257];if(-1==extra_bits)throw haxe_Exception.thrown("Invalid data");this.len=haxe_zip_InflateImpl.LEN_BASE_VAL_TBL[n]+this.getBits(extra_bits);var dist_code=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);if(-1==(extra_bits=haxe_zip_InflateImpl.DIST_EXTRA_BITS_TBL[dist_code]))throw haxe_Exception.thrown("Invalid data");if(this.dist=haxe_zip_InflateImpl.DIST_BASE_VAL_TBL[dist_code]+this.getBits(extra_bits),this.dist>this.window.available())throw haxe_Exception.thrown("Invalid data");return this.state=1==this.dist?haxe_zip__$InflateImpl_State.DistOne:haxe_zip__$InflateImpl_State.Dist,!0;case 3:var rlen=this.len<this.needed?this.len:this.needed,bytes=this.input.read(rlen);return this.len-=rlen,this.addBytes(bytes,0,rlen),0==this.len&&(this.state=this.isFinal?haxe_zip__$InflateImpl_State.Crc:haxe_zip__$InflateImpl_State.Block),this.needed>0;case 4:var calc=this.window.checksum();if(null==calc)return this.state=haxe_zip__$InflateImpl_State.Done,!0;var crc=haxe_crypto_Adler32.read(this.input);if(!calc.equals(crc))throw haxe_Exception.thrown("Invalid CRC");return this.state=haxe_zip__$InflateImpl_State.Done,!0;case 5:for(;this.len>0&&this.needed>0;){var rdist=this.len<this.dist?this.len:this.dist;rlen=this.needed<rdist?this.needed:rdist;this.addDist(this.dist,rlen),this.len-=rlen}return 0==this.len&&(this.state=haxe_zip__$InflateImpl_State.CData),this.needed>0;case 6:rlen=this.len<this.needed?this.len:this.needed;return this.addDistOne(rlen),this.len-=rlen,0==this.len&&(this.state=haxe_zip__$InflateImpl_State.CData),this.needed>0;case 7:return!1}},__class__:haxe_zip_InflateImpl};var haxe_zip_Uncompress=function(){};$hxClasses["haxe.zip.Uncompress"]=haxe_zip_Uncompress,haxe_zip_Uncompress.__name__="haxe.zip.Uncompress",haxe_zip_Uncompress.run=function(src,bufsize){return haxe_zip_InflateImpl.run(new haxe_io_BytesInput(src),bufsize)};var hxd_BitmapData=function(width,height){if(-101!=width||-102!=height){var canvas=window.document.createElement("canvas");canvas.width=width,canvas.height=height,this.ctx=canvas.getContext("2d",null)}};$hxClasses["hxd.BitmapData"]=hxd_BitmapData,hxd_BitmapData.__name__="hxd.BitmapData",hxd_BitmapData.prototype={getPixels:function(){var w=this.ctx.canvas.width,h=this.ctx.canvas.height,pixels=this.ctx.getImageData(0,0,w,h).data.buffer;return new hxd_Pixels(w,h,haxe_io_Bytes.ofData(pixels),hxd_PixelFormat.RGBA)},__class__:hxd_BitmapData};var hxd_Cursor=$hxEnums["hxd.Cursor"]={__ename__:"hxd.Cursor",__constructs__:["Default","Button","Move","TextInput","Hide","Custom","Callback"],Default:{_hx_index:0,__enum__:"hxd.Cursor",toString:$estr},Button:{_hx_index:1,__enum__:"hxd.Cursor",toString:$estr},Move:{_hx_index:2,__enum__:"hxd.Cursor",toString:$estr},TextInput:{_hx_index:3,__enum__:"hxd.Cursor",toString:$estr},Hide:{_hx_index:4,__enum__:"hxd.Cursor",toString:$estr},Custom:($_=function(custom){return{_hx_index:5,custom:custom,__enum__:"hxd.Cursor",toString:$estr}},$_.__params__=["custom"],$_),Callback:($_=function(f){return{_hx_index:6,f:f,__enum__:"hxd.Cursor",toString:$estr}},$_.__params__=["f"],$_)};hxd_Cursor.__empty_constructs__=[hxd_Cursor.Default,hxd_Cursor.Button,hxd_Cursor.Move,hxd_Cursor.TextInput,hxd_Cursor.Hide];var hxd_CustomCursor=function(frames,speed,offsetX,offsetY){this.frames=frames,this.speed=speed,this.offsetX=offsetX,this.offsetY=offsetY,this.frameDelay=1/speed,this.frameTime=0,this.frameIndex=0};$hxClasses["hxd.CustomCursor"]=hxd_CustomCursor,hxd_CustomCursor.__name__="hxd.CustomCursor",hxd_CustomCursor.prototype={reset:function(){this.frameTime=0,this.frameIndex=0},update:function(dt){for(var newTime=this.frameTime+dt,delay=this.frameDelay,index=this.frameIndex;newTime>=delay;)newTime-=delay,++index;return this.frameTime=newTime,index>=this.frames.length&&(index%=this.frames.length),index!=this.frameIndex?(this.frameIndex=index,index):-1},__class__:hxd_CustomCursor};var hxd_EventKind=$hxEnums["hxd.EventKind"]={__ename__:"hxd.EventKind",__constructs__:["EPush","ERelease","EMove","EOver","EOut","EWheel","EFocus","EFocusLost","EKeyDown","EKeyUp","EReleaseOutside","ETextInput","ECheck"],EPush:{_hx_index:0,__enum__:"hxd.EventKind",toString:$estr},ERelease:{_hx_index:1,__enum__:"hxd.EventKind",toString:$estr},EMove:{_hx_index:2,__enum__:"hxd.EventKind",toString:$estr},EOver:{_hx_index:3,__enum__:"hxd.EventKind",toString:$estr},EOut:{_hx_index:4,__enum__:"hxd.EventKind",toString:$estr},EWheel:{_hx_index:5,__enum__:"hxd.EventKind",toString:$estr},EFocus:{_hx_index:6,__enum__:"hxd.EventKind",toString:$estr},EFocusLost:{_hx_index:7,__enum__:"hxd.EventKind",toString:$estr},EKeyDown:{_hx_index:8,__enum__:"hxd.EventKind",toString:$estr},EKeyUp:{_hx_index:9,__enum__:"hxd.EventKind",toString:$estr},EReleaseOutside:{_hx_index:10,__enum__:"hxd.EventKind",toString:$estr},ETextInput:{_hx_index:11,__enum__:"hxd.EventKind",toString:$estr},ECheck:{_hx_index:12,__enum__:"hxd.EventKind",toString:$estr}};hxd_EventKind.__empty_constructs__=[hxd_EventKind.EPush,hxd_EventKind.ERelease,hxd_EventKind.EMove,hxd_EventKind.EOver,hxd_EventKind.EOut,hxd_EventKind.EWheel,hxd_EventKind.EFocus,hxd_EventKind.EFocusLost,hxd_EventKind.EKeyDown,hxd_EventKind.EKeyUp,hxd_EventKind.EReleaseOutside,hxd_EventKind.ETextInput,hxd_EventKind.ECheck];var hxd_Event=function(k,x,y){null==y&&(y=0),null==x&&(x=0),this.button=0,this.kind=k,this.relX=x,this.relY=y};$hxClasses["hxd.Event"]=hxd_Event,hxd_Event.__name__="hxd.Event",hxd_Event.prototype={__class__:hxd_Event};var hxd__$FloatBuffer_Float32Expand={_new:function(length){return{pos:0,array:new Float32Array(new ArrayBuffer(length<<2))}}},hxd_Key=function(){};$hxClasses["hxd.Key"]=hxd_Key,hxd_Key.__name__="hxd.Key",hxd_Key.initialize=function(){hxd_Key.initDone&&hxd_Key.dispose(),hxd_Key.initDone=!0,hxd_Key.keyPressed=[],hxd_Window.getInstance().addEventTarget(hxd_Key.onEvent)},hxd_Key.dispose=function(){hxd_Key.initDone&&(hxd_Window.getInstance().removeEventTarget(hxd_Key.onEvent),hxd_Key.initDone=!1,hxd_Key.keyPressed=[])},hxd_Key.onEvent=function(e){switch(e.kind._hx_index){case 0:e.button<5&&(hxd_Key.keyPressed[e.button]=hxd_Timer.frameCount+1);break;case 1:e.button<5&&(hxd_Key.keyPressed[e.button]=-(hxd_Timer.frameCount+1));break;case 5:hxd_Key.keyPressed[e.wheelDelta>0?6:5]=hxd_Timer.frameCount+1;break;case 8:if(!hxd_Key.ALLOW_KEY_REPEAT&&hxd_Key.keyPressed[e.keyCode]>0)return;hxd_Key.keyPressed[e.keyCode]=hxd_Timer.frameCount+1;break;case 9:hxd_Key.keyPressed[e.keyCode]=-(hxd_Timer.frameCount+1)}};var hxd_Flags=$hxEnums["hxd.Flags"]={__ename__:"hxd.Flags",__constructs__:["ReadOnly","AlphaPremultiplied","FlipY"],ReadOnly:{_hx_index:0,__enum__:"hxd.Flags",toString:$estr},AlphaPremultiplied:{_hx_index:1,__enum__:"hxd.Flags",toString:$estr},FlipY:{_hx_index:2,__enum__:"hxd.Flags",toString:$estr}};hxd_Flags.__empty_constructs__=[hxd_Flags.ReadOnly,hxd_Flags.AlphaPremultiplied,hxd_Flags.FlipY];var hxd_PixelsARGB={fromPixels:function(p){return p.convert(hxd_PixelFormat.ARGB),p.setFlip(!1),p}},hxd_Pixels=function(width,height,bytes,format,offset){null==offset&&(offset=0),this.width=width,this.height=height,this.bytes=bytes,this.set_innerFormat(format),this.offset=offset;var i=0;null==i&&(i=0);var this1=i;this.flags=this1};$hxClasses["hxd.Pixels"]=hxd_Pixels,hxd_Pixels.__name__="hxd.Pixels",hxd_Pixels.calcStride=function(width,format){var tmp;switch(format._hx_index){case 3:tmp=8;break;case 4:tmp=16;break;case 5:tmp=1;break;case 6:tmp=2;break;case 7:tmp=4;break;case 8:tmp=2;break;case 9:tmp=4;break;case 10:tmp=8;break;case 11:tmp=3;break;case 12:tmp=6;break;case 13:tmp=12;break;case 0:case 1:case 2:case 14:case 15:case 16:case 17:tmp=4;break;case 18:var n=format.v;if(1==n||4==n)return width>>1;tmp=1}return width*tmp},hxd_Pixels.alloc=function(width,height,format){return new hxd_Pixels(width,height,new haxe_io_Bytes(new ArrayBuffer(height*hxd_Pixels.calcStride(width,format))),format)},hxd_Pixels.prototype={set_innerFormat:function(fmt){return this.innerFormat=fmt,this.stride=hxd_Pixels.calcStride(this.width,fmt),this.bytesPerPixel=hxd_Pixels.calcStride(1,fmt),fmt},invalidFormat:function(){throw haxe_Exception.thrown("Unsupported format for this operation : "+Std.string(this.innerFormat))},makeSquare:function(copy){for(var w=this.width,h=this.height,tw=0==w?0:1,th=0==h?0:1;tw<w;)tw<<=1;for(;th<h;)th<<=1;if(w==tw&&h==th)return this;for(var bpp=this.bytesPerPixel,out=new haxe_io_Bytes(new ArrayBuffer(tw*th*bpp)),p=0,b=this.offset,_g=0,_g1=h;_g<_g1;){_g++;out.blit(p,this.bytes,b,w*bpp),p+=w*bpp,b+=w*bpp;for(var _g2=0,_g3=(tw-w)*bpp>>2;_g2<_g3;){_g2++;out.setInt32(p,0),p+=4}}for(_g=0,_g1=(th-h)*tw*bpp>>2;_g<_g1;){_g++;out.setInt32(p,0),p+=4}return copy?new hxd_Pixels(tw,th,out,this.innerFormat):(this.bytes=out,this.width=tw,this.height=th,this)},copyInner:function(){var old=this.bytes;this.bytes=new haxe_io_Bytes(new ArrayBuffer(this.height*this.stride)),this.bytes.blit(0,old,this.offset,this.height*this.stride),this.offset=0,this.flags&=-1-(1<<hxd_Flags.ReadOnly._hx_index)},setFlip:function(b){if(null==b&&(b=!1),0!=(this.flags&1<<hxd_Flags.FlipY._hx_index)!=b){0!=(this.flags&1<<hxd_Flags.ReadOnly._hx_index)&&this.copyInner(),b?this.flags|=1<<hxd_Flags.FlipY._hx_index:this.flags&=-1-(1<<hxd_Flags.FlipY._hx_index),this.stride%4!=0&&this.invalidFormat();for(var _g=0,_g1=this.height>>1;_g<_g1;)for(var y=_g++,p1=y*this.stride+this.offset,p2=(this.height-1-y)*this.stride+this.offset,_g2=0,_g3=this.stride>>2;_g2<_g3;){_g2++;var a=this.bytes.getInt32(p1);b=this.bytes.getInt32(p2);this.bytes.setInt32(p1,b),this.bytes.setInt32(p2,a),p1+=4,p2+=4}}},convert:function(target){if(this.innerFormat!=target){0!=(this.flags&1<<hxd_Flags.ReadOnly._hx_index)&&this.copyInner();var bytes=this.bytes.b,_g=this.innerFormat;switch(_g._hx_index){case 0:switch(target._hx_index){case 1:for(var _g1=0,_g2=this.width*this.height;_g1<_g2;){var a=bytes[p=(_g1++<<2)+this.offset],r=bytes[p+1],g=bytes[p+2],b=bytes[p+3];bytes[p++]=b,bytes[p++]=g,bytes[p++]=r,bytes[p]=a}break;case 2:for(_g1=0,_g2=this.width*this.height;_g1<_g2;){a=bytes[p=(_g1++<<2)+this.offset];var v=bytes[p+1];bytes[p]=v;var v1=bytes[p+2];bytes[p+1]=v1;var v2=bytes[p+3];bytes[p+2]=v2,bytes[p+3]=a}break;default:throw haxe_Exception.thrown("Cannot convert from "+Std.string(this.innerFormat)+" to "+Std.string(target))}break;case 1:switch(target._hx_index){case 0:for(_g1=0,_g2=this.width*this.height;_g1<_g2;){a=bytes[p=(_g1++<<2)+this.offset],r=bytes[p+1],g=bytes[p+2],b=bytes[p+3];bytes[p++]=b,bytes[p++]=g,bytes[p++]=r,bytes[p]=a}break;case 2:for(_g1=0,_g2=this.width*this.height;_g1<_g2;){b=bytes[p=(_g1++<<2)+this.offset],r=bytes[p+2];bytes[p]=r,bytes[p+2]=b}break;default:throw haxe_Exception.thrown("Cannot convert from "+Std.string(this.innerFormat)+" to "+Std.string(target))}break;case 2:switch(target._hx_index){case 0:for(_g1=0,_g2=this.width*this.height;_g1<_g2;){a=bytes[(p=(_g1++<<2)+this.offset)+3],v=bytes[p+2];bytes[p+3]=v;v1=bytes[p+1];bytes[p+2]=v1;v2=bytes[p];bytes[p+1]=v2,bytes[p]=a}break;case 1:for(_g1=0,_g2=this.width*this.height;_g1<_g2;){var p;b=bytes[p=(_g1++<<2)+this.offset],r=bytes[p+2];bytes[p]=r,bytes[p+2]=b}break;default:throw haxe_Exception.thrown("Cannot convert from "+Std.string(this.innerFormat)+" to "+Std.string(target))}break;case 18:if(18!=target._hx_index)throw haxe_Exception.thrown("Cannot convert from "+Std.string(this.innerFormat)+" to "+Std.string(target));if((a=_g.v)!=(b=target.v))throw haxe_Exception.thrown("Cannot convert from "+Std.string(this.innerFormat)+" to "+Std.string(target));break;default:throw haxe_Exception.thrown("Cannot convert from "+Std.string(this.innerFormat)+" to "+Std.string(target))}this.set_innerFormat(target)}},getPixel:function(x,y){var p=(x+(0!=(this.flags&1<<hxd_Flags.FlipY._hx_index)?this.height-1-y:y)*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 0:return(v=this.bytes.getInt32(p))>>>24|v>>8&65280|v<<8&16711680|v<<24;case 1:return this.bytes.getInt32(p);case 2:var v;return-16711936&(v=this.bytes.getInt32(p))|v<<16&16711680|v>>16&255;default:return this.invalidFormat(),0}},dispose:function(){this.bytes=null},__class__:hxd_Pixels};var hxd_Res=function(){};$hxClasses["hxd.Res"]=hxd_Res,hxd_Res.__name__="hxd.Res",hxd_Res.get_loader=function(){var l=hxd_res_Loader.currentInstance;if(null==l)throw haxe_Exception.thrown("Resource loader not initialized: call to hxd.Res.initXXX() required");return l},hxd_Res.set_loader=function(l){return hxd_res_Loader.currentInstance=l};var hxd_SceneEvents=function($window){this.defaultCursor=hxd_Cursor.Default,this.mouseCheckMove=!0,this.enablePhysicalMouse=!0,this.isOut=!1,this.onOver=new hxd_Event(hxd_EventKind.EOver),this.onOut=new hxd_Event(hxd_EventKind.EOut),this.checkPos=new hxd_Event(hxd_EventKind.ECheck),this.focusLost=new hxd_Event(hxd_EventKind.EFocusLost),this.lastTouch=0,this.mouseY=-1,this.mouseX=-1,this.overIndex=-1,this.scenes=[],this.pendingEvents=[],this.pushList=[],this.overList=[],this.overCandidates=[],null==$window&&($window=hxd_Window.getInstance()),this.window=$window,$window.addEventTarget($bind(this,this.onEvent))};$hxClasses["hxd.SceneEvents"]=hxd_SceneEvents,hxd_SceneEvents.__name__="hxd.SceneEvents",hxd_SceneEvents.prototype={onRemove:function(i){if(i==this.currentFocus&&(this.currentFocus=null),this.overIndex>=0){var index=this.overList.indexOf(i);index>=0&&(HxOverrides.remove(this.overList,i),index<this.overIndex&&this.overIndex--)}else HxOverrides.remove(this.overList,i),this.selectCursor();HxOverrides.remove(this.pushList,i)},addScene:function(s,index){s.setEvents(this),null==index?this.scenes.push(s):this.scenes.splice(index,0,s)},removeScene:function(s){HxOverrides.remove(this.scenes,s)&&s.setEvents(null)},blur:function(){null!=this.currentFocus&&(this.focusLost.cancel=!1,this.currentFocus.handleEvent(this.focusLost),this.focusLost.cancel||(this.currentFocus=null))},checkFocus:function(){if(null!=this.currentFocus){var s=this.currentFocus.getInteractiveScene();null!=s?s.isInteractiveVisible(this.currentFocus)||this.blur():this.currentFocus=null}},emitEvent:function(event){var oldX=event.relX,oldY=event.relY,overCandidateCount=0,handled=!1,checkOver=!1,fillOver=!1,checkPush=!1,cancelFocus=!1,updateCursor=!1;switch(this.overIndex=0,event.kind._hx_index){case 0:cancelFocus=!0,checkPush=!0;break;case 1:checkPush=!0;break;case 5:case 8:case 9:case 11:if(null!=this.currentFocus&&(event.relX=event.relY=0,this.currentFocus.handleEvent(event),event.relX=oldX,event.relY=oldY,!event.propagate))return;break;case 2:case 12:checkOver=!0,fillOver=!0}for(var _g=0,_g1=this.scenes;_g<_g1.length;){var s=_g1[_g];++_g;for(var last=null;;){if(null==(i=s.handleEvent(event,last))){event.relX=oldX,event.relY=oldY;break}if(checkOver){if(fillOver){var idx=this.overList.indexOf(i);if(-1==idx){if(this.overCandidates.length==overCandidateCount)this.overCandidates[overCandidateCount]={i:i,s:s,x:event.relX,y:event.relY,z:event.relZ};else(info=this.overCandidates[overCandidateCount]).i=i,info.s=s,info.x=event.relX,info.y=event.relY,info.z=event.relZ;++overCandidateCount,this.overList.splice(this.overIndex++,0,i),updateCursor=!0}else{if(idx<this.overIndex){for(;this.overList[idx]=this.overList[idx+1],++idx<this.overIndex;);this.overList[this.overIndex]=i,updateCursor=!0}else if(idx>this.overIndex){for(;this.overList[idx]=this.overList[idx-1],--idx>this.overIndex;);this.overList[this.overIndex]=i,updateCursor=!0}this.overIndex++}fillOver=event.propagate}}else checkPush&&(event.kind==hxd_EventKind.EPush?this.pushList.push(i):HxOverrides.remove(this.pushList,i)),cancelFocus&&i==this.currentFocus&&(cancelFocus=!1);if(event.relX=oldX,event.relY=oldY,!event.propagate){handled=!0;break}last=i,event.propagate=!1}if(handled)break}if(cancelFocus&&null!=this.currentFocus&&this.blur(),checkOver){if(this.overIndex<this.overList.length){for(;this.overIndex<this.overList.length;){this.overList.pop().handleEvent(this.onOut)}updateCursor=!0}if(0!=overCandidateCount)for(var i=0,ev=this.onOver;;){var info=this.overCandidates[i++];if(ev.relX=info.x,ev.relY=info.y,ev.relZ=info.z,info.s.isInteractiveVisible(info.i)?info.i.handleEvent(ev):HxOverrides.remove(this.overList,info.i),info.i=null,info.s=null,!(i<overCandidateCount))break}}if(this.overIndex=-1,updateCursor&&this.selectCursor(),handled||event==this.checkPos||(event.kind==hxd_EventKind.EPush?this.pushList.push(null):event.kind==hxd_EventKind.ERelease&&HxOverrides.remove(this.pushList,null),this.dispatchListeners(event)),event.kind==hxd_EventKind.ERelease&&this.pushList.length>0){for(_g=0,_g1=this.pushList;_g<_g1.length;){i=_g1[_g];if(++_g,null==i)event.kind=hxd_EventKind.EReleaseOutside,this.dispatchListeners(event),event.kind=hxd_EventKind.ERelease;else{if(null==(s=i.getInteractiveScene()))continue;event.kind=hxd_EventKind.EReleaseOutside,s.dispatchEvent(event,i),event.kind=hxd_EventKind.ERelease,event.relX=oldX,event.relY=oldY}}this.pushList=[]}},checkEvents:function(){var old=this.pendingEvents,checkMoved=!this.mouseCheckMove,checkFocused=null==this.currentFocus;if(old.length>0){this.pendingEvents=[];for(var _g=0;_g<old.length;){var e=old[_g];++_g;var ox=e.relX,oy=e.relY;switch(e.kind._hx_index){case 0:case 1:this.mouseX=e.relX,this.mouseY=e.relY,this.lastTouch=e.touchId;break;case 2:checkMoved=!0,this.mouseX=e.relX,this.mouseY=e.relY,this.lastTouch=e.touchId;break;case 3:this.isOut=!1,this.selectCursor();continue;case 4:if(this.isOut=!0,this.overList.length>0){for(var i=this.overList.length-1;i>=0;)this.onOut.cancel=!1,this.overList[i].handleEvent(this.onOut),HxOverrides.remove(this.overList,this.overList[i]),--i;this.selectCursor()}continue;case 5:case 8:case 9:case 11:checkFocused||(checkFocused=!0,this.checkFocus())}(null==this.currentDrag||null!=this.currentDrag.ref&&this.currentDrag.ref!=e.touchId||(e.propagate=!0,e.cancel=!1,this.currentDrag.f(e),e.relX=ox,e.relY=oy,e.propagate))&&this.emitEvent(e)}}checkFocused||this.checkFocus(),checkMoved||this.isOut||null!=this.currentDrag||(this.checkPos.relX=this.mouseX,this.checkPos.relY=this.mouseY,this.checkPos.touchId=this.lastTouch,this.checkPos.cancel=!1,this.checkPos.propagate=!1,this.emitEvent(this.checkPos))},updateCursor:function(i){-1!=this.overList.indexOf(i)&&this.selectCursor()},selectCursor:function(){for(var cur=this.defaultCursor,_g=0,_g1=this.overList;_g<_g1.length;){var o=_g1[_g];if(++_g,null!=o.cursor){cur=o.cursor;break}}6==cur._hx_index?(0,cur.f)():hxd_System.setCursor(cur)},onEvent:function(e){(this.enablePhysicalMouse||e.kind!=hxd_EventKind.EMove)&&this.pendingEvents.push(e)},dispatchListeners:function(event){var ox=event.relX,oy=event.relY;event.propagate=!0;for(var _g=0,_g1=this.scenes;_g<_g1.length;){var s=_g1[_g];if(++_g,event.cancel=!1,s.dispatchListeners(event),event.relX=ox,event.relY=oy,!event.propagate)break}},__class__:hxd_SceneEvents};var hxd_Platform=$hxEnums["hxd.Platform"]={__ename__:"hxd.Platform",__constructs__:["IOS","Android","WebGL","PC","Console","FlashPlayer"],IOS:{_hx_index:0,__enum__:"hxd.Platform",toString:$estr},Android:{_hx_index:1,__enum__:"hxd.Platform",toString:$estr},WebGL:{_hx_index:2,__enum__:"hxd.Platform",toString:$estr},PC:{_hx_index:3,__enum__:"hxd.Platform",toString:$estr},Console:{_hx_index:4,__enum__:"hxd.Platform",toString:$estr},FlashPlayer:{_hx_index:5,__enum__:"hxd.Platform",toString:$estr}};hxd_Platform.__empty_constructs__=[hxd_Platform.IOS,hxd_Platform.Android,hxd_Platform.WebGL,hxd_Platform.PC,hxd_Platform.Console,hxd_Platform.FlashPlayer];var hxd_SystemValue=$hxEnums["hxd.SystemValue"]={__ename__:"hxd.SystemValue",__constructs__:["IsTouch","IsWindowed","IsMobile"],IsTouch:{_hx_index:0,__enum__:"hxd.SystemValue",toString:$estr},IsWindowed:{_hx_index:1,__enum__:"hxd.SystemValue",toString:$estr},IsMobile:{_hx_index:2,__enum__:"hxd.SystemValue",toString:$estr}};hxd_SystemValue.__empty_constructs__=[hxd_SystemValue.IsTouch,hxd_SystemValue.IsWindowed,hxd_SystemValue.IsMobile];var hxd_Timer=function(){};$hxClasses["hxd.Timer"]=hxd_Timer,hxd_Timer.__name__="hxd.Timer",hxd_Timer.update=function(){hxd_Timer.frameCount++;var newTime=HxOverrides.now()/1e3;if(hxd_Timer.elapsedTime=newTime-hxd_Timer.lastTimeStamp,hxd_Timer.lastTimeStamp=newTime,hxd_Timer.elapsedTime<hxd_Timer.maxDeltaTime){var a=hxd_Timer.elapsedTime;hxd_Timer.currentDT=a+hxd_Timer.smoothFactor*(hxd_Timer.currentDT-a)}else hxd_Timer.elapsedTime=1/hxd_Timer.wantedFPS;hxd_Timer.dt=hxd_Timer.currentDT},hxd_Timer.skip=function(){hxd_Timer.lastTimeStamp=HxOverrides.now()/1e3};var hxd_Window=function(canvas,globalEvents){this.useScreenPixels=!0,this.curMouseY=0,this.curMouseX=0;var _gthis=this,customCanvas=null!=canvas;if(this.eventTargets=new haxe_ds_List,this.resizeEvents=new haxe_ds_List,null==canvas){if(null==(canvas=window.document.getElementById("webgl")))throw haxe_Exception.thrown("Missing canvas #webgl");"1"==canvas.getAttribute("globalEvents")&&(globalEvents=!0)}this.canvas=canvas,this.propagateKeyEvents=globalEvents;var propagate=canvas.getAttribute("propagateKeyEvents");null!=propagate&&(this.propagateKeyEvents="0"!=propagate&&"false"!=propagate),this.focused=globalEvents,this.element=globalEvents?window:canvas,this.canvasPos=canvas.getBoundingClientRect(),customCanvas?canvas.addEventListener("mousemove",$bind(this,this.onMouseMove)):window.addEventListener("mousemove",$bind(this,this.onMouseMove)),this.element.addEventListener("mousedown",$bind(this,this.onMouseDown)),this.element.addEventListener("mouseup",$bind(this,this.onMouseUp)),this.element.addEventListener("wheel",$bind(this,this.onMouseWheel)),this.element.addEventListener("touchstart",$bind(this,this.onTouchStart)),this.element.addEventListener("touchmove",$bind(this,this.onTouchMove)),this.element.addEventListener("touchend",$bind(this,this.onTouchEnd)),this.element.addEventListener("keydown",$bind(this,this.onKeyDown)),this.element.addEventListener("keyup",$bind(this,this.onKeyUp)),this.element.addEventListener("keypress",$bind(this,this.onKeyPress));var _g=$bind(this,this.onFocus),tmp=function(){_g(!1)};this.element.addEventListener("blur",tmp);var _g1=$bind(this,this.onFocus);tmp=function(){_g1(!0)};this.element.addEventListener("focus",tmp),canvas.oncontextmenu=function(e){return e.stopPropagation(),e.preventDefault(),!1},globalEvents?(canvas.addEventListener("mousedown",(function(e){_gthis.onMouseDown(e),e.stopPropagation(),e.preventDefault()})),this.element.addEventListener("contextmenu",(function(e){return e.stopPropagation(),e.preventDefault(),!1}))):(null==canvas.getAttribute("tabindex")&&canvas.setAttribute("tabindex","1"),canvas.style.outline="none"),this.curW=this.get_width(),this.curH=this.get_height(),this.timer=new haxe_Timer(100),this.timer.run=$bind(this,this.checkResize)};$hxClasses["hxd.Window"]=hxd_Window,hxd_Window.__name__="hxd.Window",hxd_Window.getInstance=function(){return null==hxd_Window.inst&&(hxd_Window.inst=new hxd_Window),hxd_Window.inst},hxd_Window.prototype={checkResize:function(){this.canvasPos=this.canvas.getBoundingClientRect();var cw=this.get_width(),ch=this.get_height();this.curW==cw&&this.curH==ch||(this.curW=cw,this.curH=ch,this.onResize(null))},onClose:function(){return!0},event:function(e){for(var _g_head=this.eventTargets.h;null!=_g_head;){var val=_g_head.item;_g_head=_g_head.next,val(e)}},addEventTarget:function(et){this.eventTargets.add(et)},removeEventTarget:function(et){for(var _g_head=this.eventTargets.h;null!=_g_head;){var val=_g_head.item;_g_head=_g_head.next;var e=val;if(Reflect.compareMethods(e,et)){this.eventTargets.remove(e);break}}},addResizeEvent:function(f){this.resizeEvents.push(f)},removeResizeEvent:function(f){for(var _g_head=this.resizeEvents.h;null!=_g_head;){var val=_g_head.item;if(_g_head=_g_head.next,Reflect.compareMethods(val,f)){this.resizeEvents.remove(f);break}}},onResize:function(e){for(var _g_head=this.resizeEvents.h;null!=_g_head;){var val=_g_head.item;_g_head=_g_head.next,val()}},getPixelRatio:function(){return this.useScreenPixels?window.devicePixelRatio:1},get_width:function(){return Math.round(this.canvasPos.width*this.getPixelRatio())},get_height:function(){return Math.round(this.canvasPos.height*this.getPixelRatio())},get_mouseX:function(){return Math.round((this.curMouseX-this.canvasPos.left)*this.getPixelRatio())},get_mouseY:function(){return Math.round((this.curMouseY-this.canvasPos.top)*this.getPixelRatio())},onMouseDown:function(e){e.clientX==this.curMouseX&&e.clientY==this.curMouseY||this.onMouseMove(e);var tmp,ev=new hxd_Event(hxd_EventKind.EPush,this.get_mouseX(),this.get_mouseY()),_g=e.button;switch(_g){case 1:tmp=2;break;case 2:tmp=1;break;default:tmp=_g}ev.button=tmp,this.event(ev)},onMouseUp:function(e){e.clientX==this.curMouseX&&e.clientY==this.curMouseY||this.onMouseMove(e);var tmp,ev=new hxd_Event(hxd_EventKind.ERelease,this.get_mouseX(),this.get_mouseY()),_g=e.button;switch(_g){case 1:tmp=2;break;case 2:tmp=1;break;default:tmp=_g}ev.button=tmp,this.event(ev)},onMouseMove:function(e){this.curMouseX=e.clientX,this.curMouseY=e.clientY,this.event(new hxd_Event(hxd_EventKind.EMove,this.get_mouseX(),this.get_mouseY()))},onMouseWheel:function(e){e.preventDefault();var ev=new hxd_Event(hxd_EventKind.EWheel,this.get_mouseX(),this.get_mouseY());ev.wheelDelta=e.deltaY/120,this.event(ev)},onTouchStart:function(e){var x,y,ev;e.preventDefault();for(var _g=0,_g1=e.changedTouches;_g<_g1.length;){var touch=_g1[_g];++_g,x=Math.round((touch.clientX-this.canvasPos.left)*this.getPixelRatio()),y=Math.round((touch.clientY-this.canvasPos.top)*this.getPixelRatio()),(ev=new hxd_Event(hxd_EventKind.EPush,x,y)).touchId=touch.identifier,this.event(ev)}},onTouchMove:function(e){var x,y,ev;e.preventDefault();for(var _g=0,_g1=e.changedTouches;_g<_g1.length;){var touch=_g1[_g];++_g,x=Math.round((touch.clientX-this.canvasPos.left)*this.getPixelRatio()),y=Math.round((touch.clientY-this.canvasPos.top)*this.getPixelRatio()),(ev=new hxd_Event(hxd_EventKind.EMove,x,y)).touchId=touch.identifier,this.event(ev)}},onTouchEnd:function(e){var x,y,ev;e.preventDefault();for(var _g=0,_g1=e.changedTouches;_g<_g1.length;){var touch=_g1[_g];++_g,x=Math.round((touch.clientX-this.canvasPos.left)*this.getPixelRatio()),y=Math.round((touch.clientY-this.canvasPos.top)*this.getPixelRatio()),(ev=new hxd_Event(hxd_EventKind.ERelease,x,y)).touchId=touch.identifier,this.event(ev)}},onKeyUp:function(e){var ev=new hxd_Event(hxd_EventKind.EKeyUp,this.get_mouseX(),this.get_mouseY());ev.keyCode=e.keyCode,this.event(ev),this.propagateKeyEvents||(e.preventDefault(),e.stopPropagation())},onKeyDown:function(e){var ev=new hxd_Event(hxd_EventKind.EKeyDown,this.get_mouseX(),this.get_mouseY());if(ev.keyCode=e.keyCode,this.event(ev),!this.propagateKeyEvents){switch(ev.keyCode){case 8:case 9:case 16:case 17:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:e.preventDefault()}e.stopPropagation()}},onKeyPress:function(e){var ev=new hxd_Event(hxd_EventKind.ETextInput,this.get_mouseX(),this.get_mouseY());ev.charCode=e.charCode,this.event(ev),this.propagateKeyEvents||(e.preventDefault(),e.stopPropagation())},onFocus:function(b){this.event(new hxd_Event(b?hxd_EventKind.EFocus:hxd_EventKind.EFocusLost)),this.focused=b},set_displayMode:function(m){var doc=window.document,elt=doc.documentElement,fullscreen=m!=hxd_DisplayMode.Windowed;return doc.fullscreenElement==elt==fullscreen?hxd_DisplayMode.Windowed:(m!=hxd_DisplayMode.Windowed?elt.requestFullscreen():doc.exitFullscreen(),m)},__class__:hxd_Window};var hxd_System=function(){};$hxClasses["hxd.System"]=hxd_System,hxd_System.__name__="hxd.System",hxd_System.setLoop=function(f){hxd_System.loopInit||(hxd_System.loopInit=!0,hxd_System.browserLoop()),hxd_System.loopFunc=f},hxd_System.browserLoop=function(){var $window=window;($window.requestAnimationFrame||$window.webkitRequestAnimationFrame||$window.mozRequestAnimationFrame)(hxd_System.browserLoop),null!=hxd_System.loopFunc&&hxd_System.loopFunc()},hxd_System.start=function(callb){callb()},hxd_System.setNativeCursor=function(c){if(null==hxd_System.currentNativeCursor||!Type.enumEq(c,hxd_System.currentNativeCursor)){hxd_System.currentNativeCursor=c,hxd_System.currentCustomCursor=null;var canvas=hxd_Window.getInstance().canvas;if(null!=canvas){var tmp;switch(c._hx_index){case 0:tmp="default";break;case 1:tmp="pointer";break;case 2:tmp="move";break;case 3:tmp="text";break;case 4:tmp="none";break;case 5:var cur=c.custom;if(null==cur.alloc){cur.alloc=[];for(var _g=0,_g1=cur.frames;_g<_g1.length;){var frame=_g1[_g];++_g,cur.alloc.push('url("'+frame.ctx.canvas.toDataURL("image/png")+'") '+cur.offsetX+" "+cur.offsetY+", default")}}cur.frames.length>1&&(hxd_System.currentCustomCursor=cur,cur.reset()),tmp=cur.alloc[cur.frameIndex];break;case 6:_g=c.f;throw haxe_Exception.thrown("assert")}canvas.style.cursor=tmp}}},hxd_System.getDefaultFrameRate=function(){return 60},hxd_System.getValue=function(s){switch(s._hx_index){case 0:return hxd_System.get_platform()==hxd_Platform.Android||hxd_System.get_platform()==hxd_Platform.IOS;case 1:return!0;case 2:return hxd_System.get_platform()==hxd_Platform.Android||hxd_System.get_platform()==hxd_Platform.IOS}},hxd_System.updateCursor=function(){if(null!=hxd_System.currentCustomCursor){var change=hxd_System.currentCustomCursor.update(hxd_Timer.elapsedTime);if(-1!=change){var canvas=hxd_Window.getInstance().canvas;null!=canvas&&(canvas.style.cursor=hxd_System.currentCustomCursor.alloc[change])}}},hxd_System.get_platform=function(){var ua=$global.navigator.userAgent.toLowerCase();return ua.indexOf("android")>=0?hxd_Platform.Android:ua.indexOf("ipad")>=0||ua.indexOf("iphone")>=0||ua.indexOf("ipod")>=0?hxd_Platform.IOS:hxd_Platform.PC};var hxd_DisplayMode=$hxEnums["hxd.DisplayMode"]={__ename__:"hxd.DisplayMode",__constructs__:["Windowed","Borderless","Fullscreen","FullscreenResize"],Windowed:{_hx_index:0,__enum__:"hxd.DisplayMode",toString:$estr},Borderless:{_hx_index:1,__enum__:"hxd.DisplayMode",toString:$estr},Fullscreen:{_hx_index:2,__enum__:"hxd.DisplayMode",toString:$estr},FullscreenResize:{_hx_index:3,__enum__:"hxd.DisplayMode",toString:$estr}};hxd_DisplayMode.__empty_constructs__=[hxd_DisplayMode.Windowed,hxd_DisplayMode.Borderless,hxd_DisplayMode.Fullscreen,hxd_DisplayMode.FullscreenResize];var hxd_fs_FileEntry=function(){};$hxClasses["hxd.fs.FileEntry"]=hxd_fs_FileEntry,hxd_fs_FileEntry.__name__="hxd.fs.FileEntry",hxd_fs_FileEntry.prototype={getBytes:function(){return null},open:function(){},skip:function(nbytes){},readByte:function(){return 0},read:function(out,pos,size){},close:function(){},load:function(onReady){if(!this.get_isAvailable())throw haxe_Exception.thrown("load() not implemented");null!=onReady&&onReady()},loadBitmap:function(onLoaded){throw haxe_Exception.thrown("loadBitmap() not implemented")},watch:function(onChanged){},get_isAvailable:function(){return!0},get_path:function(){throw haxe_Exception.thrown("path() not implemented")},get_extension:function(){var np=this.name.split(".");return 1==np.length?"":np.pop().toLowerCase()},__class__:hxd_fs_FileEntry};var hxd_fs_FileSystem=function(){};$hxClasses["hxd.fs.FileSystem"]=hxd_fs_FileSystem,hxd_fs_FileSystem.__name__="hxd.fs.FileSystem",hxd_fs_FileSystem.__isInterface__=!0,hxd_fs_FileSystem.prototype={__class__:hxd_fs_FileSystem};var hxd_fs__$EmbedFileSystem_EmbedEntry=function(fs,name,relPath,data){this.fs=fs,this.name=name,this.relPath=relPath,this.data=data};$hxClasses["hxd.fs._EmbedFileSystem.EmbedEntry"]=hxd_fs__$EmbedFileSystem_EmbedEntry,hxd_fs__$EmbedFileSystem_EmbedEntry.__name__="hxd.fs._EmbedFileSystem.EmbedEntry",hxd_fs__$EmbedFileSystem_EmbedEntry.__super__=hxd_fs_FileEntry,hxd_fs__$EmbedFileSystem_EmbedEntry.prototype=$extend(hxd_fs_FileEntry.prototype,{getBytes:function(){return null==this.bytes&&this.open(),this.bytes},open:function(){if(null==this.bytes&&(this.bytes=haxe_Resource.getBytes(this.data),null==this.bytes))throw haxe_Exception.thrown("Missing resource "+this.data);this.readPos=0},skip:function(nbytes){this.readPos+=nbytes},readByte:function(){return this.bytes.b[this.readPos++]},read:function(out,pos,size){out.blit(pos,this.bytes,this.readPos,size),this.readPos+=size},close:function(){this.bytes=null,this.readPos=0},load:function(onReady){null!=onReady&&haxe_Timer.delay(onReady,1)},loadBitmap:function(onLoaded){for(var rawData=null,_g=0,_g1=haxe_Resource.content;_g<_g1.length;){var res=_g1[_g];if(++_g,res.name==this.data){rawData=res.data;break}}if(null==rawData)throw haxe_Exception.thrown("Missing resource "+this.data);var image=new Image;image.onload=function(_){onLoaded(image)};var extra="";for(_g=0,_g1=(3-4*(6*rawData.length>>3)%3)%3;_g<_g1;){_g++;extra+="="}var tmp="data:image/"+this.get_extension()+";base64,"+rawData;image.src=tmp+extra},get_path:function(){return"."==this.relPath?"<root>":this.relPath},__class__:hxd_fs__$EmbedFileSystem_EmbedEntry});var hxd_fs_EmbedFileSystem=function(root){this.root=root};$hxClasses["hxd.fs.EmbedFileSystem"]=hxd_fs_EmbedFileSystem,hxd_fs_EmbedFileSystem.__name__="hxd.fs.EmbedFileSystem",hxd_fs_EmbedFileSystem.__interfaces__=[hxd_fs_FileSystem],hxd_fs_EmbedFileSystem.resolve=function(path){return"R_"+path.replace(hxd_fs_EmbedFileSystem.invalidChars.r,"_")},hxd_fs_EmbedFileSystem.prototype={splitPath:function(path){return"."==path?[]:path.split("/")},exists:function(path){for(var r=this.root,_g=0,_g1=this.splitPath(path);_g<_g1.length;){var p=_g1[_g];if(++_g,null==(r=Reflect.field(r,p)))return!1}return!0},get:function(path){if(!this.exists(path))throw haxe_Exception.thrown(new hxd_fs_NotFound(path));var id=hxd_fs_EmbedFileSystem.resolve(path);return new hxd_fs__$EmbedFileSystem_EmbedEntry(this,path.split("/").pop(),path,id)},__class__:hxd_fs_EmbedFileSystem};var hxd_fs_FileInput=function(f){this.f=f,f.open()};$hxClasses["hxd.fs.FileInput"]=hxd_fs_FileInput,hxd_fs_FileInput.__name__="hxd.fs.FileInput",hxd_fs_FileInput.__super__=haxe_io_Input,hxd_fs_FileInput.prototype=$extend(haxe_io_Input.prototype,{skip:function(nbytes){this.f.skip(nbytes)},readByte:function(){return this.f.readByte()},readBytes:function(b,pos,len){return this.f.read(b,pos,len),len},close:function(){this.f.close()},__class__:hxd_fs_FileInput});var hxd_fs_LoadedBitmap={toBitmap:function(this1){var bmp=new hxd_BitmapData(this1.width,this1.height);return bmp.ctx.drawImage(this1,0,0),bmp}},hxd_fs_NotFound=function(path){this.path=path};$hxClasses["hxd.fs.NotFound"]=hxd_fs_NotFound,hxd_fs_NotFound.__name__="hxd.fs.NotFound",hxd_fs_NotFound.prototype={toString:function(){return"Resource file not found '"+this.path+"'"},__class__:hxd_fs_NotFound};var hxd_impl_Allocator=function(){};$hxClasses["hxd.impl.Allocator"]=hxd_impl_Allocator,hxd_impl_Allocator.__name__="hxd.impl.Allocator",hxd_impl_Allocator.get=function(){return null==hxd_impl_Allocator.inst&&(hxd_impl_Allocator.inst=new hxd_impl_Allocator),hxd_impl_Allocator.inst},hxd_impl_Allocator.prototype={onContextLost:function(){},__class__:hxd_impl_Allocator};var hxd_impl_ArrayIterator_$hxd_$snd_$Channel=function(a){this.i=0,this.a=a,this.l=this.a.length};$hxClasses["hxd.impl.ArrayIterator_hxd_snd_Channel"]=hxd_impl_ArrayIterator_$hxd_$snd_$Channel,hxd_impl_ArrayIterator_$hxd_$snd_$Channel.__name__="hxd.impl.ArrayIterator_hxd_snd_Channel",hxd_impl_ArrayIterator_$hxd_$snd_$Channel.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:hxd_impl_ArrayIterator_$hxd_$snd_$Channel};var hxd_res_Resource=function(entry){this.entry=entry};$hxClasses["hxd.res.Resource"]=hxd_res_Resource,hxd_res_Resource.__name__="hxd.res.Resource",hxd_res_Resource.prototype={toString:function(){return this.entry.get_path()},watch:function(onChanged){hxd_res_Resource.LIVE_UPDATE&&this.entry.watch(onChanged)},__class__:hxd_res_Resource};var hxd_res_Image=function(entry){hxd_res_Resource.call(this,entry)};$hxClasses["hxd.res.Image"]=hxd_res_Image,hxd_res_Image.__name__="hxd.res.Image",hxd_res_Image.__super__=hxd_res_Resource,hxd_res_Image.prototype=$extend(hxd_res_Resource.prototype,{getFormat:function(){return this.getSize(),this.inf.format},getSize:function(){if(null!=this.inf)return this.inf;var format,head,f=new hxd_fs_FileInput(this.entry),width=0,height=0,bc=0;try{head=f.readUInt16()}catch(_g){if(!(haxe_Exception.caught(_g).unwrap()instanceof haxe_io_Eof))throw _g;head=0}switch(head){case 17476:format=4,f.skip(10),height=f.readInt32(),width=f.readInt32(),f.skip(64);var fourCC=f.readInt32();switch(16777215&fourCC){case 4805697:switch((fourCC>>>24)-48){case 1:bc=4;break;case 2:bc=5;break;default:bc=0}break;case 5527620:switch((fourCC>>>24)-48){case 1:bc=1;break;case 2:case 3:bc=2;break;case 4:case 5:bc=3;break;default:bc=0}break;default:if(808540228==fourCC){f.skip(40);var dxgi=f.readInt32();switch(dxgi){case 95:bc=6;break;case 98:bc=7;break;default:throw haxe_Exception.thrown(this.entry.get_path()+" has unsupported DXGI format "+dxgi)}}}if(0==bc)throw haxe_Exception.thrown(this.entry.get_path()+" has unsupported 4CC "+String.fromCodePoint(255&fourCC)+String.fromCodePoint(fourCC>>8&255)+String.fromCodePoint(fourCC>>16&255)+String.fromCodePoint(fourCC>>>24));break;case 18759:format=2,f.readInt32(),width=f.readUInt16(),height=f.readUInt16();break;case 20617:for(format=1,f.set_bigEndian(!0),f.skip(6);;){var dataLen=f.readInt32();if(1229472850==f.readInt32()){width=f.readInt32(),height=f.readInt32();break}f.skip(dataLen+4)}break;case 55551:format=0,f.set_bigEndian(!0);_hx_loop2:for(;;)switch(f.readUInt16()){case 65472:case 65473:case 65474:f.readUInt16(),f.readByte();height=f.readUInt16(),width=f.readUInt16();break _hx_loop2;default:f.skip(f.readUInt16()-2)}break;default:if("tga"!=this.entry.get_extension())throw haxe_Exception.thrown("Unsupported texture format "+this.entry.get_path());format=3,f.skip(10),width=f.readUInt16(),height=f.readUInt16()}return f.close(),this.inf={width:width,height:height,format:format,bc:bc},this.inf},getPixels:function(fmt,flipY){var pixels;switch(this.getSize(),this.inf.format){case 0:var bytes=this.entry.getBytes();try{p=hxd_res_NanoJpeg.decode(bytes)}catch(_g){var e=haxe_Exception.caught(_g).unwrap();throw haxe_Exception.thrown("Failed to decode JPG "+this.entry.get_path()+" ("+Std.string(e)+")")}pixels=new hxd_Pixels(p.width,p.height,p.pixels,hxd_PixelFormat.BGRA);break;case 1:bytes=this.entry.getBytes();var png=new format_png_Reader(new haxe_io_BytesInput(bytes));png.checkCRC=!1,pixels=hxd_Pixels.alloc(this.inf.width,this.inf.height,hxd_PixelFormat.BGRA);var pdata=png.read();format_png_Tools.extract32(pdata,pixels.bytes,flipY),flipY&&(pixels.flags|=1<<hxd_Flags.FlipY._hx_index);break;case 2:bytes=this.entry.getBytes();var gif=new format_gif_Reader(new haxe_io_BytesInput(bytes)).read();pixels=new hxd_Pixels(this.inf.width,this.inf.height,format_gif_Tools.extractFullBGRA(gif,0),hxd_PixelFormat.BGRA);break;case 3:bytes=this.entry.getBytes();var r=new format_tga_Reader(new haxe_io_BytesInput(bytes)).read();if(r.header.imageType!=format_tga_ImageType.UncompressedTrueColor||32!=r.header.bitsPerPixel)throw haxe_Exception.thrown("Not supported "+Std.string(r.header.imageType)+"/"+r.header.bitsPerPixel);var w=r.header.width,h=r.header.height;pixels=hxd_Pixels.alloc(w,h,hxd_PixelFormat.ARGB);for(var access=hxd_PixelsARGB.fromPixels(pixels),p=0,_g=0,_g1=h;_g<_g1;)for(var y=_g++,_g2=0,_g3=w;_g2<_g3;){var x=_g2++,c=r.imageData[x+y*w];access.bytes.setInt32((x+y*access.width<<2)+access.offset,c>>>24|c>>8&65280|c<<8&16711680|c<<24)}switch(r.header.imageOrigin._hx_index){case 0:pixels.flags|=1<<hxd_Flags.FlipY._hx_index;break;case 2:break;default:throw haxe_Exception.thrown("Not supported "+Std.string(r.header.imageOrigin))}break;case 4:bytes=this.entry.getBytes();pixels=new hxd_Pixels(this.inf.width,this.inf.height,bytes,hxd_PixelFormat.S3TC(this.inf.bc),128+(this.inf.bc>=6?20:0))}return null!=fmt&&pixels.convert(fmt),null!=flipY&&pixels.setFlip(flipY),pixels},watchCallb:function(){var w=this.inf.width,h=this.inf.height;this.inf=null;var s=this.getSize();w==s.width&&h==s.height||this.tex.resize(w,h),this.tex.realloc=null,this.loadTexture()},loadTexture:function(){var _gthis=this;if(0==this.getFormat()||hxd_res_Image.DEFAULT_ASYNC)this.tex.flags|=1<<h3d_mat_TextureFlags.Loading._hx_index,this.entry.loadBitmap((function(bmp){var bmp1=hxd_fs_LoadedBitmap.toBitmap(bmp);if(_gthis.tex.alloc(),bmp1.ctx.canvas.width!=_gthis.tex.width||bmp1.ctx.canvas.height!=_gthis.tex.height){var pixels=bmp1.getPixels();pixels.makeSquare(),_gthis.tex.uploadPixels(pixels),pixels.dispose()}else _gthis.tex.uploadBitmap(bmp1);if(bmp1.ctx=null,bmp1.pixel=null,_gthis.tex.realloc=$bind(_gthis,_gthis.loadTexture),_gthis.tex.flags&=-1-(1<<h3d_mat_TextureFlags.Loading._hx_index),null!=_gthis.tex.waitLoads){var arr=_gthis.tex.waitLoads;_gthis.tex.waitLoads=null;for(var _g=0;_g<arr.length;){var f=arr[_g];++_g,f()}}hxd_res_Image.ENABLE_AUTO_WATCH&&_gthis.watch($bind(_gthis,_gthis.watchCallb))}));else{var load=function(){_gthis.tex.alloc();var pixels=_gthis.getPixels(_gthis.tex.format);pixels.width==_gthis.tex.width&&pixels.height==_gthis.tex.height||pixels.makeSquare(),_gthis.tex.uploadPixels(pixels),pixels.dispose(),_gthis.tex.realloc=$bind(_gthis,_gthis.loadTexture),hxd_res_Image.ENABLE_AUTO_WATCH&&_gthis.watch($bind(_gthis,_gthis.watchCallb))};this.entry.get_isAvailable()?load():this.entry.load(load)}},toTexture:function(){if(null!=this.tex)return this.tex;this.getSize();var width=this.inf.width,height=this.inf.height;if(!hxd_res_Image.ALLOW_NPOT){for(var tw=1,th=1;tw<width;)tw<<=1;for(;th<height;)th<<=1;width=tw,height=th}var format=h3d_mat_Texture.nativeFormat;return 4==this.inf.format&&(format=hxd_PixelFormat.S3TC(this.inf.bc)),this.tex=new h3d_mat_Texture(width,height,[h3d_mat_TextureFlags.NoAlloc],format),hxd_res_Image.DEFAULT_FILTER!=h3d_mat_Filter.Linear&&this.tex.set_filter(hxd_res_Image.DEFAULT_FILTER),this.tex.setName(this.entry.get_path()),this.loadTexture(),this.tex},toTile:function(){var size=this.getSize();return h2d_Tile.fromTexture(this.toTexture()).sub(0,0,size.width,size.height)},__class__:hxd_res_Image});var hxd_res_Loader=function(fs){this.fs=fs,this.cache=new haxe_ds_StringMap};$hxClasses["hxd.res.Loader"]=hxd_res_Loader,hxd_res_Loader.__name__="hxd.res.Loader",hxd_res_Loader.prototype={loadCache:function(path,c){var res=this.cache.h[path];if(null==res){var entry=this.fs.get(path),old=hxd_res_Loader.currentInstance;hxd_res_Loader.currentInstance=this,res=Type.createInstance(c,[entry]),hxd_res_Loader.currentInstance=old,this.cache.h[path]=res}else if(null==(js_Boot.__downcastCheck(res,c)?res:null))throw haxe_Exception.thrown(path+" has been reintrepreted from "+Std.string(js_Boot.getClass(res))+" to "+Std.string(c));return res},__class__:hxd_res_Loader};var hxd_res_Filter=$hxEnums["hxd.res.Filter"]={__ename__:"hxd.res.Filter",__constructs__:["Fast","Chromatic"],Fast:{_hx_index:0,__enum__:"hxd.res.Filter",toString:$estr},Chromatic:{_hx_index:1,__enum__:"hxd.res.Filter",toString:$estr}};hxd_res_Filter.__empty_constructs__=[hxd_res_Filter.Fast,hxd_res_Filter.Chromatic];var hxd_res__$NanoJpeg_Component=function(){};$hxClasses["hxd.res._NanoJpeg.Component"]=hxd_res__$NanoJpeg_Component,hxd_res__$NanoJpeg_Component.__name__="hxd.res._NanoJpeg.Component",hxd_res__$NanoJpeg_Component.prototype={__class__:hxd_res__$NanoJpeg_Component};var hxd_res_NanoJpeg=function(){this.comps=[new hxd_res__$NanoJpeg_Component,new hxd_res__$NanoJpeg_Component,new hxd_res__$NanoJpeg_Component].slice(0);var this1=new Array(64),this2=new Array(64),this3=new Array(64),this4=new Array(64);this.qtab=[this1,this2,this3,this4].slice(0);this1=new Array(16);this.counts=this1;this1=new Array(64);this.block=this1,this.njZZ=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63].slice(0),this.vlctab=[null,null,null,null,null,null,null,null].slice(0)};$hxClasses["hxd.res.NanoJpeg"]=hxd_res_NanoJpeg,hxd_res_NanoJpeg.__name__="hxd.res.NanoJpeg",hxd_res_NanoJpeg.decode=function(bytes,filter,position,size){return null==size&&(size=-1),null==position&&(position=0),null==hxd_res_NanoJpeg.inst&&(hxd_res_NanoJpeg.inst=new hxd_res_NanoJpeg),hxd_res_NanoJpeg.inst.njInit(bytes,position,size,filter),hxd_res_NanoJpeg.inst.njDecode()},hxd_res_NanoJpeg.prototype={njInit:function(bytes,pos,size,filter){this.bytes=bytes,this.pos=pos,this.filter=null==filter?hxd_res_Filter.Chromatic:filter,size<0&&(size=bytes.length-pos),null==this.vlctab[0]&&(this.vlctab[0]=new haxe_io_Bytes(new ArrayBuffer(131072))),null==this.vlctab[1]&&(this.vlctab[1]=new haxe_io_Bytes(new ArrayBuffer(131072))),null==this.vlctab[2]&&(this.vlctab[2]=new haxe_io_Bytes(new ArrayBuffer(131072))),null==this.vlctab[3]&&(this.vlctab[3]=new haxe_io_Bytes(new ArrayBuffer(131072))),this.size=size,this.qtused=0,this.qtavail=0,this.rstinterval=0,this.length=0,this.buf=0,this.bufbits=0,this.progressive=!1,this.comps[0].dcpred=0,this.comps[1].dcpred=0,this.comps[2].dcpred=0},cleanup:function(){this.bytes=null;for(var _g=0,_g1=this.comps;_g<_g1.length;){var c=_g1[_g];++_g,null!=c.pixels&&(c.pixels=null)}null!=this.vlctab[0]&&(this.vlctab[0]=null),null!=this.vlctab[1]&&(this.vlctab[1]=null),null!=this.vlctab[2]&&(this.vlctab[2]=null),null!=this.vlctab[3]&&(this.vlctab[3]=null),null!=this.vlctab[4]&&(this.vlctab[4]=null),null!=this.vlctab[5]&&(this.vlctab[5]=null),null!=this.vlctab[6]&&(this.vlctab[6]=null),null!=this.vlctab[7]&&(this.vlctab[7]=null)},njShowBits:function(bits){if(0==bits)return 0;for(;this.bufbits<bits;)if(this.size<=0)this.buf=this.buf<<8|255,this.bufbits+=8;else{var newbyte=this.bytes.b[this.pos];if(this.pos++,this.size--,this.bufbits+=8,this.buf=this.buf<<8|newbyte,255==newbyte){var marker=this.bytes.b[this.pos];switch(this.pos++,this.size--,marker){case 217:this.size=0;break;case 0:case 255:break;default:this.buf=this.buf<<8|marker,this.bufbits+=8}}}return this.buf>>this.bufbits-bits&(1<<bits)-1},njDecodeSOF:function(){switch(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2,8!=this.bytes.b[this.pos]&&this.notSupported(),this.height=this.bytes.b[this.pos+1]<<8|this.bytes.b[this.pos+2],this.width=this.bytes.b[this.pos+3]<<8|this.bytes.b[this.pos+4],this.ncomp=this.bytes.b[this.pos+5],this.pos+=6,this.size-=6,this.length-=6,this.ncomp){case 1:case 3:break;default:this.notSupported()}for(var ssxmax=0,ssymax=0,_g=0,_g1=this.ncomp;_g<_g1;){var i=_g++;(c=this.comps[i]).cid=this.bytes.b[this.pos],c.ssx=this.bytes.b[this.pos+1]>>4,0!=(c.ssx&c.ssx-1)&&this.notSupported(),c.ssy=15&this.bytes.b[this.pos+1],0!=(c.ssy&c.ssy-1)&&this.notSupported(),c.qtsel=this.bytes.b[this.pos+2],this.pos+=3,this.size-=3,this.length-=3,this.qtused|=1<<c.qtsel,c.ssx>ssxmax&&(ssxmax=c.ssx),c.ssy>ssymax&&(ssymax=c.ssy)}1==this.ncomp&&(ssxmax=ssymax=1,(c=this.comps[0]).ssx=c.ssy=ssxmax);this.mbsizex=ssxmax<<3,this.mbsizey=ssymax<<3,this.mbwidth=(this.width+this.mbsizex-1)/this.mbsizex|0,this.mbheight=(this.height+this.mbsizey-1)/this.mbsizey|0;for(_g=0,_g1=this.ncomp;_g<_g1;){var c;i=_g++;(c=this.comps[i]).width=(this.width*c.ssx+ssxmax-1)/ssxmax|0,c.stride=c.width+7&2147483640,c.height=(this.height*c.ssy+ssymax-1)/ssymax|0,c.stride=this.mbwidth*this.mbsizex*c.ssx/ssxmax|0,(c.width<3&&c.ssx!=ssxmax||c.height<3&&c.ssy!=ssymax)&&this.notSupported(),c.pixels=new haxe_io_Bytes(new ArrayBuffer(c.stride*(this.mbheight*this.mbsizey*c.ssy/ssymax|0)))}var count=this.length;this.pos+=count,this.size-=count,this.length-=count},njDecodeDQT:function(){for(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;this.length>=65;){var i=this.bytes.b[this.pos];this.qtavail|=1<<i;for(var t=this.qtab[i],_g=0;_g<64;){var k=_g++;t[k]=this.bytes.b[this.pos+(k+1)]}this.pos+=65,this.size-=65,this.length-=65}},njDecodeDHT:function(){for(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;this.length>=17;){var i=this.bytes.b[this.pos];i=i>>4&1|(3&i)<<1,this.counts[0]=this.bytes.b[this.pos+1],this.counts[1]=this.bytes.b[this.pos+2],this.counts[2]=this.bytes.b[this.pos+3],this.counts[3]=this.bytes.b[this.pos+4],this.counts[4]=this.bytes.b[this.pos+5],this.counts[5]=this.bytes.b[this.pos+6],this.counts[6]=this.bytes.b[this.pos+7],this.counts[7]=this.bytes.b[this.pos+8],this.counts[8]=this.bytes.b[this.pos+9],this.counts[9]=this.bytes.b[this.pos+10],this.counts[10]=this.bytes.b[this.pos+11],this.counts[11]=this.bytes.b[this.pos+12],this.counts[12]=this.bytes.b[this.pos+13],this.counts[13]=this.bytes.b[this.pos+14],this.counts[14]=this.bytes.b[this.pos+15],this.counts[15]=this.bytes.b[this.pos+16],this.pos+=17,this.size-=17,this.length-=17;for(var vlc=this.vlctab[i],vpos=0,remain=65536,spread=65536,_g=1;_g<17;){var codelen=_g++;spread>>=1;var currcnt=this.counts[codelen-1];if(0!=currcnt){remain-=currcnt<<16-codelen;for(var _g1=0,_g2=currcnt;_g1<_g2;)for(var i1=_g1++,code=this.bytes.b[this.pos+i1],_g3=0,_g4=spread;_g3<_g4;){_g3++;vlc.b[vpos++]=codelen,vlc.b[vpos++]=code}this.pos+=currcnt,this.size-=currcnt,this.length-=currcnt}}for(;0!=remain--;)vlc.b[vpos]=0,vpos+=2}},njDecodeDRI:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2,this.rstinterval=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];var count=this.length;this.pos+=count,this.size-=count,this.length-=count},njDecodeBlock:function(c,po){for(var value,out=c.pixels,coef=0,_g=0;_g<64;){var i=_g++;this.block[i]=0}var tmp,c1=c,c2=c1.dcpred,vlc=this.vlctab[c.dctabsel],value1=this.njShowBits(16),bits=vlc.b[value1<<1];if(this.bufbits<bits&&this.njShowBits(bits),this.bufbits-=bits,value1=vlc.b[value1<<1|1],this.vlcCode=value1,0==(bits=15&value1))tmp=0;else{var r=this.njShowBits(bits);this.bufbits-=bits,(value1=r)<1<<bits-1&&(value1+=1+(-1<<bits)),tmp=value1}c1.dcpred=c2+tmp;var qt=this.qtab[c.qtsel],at=this.vlctab[c.actabsel];for(this.block[0]=c.dcpred*qt[0];;){value1=this.njShowBits(16),bits=at.b[value1<<1];if(this.bufbits<bits&&this.njShowBits(bits),this.bufbits-=bits,value1=at.b[value1<<1|1],this.vlcCode=value1,0==(bits=15&value1))value=0;else{r=this.njShowBits(bits);this.bufbits-=bits,(value1=r)<1<<bits-1&&(value1+=1+(-1<<bits)),value=value1}if(0==this.vlcCode)break;if(coef+=1+(this.vlcCode>>4),this.block[this.njZZ[coef]]=value*qt[coef],!(coef<63))break}var bp=0;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){var val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val;val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;bp=8;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val,val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;bp=16;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val,val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;bp=24;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val,val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;bp=32;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val,val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;bp=40;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val,val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;bp=48;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val,val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;bp=56;if(0==((x1=this.block[bp+4]<<11)|(x2=this.block[bp+6])|(x3=this.block[bp+2])|(x4=this.block[bp+1])|(x5=this.block[bp+7])|(x6=this.block[bp+5])|(x7=this.block[bp+3]))){val=this.block[bp+7]=this.block[bp]<<3,val1=this.block[bp+6]=val,val=this.block[bp+5]=val1,val1=this.block[bp+4]=val,val=this.block[bp+3]=val1,val1=this.block[bp+2]=val,val=this.block[bp+1]=val1;this.block[bp]=val}else x4=(x8=565*(x4+x5))+2276*x4,x5=x8-3406*x5,x6=(x8=2408*(x6+x7))-799*x6,x7=x8-4017*x7,x8=(x0=128+(this.block[bp]<<11))+x1,x0-=x1,x2=(x1=1108*(x3+x2))-3784*x2,x3=x1+1568*x3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8,this.block[bp]=x7+x1>>8,this.block[bp+1]=x3+x2>>8,this.block[bp+2]=x0+x4>>8,this.block[bp+3]=x8+x6>>8,this.block[bp+4]=x8-x6>>8,this.block[bp+5]=x0-x4>>8,this.block[bp+6]=x3-x2>>8,this.block[bp+7]=x7-x1>>8;var po1=po,stride=c.stride;if(0==((x1=this.block[32]<<8)|(x2=this.block[48])|(x3=this.block[16])|(x4=this.block[8])|(x5=this.block[56])|(x6=this.block[40])|(x7=this.block[24]))){x1=(x=128+(this.block[0]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[0]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;var x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}po1=1+po,stride=c.stride;if(0==((x1=this.block[33]<<8)|(x2=this.block[49])|(x3=this.block[17])|(x4=this.block[9])|(x5=this.block[57])|(x6=this.block[41])|(x7=this.block[25]))){x1=(x=128+(this.block[1]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[1]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}po1=2+po,stride=c.stride;if(0==((x1=this.block[34]<<8)|(x2=this.block[50])|(x3=this.block[18])|(x4=this.block[10])|(x5=this.block[58])|(x6=this.block[42])|(x7=this.block[26]))){x1=(x=128+(this.block[2]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[2]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}po1=3+po,stride=c.stride;if(0==((x1=this.block[35]<<8)|(x2=this.block[51])|(x3=this.block[19])|(x4=this.block[11])|(x5=this.block[59])|(x6=this.block[43])|(x7=this.block[27]))){x1=(x=128+(this.block[3]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[3]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}po1=4+po,stride=c.stride;if(0==((x1=this.block[36]<<8)|(x2=this.block[52])|(x3=this.block[20])|(x4=this.block[12])|(x5=this.block[60])|(x6=this.block[44])|(x7=this.block[28]))){x1=(x=128+(this.block[4]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[4]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}po1=5+po,stride=c.stride;if(0==((x1=this.block[37]<<8)|(x2=this.block[53])|(x3=this.block[21])|(x4=this.block[13])|(x5=this.block[61])|(x6=this.block[45])|(x7=this.block[29]))){x1=(x=128+(this.block[5]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[5]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}po1=6+po,stride=c.stride;if(0==((x1=this.block[38]<<8)|(x2=this.block[54])|(x3=this.block[22])|(x4=this.block[14])|(x5=this.block[62])|(x6=this.block[46])|(x7=this.block[30]))){x1=(x=128+(this.block[6]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[6]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}var x0,x8,x1,x2,x3,x4,x5,x6,x7;po1=7+po,stride=c.stride;if(0==((x1=this.block[39]<<8)|(x2=this.block[55])|(x3=this.block[23])|(x4=this.block[15])|(x5=this.block[63])|(x6=this.block[47])|(x7=this.block[31]))){x1=(x=128+(this.block[7]+32>>6))<0?0:x>255?255:x,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride,out.b[po1]=x1,po1+=stride}else{x4=(x8=565*(x4+x5)+4)+2276*x4>>3,x5=x8-3406*x5>>3,x6=(x8=2408*(x6+x7)+4)-799*x6>>3,x7=x8-4017*x7>>3,x8=(x0=8192+(this.block[7]<<8))+x1,x0-=x1,x2=(x1=1108*(x3+x2)+4)-3784*x2>>3,x3=x1+1568*x3>>3,x1=x4+x6,x4-=x6,x6=x5+x7,x5-=x7,x7=x8+x3,x8-=x3,x3=x0+x2,x0-=x2,x2=181*(x4+x5)+128>>8,x4=181*(x4-x5)+128>>8;x=128+(x7+x1>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3+x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0+x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8+x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x8-x6>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x0-x4>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x3-x2>>14);out.b[po1]=x<0?0:x>255?255:x,po1+=stride;x=128+(x7-x1>>14);out.b[po1]=x<0?0:x>255?255:x}},notSupported:function(){throw haxe_Exception.thrown("This JPG file is not supported")},njDecodeScan:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2,this.bytes.b[this.pos]!=this.ncomp&&this.notSupported(),this.pos+=1,this.size-=1,this.length-=1;for(var _g=0,_g1=this.ncomp;_g<_g1;){var i=_g++;(c=this.comps[i]).dctabsel=this.bytes.b[this.pos+1]>>4<<1,c.actabsel=(3&this.bytes.b[this.pos+1])<<1|1,this.pos+=2,this.size-=2,this.length-=2}var start=this.bytes.b[this.pos],count=this.bytes.b[this.pos+1],other=this.bytes.b[this.pos+2];(!this.progressive&&0!=start||count!=63-start||0!=other)&&this.notSupported();count=this.length;this.pos+=count,this.size-=count,this.length-=count;for(var mbx=0,mby=0,rstcount=this.rstinterval,nextrst=0;;){for(_g=0,_g1=this.ncomp;_g<_g1;){i=_g++;for(var c,_g2=0,_g3=(c=this.comps[i]).ssy;_g2<_g3;)for(var sby=_g2++,_g4=0,_g5=c.ssx;_g4<_g5;){var sbx=_g4++;this.njDecodeBlock(c,(mby*c.ssy+sby)*c.stride+mbx*c.ssx+sbx<<3)}}if(++mbx>=this.mbwidth&&(mbx=0,++mby>=this.mbheight))break;if(0!=this.rstinterval&&0==--rstcount){this.bufbits&=248;this.njShowBits(16);this.bufbits-=16;nextrst=nextrst+1&7,rstcount=this.rstinterval,this.comps[0].dcpred=0,this.comps[1].dcpred=0,this.comps[2].dcpred=0}}},njUpsampleH:function(c){for(var xmax=c.width-3,cout=new haxe_io_Bytes(new ArrayBuffer(c.width*c.height<<1)),lout=cout,lin=c.pixels,pi=0,po=0,_g=0,_g1=c.height;_g<_g1;){_g++;var x=139*lin.b[pi]+-11*lin.b[pi+1]+64>>7;lout.b[po]=x<0?0:x>255?255:x;var x1=104*lin.b[pi]+27*lin.b[pi+1]+-3*lin.b[pi+2]+64>>7;lout.b[po+1]=x1<0?0:x1>255?255:x1;var x2=28*lin.b[pi]+109*lin.b[pi+1]+-9*lin.b[pi+2]+64>>7;lout.b[po+2]=x2<0?0:x2>255?255:x2;for(var _g2=0,_g3=xmax;_g2<_g3;){var x3=_g2++,x4=-9*lin.b[pi+x3]+111*lin.b[pi+x3+1]+29*lin.b[pi+x3+2]+-3*lin.b[pi+x3+3]+64>>7;lout.b[po+(x3<<1)+3]=x4<0?0:x4>255?255:x4;var x5=-3*lin.b[pi+x3]+29*lin.b[pi+x3+1]+111*lin.b[pi+x3+2]+-9*lin.b[pi+x3+3]+64>>7;lout.b[po+(x3<<1)+4]=x5<0?0:x5>255?255:x5}pi+=c.stride,po+=c.width<<1;var x6=28*lin.b[pi-1]+109*lin.b[pi-2]+-9*lin.b[pi-3]+64>>7;lout.b[po-3]=x6<0?0:x6>255?255:x6;var x7=104*lin.b[pi-1]+27*lin.b[pi-2]+-3*lin.b[pi-3]+64>>7;lout.b[po-2]=x7<0?0:x7>255?255:x7;var x8=139*lin.b[pi-1]+-11*lin.b[pi-2]+64>>7;lout.b[po-1]=x8<0?0:x8>255?255:x8}c.width<<=1,c.stride=c.width,c.pixels=cout},njUpsampleV:function(c){for(var w=c.width,s1=c.stride,s2=s1+s1,out=new haxe_io_Bytes(new ArrayBuffer(c.width*c.height<<1)),pi=0,po=0,cout=out,cin=c.pixels,_g=0,_g1=w;_g<_g1;){pi=po=_g++;var x1=139*cin.b[pi]+-11*cin.b[pi+s1]+64>>7;cout.b[po]=x1<0?0:x1>255?255:x1,po+=w;var x2=104*cin.b[pi]+27*cin.b[pi+s1]+-3*cin.b[pi+s2]+64>>7;cout.b[po]=x2<0?0:x2>255?255:x2,po+=w;var x3=28*cin.b[pi]+109*cin.b[pi+s1]+-9*cin.b[pi+s2]+64>>7;cout.b[po]=x3<0?0:x3>255?255:x3,po+=w,pi+=s1;for(var _g2=0,_g3=c.height-2;_g2<_g3;){_g2++;var x4=-9*cin.b[pi-s1]+111*cin.b[pi]+29*cin.b[pi+s1]+-3*cin.b[pi+s2]+64>>7;cout.b[po]=x4<0?0:x4>255?255:x4,po+=w;var x5=-3*cin.b[pi-s1]+29*cin.b[pi]+111*cin.b[pi+s1]+-9*cin.b[pi+s2]+64>>7;cout.b[po]=x5<0?0:x5>255?255:x5,po+=w,pi+=s1}pi+=s1;var x6=28*cin.b[pi]+109*cin.b[pi-s1]+-9*cin.b[pi-s2]+64>>7;cout.b[po]=x6<0?0:x6>255?255:x6,po+=w;var x7=104*cin.b[pi]+27*cin.b[pi-s1]+-3*cin.b[pi-s2]+64>>7;cout.b[po]=x7<0?0:x7>255?255:x7,po+=w;var x8=139*cin.b[pi]+-11*cin.b[pi-s1]+64>>7;cout.b[po]=x8<0?0:x8>255?255:x8}c.height<<=1,c.stride=c.width,c.pixels=out},njUpsample:function(c){for(var xshift=0,yshift=0;c.width<this.width;)c.width<<=1,++xshift;for(;c.height<this.height;)c.height<<=1,++yshift;for(var out=new haxe_io_Bytes(new ArrayBuffer(c.width*c.height)),lin=c.pixels,pout=0,lout=out,_g=0,_g1=c.height;_g<_g1;)for(var pin=(_g++>>yshift)*c.stride,_g2=0,_g3=c.width;_g2<_g3;){var x=_g2++;lout.b[pout++]=lin.b[(x>>xshift)+pin]}c.stride=c.width,c.pixels=out},njConvert:function(){for(var _g=0,_g1=this.ncomp;_g<_g1;){var i=_g++,c=this.comps[i];switch(this.filter._hx_index){case 0:(c.width<this.width||c.height<this.height)&&this.njUpsample(c);break;case 1:for(;c.width<this.width||c.height<this.height;)c.width<this.width&&this.njUpsampleH(c),c.height<this.height&&this.njUpsampleV(c)}if(c.width<this.width||c.height<this.height)throw haxe_Exception.thrown("assert")}var pixels=new haxe_io_Bytes(new ArrayBuffer(this.width*this.height*4));if(3!=this.ncomp)throw haxe_Exception.thrown("TODO");var py=this.comps[0].pixels,pcb=this.comps[1].pixels,pcr=this.comps[2].pixels,pix=pixels,k1=0,k2=0,k3=0,out=0;for(_g=0,_g1=this.height;_g<_g1;){_g++;for(var _g2=0,_g3=this.width;_g2<_g3;){_g2++;var y=py.b[k1++]<<8,cb=pcb.b[k2++]-128,cr=pcr.b[k3++]-128,x1=y+359*cr+128>>8,r=x1<0?0:x1>255?255:x1,x2=y-88*cb-183*cr+128>>8,g=x2<0?0:x2>255?255:x2,x3=y+454*cb+128>>8,b=x3<0?0:x3>255?255:x3;pix.b[out++]=b,pix.b[out++]=g,pix.b[out++]=r,pix.b[out++]=255}k1+=this.comps[0].stride-this.width,k2+=this.comps[1].stride-this.width,k3+=this.comps[2].stride-this.width}return pixels},njDecode:function(){if(this.size<2||255!=this.bytes.b[this.pos]||216!=this.bytes.b[this.pos+1])throw haxe_Exception.thrown("This file is not a JPEG");this.pos+=2,this.size-=2,this.length-=2;_hx_loop1:for(;;)switch(this.pos+=2,this.size-=2,this.length-=2,this.bytes.b[this.pos+-1]){case 192:this.njDecodeSOF();break;case 194:if(this.progressive=!0,this.progressive)throw haxe_Exception.thrown("Unsupported progressive JPG");null==this.vlctab[4]&&(this.vlctab[4]=new haxe_io_Bytes(new ArrayBuffer(131072))),null==this.vlctab[5]&&(this.vlctab[5]=new haxe_io_Bytes(new ArrayBuffer(131072))),null==this.vlctab[6]&&(this.vlctab[6]=new haxe_io_Bytes(new ArrayBuffer(131072))),null==this.vlctab[7]&&(this.vlctab[7]=new haxe_io_Bytes(new ArrayBuffer(131072))),this.njDecodeSOF();break;case 195:throw haxe_Exception.thrown("Unsupported lossless JPG");case 196:this.njDecodeDHT();break;case 218:this.njDecodeScan();break _hx_loop1;case 219:this.njDecodeDQT();break;case 221:this.njDecodeDRI();break;case 254:this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;var count=this.length;this.pos+=count,this.size-=count,this.length-=count;break;default:switch(240&this.bytes.b[this.pos+-1]){case 192:throw haxe_Exception.thrown("Unsupported jpeg type "+(15&this.bytes.b[this.pos+-1]));case 224:this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;var count1=this.length;this.pos+=count1,this.size-=count1,this.length-=count1;break;default:throw haxe_Exception.thrown("Unsupported jpeg tag 0x"+StringTools.hex(this.bytes.b[this.pos+-1],2))}}var pixels=this.njConvert();return this.cleanup(),{pixels:pixels,width:this.width,height:this.height}},__class__:hxd_res_NanoJpeg};var hxd_res_Sound=function(entry){this.lastPlay=0,hxd_res_Resource.call(this,entry)};$hxClasses["hxd.res.Sound"]=hxd_res_Sound,hxd_res_Sound.__name__="hxd.res.Sound",hxd_res_Sound.__super__=hxd_res_Resource,hxd_res_Sound.prototype=$extend(hxd_res_Resource.prototype,{getData:function(){if(null!=this.data)return this.data;var bytes=this.entry.getBytes();switch(bytes.b[0]){case 73:case 255:this.data=new hxd_snd_Mp3Data(bytes);break;case 79:throw haxe_Exception.thrown("OGG format requires -lib stb_ogg_sound (for "+this.entry.get_path()+")");case 82:this.data=new hxd_snd_WavData(bytes)}if(null==this.data)throw haxe_Exception.thrown("Unsupported sound format "+this.entry.get_path());return hxd_res_Sound.ENABLE_AUTO_WATCH&&this.watch($bind(this,this.watchCallb)),this.data},play:function(loop,volume,channelGroup,soundGroup){return null==volume&&(volume=1),null==loop&&(loop=!1),this.lastPlay=HxOverrides.now()/1e3,this.channel=hxd_snd_Manager.get().play(this,channelGroup,soundGroup),this.channel.loop=loop,this.channel.set_volume(volume),this.channel},watchCallb:function(){var old=this.data;this.data=null;var data=this.getData();if(null!=old&&(old.channels!=data.channels||old.samples!=data.samples||old.sampleFormat!=data.sampleFormat||old.samplingRate!=data.samplingRate))for(var ch=hxd_snd_Manager.get().getAll(this);ch.hasNext();){var ch1=ch.next();ch1.duration=data.get_duration(),ch1.set_position(ch1.position)}},__class__:hxd_res_Sound});var hxd_snd_ChannelBase=function(){this.volume=1,this.bindedEffects=[],this.effects=[],this.mute=!1,this.priority=0};$hxClasses["hxd.snd.ChannelBase"]=hxd_snd_ChannelBase,hxd_snd_ChannelBase.__name__="hxd.snd.ChannelBase",hxd_snd_ChannelBase.prototype={set_volume:function(v){return this.currentFade=null,this.volume=v},updateCurrentVolume:function(now){if(null!=this.currentFade){var f=this.currentFade,dt=now-f.start;dt>=f.duration?(this.set_volume(f.targetVolume),null!=f.onEnd&&f.onEnd()):(this.set_volume(f.startVolume+dt/f.duration*(f.targetVolume-f.startVolume)),this.currentFade=f)}this.currentVolume=this.volume},removeEffect:function(e){HxOverrides.remove(this.effects,e)},__class__:hxd_snd_ChannelBase};var hxd_snd_Channel=function(){this.queue=[],this.positionChanged=!1,this.isLoading=!1,this.isVirtual=!1,this.lastStamp=0,this.audibleVolume=1,this.allowVirtual=!0,this.loop=!1,this.pause=!1,this.position=0,hxd_snd_ChannelBase.call(this),this.id=hxd_snd_Channel.ID++};$hxClasses["hxd.snd.Channel"]=hxd_snd_Channel,hxd_snd_Channel.__name__="hxd.snd.Channel",hxd_snd_Channel.__super__=hxd_snd_ChannelBase,hxd_snd_Channel.prototype=$extend(hxd_snd_ChannelBase.prototype,{onEnd:function(){},set_position:function(v){return this.lastStamp=HxOverrides.now()/1e3,this.positionChanged=!0,v>this.duration?v=this.duration:v<0&&(v=0),this.position=v},updateCurrentVolume:function(now){if(this.pause&&null!=this.currentFade){var f=this.currentFade;this.currentFade=null,this.updateCurrentVolume(now),this.currentFade=f}if(hxd_snd_ChannelBase.prototype.updateCurrentVolume.call(this,now),this.channelGroup.updateCurrentVolume(now),this.currentVolume*=this.channelGroup.currentVolume*this.soundGroup.volume,null!=this.manager){for(var _g=0,_g1=this.channelGroup.effects;_g<_g1.length;){var e=_g1[_g];++_g,this.currentVolume*=e.getVolumeModifier()}for(_g=0,_g1=this.effects;_g<_g1.length;){e=_g1[_g];++_g,this.currentVolume*=e.getVolumeModifier()}}},calcAudibleVolume:function(now){if(this.updateCurrentVolume(now),this.audibleVolume=this.currentVolume,null!=this.manager){for(var _g=0,_g1=this.channelGroup.effects;_g<_g1.length;){var e=_g1[_g];++_g,this.audibleVolume=e.applyAudibleVolumeModifier(this.audibleVolume)}for(_g=0,_g1=this.effects;_g<_g1.length;){e=_g1[_g];++_g,this.audibleVolume=e.applyAudibleVolumeModifier(this.audibleVolume)}}},stop:function(){null!=this.manager&&this.manager.releaseChannel(this)},__class__:hxd_snd_Channel});var hxd_snd_ChannelGroup=function(name){hxd_snd_ChannelBase.call(this),this.name=name};$hxClasses["hxd.snd.ChannelGroup"]=hxd_snd_ChannelGroup,hxd_snd_ChannelGroup.__name__="hxd.snd.ChannelGroup",hxd_snd_ChannelGroup.__super__=hxd_snd_ChannelBase,hxd_snd_ChannelGroup.prototype=$extend(hxd_snd_ChannelBase.prototype,{__class__:hxd_snd_ChannelGroup});var hxd_snd_SampleFormat=$hxEnums["hxd.snd.SampleFormat"]={__ename__:"hxd.snd.SampleFormat",__constructs__:["UI8","I16","F32"],UI8:{_hx_index:0,__enum__:"hxd.snd.SampleFormat",toString:$estr},I16:{_hx_index:1,__enum__:"hxd.snd.SampleFormat",toString:$estr},F32:{_hx_index:2,__enum__:"hxd.snd.SampleFormat",toString:$estr}};hxd_snd_SampleFormat.__empty_constructs__=[hxd_snd_SampleFormat.UI8,hxd_snd_SampleFormat.I16,hxd_snd_SampleFormat.F32];var hxd_snd_Data=function(){};$hxClasses["hxd.snd.Data"]=hxd_snd_Data,hxd_snd_Data.__name__="hxd.snd.Data",hxd_snd_Data.prototype={isLoading:function(){return!1},decode:function(out,outPos,sampleStart,sampleCount){var bpp=this.getBytesPerSample();if(sampleStart<0||sampleCount<0||outPos<0||outPos+sampleCount*bpp>out.length){var s="sampleStart = "+sampleStart;throw s+=" sampleCount = "+sampleCount,s+=" outPos = "+outPos,s+=" bpp = "+bpp,s+=" out.length = "+out.length,haxe_Exception.thrown(s)}if(sampleStart+sampleCount>=this.samples){var count=0;return sampleStart<this.samples&&(count=this.samples-sampleStart,this.decodeBuffer(out,outPos,sampleStart,count)),void out.fill(outPos+count*bpp,(sampleCount-count)*bpp,0)}this.decodeBuffer(out,outPos,sampleStart,sampleCount)},resample:function(rate,format,channels){if(this.sampleFormat==format&&this.samplingRate==rate&&this.channels==channels)return this;var newSamples=Math.ceil(this.samples*(rate/this.samplingRate)),bpp=this.getBytesPerSample(),data=new haxe_io_Bytes(new ArrayBuffer(bpp*this.samples));this.decodeBuffer(data,0,0,this.samples);var out1,out=channels*newSamples;switch(format._hx_index){case 0:out1=1;break;case 1:out1=2;break;case 2:out1=4}var out2=new haxe_io_Bytes(new ArrayBuffer(out*out1));return this.resampleBuffer(out2,0,data,0,rate,format,channels,this.samples),(data=new hxd_snd_WavData(null)).channels=channels,data.samples=newSamples,data.sampleFormat=format,data.samplingRate=rate,data.rawData=out2,data},resampleBuffer:function(out,outPos,input,inPos,rate,format,channels,samples){var bpp=this.getBytesPerSample(),newSamples=Math.ceil(samples*(rate/this.samplingRate)),resample=samples!=newSamples;if(resample||this.sampleFormat!=hxd_snd_SampleFormat.I16||format!=hxd_snd_SampleFormat.I16||1!=channels||2!=this.channels){var srcChannels=this.channels,commonChannels=channels<srcChannels?channels:srcChannels,extraChannels=channels-commonChannels,sval=0,ival=0;for(_g=0,_g1=newSamples;_g<_g1;){var targetSample=_g++/(newSamples-1)*(samples-1),isample=0|targetSample,offset=targetSample-isample,srcPos=inPos+isample*bpp;isample==samples-1&&(resample=!1);for(var _g2=0,_g3=commonChannels;_g2<_g3;){_g2++;var sval1,sval2=0;switch(this.sampleFormat._hx_index){case 0:sval1=input.b[srcPos]/255,resample&&(sval2=input.b[srcPos+bpp]/255),++srcPos;break;case 1:var v=input.getUInt16(srcPos);if(sval1=(0==(32768&v)?v:-65536|v)/32768,resample){var v1=input.getUInt16(srcPos+bpp);sval2=(0==(32768&v1)?v1:-65536|v1)/32768}srcPos+=2;break;case 2:sval1=input.getFloat(srcPos),resample&&(sval2=input.getFloat(srcPos+bpp)),srcPos+=4}switch(sval=resample?sval1+offset*(sval2-sval1):sval1,format._hx_index){case 0:(ival=128*(sval+1)|0)>255&&(ival=255),out.b[outPos++]=ival;break;case 1:(ival=32768*sval|0)>32767&&(ival=32767),ival&=65535,out.setUInt16(outPos,ival),outPos+=2;break;case 2:out.setFloat(outPos,sval),outPos+=4}}for(var _g4=0,_g5=extraChannels;_g4<_g5;){_g4++;switch(format._hx_index){case 0:out.b[outPos++]=ival;break;case 1:out.setUInt16(outPos,ival),outPos+=2;break;case 2:out.setFloat(outPos,sval),outPos+=4}}}}else for(var r=inPos,w=outPos,_g=0,_g1=samples;_g<_g1;){_g++;var sl=input.getUInt16(r);r+=2;var s,sr=input.getUInt16(r);r+=2,(sl^sr)>=32768?(0!=(32768&sl)&&(sl|=-65536),0!=(32768&sr)&&(sr|=-65536),s=sl+sr>>1&65535):s=sl+sr>>1,out.setUInt16(w,s),w+=2}},decodeBuffer:function(out,outPos,sampleStart,sampleCount){throw haxe_Exception.thrown("Not implemented")},getBytesPerSample:function(){var tmp;switch(this.sampleFormat._hx_index){case 0:tmp=1;break;case 1:tmp=2;break;case 2:tmp=4}return this.channels*tmp},load:function(onEnd){onEnd()},get_duration:function(){return this.samples/this.samplingRate},__class__:hxd_snd_Data};var hxd_snd_EffectDriver=function(){};$hxClasses["hxd.snd.EffectDriver"]=hxd_snd_EffectDriver,hxd_snd_EffectDriver.__name__="hxd.snd.EffectDriver",hxd_snd_EffectDriver.prototype={acquire:function(){},release:function(){},update:function(e){},bind:function(e,source){},apply:function(e,source){},unbind:function(e,source){},__class__:hxd_snd_EffectDriver};var hxd_snd_DriverFeature=$hxEnums["hxd.snd.DriverFeature"]={__ename__:"hxd.snd.DriverFeature",__constructs__:["MasterVolume"],MasterVolume:{_hx_index:0,__enum__:"hxd.snd.DriverFeature",toString:$estr}};hxd_snd_DriverFeature.__empty_constructs__=[hxd_snd_DriverFeature.MasterVolume];var hxd_snd_Driver=function(){};$hxClasses["hxd.snd.Driver"]=hxd_snd_Driver,hxd_snd_Driver.__name__="hxd.snd.Driver",hxd_snd_Driver.__isInterface__=!0,hxd_snd_Driver.prototype={__class__:hxd_snd_Driver};var hxd_snd_Effect=function(type){this.refs=0,this.priority=0,this.retainTime=0,this.lastStamp=0;var managerDriver=hxd_snd_Manager.get().driver;null!=managerDriver&&(this.driver=managerDriver.getEffectDriver(type))};$hxClasses["hxd.snd.Effect"]=hxd_snd_Effect,hxd_snd_Effect.__name__="hxd.snd.Effect",hxd_snd_Effect.prototype={applyAudibleVolumeModifier:function(v){return v},getVolumeModifier:function(){return 1},__class__:hxd_snd_Effect};var hxd_snd_Listener=function(){this.position=new h3d_Vector,this.velocity=new h3d_Vector,this.direction=new h3d_Vector(1,0,0),this.up=new h3d_Vector(0,0,1)};$hxClasses["hxd.snd.Listener"]=hxd_snd_Listener,hxd_snd_Listener.__name__="hxd.snd.Listener",hxd_snd_Listener.prototype={__class__:hxd_snd_Listener};var hxd_snd_Source=function(driver){this.start=0,this.playing=!1,this.volume=-1,this.id=hxd_snd_Source.ID++,this.handle=driver.createSource(),this.buffers=[]};$hxClasses["hxd.snd.Source"]=hxd_snd_Source,hxd_snd_Source.__name__="hxd.snd.Source",hxd_snd_Source.prototype={dispose:function(){hxd_snd_Manager.get().driver.destroySource(this.handle)},__class__:hxd_snd_Source};var hxd_snd_Buffer=function(driver){this.handle=driver.createBuffer(),this.refs=0,this.lastStop=HxOverrides.now()/1e3};$hxClasses["hxd.snd.Buffer"]=hxd_snd_Buffer,hxd_snd_Buffer.__name__="hxd.snd.Buffer",hxd_snd_Buffer.prototype={dispose:function(){hxd_snd_Manager.get().driver.destroyBuffer(this.handle)},__class__:hxd_snd_Buffer};var hxd_snd_Manager=function(){this.suspended=!1,this.timeOffset=0;try{this.driver=new hxd_snd_webaudio_Driver}catch(_g){if("string"!=typeof haxe_Exception.caught(_g).unwrap())throw _g;this.driver=null}if(this.masterVolume=1,this.hasMasterVolume=null==this.driver||this.driver.hasFeature(hxd_snd_DriverFeature.MasterVolume),this.masterSoundGroup=new hxd_snd_SoundGroup("master"),this.masterChannelGroup=new hxd_snd_ChannelGroup("master"),this.listener=new hxd_snd_Listener,this.soundBufferMap=new haxe_ds_StringMap,this.soundBufferKeys=[],this.freeStreamBuffers=[],this.effectGC=[],this.soundBufferCount=0,null!=this.driver){this.sources=[];for(var _g=0,_g1=hxd_snd_Manager.MAX_SOURCES;_g<_g1;){_g++;this.sources.push(new hxd_snd_Source(this.driver))}}this.cachedBytes=new haxe_io_Bytes(new ArrayBuffer(24)),this.resampleBytes=new haxe_io_Bytes(new ArrayBuffer(2*hxd_snd_Manager.STREAM_BUFFER_SAMPLE_COUNT))};$hxClasses["hxd.snd.Manager"]=hxd_snd_Manager,hxd_snd_Manager.__name__="hxd.snd.Manager",hxd_snd_Manager.get=function(){return null==hxd_snd_Manager.instance&&(hxd_snd_Manager.instance=new hxd_snd_Manager,hxd_snd_Manager.instance.updateEvent=haxe_MainLoop.add($bind($_=hxd_snd_Manager.instance,$_.update)),hxd_snd_Manager.instance.updateEvent.isBlocking=!1),hxd_snd_Manager.instance},hxd_snd_Manager.regEffect=function(list,e){for(var l=list;null!=l;){if(l==e)return list;l=l.next}return e.next=list,e},hxd_snd_Manager.prototype={getTmpBytes:function(size){return this.cachedBytes.length<size&&(this.cachedBytes=new haxe_io_Bytes(new ArrayBuffer(size))),this.cachedBytes},getResampleBytes:function(size){return this.resampleBytes.length<size&&(this.resampleBytes=new haxe_io_Bytes(new ArrayBuffer(size))),this.resampleBytes},stopAll:function(){for(;null!=this.channels;)this.channels.stop()},getAll:function(sound){for(var ch=this.channels,result=[];null!=ch;)ch.sound==sound&&result.push(ch),ch=ch.next;return new hxd_impl_ArrayIterator_$hxd_$snd_$Channel(result)},dispose:function(){if(this.stopAll(),null!=this.driver){for(var _g=0,_g1=this.sources;_g<_g1.length;){var s=_g1[_g];++_g,s.dispose()}for(var b=haxe_ds_StringMap.valueIterator(this.soundBufferMap.h);b.hasNext();){b.next().dispose()}for(_g=0,_g1=this.freeStreamBuffers;_g<_g1.length;){b=_g1[_g];++_g,b.dispose()}for(_g=0,_g1=this.effectGC;_g<_g1.length;){var e=_g1[_g];++_g,e.driver.release()}this.driver.dispose()}this.sources=null,this.soundBufferMap=null,this.soundBufferKeys=null,this.freeStreamBuffers=null,this.effectGC=null,this.updateEvent.stop(),hxd_snd_Manager.instance=null},play:function(sound,channelGroup,soundGroup){null==soundGroup&&(soundGroup=this.masterSoundGroup),null==channelGroup&&(channelGroup=this.masterChannelGroup);var sdat=sound.getData();if(0==sdat.samples)throw haxe_Exception.thrown(Std.string(sound)+" has no samples");var c=new hxd_snd_Channel;return c.sound=sound,c.duration=sdat.get_duration(),c.manager=this,c.soundGroup=soundGroup,c.channelGroup=channelGroup,c.next=this.channels,c.isLoading=sdat.isLoading(),c.isVirtual=null==this.driver,this.channels=c,c},updateVirtualChannels:function(now){for(var c=this.channels;null!=c;)if(c.pause||!c.isVirtual||c.isLoading)c=c.next;else{var _g=c,a=now-c.lastStamp;_g.set_position(_g.position+(a<0?0:a)),c.lastStamp=now;for(var next=c.next;c.position>=c.duration;){var _g1=c;if(_g1.set_position(_g1.position-c.duration),c.onEnd(),null!=next&&null==next.manager&&(next=null),c.queue.length>0)c.sound=c.queue.shift(),c.duration=c.sound.getData().get_duration();else if(!c.loop){this.releaseChannel(c);break}}c=next}},update:function(){if(0!=this.timeOffset){for(var c=this.channels;null!=c;)c.lastStamp+=this.timeOffset,null!=c.currentFade&&(c.currentFade.start+=this.timeOffset),c=c.next;for(var _g=0,_g1=this.sources;_g<_g1.length;){var s=_g1[_g];++_g;for(var _g2=0,_g3=s.buffers;_g2<_g3.length;){var b=_g3[_g2];++_g2,b.lastStop+=this.timeOffset}}this.timeOffset=0}if(this.now=HxOverrides.now()/1e3,null!=this.driver){for(_g=0,_g1=this.sources;_g<_g1.length;){s=_g1[_g];if(++_g,null!=(c=s.channel))if(c.positionChanged)this.releaseSource(s);else{var lastBuffer=null;for(_g2=0,_g3=this.driver.getProcessedBuffers(s.handle);_g2<_g3;){var i=_g2++;null!=(b=this.unqueueBuffer(s))&&(lastBuffer=b,b.isEnd&&(c.sound=b.sound,c.duration=b.sound.getData().get_duration(),c.set_position(c.duration),c.positionChanged=!1,c.onEnd(),s.start=0))}if(0!=s.buffers.length){c.sound=s.buffers[0].sound,c.duration=c.sound.getData().get_duration();var playedSamples=this.driver.getPlayedSampleCount(s.handle);if(playedSamples<0&&(playedSamples=0),c.set_position((s.start+playedSamples)/s.buffers[0].sampleRate),c.positionChanged=!1,s.buffers.length<hxd_snd_Manager.BUFFER_QUEUE_LENGTH){var b1=s.buffers[s.buffers.length-1];if(b1.isEnd)if(c.queue.length>0){var snd=c.queue[0];this.queueBuffer(s,snd,0)&&c.queue.shift()}else c.loop&&this.queueBuffer(s,b1.sound,0);else this.queueBuffer(s,b1.sound,b1.start+b1.samples)}}else lastBuffer.isEnd?c.queue.length>0?(c.sound=c.queue[0],c.duration=c.sound.getData().get_duration(),c.set_position(0),this.releaseSource(s)):c.loop?(c.set_position(0),this.releaseSource(s)):this.releaseChannel(c):(c.set_position((lastBuffer.start+lastBuffer.samples)/lastBuffer.sampleRate),this.releaseSource(s))}}for(c=this.channels;null!=c;)c.calcAudibleVolume(this.now),c.isLoading&&!c.sound.getData().isLoading()&&(c.isLoading=!1),c.isVirtual=this.suspended||c.pause||c.mute||c.channelGroup.mute||c.allowVirtual&&c.audibleVolume<hxd_snd_Manager.VIRTUAL_VOLUME_THRESHOLD||c.isLoading,c=c.next;var tmp,list=this.channels,cmp=$bind(this,this.sortChannel);if(null==list)tmp=null;else{for(var insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(_g=0,_g1=insize;_g<_g1;){i=_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||cmp(p,q)<=0?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}tmp=list}this.channels=tmp;var audibleCount=0;for(c=this.channels;null!=c&&!c.isVirtual;)++audibleCount>this.sources.length?c.isVirtual=!0:c.soundGroup.maxAudible>=0&&(c.soundGroup.lastUpdate!=this.now&&(c.soundGroup.lastUpdate=this.now,c.soundGroup.numAudible=0),++c.soundGroup.numAudible>c.soundGroup.maxAudible&&(c.isVirtual=!0,--audibleCount)),c=c.next;for(_g=0,_g1=this.sources;_g<_g1.length;){s=_g1[_g];++_g,null!=s.channel&&s.channel.isVirtual&&this.releaseSource(s)}for(c=this.channels;null!=c;)if(null!=c.source||c.isVirtual)c=c.next;else{for(s=null,_g=0,_g1=this.sources;_g<_g1.length;){var s2=_g1[_g];if(++_g,null==s2.channel){s=s2;break}}if(null==s)throw haxe_Exception.thrown("could not get a source");s.channel=c,c.source=s,this.checkTargetFormat(c.sound.getData(),c.soundGroup.mono),s.start=Math.floor(c.position*this.targetRate),s.start<0&&(s.start=0),this.queueBuffer(s,c.sound,s.start),c.positionChanged=!1,c=c.next}var usedEffects=null,volume=this.hasMasterVolume?1:this.masterVolume;for(_g=0,_g1=this.sources;_g<_g1.length;){s=_g1[_g];if(++_g,null!=(c=s.channel)){var v=c.currentVolume*volume;s.volume!=v&&(v<0&&(v=0),s.volume=v,this.driver.setSourceVolume(s.handle,v)),s.playing||(this.driver.playSource(s.handle),s.playing=!0);for(i=c.bindedEffects.length;--i>=0;){var e=c.bindedEffects[i];c.effects.indexOf(e)<0&&c.channelGroup.effects.indexOf(e)<0&&this.unbindEffect(c,s,e)}for(_g2=0,_g3=c.channelGroup.effects;_g2<_g3.length;){var e1=_g3[_g2];++_g2,c.bindedEffects.indexOf(e1)<0&&this.bindEffect(c,s,e1)}for(var _g4=0,_g5=c.effects;_g4<_g5.length;){var e2=_g5[_g4];++_g4,c.bindedEffects.indexOf(e2)<0&&this.bindEffect(c,s,e2)}for(var _g6=0,_g7=c.bindedEffects;_g6<_g7.length;){var e3=_g7[_g6];++_g6,usedEffects=hxd_snd_Manager.regEffect(usedEffects,e3)}}}list=usedEffects,cmp=$bind(this,this.sortEffect);if(null==list)usedEffects=null;else{var nmerges,p,q,tail;for(insize=1,psize=0,qsize=0;;){for(p=list,list=null,tail=null,nmerges=0;null!=p;){++nmerges,q=p,psize=0;for(_g=0,_g1=insize;_g<_g1;){i=_g++;if(++psize,null==(q=q.next))break}for(qsize=insize;psize>0||qsize>0&&null!=q;)0==psize?(e=q,q=q.next,--qsize):0==qsize||null==q||cmp(p,q)<=0?(e=p,p=p.next,--psize):(e=q,q=q.next,--qsize),null!=tail?tail.next=e:list=e,tail=e;p=q}if(tail.next=null,nmerges<=1)break;insize*=2}usedEffects=list}for(e=usedEffects;null!=e;)e.driver.update(e),e=e.next;for(_g=0,_g1=this.sources;_g<_g1.length;){s=_g1[_g];if(++_g,null!=(c=s.channel))for(_g2=0,_g3=c.bindedEffects;_g2<_g3.length;){e=_g3[_g2];++_g2,e.driver.apply(e,s.handle)}}for(_g=0,_g1=this.effectGC;_g<_g1.length;){e=_g1[_g];if(++_g,this.now-e.lastStamp>e.retainTime){e.driver.release(),HxOverrides.remove(this.effectGC,e);break}}if(this.updateVirtualChannels(this.now),this.listener.direction.normalize(),this.listener.up.normalize(),this.hasMasterVolume&&this.driver.setMasterVolume(this.masterVolume),this.driver.setListenerParams(this.listener.position,this.listener.direction,this.listener.up,this.listener.velocity),this.driver.update(),this.soundBufferCount>=hxd_snd_Manager.SOUND_BUFFER_CACHE_SIZE){var now=HxOverrides.now()/1e3;for(i=0;i<this.soundBufferKeys.length;){var k=this.soundBufferKeys[i];if(++i,!((b=this.soundBufferMap.h[k]).refs>0||b.lastStop+60>now)){var _this=this.soundBufferMap;Object.prototype.hasOwnProperty.call(_this.h,k)&&delete _this.h[k],HxOverrides.remove(this.soundBufferKeys,k),--i,b.dispose(),--this.soundBufferCount}}}}else this.updateVirtualChannels(this.now)},progressiveDecodeBuffer:function(s,snd,start){var data=snd.getData(),samples=Math.ceil(hxd_snd_Manager.STREAM_BUFFER_SAMPLE_COUNT/hxd_snd_Manager.BUFFER_STREAM_SPLIT);s.streamStart==start&&s.streamSound==snd||(s.streamSound=snd,s.streamStart=start,s.streamPos=start);var end=start+hxd_snd_Manager.STREAM_BUFFER_SAMPLE_COUNT;if(s.streamPos==end)return!0;var bpp=data.getBytesPerSample(),reqSize=hxd_snd_Manager.STREAM_BUFFER_SAMPLE_COUNT*bpp;(null==s.streamBuffer||s.streamBuffer.length<reqSize)&&(s.streamBuffer=new haxe_io_Bytes(new ArrayBuffer(reqSize)),s.streamPos=start);var remain=end-s.streamPos;return remain>samples&&(remain=samples),data.decode(s.streamBuffer,(s.streamPos-start)*bpp,s.streamPos,remain),s.streamPos+=remain,s.streamPos==end},queueBuffer:function(s,snd,start){var data=snd.getData(),sgroup=s.channel.soundGroup,b=null;if(data.get_duration()<=hxd_snd_Manager.STREAM_DURATION)b=this.getSoundBuffer(snd,sgroup),this.driver.queueBuffer(s.handle,b.handle,start,!0);else{if(s.buffers.length>0&&hxd_snd_Manager.BUFFER_STREAM_SPLIT>1&&!this.progressiveDecodeBuffer(s,snd,start))return!1;b=this.getStreamBuffer(s,snd,sgroup,start),this.driver.queueBuffer(s.handle,b.handle,0,b.isEnd)}return s.buffers.push(b),!0},unqueueBuffer:function(s){var b=s.buffers.shift();return null==b?null:(this.driver.unqueueBuffer(s.handle,b.handle),b.isStream?this.freeStreamBuffers.unshift(b):0==--b.refs&&(b.lastStop=HxOverrides.now()/1e3),b)},bindEffect:function(c,s,e){0!=e.refs||HxOverrides.remove(this.effectGC,e)||e.driver.acquire(),++e.refs,e.driver.bind(e,s.handle),c.bindedEffects.push(e)},unbindEffect:function(c,s,e){e.driver.unbind(e,s.handle),HxOverrides.remove(c.bindedEffects,e),0==--e.refs&&(e.lastStamp=this.now,this.effectGC.push(e))},releaseSource:function(s){if(null!=s.channel){for(var _g=0,_g1=s.channel.bindedEffects.slice();_g<_g1.length;){var e=_g1[_g];++_g,this.unbindEffect(s.channel,s,e)}s.channel.bindedEffects=[],s.channel.source=null,s.channel=null}for(s.playing&&(s.playing=!1,this.driver.stopSource(s.handle),s.volume=-1);s.buffers.length>0;)this.unqueueBuffer(s)},checkTargetFormat:function(dat,forceMono){var tmp;switch(null==forceMono&&(forceMono=!1),this.targetRate=dat.samplingRate,this.targetChannels=forceMono||1==dat.channels?1:2,dat.sampleFormat._hx_index){case 0:tmp=hxd_snd_SampleFormat.UI8;break;case 1:tmp=hxd_snd_SampleFormat.I16;break;case 2:tmp=hxd_snd_SampleFormat.F32}return this.targetFormat=tmp,this.targetChannels==dat.channels&&this.targetFormat==dat.sampleFormat&&this.targetRate==dat.samplingRate},getSoundBuffer:function(snd,grp){var _gthis=this,data=snd.getData(),mono=grp.mono,key=snd.entry.get_path();mono&&1!=data.channels&&(key+="mono");var b=this.soundBufferMap.h[key];return null==b&&((b=new hxd_snd_Buffer(this.driver)).isStream=!1,b.isEnd=!0,b.sound=snd,data.load((function(){_gthis.fillSoundBuffer(b,data,mono)})),this.soundBufferMap.h[key]=b,this.soundBufferKeys.push(key),++this.soundBufferCount),++b.refs,b},fillSoundBuffer:function(buf,dat,forceMono){null==forceMono&&(forceMono=!1),this.checkTargetFormat(dat,forceMono)||(dat=dat.resample(this.targetRate,this.targetFormat,this.targetChannels));var length=dat.samples*dat.getBytesPerSample(),bytes=this.getTmpBytes(length);dat.decode(bytes,0,0,dat.samples),this.driver.setBufferData(buf.handle,bytes,length,this.targetFormat,this.targetChannels,this.targetRate),buf.sampleRate=this.targetRate,buf.samples=dat.samples},getStreamBuffer:function(src,snd,grp,start){var data=snd.getData(),b=this.freeStreamBuffers.shift();null==b&&((b=new hxd_snd_Buffer(this.driver)).isStream=!0);var samples=hxd_snd_Manager.STREAM_BUFFER_SAMPLE_COUNT;start+samples>=data.samples?(samples=data.samples-start,b.isEnd=!0):b.isEnd=!1,b.sound=snd,b.samples=samples,b.start=start;var bytes,size=samples*data.getBytesPerSample();if(src.streamSound==snd&&src.streamStart==start){for(;!this.progressiveDecodeBuffer(src,snd,start););bytes=src.streamBuffer}else bytes=this.getTmpBytes(size),data.decode(bytes,0,start,samples);if(!this.checkTargetFormat(data,grp.mono)){var size2,size1=Math.ceil(samples*(this.targetRate/data.samplingRate))*this.targetChannels;switch(this.targetFormat._hx_index){case 0:size2=1;break;case 1:size2=2;break;case 2:size2=4}size=size1*size2;var resampleBytes=this.getResampleBytes(size);data.resampleBuffer(resampleBytes,0,bytes,0,this.targetRate,this.targetFormat,this.targetChannels,samples),bytes=resampleBytes}return this.driver.setBufferData(b.handle,bytes,size,this.targetFormat,this.targetChannels,this.targetRate),b.sampleRate=this.targetRate,b},sortChannel:function(a,b){return a.isVirtual!=b.isVirtual?a.isVirtual?1:-1:a.channelGroup.priority!=b.channelGroup.priority?a.channelGroup.priority<b.channelGroup.priority?1:-1:a.priority!=b.priority?a.priority<b.priority?1:-1:a.audibleVolume!=b.audibleVolume?a.audibleVolume<b.audibleVolume?1:-1:a.id<b.id?1:-1},sortEffect:function(a,b){return b.priority-a.priority},releaseChannel:function(c){if(null!=c.manager){if(this.channels==c)this.channels=c.next;else{for(var prev=this.channels;prev.next!=c;)prev=prev.next;prev.next=c.next}for(var _g=0,_g1=c.effects;_g<_g1.length;){var e=_g1[_g];++_g,c.removeEffect(e)}null!=c.source&&this.releaseSource(c.source),c.next=null,c.manager=null,c.effects=null,c.bindedEffects=null,c.currentFade=null;var snd=c.sound;null!=snd&&snd.channel==c&&(snd.channel=null)}},__class__:hxd_snd_Manager};var hxd_snd_Mp3Data=function(bytes){var mp=new format_mp3_Reader(new haxe_io_BytesInput(bytes)).read();this.samples=mp.sampleCount;for(var frame=mp.frames[0].data,lame=-1,_g=0,_g1=frame.length-24;_g<_g1;){var i=_g++;if(76==frame.b[i]&&65==frame.b[i+1]&&77==frame.b[i+2]&&69==frame.b[i+3]){lame=i;break}}if(lame>=0){var startEnd=frame.b[lame+21]<<16|frame.b[lame+22]<<8|frame.b[lame+23],start=startEnd>>12,end=4095&startEnd;this.samples-=start+end+1152}var header=mp.frames[0].header;this.sampleFormat=hxd_snd_SampleFormat.F32,this.samplingRate=format_mp3_MPEG.srEnum2Num(header.samplingRate),this.channels=header.channelMode==format_mp3_ChannelMode.Mono?1:2;var ctx=hxd_snd_webaudio_Context.get();if(null!=ctx){ctx.decodeAudioData(bytes.b.bufferValue,$bind(this,this.processBuffer));var decodedRate=0|ctx.sampleRate;this.samples=Math.ceil(this.samples*decodedRate/this.samplingRate),this.samplingRate=decodedRate}};$hxClasses["hxd.snd.Mp3Data"]=hxd_snd_Mp3Data,hxd_snd_Mp3Data.__name__="hxd.snd.Mp3Data",hxd_snd_Mp3Data.__super__=hxd_snd_Data,hxd_snd_Mp3Data.prototype=$extend(hxd_snd_Data.prototype,{isLoading:function(){return null==this.buffer},load:function(onEnd){null!=this.buffer?onEnd():this.onEnd=onEnd},processBuffer:function(buf){var left=buf.getChannelData(0);if(this.samples=buf.length,1!=this.channels){for(var right=buf.numberOfChannels<2?left:buf.getChannelData(1),join=new Float32Array(2*left.length),w=0,_g=0,_g1=buf.length;_g<_g1;){var i=_g++;join[w++]=left[i],join[w++]=right[i]}this.buffer=haxe_io_Bytes.ofData(join.buffer),null!=this.onEnd&&(this.onEnd(),this.onEnd=null)}else this.buffer=haxe_io_Bytes.ofData(left.buffer)},decodeBuffer:function(out,outPos,sampleStart,sampleCount){null==this.buffer?out.fill(outPos,4*sampleCount*this.channels,0):out.blit(outPos,this.buffer,4*sampleStart*this.channels,4*sampleCount*this.channels)},__class__:hxd_snd_Mp3Data});var hxd_snd_SoundGroup=function(name){this.name=name,this.maxAudible=-1,this.volume=1,this.mono=!1};$hxClasses["hxd.snd.SoundGroup"]=hxd_snd_SoundGroup,hxd_snd_SoundGroup.__name__="hxd.snd.SoundGroup",hxd_snd_SoundGroup.prototype={__class__:hxd_snd_SoundGroup};var hxd_snd_WavData=function(bytes){null!=bytes&&this.init(new format_wav_Reader(new haxe_io_BytesInput(bytes)).read())};$hxClasses["hxd.snd.WavData"]=hxd_snd_WavData,hxd_snd_WavData.__name__="hxd.snd.WavData",hxd_snd_WavData.__super__=hxd_snd_Data,hxd_snd_WavData.prototype=$extend(hxd_snd_Data.prototype,{init:function(d){var tmp,h=d.header;switch(this.samplingRate=h.samplingRate,this.channels=h.channels,h.bitsPerSample){case 8:tmp=hxd_snd_SampleFormat.UI8;break;case 16:tmp=hxd_snd_SampleFormat.I16;break;default:throw haxe_Exception.thrown("Unsupported WAV "+h.bitsPerSample+" bits")}this.sampleFormat=tmp,this.rawData=d.data,this.samples=this.rawData.length/this.getBytesPerSample()|0},decodeBuffer:function(out,outPos,sampleStart,sampleCount){var bpp=this.getBytesPerSample();out.blit(outPos,this.rawData,sampleStart*bpp,sampleCount*bpp)},__class__:hxd_snd_WavData});var hxd_snd_effect_LowPass=function(){hxd_snd_Effect.call(this,"lowpass"),this.priority=100,this.gainHF=1};$hxClasses["hxd.snd.effect.LowPass"]=hxd_snd_effect_LowPass,hxd_snd_effect_LowPass.__name__="hxd.snd.effect.LowPass",hxd_snd_effect_LowPass.__super__=hxd_snd_Effect,hxd_snd_effect_LowPass.prototype=$extend(hxd_snd_Effect.prototype,{__class__:hxd_snd_effect_LowPass});var hxd_snd_effect_Pitch=function(value){null==value&&(value=1),hxd_snd_Effect.call(this,"pitch"),this.value=value};$hxClasses["hxd.snd.effect.Pitch"]=hxd_snd_effect_Pitch,hxd_snd_effect_Pitch.__name__="hxd.snd.effect.Pitch",hxd_snd_effect_Pitch.__super__=hxd_snd_Effect,hxd_snd_effect_Pitch.prototype=$extend(hxd_snd_Effect.prototype,{__class__:hxd_snd_effect_Pitch});var hxd_snd_effect_Spatialization=function(){hxd_snd_Effect.call(this,"spatialization"),this.position=new h3d_Vector,this.velocity=new h3d_Vector,this.direction=new h3d_Vector,this.referenceDistance=1,this.rollOffFactor=1};$hxClasses["hxd.snd.effect.Spatialization"]=hxd_snd_effect_Spatialization,hxd_snd_effect_Spatialization.__name__="hxd.snd.effect.Spatialization",hxd_snd_effect_Spatialization.__super__=hxd_snd_Effect,hxd_snd_effect_Spatialization.prototype=$extend(hxd_snd_Effect.prototype,{getVolumeModifier:function(){if(null==this.fadeDistance)return 1;var _this=hxd_snd_Manager.get().listener.position,v=this.position,dx=v.x-_this.x,dy=v.y-_this.y,dz=v.z-_this.z,dist=Math.sqrt(dx*dx+dy*dy+dz*dz);null!=this.maxDistance?dist-=this.maxDistance:dist-=this.referenceDistance;var volume=1-dist/this.fadeDistance;return volume>1&&(volume=1),volume<0&&(volume=0),volume},applyAudibleVolumeModifier:function(v){var b,_this=hxd_snd_Manager.get().listener.position,v1=this.position,dx=v1.x-_this.x,dy=v1.y-_this.y,dz=v1.z-_this.z,dist=Math.sqrt(dx*dx+dy*dy+dz*dz);(dist<(b=this.referenceDistance)&&(dist=b),null!=this.maxDistance)&&(dist>(b=this.maxDistance)&&(dist=b));return v*(this.referenceDistance/(this.referenceDistance+this.rollOffFactor*(dist-this.referenceDistance)))},__class__:hxd_snd_effect_Spatialization});var hxd_snd_webaudio_BufferHandle=function(){};$hxClasses["hxd.snd.webaudio.BufferHandle"]=hxd_snd_webaudio_BufferHandle,hxd_snd_webaudio_BufferHandle.__name__="hxd.snd.webaudio.BufferHandle",hxd_snd_webaudio_BufferHandle.prototype={__class__:hxd_snd_webaudio_BufferHandle};var hxd_snd_webaudio_SourceHandle=function(){this.buffers=[],this.sampleOffset=0,this.pitch=1,this.firstPlay=!0};$hxClasses["hxd.snd.webaudio.SourceHandle"]=hxd_snd_webaudio_SourceHandle,hxd_snd_webaudio_SourceHandle.__name__="hxd.snd.webaudio.SourceHandle",hxd_snd_webaudio_SourceHandle.prototype={updateDestination:function(){this.destination=this.gain,null!=this.lowPass&&(this.lowPass.connect(this.destination),this.destination=this.lowPass),null!=this.panner&&(this.panner.connect(this.destination),this.destination=this.panner),this.gain.connect(hxd_snd_webaudio_Context.destination);for(var _g=0,_g1=this.buffers;_g<_g1.length;){var b=_g1[_g];++_g,null!=b.node&&b.restart(this)}},applyPitch:function(){for(var t=0,_g=0,_g1=this.buffers;_g<_g1.length;){var b=_g1[_g];++_g,t=b.readjust(t,this)}},__class__:hxd_snd_webaudio_SourceHandle};var hxd_snd_webaudio_BufferPlayback=function(){};$hxClasses["hxd.snd.webaudio.BufferPlayback"]=hxd_snd_webaudio_BufferPlayback,hxd_snd_webaudio_BufferPlayback.__name__="hxd.snd.webaudio.BufferPlayback",hxd_snd_webaudio_BufferPlayback.prototype={get_currentSample:function(){return this.consumed?this.buffer.samples:null==this.node||!this.dirty||this.node.context.currentTime<this.lastTime?0:(this.lastSamples+=Math.floor((this.node.context.currentTime-this.lastTime)*this.buffer.inst.sampleRate*this.node.playbackRate.value),this.lastTime=this.node.context.currentTime,this.lastSamples)},set:function(buf,grainOffset){this.buffer=buf,this.offset=isNaN(grainOffset)?0:grainOffset,this.dirty=!1,this.consumed=!1,this.starts=0,this.ends=0},start:function(ctx,source,time){if(this.dirty=!0,this.consumed=!1,null!=this.node&&this.stop(),source.firstPlay&&this.buffer.samples>10){source.firstPlay=!1;for(var _g=[],_g1=0,_g2=this.buffer.inst.numberOfChannels;_g1<_g2;){var i=_g1++;_g.push(this.buffer.inst.getChannelData(i))}for(var channels=_g,j=0,fade=0;j<10;){for(i=0;i<channels.length;)channels[i][j]*=fade,++i;++j,(fade+=.1)>1&&(fade=1)}}return this.node=ctx.createBufferSource(),this.node.buffer=this.buffer.inst,this.node.addEventListener("ended",$bind(this,this.onBufferConsumed)),this.node.connect(source.destination),this.node.playbackRate.value=source.pitch,this.node.start(time,this.offset),this.lastSamples=0,this.lastTime=time,this.starts=time,this.ends=time+(this.buffer.inst.duration-this.offset)/source.pitch},readjust:function(time,source){if(this.consumed||null==this.node)return this.ends;var ctx=source.driver.ctx,shiftTime=ctx.currentTime;this.node.playbackRate.setValueAtTime(source.pitch,shiftTime);var elapsed=shiftTime-this.starts;return elapsed<0?this.start(ctx,source,0==time?shiftTime:time):(this.starts=shiftTime-elapsed/source.pitch,this.ends=this.starts+(this.buffer.inst.duration-this.offset)/source.pitch)},restart:function(source){if(!this.consumed&&null!=this.node){var ctx=hxd_snd_webaudio_Context.get();ctx.currentTime>this.starts?(this.offset+=(ctx.currentTime-this.starts)*source.pitch,this.start(ctx,source,ctx.currentTime)):this.start(ctx,source,this.starts)}},stop:function(immediate){null==immediate&&(immediate=!0),null!=this.node&&(this.node.removeEventListener("ended",$bind(this,this.onBufferConsumed)),immediate?this.node.disconnect():this.node.stop(),this.node=null)},onBufferConsumed:function(e){this.node.removeEventListener("ended",$bind(this,this.onBufferConsumed)),this.node.disconnect(),this.node=null,this.consumed=!0},clear:function(){this.buffer=null,this.node=null},__class__:hxd_snd_webaudio_BufferPlayback};var hxd_snd_webaudio_Context=function(){};$hxClasses["hxd.snd.webaudio.Context"]=hxd_snd_webaudio_Context,hxd_snd_webaudio_Context.__name__="hxd.snd.webaudio.Context",hxd_snd_webaudio_Context.get=function(){if(null==hxd_snd_webaudio_Context.ctx){try{hxd_snd_webaudio_Context.ctx=new AudioContext}catch(_g){try{hxd_snd_webaudio_Context.ctx=new window.webkitAudioContext}catch(_g1){hxd_snd_webaudio_Context.ctx=null}}if(null==hxd_snd_webaudio_Context.ctx)throw haxe_Exception.thrown("WebAudio API not available in this browser!");"suspended"==hxd_snd_webaudio_Context.ctx.state&&hxd_snd_webaudio_Context.waitForPageInput(),hxd_snd_webaudio_Context.ctx.addEventListener("statechange",(function(_){"suspended"==hxd_snd_webaudio_Context.ctx.state&&hxd_snd_webaudio_Context.waitForPageInput()})),hxd_snd_webaudio_Context.bufferPool=[],hxd_snd_webaudio_Context.gainPool=[],hxd_snd_webaudio_Context.masterGain=hxd_snd_webaudio_Context.ctx.createGain(),hxd_snd_webaudio_Context.masterGain.connect(hxd_snd_webaudio_Context.ctx.destination),hxd_snd_webaudio_Context.destination=hxd_snd_webaudio_Context.masterGain}return hxd_snd_webaudio_Context.ctx},hxd_snd_webaudio_Context.waitForPageInput=function(){hxd_snd_webaudio_Context.suspended||(window.document.addEventListener("click",hxd_snd_webaudio_Context.resumeContext),window.document.addEventListener("keydown",hxd_snd_webaudio_Context.resumeContext),window.document.body.addEventListener("keydown",hxd_snd_webaudio_Context.resumeContext),window.document.body.addEventListener("touchend",hxd_snd_webaudio_Context.resumeContext),hxd_snd_webaudio_Context.suspended=!0)},hxd_snd_webaudio_Context.resumeContext=function(_){hxd_snd_webaudio_Context.suspended&&(null!=hxd_snd_webaudio_Context.ctx&&hxd_snd_webaudio_Context.ctx.resume(),window.document.removeEventListener("click",hxd_snd_webaudio_Context.resumeContext),window.document.removeEventListener("keydown",hxd_snd_webaudio_Context.resumeContext),window.document.body.removeEventListener("keydown",hxd_snd_webaudio_Context.resumeContext),window.document.body.removeEventListener("touchend",hxd_snd_webaudio_Context.resumeContext),hxd_snd_webaudio_Context.suspended=!1)},hxd_snd_webaudio_Context.getBuffer=function(channels,sampleCount,rate){for(var _g=0,_g1=hxd_snd_webaudio_Context.bufferPool;_g<_g1.length;){var pool=_g1[_g];if(++_g,pool.channels==channels&&pool.samples==sampleCount&&pool.rate==rate)return 0!=pool.pool.length?pool.pool.pop():hxd_snd_webaudio_Context.ctx.createBuffer(channels,sampleCount,rate)}pool=new hxd_snd_webaudio__$Context_BufferPool(channels,sampleCount,rate);return hxd_snd_webaudio_Context.bufferPool.push(pool),hxd_snd_webaudio_Context.ctx.createBuffer(channels,sampleCount,rate)},hxd_snd_webaudio_Context.putBuffer=function(buf){for(var rate=0|buf.sampleRate,_g=0,_g1=hxd_snd_webaudio_Context.bufferPool;_g<_g1.length;){var pool=_g1[_g];if(++_g,pool.channels==buf.numberOfChannels&&pool.samples==buf.length&&pool.rate==rate){pool.pool.push(buf);break}}};var hxd_snd_webaudio__$Context_BufferPool=function(channels,samples,rate){this.pool=[],this.channels=channels,this.samples=samples,this.rate=rate};$hxClasses["hxd.snd.webaudio._Context.BufferPool"]=hxd_snd_webaudio__$Context_BufferPool,hxd_snd_webaudio__$Context_BufferPool.__name__="hxd.snd.webaudio._Context.BufferPool",hxd_snd_webaudio__$Context_BufferPool.prototype={__class__:hxd_snd_webaudio__$Context_BufferPool};var hxd_snd_webaudio_Driver=function(){this.playbackPool=[],this.ctx=hxd_snd_webaudio_Context.get()};$hxClasses["hxd.snd.webaudio.Driver"]=hxd_snd_webaudio_Driver,hxd_snd_webaudio_Driver.__name__="hxd.snd.webaudio.Driver",hxd_snd_webaudio_Driver.__interfaces__=[hxd_snd_Driver],hxd_snd_webaudio_Driver.prototype={hasFeature:function(d){return!0},setMasterVolume:function(value){hxd_snd_webaudio_Context.masterGain.gain.value=value},setListenerParams:function(position,direction,up,velocity){this.ctx.listener.setPosition(-position.x,position.y,position.z),this.ctx.listener.setOrientation(-direction.x,direction.y,direction.z,-up.x,up.y,up.z)},createSource:function(){var s=new hxd_snd_webaudio_SourceHandle;return s.driver=this,s.gain=0!=hxd_snd_webaudio_Context.gainPool.length?hxd_snd_webaudio_Context.gainPool.pop():hxd_snd_webaudio_Context.ctx.createGain(),s.updateDestination(),s},playSource:function(source){if(!source.playing&&(source.playing=!0,0!=source.buffers.length))for(var time=this.ctx.currentTime,_g=0,_g1=source.buffers;_g<_g1.length;){var b=_g1[_g];++_g,b.consumed||(time=b.start(this.ctx,source,time))}},stopSource:function(source){source.playing=!1,source.sampleOffset=0},setSourceVolume:function(source,value){source.gain.gain.value=value},destroySource:function(source){this.stopSource(source),source.gain.disconnect(),source.driver=null;var gain=source.gain;hxd_snd_webaudio_Context.gainPool.push(gain),gain.gain.value=1,source.gain=null;for(var _g=0,_g1=source.buffers;_g<_g1.length;){var b=_g1[_g];++_g,b.stop(),b.clear(),this.playbackPool.push(b)}source.buffers=[]},createBuffer:function(){var b=new hxd_snd_webaudio_BufferHandle;return b.samples=0,b},setBufferData:function(buffer,data,size,format,channelCount,samplingRate){var sampleCount;switch(format._hx_index){case 0:sampleCount=1;break;case 1:sampleCount=2;break;case 2:sampleCount=4}var sampleCount1=size/sampleCount/channelCount|0;if(buffer.samples=sampleCount1,0!=sampleCount1)switch(null==buffer.inst?buffer.inst=hxd_snd_webaudio_Context.getBuffer(channelCount,sampleCount1,samplingRate):buffer.inst.sampleRate==samplingRate&&buffer.inst.numberOfChannels==channelCount&&buffer.inst.length==sampleCount1||(hxd_snd_webaudio_Context.putBuffer(buffer.inst),buffer.inst=hxd_snd_webaudio_Context.getBuffer(channelCount,sampleCount1,samplingRate)),format._hx_index){case 0:var ui8=new Uint8Array(data.b.bufferValue);if(1==channelCount)for(var chn=buffer.inst.getChannelData(0),_g=0,_g1=sampleCount1;_g<_g1;){chn[i=_g++]=ui8[i]/255}else{var left=buffer.inst.getChannelData(0),right=buffer.inst.getChannelData(1),r=0;for(_g=0,_g1=sampleCount1;_g<_g1;){left[i=_g++]=ui8[r]/255,right[i]=ui8[r+1]/255,r+=channelCount}}break;case 1:var i16=new Int16Array(data.b.bufferValue);if(1==channelCount)for(chn=buffer.inst.getChannelData(0),_g=0,_g1=sampleCount1;_g<_g1;){chn[i=_g++]=i16[i]/32768}else for(left=buffer.inst.getChannelData(0),right=buffer.inst.getChannelData(1),r=0,_g=0,_g1=sampleCount1;_g<_g1;){left[i=_g++]=i16[r]/32768,right[i]=i16[r+1]/32768,r+=channelCount}break;case 2:var f32=new Float32Array(data.b.bufferValue);if(1==channelCount)for(chn=buffer.inst.getChannelData(0),_g=0,_g1=sampleCount1;_g<_g1;){chn[i=_g++]=f32[i]}else for(left=buffer.inst.getChannelData(0),right=buffer.inst.getChannelData(1),r=0,_g=0,_g1=sampleCount1;_g<_g1;){var i;left[i=_g++]=f32[r],right[i]=f32[r+1],r+=channelCount}}},destroyBuffer:function(buffer){null!=buffer.inst&&hxd_snd_webaudio_Context.putBuffer(buffer.inst),buffer.inst=null},queueBuffer:function(source,buffer,sampleStart,endOfStream){var buf=0!=this.playbackPool.length?this.playbackPool.pop():new hxd_snd_webaudio_BufferPlayback;if(null!=buffer.inst&&(buf.set(buffer,sampleStart/buffer.inst.length*buffer.inst.duration),buffer.isEnd=endOfStream,source.buffers.push(buf),source.playing))if(1!=source.buffers.length){var tmp1,t=source.buffers[source.buffers.length-2].ends,tmp=this.ctx;if(isFinite(t)){var b=this.ctx.currentTime;tmp1=t<b?b:t}else tmp1=this.ctx.currentTime;buf.start(tmp,source,tmp1)}else buf.start(this.ctx,source,this.ctx.currentTime)},unqueueBuffer:function(source,buffer){for(;0<source.buffers.length;){var b=source.buffers[0];if(b.buffer==buffer){source.buffers.splice(0,1),b.stop(!buffer.isEnd),b.clear(),this.playbackPool.push(b);break}}buffer.isEnd||!source.playing?source.sampleOffset=0:source.sampleOffset+=buffer.samples},getProcessedBuffers:function(source){for(var cnt=0,_g=0,_g1=source.buffers;_g<_g1.length;){var b=_g1[_g];++_g,b.consumed&&++cnt}return cnt},getPlayedSampleCount:function(source){for(var consumed=0,buf=null,_g=0,_g1=source.buffers;_g<_g1.length;){var b=_g1[_g];if(++_g,b.consumed)consumed+=b.buffer.samples;else if(b.dirty){buf=b;break}}return null!=buf?source.sampleOffset+consumed+buf.get_currentSample():source.sampleOffset+consumed},update:function(){},dispose:function(){},getEffectDriver:function(type){switch(type){case"lowpass":return new hxd_snd_webaudio_LowPassDriver;case"pitch":return new hxd_snd_webaudio_PitchDriver;case"spatialization":return new hxd_snd_webaudio_SpatializationDriver;default:return new hxd_snd_EffectDriver}},__class__:hxd_snd_webaudio_Driver};var hxd_snd_webaudio_LowPassDriver=function(){this.pool=[],hxd_snd_EffectDriver.call(this)};$hxClasses["hxd.snd.webaudio.LowPassDriver"]=hxd_snd_webaudio_LowPassDriver,hxd_snd_webaudio_LowPassDriver.__name__="hxd.snd.webaudio.LowPassDriver",hxd_snd_webaudio_LowPassDriver.__super__=hxd_snd_EffectDriver,hxd_snd_webaudio_LowPassDriver.prototype=$extend(hxd_snd_EffectDriver.prototype,{get:function(ctx){if(0!=this.pool.length)return this.pool.pop();var node=ctx.createBiquadFilter();return node.type="lowpass",node},bind:function(e,source){source.lowPass=this.get(source.driver.ctx),source.updateDestination(),this.apply(e,source)},apply:function(e,source){var max=source.driver.ctx.sampleRate/2,octaves=Math.log(max/40)/Math.LN2;source.lowPass.frequency.value=max*Math.pow(2,octaves*(e.gainHF-1))},unbind:function(e,source){this.pool.push(source.lowPass),source.lowPass.disconnect(),source.lowPass=null,null!=source.driver&&source.updateDestination()},__class__:hxd_snd_webaudio_LowPassDriver});var hxd_snd_webaudio_PitchDriver=function(){hxd_snd_EffectDriver.call(this)};$hxClasses["hxd.snd.webaudio.PitchDriver"]=hxd_snd_webaudio_PitchDriver,hxd_snd_webaudio_PitchDriver.__name__="hxd.snd.webaudio.PitchDriver",hxd_snd_webaudio_PitchDriver.__super__=hxd_snd_EffectDriver,hxd_snd_webaudio_PitchDriver.prototype=$extend(hxd_snd_EffectDriver.prototype,{apply:function(e,source){source.pitch!=e.value&&(source.pitch=e.value,source.applyPitch())},unbind:function(e,source){source.pitch=1,source.applyPitch()},__class__:hxd_snd_webaudio_PitchDriver});var hxd_snd_webaudio_SpatializationDriver=function(){this.pool=[],hxd_snd_EffectDriver.call(this)};$hxClasses["hxd.snd.webaudio.SpatializationDriver"]=hxd_snd_webaudio_SpatializationDriver,hxd_snd_webaudio_SpatializationDriver.__name__="hxd.snd.webaudio.SpatializationDriver",hxd_snd_webaudio_SpatializationDriver.__super__=hxd_snd_EffectDriver,hxd_snd_webaudio_SpatializationDriver.prototype=$extend(hxd_snd_EffectDriver.prototype,{get:function(ctx){return 0!=this.pool.length?this.pool.pop():ctx.createPanner()},bind:function(e,source){source.panner=this.get(source.driver.ctx),source.updateDestination(),this.apply(e,source)},apply:function(e,source){source.panner.setPosition(-e.position.x,e.position.y,e.position.z),source.panner.setOrientation(-e.direction.x,e.direction.y,e.direction.z),source.panner.rolloffFactor=e.rollOffFactor,source.panner.refDistance=e.referenceDistance;var maxDist=null==e.maxDistance?340282347e30:e.maxDistance;source.panner.maxDistance=maxDist},unbind:function(e,source){this.pool.push(source.panner),source.panner.disconnect(),source.panner=null,null!=source.driver&&source.updateDestination()},__class__:hxd_snd_webaudio_SpatializationDriver});var hxsl_Type=$hxEnums["hxsl.Type"]={__ename__:"hxsl.Type",__constructs__:["TVoid","TInt","TBool","TFloat","TString","TVec","TMat3","TMat4","TMat3x4","TBytes","TSampler2D","TSampler2DArray","TSamplerCube","TStruct","TFun","TArray","TBuffer","TChannel"],TVoid:{_hx_index:0,__enum__:"hxsl.Type",toString:$estr},TInt:{_hx_index:1,__enum__:"hxsl.Type",toString:$estr},TBool:{_hx_index:2,__enum__:"hxsl.Type",toString:$estr},TFloat:{_hx_index:3,__enum__:"hxsl.Type",toString:$estr},TString:{_hx_index:4,__enum__:"hxsl.Type",toString:$estr},TVec:($_=function(size,t){return{_hx_index:5,size:size,t:t,__enum__:"hxsl.Type",toString:$estr}},$_.__params__=["size","t"],$_),TMat3:{_hx_index:6,__enum__:"hxsl.Type",toString:$estr},TMat4:{_hx_index:7,__enum__:"hxsl.Type",toString:$estr},TMat3x4:{_hx_index:8,__enum__:"hxsl.Type",toString:$estr},TBytes:($_=function(size){return{_hx_index:9,size:size,__enum__:"hxsl.Type",toString:$estr}},$_.__params__=["size"],$_),TSampler2D:{_hx_index:10,__enum__:"hxsl.Type",toString:$estr},TSampler2DArray:{_hx_index:11,__enum__:"hxsl.Type",toString:$estr},TSamplerCube:{_hx_index:12,__enum__:"hxsl.Type",toString:$estr},TStruct:($_=function(vl){return{_hx_index:13,vl:vl,__enum__:"hxsl.Type",toString:$estr}},$_.__params__=["vl"],$_),TFun:($_=function(variants){return{_hx_index:14,variants:variants,__enum__:"hxsl.Type",toString:$estr}},$_.__params__=["variants"],$_),TArray:($_=function(t,size){return{_hx_index:15,t:t,size:size,__enum__:"hxsl.Type",toString:$estr}},$_.__params__=["t","size"],$_),TBuffer:($_=function(t,size){return{_hx_index:16,t:t,size:size,__enum__:"hxsl.Type",toString:$estr}},$_.__params__=["t","size"],$_),TChannel:($_=function(size){return{_hx_index:17,size:size,__enum__:"hxsl.Type",toString:$estr}},$_.__params__=["size"],$_)};hxsl_Type.__empty_constructs__=[hxsl_Type.TVoid,hxsl_Type.TInt,hxsl_Type.TBool,hxsl_Type.TFloat,hxsl_Type.TString,hxsl_Type.TMat3,hxsl_Type.TMat4,hxsl_Type.TMat3x4,hxsl_Type.TSampler2D,hxsl_Type.TSampler2DArray,hxsl_Type.TSamplerCube];var hxsl_VecType=$hxEnums["hxsl.VecType"]={__ename__:"hxsl.VecType",__constructs__:["VInt","VFloat","VBool"],VInt:{_hx_index:0,__enum__:"hxsl.VecType",toString:$estr},VFloat:{_hx_index:1,__enum__:"hxsl.VecType",toString:$estr},VBool:{_hx_index:2,__enum__:"hxsl.VecType",toString:$estr}};hxsl_VecType.__empty_constructs__=[hxsl_VecType.VInt,hxsl_VecType.VFloat,hxsl_VecType.VBool];var hxsl_SizeDecl=$hxEnums["hxsl.SizeDecl"]={__ename__:"hxsl.SizeDecl",__constructs__:["SConst","SVar"],SConst:($_=function(v){return{_hx_index:0,v:v,__enum__:"hxsl.SizeDecl",toString:$estr}},$_.__params__=["v"],$_),SVar:($_=function(v){return{_hx_index:1,v:v,__enum__:"hxsl.SizeDecl",toString:$estr}},$_.__params__=["v"],$_)};hxsl_SizeDecl.__empty_constructs__=[];var hxsl_Error=function(msg,pos){this.msg=msg,this.pos=pos};$hxClasses["hxsl.Error"]=hxsl_Error,hxsl_Error.__name__="hxsl.Error",hxsl_Error.t=function(msg,pos){throw haxe_Exception.thrown(new hxsl_Error(msg,pos))},hxsl_Error.prototype={toString:function(){return"Error("+this.msg+")@"+Std.string(this.pos)},__class__:hxsl_Error};var hxsl_VarKind=$hxEnums["hxsl.VarKind"]={__ename__:"hxsl.VarKind",__constructs__:["Global","Input","Param","Var","Local","Output","Function"],Global:{_hx_index:0,__enum__:"hxsl.VarKind",toString:$estr},Input:{_hx_index:1,__enum__:"hxsl.VarKind",toString:$estr},Param:{_hx_index:2,__enum__:"hxsl.VarKind",toString:$estr},Var:{_hx_index:3,__enum__:"hxsl.VarKind",toString:$estr},Local:{_hx_index:4,__enum__:"hxsl.VarKind",toString:$estr},Output:{_hx_index:5,__enum__:"hxsl.VarKind",toString:$estr},Function:{_hx_index:6,__enum__:"hxsl.VarKind",toString:$estr}};hxsl_VarKind.__empty_constructs__=[hxsl_VarKind.Global,hxsl_VarKind.Input,hxsl_VarKind.Param,hxsl_VarKind.Var,hxsl_VarKind.Local,hxsl_VarKind.Output,hxsl_VarKind.Function];var hxsl_VarQualifier=$hxEnums["hxsl.VarQualifier"]={__ename__:"hxsl.VarQualifier",__constructs__:["Const","Private","Nullable","PerObject","Name","Shared","Precision","Range","Ignore","PerInstance"],Const:($_=function(max){return{_hx_index:0,max:max,__enum__:"hxsl.VarQualifier",toString:$estr}},$_.__params__=["max"],$_),Private:{_hx_index:1,__enum__:"hxsl.VarQualifier",toString:$estr},Nullable:{_hx_index:2,__enum__:"hxsl.VarQualifier",toString:$estr},PerObject:{_hx_index:3,__enum__:"hxsl.VarQualifier",toString:$estr},Name:($_=function(n){return{_hx_index:4,n:n,__enum__:"hxsl.VarQualifier",toString:$estr}},$_.__params__=["n"],$_),Shared:{_hx_index:5,__enum__:"hxsl.VarQualifier",toString:$estr},Precision:($_=function(p){return{_hx_index:6,p:p,__enum__:"hxsl.VarQualifier",toString:$estr}},$_.__params__=["p"],$_),Range:($_=function(min,max){return{_hx_index:7,min:min,max:max,__enum__:"hxsl.VarQualifier",toString:$estr}},$_.__params__=["min","max"],$_),Ignore:{_hx_index:8,__enum__:"hxsl.VarQualifier",toString:$estr},PerInstance:($_=function(v){return{_hx_index:9,v:v,__enum__:"hxsl.VarQualifier",toString:$estr}},$_.__params__=["v"],$_)};hxsl_VarQualifier.__empty_constructs__=[hxsl_VarQualifier.Private,hxsl_VarQualifier.Nullable,hxsl_VarQualifier.PerObject,hxsl_VarQualifier.Shared,hxsl_VarQualifier.Ignore];var hxsl_Prec=$hxEnums["hxsl.Prec"]={__ename__:"hxsl.Prec",__constructs__:["Low","Medium","High"],Low:{_hx_index:0,__enum__:"hxsl.Prec",toString:$estr},Medium:{_hx_index:1,__enum__:"hxsl.Prec",toString:$estr},High:{_hx_index:2,__enum__:"hxsl.Prec",toString:$estr}};hxsl_Prec.__empty_constructs__=[hxsl_Prec.Low,hxsl_Prec.Medium,hxsl_Prec.High];var hxsl_Const=$hxEnums["hxsl.Const"]={__ename__:"hxsl.Const",__constructs__:["CNull","CBool","CInt","CFloat","CString"],CNull:{_hx_index:0,__enum__:"hxsl.Const",toString:$estr},CBool:($_=function(b){return{_hx_index:1,b:b,__enum__:"hxsl.Const",toString:$estr}},$_.__params__=["b"],$_),CInt:($_=function(v){return{_hx_index:2,v:v,__enum__:"hxsl.Const",toString:$estr}},$_.__params__=["v"],$_),CFloat:($_=function(v){return{_hx_index:3,v:v,__enum__:"hxsl.Const",toString:$estr}},$_.__params__=["v"],$_),CString:($_=function(v){return{_hx_index:4,v:v,__enum__:"hxsl.Const",toString:$estr}},$_.__params__=["v"],$_)};hxsl_Const.__empty_constructs__=[hxsl_Const.CNull];var hxsl_FunctionKind=$hxEnums["hxsl.FunctionKind"]={__ename__:"hxsl.FunctionKind",__constructs__:["Vertex","Fragment","Init","Helper"],Vertex:{_hx_index:0,__enum__:"hxsl.FunctionKind",toString:$estr},Fragment:{_hx_index:1,__enum__:"hxsl.FunctionKind",toString:$estr},Init:{_hx_index:2,__enum__:"hxsl.FunctionKind",toString:$estr},Helper:{_hx_index:3,__enum__:"hxsl.FunctionKind",toString:$estr}};hxsl_FunctionKind.__empty_constructs__=[hxsl_FunctionKind.Vertex,hxsl_FunctionKind.Fragment,hxsl_FunctionKind.Init,hxsl_FunctionKind.Helper];var hxsl_TGlobal=$hxEnums["hxsl.TGlobal"]={__ename__:"hxsl.TGlobal",__constructs__:["Radians","Degrees","Sin","Cos","Tan","Asin","Acos","Atan","Pow","Exp","Log","Exp2","Log2","Sqrt","Inversesqrt","Abs","Sign","Floor","Ceil","Fract","Mod","Min","Max","Clamp","Mix","Step","Smoothstep","Length","Distance","Dot","Cross","Normalize","LReflect","Texture","TextureLod","Texel","TexelLod","ToInt","ToFloat","ToBool","Vec2","Vec3","Vec4","IVec2","IVec3","IVec4","BVec2","BVec3","BVec4","Mat2","Mat3","Mat4","Mat3x4","Saturate","Pack","Unpack","PackNormal","UnpackNormal","ScreenToUv","UvToScreen","DFdx","DFdy","Fwidth","ChannelRead","ChannelReadLod","ChannelFetch","ChannelFetchLod","Trace","VertexID","InstanceID","FragCoord"],Radians:{_hx_index:0,__enum__:"hxsl.TGlobal",toString:$estr},Degrees:{_hx_index:1,__enum__:"hxsl.TGlobal",toString:$estr},Sin:{_hx_index:2,__enum__:"hxsl.TGlobal",toString:$estr},Cos:{_hx_index:3,__enum__:"hxsl.TGlobal",toString:$estr},Tan:{_hx_index:4,__enum__:"hxsl.TGlobal",toString:$estr},Asin:{_hx_index:5,__enum__:"hxsl.TGlobal",toString:$estr},Acos:{_hx_index:6,__enum__:"hxsl.TGlobal",toString:$estr},Atan:{_hx_index:7,__enum__:"hxsl.TGlobal",toString:$estr},Pow:{_hx_index:8,__enum__:"hxsl.TGlobal",toString:$estr},Exp:{_hx_index:9,__enum__:"hxsl.TGlobal",toString:$estr},Log:{_hx_index:10,__enum__:"hxsl.TGlobal",toString:$estr},Exp2:{_hx_index:11,__enum__:"hxsl.TGlobal",toString:$estr},Log2:{_hx_index:12,__enum__:"hxsl.TGlobal",toString:$estr},Sqrt:{_hx_index:13,__enum__:"hxsl.TGlobal",toString:$estr},Inversesqrt:{_hx_index:14,__enum__:"hxsl.TGlobal",toString:$estr},Abs:{_hx_index:15,__enum__:"hxsl.TGlobal",toString:$estr},Sign:{_hx_index:16,__enum__:"hxsl.TGlobal",toString:$estr},Floor:{_hx_index:17,__enum__:"hxsl.TGlobal",toString:$estr},Ceil:{_hx_index:18,__enum__:"hxsl.TGlobal",toString:$estr},Fract:{_hx_index:19,__enum__:"hxsl.TGlobal",toString:$estr},Mod:{_hx_index:20,__enum__:"hxsl.TGlobal",toString:$estr},Min:{_hx_index:21,__enum__:"hxsl.TGlobal",toString:$estr},Max:{_hx_index:22,__enum__:"hxsl.TGlobal",toString:$estr},Clamp:{_hx_index:23,__enum__:"hxsl.TGlobal",toString:$estr},Mix:{_hx_index:24,__enum__:"hxsl.TGlobal",toString:$estr},Step:{_hx_index:25,__enum__:"hxsl.TGlobal",toString:$estr},Smoothstep:{_hx_index:26,__enum__:"hxsl.TGlobal",toString:$estr},Length:{_hx_index:27,__enum__:"hxsl.TGlobal",toString:$estr},Distance:{_hx_index:28,__enum__:"hxsl.TGlobal",toString:$estr},Dot:{_hx_index:29,__enum__:"hxsl.TGlobal",toString:$estr},Cross:{_hx_index:30,__enum__:"hxsl.TGlobal",toString:$estr},Normalize:{_hx_index:31,__enum__:"hxsl.TGlobal",toString:$estr},LReflect:{_hx_index:32,__enum__:"hxsl.TGlobal",toString:$estr},Texture:{_hx_index:33,__enum__:"hxsl.TGlobal",toString:$estr},TextureLod:{_hx_index:34,__enum__:"hxsl.TGlobal",toString:$estr},Texel:{_hx_index:35,__enum__:"hxsl.TGlobal",toString:$estr},TexelLod:{_hx_index:36,__enum__:"hxsl.TGlobal",toString:$estr},ToInt:{_hx_index:37,__enum__:"hxsl.TGlobal",toString:$estr},ToFloat:{_hx_index:38,__enum__:"hxsl.TGlobal",toString:$estr},ToBool:{_hx_index:39,__enum__:"hxsl.TGlobal",toString:$estr},Vec2:{_hx_index:40,__enum__:"hxsl.TGlobal",toString:$estr},Vec3:{_hx_index:41,__enum__:"hxsl.TGlobal",toString:$estr},Vec4:{_hx_index:42,__enum__:"hxsl.TGlobal",toString:$estr},IVec2:{_hx_index:43,__enum__:"hxsl.TGlobal",toString:$estr},IVec3:{_hx_index:44,__enum__:"hxsl.TGlobal",toString:$estr},IVec4:{_hx_index:45,__enum__:"hxsl.TGlobal",toString:$estr},BVec2:{_hx_index:46,__enum__:"hxsl.TGlobal",toString:$estr},BVec3:{_hx_index:47,__enum__:"hxsl.TGlobal",toString:$estr},BVec4:{_hx_index:48,__enum__:"hxsl.TGlobal",toString:$estr},Mat2:{_hx_index:49,__enum__:"hxsl.TGlobal",toString:$estr},Mat3:{_hx_index:50,__enum__:"hxsl.TGlobal",toString:$estr},Mat4:{_hx_index:51,__enum__:"hxsl.TGlobal",toString:$estr},Mat3x4:{_hx_index:52,__enum__:"hxsl.TGlobal",toString:$estr},Saturate:{_hx_index:53,__enum__:"hxsl.TGlobal",toString:$estr},Pack:{_hx_index:54,__enum__:"hxsl.TGlobal",toString:$estr},Unpack:{_hx_index:55,__enum__:"hxsl.TGlobal",toString:$estr},PackNormal:{_hx_index:56,__enum__:"hxsl.TGlobal",toString:$estr},UnpackNormal:{_hx_index:57,__enum__:"hxsl.TGlobal",toString:$estr},ScreenToUv:{_hx_index:58,__enum__:"hxsl.TGlobal",toString:$estr},UvToScreen:{_hx_index:59,__enum__:"hxsl.TGlobal",toString:$estr},DFdx:{_hx_index:60,__enum__:"hxsl.TGlobal",toString:$estr},DFdy:{_hx_index:61,__enum__:"hxsl.TGlobal",toString:$estr},Fwidth:{_hx_index:62,__enum__:"hxsl.TGlobal",toString:$estr},ChannelRead:{_hx_index:63,__enum__:"hxsl.TGlobal",toString:$estr},ChannelReadLod:{_hx_index:64,__enum__:"hxsl.TGlobal",toString:$estr},ChannelFetch:{_hx_index:65,__enum__:"hxsl.TGlobal",toString:$estr},ChannelFetchLod:{_hx_index:66,__enum__:"hxsl.TGlobal",toString:$estr},Trace:{_hx_index:67,__enum__:"hxsl.TGlobal",toString:$estr},VertexID:{_hx_index:68,__enum__:"hxsl.TGlobal",toString:$estr},InstanceID:{_hx_index:69,__enum__:"hxsl.TGlobal",toString:$estr},FragCoord:{_hx_index:70,__enum__:"hxsl.TGlobal",toString:$estr}};hxsl_TGlobal.__empty_constructs__=[hxsl_TGlobal.Radians,hxsl_TGlobal.Degrees,hxsl_TGlobal.Sin,hxsl_TGlobal.Cos,hxsl_TGlobal.Tan,hxsl_TGlobal.Asin,hxsl_TGlobal.Acos,hxsl_TGlobal.Atan,hxsl_TGlobal.Pow,hxsl_TGlobal.Exp,hxsl_TGlobal.Log,hxsl_TGlobal.Exp2,hxsl_TGlobal.Log2,hxsl_TGlobal.Sqrt,hxsl_TGlobal.Inversesqrt,hxsl_TGlobal.Abs,hxsl_TGlobal.Sign,hxsl_TGlobal.Floor,hxsl_TGlobal.Ceil,hxsl_TGlobal.Fract,hxsl_TGlobal.Mod,hxsl_TGlobal.Min,hxsl_TGlobal.Max,hxsl_TGlobal.Clamp,hxsl_TGlobal.Mix,hxsl_TGlobal.Step,hxsl_TGlobal.Smoothstep,hxsl_TGlobal.Length,hxsl_TGlobal.Distance,hxsl_TGlobal.Dot,hxsl_TGlobal.Cross,hxsl_TGlobal.Normalize,hxsl_TGlobal.LReflect,hxsl_TGlobal.Texture,hxsl_TGlobal.TextureLod,hxsl_TGlobal.Texel,hxsl_TGlobal.TexelLod,hxsl_TGlobal.ToInt,hxsl_TGlobal.ToFloat,hxsl_TGlobal.ToBool,hxsl_TGlobal.Vec2,hxsl_TGlobal.Vec3,hxsl_TGlobal.Vec4,hxsl_TGlobal.IVec2,hxsl_TGlobal.IVec3,hxsl_TGlobal.IVec4,hxsl_TGlobal.BVec2,hxsl_TGlobal.BVec3,hxsl_TGlobal.BVec4,hxsl_TGlobal.Mat2,hxsl_TGlobal.Mat3,hxsl_TGlobal.Mat4,hxsl_TGlobal.Mat3x4,hxsl_TGlobal.Saturate,hxsl_TGlobal.Pack,hxsl_TGlobal.Unpack,hxsl_TGlobal.PackNormal,hxsl_TGlobal.UnpackNormal,hxsl_TGlobal.ScreenToUv,hxsl_TGlobal.UvToScreen,hxsl_TGlobal.DFdx,hxsl_TGlobal.DFdy,hxsl_TGlobal.Fwidth,hxsl_TGlobal.ChannelRead,hxsl_TGlobal.ChannelReadLod,hxsl_TGlobal.ChannelFetch,hxsl_TGlobal.ChannelFetchLod,hxsl_TGlobal.Trace,hxsl_TGlobal.VertexID,hxsl_TGlobal.InstanceID,hxsl_TGlobal.FragCoord];var hxsl_Component=$hxEnums["hxsl.Component"]={__ename__:"hxsl.Component",__constructs__:["X","Y","Z","W"],X:{_hx_index:0,__enum__:"hxsl.Component",toString:$estr},Y:{_hx_index:1,__enum__:"hxsl.Component",toString:$estr},Z:{_hx_index:2,__enum__:"hxsl.Component",toString:$estr},W:{_hx_index:3,__enum__:"hxsl.Component",toString:$estr}};hxsl_Component.__empty_constructs__=[hxsl_Component.X,hxsl_Component.Y,hxsl_Component.Z,hxsl_Component.W];var hxsl_TExprDef=$hxEnums["hxsl.TExprDef"]={__ename__:"hxsl.TExprDef",__constructs__:["TConst","TVar","TGlobal","TParenthesis","TBlock","TBinop","TUnop","TVarDecl","TCall","TSwiz","TIf","TDiscard","TReturn","TFor","TContinue","TBreak","TArray","TArrayDecl","TSwitch","TWhile","TMeta"],TConst:($_=function(c){return{_hx_index:0,c:c,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["c"],$_),TVar:($_=function(v){return{_hx_index:1,v:v,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["v"],$_),TGlobal:($_=function(g){return{_hx_index:2,g:g,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["g"],$_),TParenthesis:($_=function(e){return{_hx_index:3,e:e,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["e"],$_),TBlock:($_=function(el){return{_hx_index:4,el:el,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["el"],$_),TBinop:($_=function(op,e1,e2){return{_hx_index:5,op:op,e1:e1,e2:e2,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["op","e1","e2"],$_),TUnop:($_=function(op,e1){return{_hx_index:6,op:op,e1:e1,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["op","e1"],$_),TVarDecl:($_=function(v,init){return{_hx_index:7,v:v,init:init,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["v","init"],$_),TCall:($_=function(e,args){return{_hx_index:8,e:e,args:args,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["e","args"],$_),TSwiz:($_=function(e,regs){return{_hx_index:9,e:e,regs:regs,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["e","regs"],$_),TIf:($_=function(econd,eif,eelse){return{_hx_index:10,econd:econd,eif:eif,eelse:eelse,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["econd","eif","eelse"],$_),TDiscard:{_hx_index:11,__enum__:"hxsl.TExprDef",toString:$estr},TReturn:($_=function(e){return{_hx_index:12,e:e,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["e"],$_),TFor:($_=function(v,it,loop){return{_hx_index:13,v:v,it:it,loop:loop,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["v","it","loop"],$_),TContinue:{_hx_index:14,__enum__:"hxsl.TExprDef",toString:$estr},TBreak:{_hx_index:15,__enum__:"hxsl.TExprDef",toString:$estr},TArray:($_=function(e,index){return{_hx_index:16,e:e,index:index,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["e","index"],$_),TArrayDecl:($_=function(el){return{_hx_index:17,el:el,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["el"],$_),TSwitch:($_=function(e,cases,def){return{_hx_index:18,e:e,cases:cases,def:def,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["e","cases","def"],$_),TWhile:($_=function(e,loop,normalWhile){return{_hx_index:19,e:e,loop:loop,normalWhile:normalWhile,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["e","loop","normalWhile"],$_),TMeta:($_=function(m,args,e){return{_hx_index:20,m:m,args:args,e:e,__enum__:"hxsl.TExprDef",toString:$estr}},$_.__params__=["m","args","e"],$_)};hxsl_TExprDef.__empty_constructs__=[hxsl_TExprDef.TDiscard,hxsl_TExprDef.TContinue,hxsl_TExprDef.TBreak];var hxsl_Tools=function(){};$hxClasses["hxsl.Tools"]=hxsl_Tools,hxsl_Tools.__name__="hxsl.Tools",hxsl_Tools.allocVarId=function(){return++hxsl_Tools.UID},hxsl_Tools.getName=function(v){if(null==v.qualifiers)return v.name;for(var _g=0,_g1=v.qualifiers;_g<_g1.length;){var q=_g1[_g];if(++_g,4==q._hx_index)return q.n}return v.name},hxsl_Tools.getConstBits=function(v){var _g=v.type;switch(_g._hx_index){case 1:for(var _g1=0,_g2=v.qualifiers;_g1<_g2.length;){var q=_g2[_g1];if(++_g1,0==q._hx_index){var n=q.max;if(null!=n){for(var bits=0;n>=1<<bits;)++bits;return bits}return 8}}break;case 2:return 1;case 17:_g1=_g.size;return 3+hxsl_Tools.MAX_CHANNELS_BITS}return 0},hxsl_Tools.isConst=function(v){var tmp;if(17==(_g=v.type)._hx_index){var _g1=_g.size;tmp=!0}else tmp=!1;if(tmp)return!0;if(null!=v.qualifiers){var _g=0;for(_g1=v.qualifiers;_g<_g1.length;){var q=_g1[_g];if(++_g,0==q._hx_index){q.max;return!0}}}return!1},hxsl_Tools.hasQualifier=function(v,q){if(null!=v.qualifiers)for(var _g=0,_g1=v.qualifiers;_g<_g1.length;){var q2=_g1[_g];if(++_g,q2==q)return!0}return!1},hxsl_Tools.isSampler=function(t){switch(t._hx_index){case 10:case 11:case 12:return!0;case 17:t.size;return!0;default:return!1}},hxsl_Tools.toString=function(t){switch(t._hx_index){case 5:var prefix,t1=t.t,size=t.size;switch(t1._hx_index){case 0:prefix="I";break;case 1:prefix="";break;case 2:prefix="B"}return prefix+"Vec"+size;case 9:return"Bytes"+t.size;case 13:for(var vl=t.vl,_g=[],_g1=0;_g1<vl.length;){var v=vl[_g1];++_g1,_g.push(v.name+" : "+hxsl_Tools.toString(v.type))}return"{"+_g.join(",")+"}";case 15:var s=t.size,tmp=(t1=t.t,hxsl_Tools.toString(t1)+"[");switch(s._hx_index){case 0:tmp1=""+s.v;break;case 1:tmp1=(v=s.v).name}return tmp+tmp1+"]";case 16:var tmp1;s=t.size,t1=t.t,tmp="buffer "+hxsl_Tools.toString(t1)+"[";switch(s._hx_index){case 0:tmp1=""+s.v;break;case 1:tmp1=(v=s.v).name}return tmp+tmp1+"]";default:return HxOverrides.substr($hxEnums[t.__enum__].__constructs__[t._hx_index],1,null)}},hxsl_Tools.hasSideEffect=function(e){var _g=e.e;switch(_g._hx_index){case 0:var _g1=_g.c;return!1;case 1:_g1=_g.v;return!1;case 2:_g1=_g.g;return!1;case 3:e=_g.e;return hxsl_Tools.hasSideEffect(e);case 4:var el=_g.el;for(_g1=0;_g1<el.length;){e=el[_g1];if(++_g1,hxsl_Tools.hasSideEffect(e))return!0}return!1;case 5:_g1=_g.e2;var _g2=_g.e1;switch((_g3=_g.op)._hx_index){case 4:return!0;case 20:_g3.op;return!0;default:var e2=_g1;return!!hxsl_Tools.hasSideEffect(e1=_g2)||hxsl_Tools.hasSideEffect(e2)}break;case 6:_g1=_g.op;var e1=_g.e1;return hxsl_Tools.hasSideEffect(e1);case 7:_g1=_g.init,_g1=_g.v;return!0;case 8:_g1=_g.args,_g1=_g.e;return!0;case 9:_g1=_g.regs,e=_g.e;return hxsl_Tools.hasSideEffect(e);case 10:var eelse=_g.eelse,eif=_g.eif,econd=_g.econd;return!(!hxsl_Tools.hasSideEffect(econd)&&!hxsl_Tools.hasSideEffect(eif))||null!=eelse&&hxsl_Tools.hasSideEffect(eelse);case 12:_g1=_g.e;return!0;case 13:_g1=_g.v;var loop=_g.loop,it=_g.it;return!!hxsl_Tools.hasSideEffect(it)||hxsl_Tools.hasSideEffect(loop);case 11:case 14:case 15:return!0;case 16:var index=_g.index;e=_g.e;return!!hxsl_Tools.hasSideEffect(e)||hxsl_Tools.hasSideEffect(index);case 17:for(el=_g.el,_g1=0;_g1<el.length;){e=el[_g1];if(++_g1,hxsl_Tools.hasSideEffect(e))return!0}return!1;case 18:var def=_g.def,cases=_g.cases;for(e=_g.e,_g1=0;_g1<cases.length;){var c=cases[_g1];++_g1;_g2=0;for(var _g3=c.values;_g2<_g3.length;){var v=_g3[_g2];if(++_g2,hxsl_Tools.hasSideEffect(v))return!0}if(hxsl_Tools.hasSideEffect(c.expr))return!0}return!!hxsl_Tools.hasSideEffect(e)||null!=def&&hxsl_Tools.hasSideEffect(def);case 19:_g1=_g.normalWhile,loop=_g.loop,e=_g.e;return!!hxsl_Tools.hasSideEffect(e)||hxsl_Tools.hasSideEffect(loop);case 20:_g1=_g.args,_g1=_g.m,e=_g.e;return hxsl_Tools.hasSideEffect(e)}},hxsl_Tools.iter=function(e,f){var _g=e.e;switch(_g._hx_index){case 0:var _g1=_g.c;break;case 1:_g1=_g.v;break;case 2:_g1=_g.g;break;case 3:f(e=_g.e);break;case 4:var el=_g.el;for(_g1=0;_g1<el.length;){e=el[_g1];++_g1,f(e)}break;case 5:_g1=_g.op;var e2=_g.e2;f(_g.e1),f(e2);break;case 6:_g1=_g.op;f(_g.e1);break;case 7:_g1=_g.v;var init=_g.init;null!=init&&f(init);break;case 8:var args=_g.args;f(e=_g.e);for(_g1=0;_g1<args.length;){var a=args[_g1];++_g1,f(a)}break;case 9:_g1=_g.regs;f(e=_g.e);break;case 10:var eelse=_g.eelse,eif=_g.eif;f(_g.econd),f(eif),null!=eelse&&f(eelse);break;case 12:null!=(e=_g.e)&&f(e);break;case 13:_g1=_g.v;var loop=_g.loop;f(_g.it),f(loop);break;case 11:case 14:case 15:break;case 16:var index=_g.index;f(e=_g.e),f(index);break;case 17:for(el=_g.el,_g1=0;_g1<el.length;){e=el[_g1];++_g1,f(e)}break;case 18:var def=_g.def,cases=_g.cases;f(e=_g.e);for(_g1=0;_g1<cases.length;){var c=cases[_g1];++_g1;for(var _g2=0,_g3=c.values;_g2<_g3.length;){var v=_g3[_g2];++_g2,f(v)}f(c.expr)}null!=def&&f(def);break;case 19:_g1=_g.normalWhile,loop=_g.loop;f(e=_g.e),f(loop);break;case 20:_g1=_g.args,_g1=_g.m;f(e=_g.e)}},hxsl_Tools.map=function(e,f){var ed,_g=e.e;switch(_g._hx_index){case 0:var _g1=_g.c;ed=e.e;break;case 1:_g1=_g.v;ed=e.e;break;case 2:_g1=_g.g;ed=e.e;break;case 3:var e1=_g.e;ed=hxsl_TExprDef.TParenthesis(f(e1));break;case 4:for(var el=_g.el,_g2=(_g1=[],0);_g2<el.length;){e1=el[_g2];++_g2,_g1.push(f(e1))}ed=hxsl_TExprDef.TBlock(_g1);break;case 5:var e2=_g.e2,op=(e1=_g.e1,_g.op);ed=hxsl_TExprDef.TBinop(op,f(e1),f(e2));break;case 6:e1=_g.e1,op=_g.op;ed=hxsl_TExprDef.TUnop(op,f(e1));break;case 7:var init=_g.init,v=_g.v;ed=hxsl_TExprDef.TVarDecl(v,null!=init?f(init):null);break;case 8:var args=_g.args,ed1=f(e1=_g.e);for(_g1=[],_g2=0;_g2<args.length;){var a=args[_g2];++_g2,_g1.push(f(a))}ed=hxsl_TExprDef.TCall(ed1,_g1);break;case 9:var c=_g.regs;e1=_g.e;ed=hxsl_TExprDef.TSwiz(f(e1),c);break;case 10:var eelse=_g.eelse,eif=_g.eif,econd=_g.econd;ed=hxsl_TExprDef.TIf(f(econd),f(eif),null!=eelse?f(eelse):null);break;case 12:e1=_g.e;ed=hxsl_TExprDef.TReturn(null!=e1?f(e1):null);break;case 13:var loop=_g.loop,it=_g.it;v=_g.v;ed=hxsl_TExprDef.TFor(v,f(it),f(loop));break;case 11:case 14:case 15:ed=e.e;break;case 16:var index=_g.index;e1=_g.e;ed=hxsl_TExprDef.TArray(f(e1),f(index));break;case 17:for(el=_g.el,_g1=[],_g2=0;_g2<el.length;){e1=el[_g2];++_g2,_g1.push(f(e1))}ed=hxsl_TExprDef.TArrayDecl(_g1);break;case 18:var def=_g.def,cases=_g.cases;for(ed1=f(e1=_g.e),_g1=[],_g2=0;_g2<cases.length;){c=cases[_g2];++_g2;for(var _g3=[],_g4=0,_g5=c.values;_g4<_g5.length;){v=_g5[_g4];++_g4,_g3.push(f(v))}_g1.push({values:_g3,expr:f(c.expr)})}ed=hxsl_TExprDef.TSwitch(ed1,_g1,null==def?null:f(def));break;case 19:var normalWhile=_g.normalWhile;loop=_g.loop,e1=_g.e;ed=hxsl_TExprDef.TWhile(f(e1),f(loop),normalWhile);break;case 20:e1=_g.e,args=_g.args;var m=_g.m;ed=hxsl_TExprDef.TMeta(m,args,f(e1))}return{e:ed,t:e.t,p:e.p}},hxsl_Tools.size=function(t){switch(t._hx_index){case 0:return 0;case 1:case 3:return 1;case 2:case 4:case 10:case 11:case 12:return 0;case 5:var _g=t.t;return t.size;case 6:return 9;case 7:return 16;case 8:return 12;case 9:return s=t.size;case 13:var vl=t.vl,s=0;for(_g=0;_g<vl.length;){var v=vl[_g];++_g,s+=hxsl_Tools.size(v.type)}return s;case 14:_g=t.variants;return 0;case 15:_g=t.size;var _g1=t.t;switch(_g._hx_index){case 0:var t1=_g1;v=_g.v;return hxsl_Tools.size(t1)*v;case 1:_g1=_g.v;return 0}break;case 16:if(0==(_g=t.size)._hx_index){t1=t.t,v=_g.v;return hxsl_Tools.size(t1)*v}return 0;case 17:return t.size}};var hxsl_Tools2=function(){};$hxClasses["hxsl.Tools2"]=hxsl_Tools2,hxsl_Tools2.__name__="hxsl.Tools2",hxsl_Tools2.toString=function(g){var n=$hxEnums[g.__enum__].__constructs__[g._hx_index];return n.charAt(0).toLowerCase()+HxOverrides.substr(n,1,null)};var hxsl_BatchShader=function(){this.Batch_Count__=0,hxsl_Shader.call(this)};$hxClasses["hxsl.BatchShader"]=hxsl_BatchShader,hxsl_BatchShader.__name__="hxsl.BatchShader",hxsl_BatchShader.__super__=hxsl_Shader,hxsl_BatchShader.prototype=$extend(hxsl_Shader.prototype,{updateConstants:function(globals){this.constBits=0;var v=this.Batch_Count__;if(v>>>17!=0)throw haxe_Exception.thrown("Batch_Count is out of range "+v+">131071");this.constBits|=v,this.updateConstantsFinal(globals)},getParamValue:function(index){switch(index){case 0:return this.Batch_Count__;case 1:return this.Batch_Buffer__}return null},getParamFloatValue:function(index){return 0},__class__:hxsl_BatchShader});var hxsl_SearchMap=function(){};$hxClasses["hxsl.SearchMap"]=hxsl_SearchMap,hxsl_SearchMap.__name__="hxsl.SearchMap",hxsl_SearchMap.prototype={__class__:hxsl_SearchMap};var hxsl_Cache=function(){this.constsToGlobal=!1,this.linkCache=new hxsl_SearchMap,this.linkShaders=new haxe_ds_StringMap,this.batchShaders=new haxe_ds_IntMap,this.byID=new haxe_ds_StringMap};$hxClasses["hxsl.Cache"]=hxsl_Cache,hxsl_Cache.__name__="hxsl.Cache",hxsl_Cache.get=function(){var c=hxsl_Cache.INST;return null==c&&(c=new hxsl_Cache,hxsl_Cache.INST=c),c},hxsl_Cache.prototype={getLinkShader:function(vars){for(var _g=[],_g1=0;_g1<vars.length;){var v=vars[_g1];++_g1,_g.push(Std.string(v))}var key=_g.join(","),shader=this.linkShaders.h[key];if(null!=shader)return shader;var s=new hxsl_SharedShader(""),id=HxOverrides.substr(haxe_crypto_Md5.encode(key),0,8);s.data={name:"shaderLinker_"+id,vars:[],funs:[]};var pos=null,outVars_h=Object.create(null),outputCount=0,tvec4=hxsl_Type.TVec(4,hxsl_VecType.VFloat),makeVec=function(g,size,args,makeOutExpr){for(var out=[],rem=size,_g=0,_g1=args.length;_g<_g1;){var i=_g++,e=makeOutExpr(args[args.length-1-i],rem-(args.length-1-i));rem-=hxsl_Tools.size(e.t),out.unshift(e)}return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(g),t:hxsl_Type.TVoid,p:pos},out),t:hxsl_Type.TVec(size,hxsl_VecType.VFloat),p:pos}},makeVar=function(name,t,parent){var path=null==parent?name:hxsl_Tools.getName(parent)+"."+name,v=outVars_h[path];if(null!=v)return v;if(v={id:hxsl_Tools.allocVarId(),name:name,type:t,kind:hxsl_VarKind.Var,parent:parent},null==parent)s.data.vars.push(v);else{var _g=parent.type;if(13!=_g._hx_index)throw haxe_Exception.thrown("assert");_g.vl.push(v)}return outVars_h[path]=v,v},makeOutExpr=null;makeOutExpr=function(v,rem){switch(v._hx_index){case 0:var v1=v.v;return{e:hxsl_TExprDef.TConst(hxsl_Const.CFloat(v1)),t:hxsl_Type.TFloat,p:pos};case 1:var size=v.size,vname=v.v;if(null!=(v1=outVars_h[vname]))return{e:hxsl_TExprDef.TVar(v1),t:v1.type,p:pos};for(var path=vname.split("."),parent=null;path.length>1;)parent=makeVar(path.shift(),hxsl_Type.TStruct([]),parent);return null!=size&&(rem=size),v1=makeVar(path.shift(),1==rem?hxsl_Type.TFloat:hxsl_Type.TVec(rem,hxsl_VecType.VFloat),parent),{e:hxsl_TExprDef.TVar(v1),t:v1.type,p:pos};case 2:v1=v.v;return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.PackNormal),t:hxsl_Type.TVoid,p:pos},[makeOutExpr(v1,3)]),t:tvec4,p:pos};case 3:v1=v.v;return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Pack),t:hxsl_Type.TVoid,p:pos},[makeOutExpr(v1,1)]),t:tvec4,p:pos};case 4:var args=v.a;return makeVec(hxsl_TGlobal.Vec2,2,args,makeOutExpr);case 5:args=v.a;return makeVec(hxsl_TGlobal.Vec3,3,args,makeOutExpr);case 6:args=v.a;return makeVec(hxsl_TGlobal.Vec4,4,args,makeOutExpr);case 7:var comps=v.swiz;v1=v.a;return{e:hxsl_TExprDef.TSwiz(makeOutExpr(v1,4),comps),t:hxsl_Type.TVec(comps.length,hxsl_VecType.VFloat),p:pos}}};var makeOutput=function(v){outputCount+=1;var ov={id:hxsl_Tools.allocVarId(),type:tvec4,name:"OUTPUT"+(outputCount-1),kind:hxsl_VarKind.Output};return s.data.vars.push(ov),{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAssign,{e:hxsl_TExprDef.TVar(ov),t:tvec4,p:pos},makeOutExpr(v,4)),t:hxsl_Type.TVoid,p:pos}},defineFun=function(kind,vars){for(var fv={id:hxsl_Tools.allocVarId(),type:hxsl_Type.TFun([]),name:(""+Std.string(kind)).toLowerCase(),kind:hxsl_VarKind.Function},_g=[],_g1=0;_g1<vars.length;){var v=vars[_g1];++_g1,_g.push(makeOutput(v))}var f={kind:kind,ref:fv,args:[],ret:hxsl_Type.TVoid,expr:{e:hxsl_TExprDef.TBlock(_g),p:pos,t:hxsl_Type.TVoid}};s.data.funs.push(f)};return defineFun(hxsl_FunctionKind.Vertex,[hxsl_Output.Value("output.position")]),defineFun(hxsl_FunctionKind.Fragment,vars),(shader=Object.create(hxsl_Shader.prototype)).shader=s,this.linkShaders.h[key]=shader,shader.updateConstantsFinal(null),shader},link:function(shaders,batchMode){for(var c=this.linkCache,_g_l=shaders;null!=_g_l;){var s=_g_l.s;_g_l=_g_l.next;var i=s.instance;null==c.next&&(c.next=new haxe_ds_IntMap);var cs=c.next.h[i.id];null==cs&&(cs=new hxsl_SearchMap,c.next.h[i.id]=cs),c=cs}return null==c.linked&&(c.linked=this.compileRuntimeShader(shaders,batchMode)),c.linked},compileRuntimeShader:function(shaders,batchMode){for(var shaderDatas=[],index=0,_g_l=shaders;null!=_g_l;){var s=_g_l.s;_g_l=_g_l.next;var i=(s1=s).instance;shaderDatas.push({inst:i,p:s1.priority,index:index++})}shaderDatas.reverse(),haxe_ds_ArraySort.sort(shaderDatas,(function(s1,s2){return s2.p-s1.p}));var linker=new hxsl_Linker(batchMode);try{for(var _g=[],_g1=0;_g1<shaderDatas.length;){var s1=shaderDatas[_g1];++_g1,_g.push(s1.inst.shader)}s=linker.link(_g)}catch(_g){if((_g1=haxe_Exception.caught(_g).unwrap())instanceof hxsl_Error){for(var e=_g1,_g2=(_g1=[],0);_g2<shaderDatas.length;){s1=shaderDatas[_g2];++_g2,_g1.push(hxsl_Printer.shaderToString(s1.inst.shader))}var shaders1=_g1;throw e.msg+="\n\nin\n\n"+shaders1.join("\n-----\n"),haxe_Exception.thrown(e)}throw _g}var paramVars=new haxe_ds_IntMap;for(_g=0,_g1=linker.allVars;_g<_g1.length;){var v=_g1[_g];if(++_g,v.v.kind==hxsl_VarKind.Param){if(13==(_g2=v.v.type)._hx_index){_g2.vl;continue}var inf=shaderDatas[v.instanceIndex];paramVars.h[v.id]={instance:inf.index,index:inf.inst.params.h[v.merged[0].id]}}}try{s1=(new hxsl_Splitter).split(s)}catch(_g){if((_g1=haxe_Exception.caught(_g).unwrap())instanceof hxsl_Error)throw(e=_g1).msg+="\n\nin\n\n"+hxsl_Printer.shaderToString(s),haxe_Exception.thrown(e);throw _g}if(batchMode)for(_g=0,_g1=s1.vertex.vars;_g<_g1.length;){v=_g1[_g];++_g,null!=v.qualifiers&&v.qualifiers.indexOf(hxsl_VarQualifier.PerObject)>=0&&(v.kind=hxsl_VarKind.Local)}s=(new hxsl_Dce).dce(s1.vertex,s1.fragment);for(var r=this.buildRuntimeShader(s.vertex,s.fragment,paramVars),_g4_l=(_g=[],shaders);null!=_g4_l;){s=_g4_l.s;_g4_l=_g4_l.next;s1=s;_g.push(new hxsl_ShaderInstanceDesc(s1.shader,s1.constBits))}r.spec={instances:_g,signature:null};for(_g=0,_g1=shaderDatas.length;_g<_g1;){i=_g++,s=shaderDatas[shaderDatas.length-1-i];r.spec.instances[s.index].index=i}for(_g=[],_g1=0,_g2=r.spec.instances;_g1<_g2.length;){i=_g2[_g1];++_g1,_g.push(i.shader.data.name+"_"+i.bits+"_"+i.index)}var tmp=_g.join(":");r.spec.signature=haxe_crypto_Md5.encode(tmp),r.signature=haxe_crypto_Md5.encode(hxsl_Printer.shaderToString(r.vertex.data)+hxsl_Printer.shaderToString(r.fragment.data)),r.batchMode=batchMode;var r2=this.byID.h[r.signature];return null!=r2?r.id=r2.id:this.byID.h[r.signature]=r,r},buildRuntimeShader:function(vertex,fragment,paramVars){var r=new hxsl_RuntimeShader;return r.vertex=this.flattenShader(vertex,hxsl_FunctionKind.Vertex,paramVars),r.vertex.vertex=!0,r.fragment=this.flattenShader(fragment,hxsl_FunctionKind.Fragment,paramVars),r.globals=new haxe_ds_IntMap,this.initGlobals(r,r.vertex),this.initGlobals(r,r.fragment),r},initGlobals:function(r,s){for(var p=s.globals;null!=p;)r.globals.h[p.gid]=!0,p=p.next;for(p=s.params;null!=p;)null!=p.perObjectGlobal&&(r.globals.h[p.perObjectGlobal.gid]=!0),p=p.next},getPath:function(v){return null==v.parent?v.name:this.getPath(v.parent)+"."+v.name},flattenShader:function(s,kind,params){var flat=new hxsl_Flatten,c=new hxsl_RuntimeShaderData,data=flat.flatten(s,kind,this.constsToGlobal),textures=[];c.consts=flat.consts,c.texturesCount=0;for(var g=flat.allocData.keys();g.hasNext();){var g1=g.next(),alloc=flat.allocData.h[g1.__id__];switch(g1.kind._hx_index){case 0:for(var _g=[],_g1=0;_g1<alloc.length;){var a=alloc[_g1];++_g1,null!=a.v&&_g.push(new hxsl_AllocGlobal(a.pos,this.getPath(a.v),a.v.type))}for(var out=_g,_g2=0,_g3=out.length-1;_g2<_g3;){out[i=_g2++].next=out[i+1]}var _g4=g1.type;if(15!=_g4._hx_index)throw haxe_Exception.thrown("assert");var _g5=_g4.size,_g6=_g4.t;if(5!=_g6._hx_index)throw haxe_Exception.thrown("assert");if(4!=_g6.size)throw haxe_Exception.thrown("assert");if(1!=_g6.t._hx_index)throw haxe_Exception.thrown("assert");if(0!=_g5._hx_index)throw haxe_Exception.thrown("assert");var size=_g5.v;c.globals=out[0],c.globalsSize=size;break;case 2:for(var out1=[],_g7=0;_g7<alloc.length;){var a1=alloc[_g7];if(++_g7,null!=a1.v){var p=params.h[a1.v.id];if(null!=p)out1.push(new hxsl_AllocParam(a1.v.name,a1.pos,p.instance,p.index,a1.v.type));else{var ap=new hxsl_AllocParam(a1.v.name,a1.pos,-1,-1,a1.v.type);ap.perObjectGlobal=new hxsl_AllocGlobal(-1,this.getPath(a1.v),a1.v.type),out1.push(ap)}}}for(var _g8=0,_g9=out1.length-1;_g8<_g9;){var i1=_g8++;out1[i1].next=out1[i1+1]}var _g10=g1.type;if(15!=_g10._hx_index)throw haxe_Exception.thrown("assert");var _g11=_g10.size,_g12=_g10.t,t=_g12;if(hxsl_Tools.isSampler(t))textures.push({t:t,all:out1}),c.texturesCount+=out1.length;else switch(_g12._hx_index){case 5:if(4!=_g12.size)throw haxe_Exception.thrown("assert");if(1!=_g12.t._hx_index)throw haxe_Exception.thrown("assert");if(0!=_g11._hx_index)throw haxe_Exception.thrown("assert");var size1=_g11.v;c.params=out1[0],c.paramsSize=size1;break;case 16:_g12.size,_g12.t;c.buffers=out1[0],c.bufferCount=out1.length;break;default:throw haxe_Exception.thrown("assert")}break;default:throw haxe_Exception.thrown("assert")}}if(textures.length>0){textures.sort((function(t1,t2){return t1.t._hx_index-t2.t._hx_index})),c.textures=textures[0].all[0];for(_g=1,_g1=textures.length;_g<_g1;){var i,prevAll=textures[(i=_g++)-1].all;prevAll[prevAll.length-1].next=textures[i].all[0]}}return null==c.globals&&(c.globalsSize=0),null==c.params&&(c.paramsSize=0),null==c.buffers&&(c.bufferCount=0),c.data=data,c},__class__:hxsl_Cache};var hxsl_Channel=$hxEnums["hxsl.Channel"]={__ename__:"hxsl.Channel",__constructs__:["Unknown","R","G","B","A","PackedFloat","PackedNormal"],Unknown:{_hx_index:0,__enum__:"hxsl.Channel",toString:$estr},R:{_hx_index:1,__enum__:"hxsl.Channel",toString:$estr},G:{_hx_index:2,__enum__:"hxsl.Channel",toString:$estr},B:{_hx_index:3,__enum__:"hxsl.Channel",toString:$estr},A:{_hx_index:4,__enum__:"hxsl.Channel",toString:$estr},PackedFloat:{_hx_index:5,__enum__:"hxsl.Channel",toString:$estr},PackedNormal:{_hx_index:6,__enum__:"hxsl.Channel",toString:$estr}};hxsl_Channel.__empty_constructs__=[hxsl_Channel.Unknown,hxsl_Channel.R,hxsl_Channel.G,hxsl_Channel.B,hxsl_Channel.A,hxsl_Channel.PackedFloat,hxsl_Channel.PackedNormal];var hxsl_Clone=function(){this.varMap=new haxe_ds_IntMap};$hxClasses["hxsl.Clone"]=hxsl_Clone,hxsl_Clone.__name__="hxsl.Clone",hxsl_Clone.shaderData=function(s){return(new hxsl_Clone).shader(s)},hxsl_Clone.prototype={tvar:function(v){var v2=this.varMap.h[v.id];return null!=v2||(v2={id:hxsl_Tools.allocVarId(),type:v.type,name:v.name,kind:v.kind},this.varMap.h[v.id]=v2,null!=v.parent&&(v2.parent=this.tvar(v.parent)),null!=v.qualifiers&&(v2.qualifiers=v.qualifiers.slice()),v2.type=this.ttype(v.type)),v2},tfun:function(f){for(var tmp=this.ttype(f.ret),f1=f.kind,tmp1=this.tvar(f.ref),_g=[],_g1=0,_g2=f.args;_g1<_g2.length;){var a=_g2[_g1];++_g1,_g.push(this.tvar(a))}return{ret:tmp,kind:f1,ref:tmp1,args:_g,expr:this.texpr(f.expr)}},ttype:function(t){switch(t._hx_index){case 13:for(var vl=t.vl,_g=[],_g1=0;_g1<vl.length;){var v=vl[_g1];++_g1,_g.push(this.tvar(v))}return hxsl_Type.TStruct(_g);case 14:var vars=t.variants;return hxsl_Type.TFun(vars);case 15:var tmp1,size=t.size,t1=t.t,tmp=this.ttype(t1);switch(size._hx_index){case 0:_g=size.v;tmp1=size;break;case 1:v=size.v;tmp1=hxsl_SizeDecl.SVar(this.tvar(v))}return hxsl_Type.TArray(tmp,tmp1);default:return t}},texpr:function(e){var e2=hxsl_Tools.map(e,$bind(this,this.texpr));e2.t=this.ttype(e.t);var tmp,_g=e2.e;switch(_g._hx_index){case 1:var v=_g.v;tmp=hxsl_TExprDef.TVar(this.tvar(v));break;case 7:var init=_g.init;v=_g.v;tmp=hxsl_TExprDef.TVarDecl(this.tvar(v),init);break;case 13:var loop=_g.loop,it=_g.it;v=_g.v;tmp=hxsl_TExprDef.TFor(this.tvar(v),it,loop);break;default:tmp=e2.e}return e2.e=tmp,e2},shader:function(s){for(var s1=s.name,_g=[],_g1=0,_g2=s.vars;_g1<_g2.length;){var v=_g2[_g1];++_g1,_g.push(this.tvar(v))}var tmp=_g;for(_g=[],_g1=0,_g2=s.funs;_g1<_g2.length;){var f=_g2[_g1];++_g1,_g.push(this.tfun(f))}return{name:s1,vars:tmp,funs:_g}},__class__:hxsl_Clone};var hxsl__$Dce_VarDeps=function(v){this.v=v,this.used=!1,this.deps=new haxe_ds_IntMap};$hxClasses["hxsl._Dce.VarDeps"]=hxsl__$Dce_VarDeps,hxsl__$Dce_VarDeps.__name__="hxsl._Dce.VarDeps",hxsl__$Dce_VarDeps.prototype={__class__:hxsl__$Dce_VarDeps};var hxsl_Dce=function(){};$hxClasses["hxsl.Dce"]=hxsl_Dce,hxsl_Dce.__name__="hxsl.Dce",hxsl_Dce.prototype={dce:function(vertex,fragment){this.used=new haxe_ds_IntMap,this.channelVars=[];for(var inputs=[],_g=0,_g1=vertex.vars;_g<_g1.length;){var v=_g1[_g];++_g;var i=this.get(v);v.kind==hxsl_VarKind.Input&&inputs.push(i),v.kind==hxsl_VarKind.Output&&(i.keep=!0)}for(_g=0,_g1=fragment.vars;_g<_g1.length;){v=_g1[_g];++_g;i=this.get(v);v.kind==hxsl_VarKind.Output&&(i.keep=!0)}for(_g=0,_g1=vertex.funs;_g<_g1.length;){var f=_g1[_g];++_g,this.check(f.expr,[],[])}for(_g=0,_g1=fragment.funs;_g<_g1.length;){f=_g1[_g];++_g,this.check(f.expr,[],[])}for(var outExprs=[];;){for(v=this.used.iterator();v.hasNext();){(v1=v.next()).keep&&this.markRec(v1)}for(;inputs.length>1&&!inputs[inputs.length-1].used;)inputs.pop();for(_g=0;_g<inputs.length;){var v2=inputs[_g];++_g,this.markRec(v2)}outExprs=[];_g1=0;for(var _g2=vertex.funs;_g1<_g2.length;){f=_g2[_g1];++_g1,outExprs.push(this.mapExpr(f.expr,!1))}for(var _g3=0,_g4=fragment.funs;_g3<_g4.length;){var f1=_g4[_g3];++_g3,outExprs.push(this.mapExpr(f1.expr,!1))}this.markAsKeep=!1;for(var _g5=0;_g5<outExprs.length;){var e=outExprs[_g5];++_g5,this.checkBranches(e)}if(!this.markAsKeep)break}for(_g=0,_g1=vertex.funs;_g<_g1.length;){f=_g1[_g];++_g,f.expr=outExprs.shift()}for(_g=0,_g1=fragment.funs;_g<_g1.length;){f=_g1[_g];++_g,f.expr=outExprs.shift()}for(v=this.used.iterator();v.hasNext();){var v1;(v1=v.next()).used||v1.v.kind!=hxsl_VarKind.Input&&(HxOverrides.remove(vertex.vars,v1.v),HxOverrides.remove(fragment.vars,v1.v))}return{fragment:fragment,vertex:vertex}},get:function(v){var vd=this.used.h[v.id];return null==vd&&(vd=new hxsl__$Dce_VarDeps(v),this.used.h[v.id]=vd),vd},markRec:function(v){if(!v.used){v.used=!0;for(var d=v.deps.iterator();d.hasNext();){var d1=d.next();this.markRec(d1)}}},link:function(v,writeTo){for(var vd=this.get(v),_g=0;_g<writeTo.length;){var w=writeTo[_g];++_g,null!=w?w.deps.h[v.id]=vd:vd.keep||(vd.keep=!0,this.markAsKeep=!0)}},check:function(e,writeTo,isAffected){switch((_g=e.e)._hx_index){case 1:var v=_g.v;this.link(v,writeTo);break;case 4:for(var el=_g.el,noWrite=[],_g1=0,_g2=el.length;_g1<_g2;){var i=_g1++;this.check(el[i],i<el.length-1?noWrite:writeTo,isAffected)}break;case 5:_g1=_g.e2,_g2=_g.e1;switch((_g3=_g.op)._hx_index){case 4:var _g4=_g2.t;_g4=_g2.p;switch((_g4=_g2.e)._hx_index){case 1:var e1=_g1,v1=(v=_g4.v,this.get(v));writeTo.push(v1),this.check(e1,writeTo,isAffected),writeTo.pop(),isAffected.indexOf(v1)<0&&isAffected.push(v1);break;case 9:var _g5=_g4.regs;_g4=(_g5=_g4.e).t,_g4=_g5.p;if(1==(_g4=_g5.e)._hx_index){e1=_g1,v=_g4.v,v1=this.get(v);writeTo.push(v1),this.check(e1,writeTo,isAffected),writeTo.pop(),isAffected.indexOf(v1)<0&&isAffected.push(v1)}else{_g4=$bind(this,this.check);var writeTo1=writeTo,isAffected1=isAffected;hxsl_Tools.iter(e,(function(e){_g4(e,writeTo1,isAffected1)}))}break;default:_g5=$bind(this,this.check);var writeTo2=writeTo,isAffected2=isAffected;hxsl_Tools.iter(e,(function(e){_g5(e,writeTo2,isAffected2)}))}break;case 20:var _g6=_g3.op,_g3=_g2.t;_g3=_g2.p;switch((_g3=_g2.e)._hx_index){case 1:e1=_g1,v=_g3.v,v1=this.get(v);writeTo.push(v1),this.check(e1,writeTo,isAffected),writeTo.pop(),isAffected.indexOf(v1)<0&&isAffected.push(v1);break;case 9:_g2=_g3.regs,_g3=(_g2=_g3.e).t,_g3=_g2.p;if(1==(_g3=_g2.e)._hx_index){e1=_g1,v=_g3.v,v1=this.get(v);writeTo.push(v1),this.check(e1,writeTo,isAffected),writeTo.pop(),isAffected.indexOf(v1)<0&&isAffected.push(v1)}else{_g1=$bind(this,this.check);var writeTo3=writeTo,isAffected3=isAffected;hxsl_Tools.iter(e,(function(e){_g1(e,writeTo3,isAffected3)}))}break;default:_g2=$bind(this,this.check);var writeTo4=writeTo,isAffected4=isAffected;hxsl_Tools.iter(e,(function(e){_g2(e,writeTo4,isAffected4)}))}break;default:_g3=$bind(this,this.check);var writeTo5=writeTo,isAffected5=isAffected;hxsl_Tools.iter(e,(function(e){_g3(e,writeTo5,isAffected5)}))}break;case 7:var init=_g.init;v=_g.v;if(null!=init)writeTo.push(this.get(v)),this.check(init,writeTo,isAffected),writeTo.pop();else{_g6=$bind(this,this.check);var writeTo6=writeTo,isAffected6=isAffected;hxsl_Tools.iter(e,(function(e){_g6(e,writeTo6,isAffected6)}))}break;case 8:var _g7=_g.args,_g9=(_g8=_g.e).t;_g9=_g8.p;if(2==(_g9=_g8.e)._hx_index)switch(_g9.g._hx_index){case 63:if(3==_g7.length){var _g8=_g7[2],_g10=(_g9=_g7[0]).t;_g10=_g9.p;if(1==(_g10=_g9.e)._hx_index){_g9=_g8.t,_g9=_g8.p;if(0==(_g9=_g8.e)._hx_index){if(2==(_g8=_g9.c)._hx_index){var c=_g10.v,uv=_g7[1],cid=_g8.v;this.check(uv,writeTo,isAffected),null==this.channelVars[cid]?(this.channelVars[cid]=c,this.link(c,writeTo)):this.link(this.channelVars[cid],writeTo)}else{_g8=$bind(this,this.check);var writeTo7=writeTo,isAffected7=isAffected;hxsl_Tools.iter(e,(function(e){_g8(e,writeTo7,isAffected7)}))}}else{_g9=$bind(this,this.check);var writeTo8=writeTo,isAffected8=isAffected;hxsl_Tools.iter(e,(function(e){_g9(e,writeTo8,isAffected8)}))}}else{_g10=$bind(this,this.check);var writeTo9=writeTo,isAffected9=isAffected;hxsl_Tools.iter(e,(function(e){_g10(e,writeTo9,isAffected9)}))}}else{var _g11=$bind(this,this.check),writeTo10=writeTo,isAffected10=isAffected;hxsl_Tools.iter(e,(function(e){_g11(e,writeTo10,isAffected10)}))}break;case 64:if(4==_g7.length){var _g12=_g7[3],_g14=(_g13=_g7[0]).t;_g14=_g13.p;if(1==(_g14=_g13.e)._hx_index){var _g13=_g12.t;_g13=_g12.p;if(0==(_g13=_g12.e)._hx_index){if(2==(_g12=_g13.c)._hx_index){c=_g14.v,uv=_g7[1];var lod=_g7[2];cid=_g12.v;this.check(uv,writeTo,isAffected),this.check(lod,writeTo,isAffected),null==this.channelVars[cid]?(this.channelVars[cid]=c,this.link(c,writeTo)):this.link(this.channelVars[cid],writeTo)}else{_g7=$bind(this,this.check);var writeTo11=writeTo,isAffected11=isAffected;hxsl_Tools.iter(e,(function(e){_g7(e,writeTo11,isAffected11)}))}}else{_g12=$bind(this,this.check);var writeTo12=writeTo,isAffected12=isAffected;hxsl_Tools.iter(e,(function(e){_g12(e,writeTo12,isAffected12)}))}}else{_g13=$bind(this,this.check);var writeTo13=writeTo,isAffected13=isAffected;hxsl_Tools.iter(e,(function(e){_g13(e,writeTo13,isAffected13)}))}}else{_g14=$bind(this,this.check);var writeTo14=writeTo,isAffected14=isAffected;hxsl_Tools.iter(e,(function(e){_g14(e,writeTo14,isAffected14)}))}break;default:var _g15=$bind(this,this.check),writeTo15=writeTo,isAffected15=isAffected;hxsl_Tools.iter(e,(function(e){_g15(e,writeTo15,isAffected15)}))}else{var _g16=$bind(this,this.check),writeTo16=writeTo,isAffected16=isAffected;hxsl_Tools.iter(e,(function(e){_g16(e,writeTo16,isAffected16)}))}break;case 10:var eelse=_g.eelse,eif=_g.eif,affect=(e1=_g.econd,[]);this.check(eif,writeTo,affect),null!=eelse&&this.check(eelse,writeTo,affect);for(var len=affect.length,_g17=0;_g17<writeTo.length;){v=writeTo[_g17];++_g17,affect.indexOf(v)<0&&affect.push(v)}this.check(e1,affect,isAffected);_g17=0;for(var _g18=len;_g17<_g18;){v=affect[i=_g17++];isAffected.indexOf(v)<0&&isAffected.push(v)}break;case 13:var loop=_g.loop,it=_g.it;v=_g.v,affect=[];this.check(loop,writeTo,affect),this.check(it,affect,isAffected);for(var _g=0;_g<affect.length;){v=affect[_g];++_g,isAffected.indexOf(v)<0&&isAffected.push(v)}break;default:_g=$bind(this,this.check);var writeTo17=writeTo,isAffected17=isAffected;hxsl_Tools.iter(e,(function(e){_g(e,writeTo17,isAffected17)}))}},checkBranches:function(e){var _g=e.e;if(10==_g._hx_index){_g.eelse,_g.eif;var cond=_g.econd;this.check(cond,[null],[])}hxsl_Tools.iter(e,$bind(this,this.checkBranches))},mapExpr:function(e,isVar){var _gthis=this,_g=e.e;switch(_g._hx_index){case 4:for(var el=_g.el,out=[],count=0,_g1=0;_g1<el.length;){var e1=el[_g1];++_g1;var isVar1=isVar&&count==el.length-1,e2=this.mapExpr(e1,isVar1);(hxsl_Tools.hasSideEffect(e2)||isVar1)&&out.push(e2),++count}return{e:hxsl_TExprDef.TBlock(out),p:e.p,t:e.t};case 5:_g1=_g.e2,_g1=_g.e1;switch((_g2=_g.op)._hx_index){case 4:var _g3=_g1.t;_g3=_g1.p;switch((_g3=_g1.e)._hx_index){case 1:var v=_g3.v;return this.get(v).used?hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)})):{e:hxsl_TExprDef.TConst(hxsl_Const.CNull),t:e.t,p:e.p};case 9:var _g4=_g3.regs;_g3=(_g4=_g3.e).t,_g3=_g4.p;if(1==(_g3=_g4.e)._hx_index){v=_g3.v;return this.get(v).used?hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)})):{e:hxsl_TExprDef.TConst(hxsl_Const.CNull),t:e.t,p:e.p}}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}));default:return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}break;case 20:_g3=_g2.op;var _g2=_g1.t;_g2=_g1.p;switch((_g2=_g1.e)._hx_index){case 1:v=_g2.v;return this.get(v).used?hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)})):{e:hxsl_TExprDef.TConst(hxsl_Const.CNull),t:e.t,p:e.p};case 9:_g1=_g2.regs,_g2=(_g1=_g2.e).t,_g2=_g1.p;if(1==(_g2=_g1.e)._hx_index){v=_g2.v;return this.get(v).used?hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)})):{e:hxsl_TExprDef.TConst(hxsl_Const.CNull),t:e.t,p:e.p}}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}));default:return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}break;default:return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}break;case 7:_g1=_g.init,v=_g.v;return this.get(v).used?hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)})):{e:hxsl_TExprDef.TConst(hxsl_Const.CNull),t:e.t,p:e.p};case 8:_g1=_g.args,_g3=(_g2=_g.e).t,_g3=_g2.p;if(2!=(_g3=_g2.e)._hx_index)return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}));switch(_g3.g._hx_index){case 63:if(3==_g1.length){_g2=_g1[2],_g3=_g1[0],_g3=_g2.t,_g3=_g2.p;if(0==(_g3=_g2.e)._hx_index){if(2==(_g2=_g3.c)._hx_index){var uv=_g1[1],cid=_g2.v,c=this.channelVars[cid];return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Texture),p:e.p,t:hxsl_Type.TVoid},[{e:hxsl_TExprDef.TVar(c),t:c.type,p:e.p},this.mapExpr(uv,!0)]),t:hxsl_Type.TVoid,p:e.p}}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}));case 64:if(4==_g1.length){_g2=_g1[3],_g3=_g1[0],_g3=_g2.t,_g3=_g2.p;if(0==(_g3=_g2.e)._hx_index){if(2==(_g2=_g3.c)._hx_index){uv=_g1[1];var lod=_g1[2];cid=_g2.v,c=this.channelVars[cid];return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.TextureLod),p:e.p,t:hxsl_Type.TVoid},[{e:hxsl_TExprDef.TVar(c),t:c.type,p:e.p},this.mapExpr(uv,!0),this.mapExpr(lod,!0)]),t:hxsl_Type.TVoid,p:e.p}}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}));case 65:if(3==_g1.length){_g2=_g1[2],_g3=_g1[0],_g3=_g2.t,_g3=_g2.p;if(0==(_g3=_g2.e)._hx_index){if(2==(_g2=_g3.c)._hx_index){var pos=_g1[1];cid=_g2.v,c=this.channelVars[cid];return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Texel),p:e.p,t:hxsl_Type.TVoid},[{e:hxsl_TExprDef.TVar(c),t:c.type,p:e.p},this.mapExpr(pos,!0)]),t:hxsl_Type.TVoid,p:e.p}}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}));case 66:if(4==_g1.length){_g2=_g1[3],_g3=_g1[0],_g3=_g2.t,_g3=_g2.p;if(0==(_g3=_g2.e)._hx_index){if(2==(_g2=_g3.c)._hx_index){pos=_g1[1],lod=_g1[2],cid=_g2.v,c=this.channelVars[cid];return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Texel),p:e.p,t:hxsl_Type.TVoid},[{e:hxsl_TExprDef.TVar(c),t:c.type,p:e.p},this.mapExpr(pos,!0),this.mapExpr(lod,!0)]),t:hxsl_Type.TVoid,p:e.p}}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}));default:return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}break;case 10:var eelse=_g.eelse,econd=_g.eif,econd1=(e1=_g.econd,e2=this.mapExpr(e1,!0),this.mapExpr(econd,isVar)),eelse1=null==eelse?null:this.mapExpr(eelse,isVar);return isVar||hxsl_Tools.hasSideEffect(econd1)||null!=eelse1&&hxsl_Tools.hasSideEffect(eelse1)?{e:hxsl_TExprDef.TIf(e2,econd1,eelse1),p:e2.p,t:e2.t}:{e:hxsl_TExprDef.TConst(hxsl_Const.CNull),t:e2.t,p:e2.p};case 13:var loop=_g.loop,it=_g.it,it1=(v=_g.v,this.mapExpr(it,!0)),loop1=this.mapExpr(loop,!1);return hxsl_Tools.hasSideEffect(loop1)?{e:hxsl_TExprDef.TFor(v,it1,loop1),p:e.p,t:e.t}:{e:hxsl_TExprDef.TConst(hxsl_Const.CNull),t:e.t,p:e.p};default:return hxsl_Tools.map(e,(function(e){return _gthis.mapExpr(e,!0)}))}},__class__:hxsl_Dce};var hxsl_Eval=function(){this.varMap=new haxe_ds_ObjectMap,this.funMap=new haxe_ds_ObjectMap,this.constants=new haxe_ds_IntMap};$hxClasses["hxsl.Eval"]=hxsl_Eval,hxsl_Eval.__name__="hxsl.Eval",hxsl_Eval.prototype={setConstant:function(v,c){this.constants.h[v.id]=hxsl_TExprDef.TConst(c)},mapVar:function(v){var v21,v2=this.varMap.h[v.__id__];if(null!=v2)return v==v2?v2:this.mapVar(v2);if(null!=v.parent&&(this.mapVar(v.parent),null!=(v2=this.varMap.h[v.__id__])))return v==v2?v2:this.mapVar(v2);if(17==(_g=v.type)._hx_index){var _g1=_g.size;v21=!0}else v21=!1;switch(v2={id:v21?v.id:hxsl_Tools.allocVarId(),name:v.name,type:v.type,kind:v.kind},null!=v.parent&&(v2.parent=this.mapVar(v.parent)),null!=v.qualifiers&&(v2.qualifiers=v.qualifiers.slice()),this.varMap.set(v,v2),this.varMap.set(v2,v2),(_g=v2.type)._hx_index){case 13:for(var vl=_g.vl,_g2=(_g1=[],0);_g2<vl.length;){v=vl[_g2];++_g2,_g1.push(this.mapVar(v))}v2.type=hxsl_Type.TStruct(_g1);break;case 15:if(1==(_g1=_g.size)._hx_index){var t=_g.t,vs=_g1.v;if(null!=(c=this.constants.h[vs.id]))if(null==c)hxsl_Error.t("Integer value expected for array size constant "+vs.name,null);else if(0==c._hx_index){if(2==(_g1=c.c)._hx_index){v=_g1.v;if(15==(_g1=v2.type)._hx_index){_g2=_g1.size,_g2=_g1.t;tmp=!0}else tmp=!1;v2.type=tmp?hxsl_Type.TArray(t,hxsl_SizeDecl.SConst(v)):hxsl_Type.TBuffer(t,hxsl_SizeDecl.SConst(v))}else hxsl_Error.t("Integer value expected for array size constant "+vs.name,null)}else hxsl_Error.t("Integer value expected for array size constant "+vs.name,null);else{var vs2=this.mapVar(vs);if(15==(_g1=v2.type)._hx_index){_g2=_g1.size,_g2=_g1.t;tmp=!0}else tmp=!1;v2.type=tmp?hxsl_Type.TArray(t,hxsl_SizeDecl.SVar(vs2)):hxsl_Type.TBuffer(t,hxsl_SizeDecl.SVar(vs2))}}break;case 16:if(1==(_g1=_g.size)._hx_index){var c;t=_g.t,vs=_g1.v;if(null!=(c=this.constants.h[vs.id]))if(null==c)hxsl_Error.t("Integer value expected for array size constant "+vs.name,null);else if(0==c._hx_index){if(2==(_g=c.c)._hx_index){v=_g.v;if(15==(_g=v2.type)._hx_index){_g1=_g.size,_g1=_g.t;tmp=!0}else tmp=!1;v2.type=tmp?hxsl_Type.TArray(t,hxsl_SizeDecl.SConst(v)):hxsl_Type.TBuffer(t,hxsl_SizeDecl.SConst(v))}else hxsl_Error.t("Integer value expected for array size constant "+vs.name,null)}else hxsl_Error.t("Integer value expected for array size constant "+vs.name,null);else{var _g,tmp;vs2=this.mapVar(vs);if(15==(_g=v2.type)._hx_index){_g1=_g.size,_g1=_g.t;tmp=!0}else tmp=!1;v2.type=tmp?hxsl_Type.TArray(t,hxsl_SizeDecl.SVar(vs2)):hxsl_Type.TBuffer(t,hxsl_SizeDecl.SVar(vs2))}}}return v2},eval:function(s){for(var funs=[],_g=0,_g1=s.funs;_g<_g1.length;){var f=_g1[_g];++_g;for(var f1=f.kind,f2=this.mapVar(f.ref),_g2=[],_g3=0,_g4=f.args;_g3<_g4.length;){var a=_g4[_g3];++_g3,_g2.push(this.mapVar(a))}var f21={kind:f1,ref:f2,args:_g2,ret:f.ret,expr:f.expr};this.inlineCalls&&f.kind==hxsl_FunctionKind.Helper||funs.push(f21),this.funMap.set(f21.ref,f)}for(_g=0,_g1=funs.length;_g<_g1;){var i=_g++;this.curFun=funs[i],this.curFun.expr=this.evalExpr(this.curFun.expr,!1)}var s1=s.name;for(_g=[],_g1=0,_g2=s.vars;_g1<_g2.length;){var v=_g2[_g1];++_g1,_g.push(this.mapVar(v))}return{name:s1,vars:_g,funs:funs}},hasReturn:function(e){return this.markReturn=!1,this.hasReturnLoop(e),this.markReturn},hasReturnLoop:function(e){var _g=e.e;if(12==_g._hx_index){_g.e;this.markReturn=!0}else this.markReturn||hxsl_Tools.iter(e,$bind(this,this.hasReturnLoop))},handleReturn:function(e,isFinal){null==isFinal&&(isFinal=!1);var _g=e.e;switch(_g._hx_index){case 3:var v=_g.e,v1=this.handleReturn(v,isFinal);return{e:hxsl_TExprDef.TParenthesis(v1),t:v1.t,p:e.p};case 4:var el=_g.el,i=0,last=el.length,out=[];_hx_loop1:for(;i<last;){var e1=el[i++];if(i==last)out.push(this.handleReturn(e1,isFinal));else{var _g1=e1.e;switch(_g1._hx_index){case 10:if(null==_g1.eelse){var econd=_g1.econd,eif=_g1.eif;if(isFinal&&this.hasReturn(eif)){out.push(this.handleReturn({e:hxsl_TExprDef.TIf(econd,eif,{e:hxsl_TExprDef.TBlock(el.slice(i)),t:e1.t,p:e1.p}),t:e1.t,p:e1.p}));break _hx_loop1}out.push(this.handleReturn(e1))}else out.push(this.handleReturn(e1));break;case 12:var e2=_g1.e;out.push(this.handleReturn(e2,isFinal));break _hx_loop1;default:out.push(this.handleReturn(e1))}}}var t=isFinal?out[out.length-1].t:e.t;return{e:hxsl_TExprDef.TBlock(out),t:t,p:e.p};case 10:var eelse=_g.eelse,cond=(eif=_g.eif,_g.econd);if(null!=eelse&&isFinal){var cond1=this.handleReturn(cond),eif1=this.handleReturn(eif,isFinal);return{e:hxsl_TExprDef.TIf(cond1,eif1,this.handleReturn(eelse,isFinal)),t:eif1.t,p:e.p}}return hxsl_Tools.map(e,$bind(this,this.handleReturnDef));case 12:v=_g.e;return isFinal||hxsl_Error.t("Cannot inline not final return",e.p),null==v?{e:hxsl_TExprDef.TBlock([]),t:hxsl_Type.TVoid,p:e.p}:this.handleReturn(v,!0);default:return hxsl_Tools.map(e,$bind(this,this.handleReturnDef))}},handleReturnDef:function(e){return this.handleReturn(e)},evalCall:function(g,args,oldArgs,pos){switch(g._hx_index){case 38:if(1==args.length){var _g1=(_g=args[0]).t;_g1=_g.p;if(0==(_g1=_g.e)._hx_index){if(2==(_g=_g1.c)._hx_index){var i=_g.v;return hxsl_TExprDef.TConst(hxsl_Const.CFloat(i))}return null}return null}return null;case 63:case 64:if(0!=(_g=args[0].e)._hx_index)throw hxsl_Error.t("Cannot eval complex channel "+hxsl_Printer.toString(args[0],!0)+" "+this.constantsToString(),pos),haxe_Exception.thrown("assert");if(2!=(_g1=_g.c)._hx_index)throw hxsl_Error.t("Cannot eval complex channel "+hxsl_Printer.toString(args[0],!0)+" "+this.constantsToString(),pos),haxe_Exception.thrown("assert");i=i1=_g1.v;var channel=oldArgs[0];if(1!=(_g=channel.e)._hx_index)throw haxe_Exception.thrown("assert");var count,v=_g.v;if(17!=(_g=(channel={e:hxsl_TExprDef.TVar(this.mapVar(v)),t:channel.t,p:channel.p}).t)._hx_index)throw haxe_Exception.thrown("assert");count=i1=_g.size;var channelMode=Type.createEnumIndex(hxsl_Channel,7&i,null),targs=[channel],_g=1;for(_g1=args.length;_g<_g1;){var i1=_g++;targs.push(args[i1])}targs.push({e:hxsl_TExprDef.TConst(hxsl_Const.CInt(i>>3)),t:hxsl_Type.TInt,p:pos});var tget={e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(g),t:hxsl_Type.TVoid,p:pos},targs),t:hxsl_Type.TVoid,p:pos};switch(channelMode._hx_index){case 0:var zero={e:hxsl_TExprDef.TConst(hxsl_Const.CFloat(0)),t:hxsl_Type.TFloat,p:pos};return 1==count?zero.e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal([hxsl_TGlobal.Vec2,hxsl_TGlobal.Vec3,hxsl_TGlobal.Vec4][count-2]),t:hxsl_Type.TVoid,p:pos},[zero]);case 1:case 2:case 3:case 4:var tmp;switch(count){case 1:switch(channelMode._hx_index){case 1:tmp=[hxsl_Component.X];break;case 2:tmp=[hxsl_Component.Y];break;case 3:tmp=[hxsl_Component.Z];break;case 4:tmp=[hxsl_Component.W];break;default:throw haxe_Exception.thrown("Invalid channel value "+Std.string(channelMode)+" for "+count+" channels")}break;case 2:switch(channelMode._hx_index){case 1:tmp=[hxsl_Component.X,hxsl_Component.Y];break;case 2:tmp=[hxsl_Component.Y,hxsl_Component.Z];break;case 3:tmp=[hxsl_Component.Z,hxsl_Component.W];break;default:throw haxe_Exception.thrown("Invalid channel value "+Std.string(channelMode)+" for "+count+" channels")}break;case 3:switch(channelMode._hx_index){case 1:tmp=[hxsl_Component.X,hxsl_Component.Y,hxsl_Component.Z];break;case 2:tmp=[hxsl_Component.Y,hxsl_Component.Z,hxsl_Component.W];break;default:throw haxe_Exception.thrown("Invalid channel value "+Std.string(channelMode)+" for "+count+" channels")}break;default:throw haxe_Exception.thrown("Invalid channel value "+Std.string(channelMode)+" for "+count+" channels")}return hxsl_TExprDef.TSwiz(tget,tmp);case 5:return hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Unpack),t:hxsl_Type.TVoid,p:pos},[tget]);case 6:return hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.UnpackNormal),t:hxsl_Type.TVoid,p:pos},[tget])}break;case 67:var args1=args;for(_g=0;_g<args1.length;){var a=args1[_g];++_g,haxe_Log.trace(hxsl_Printer.toString(a),{fileName:a.p.file,lineNumber:0,className:null,methodName:null})}return hxsl_TExprDef.TBlock([]);default:return null}},constantsToString:function(){for(var _g=[],c=this.constants.keys();c.hasNext();){var c1=c.next();_g.push(c1+" => "+hxsl_Printer.toString({e:this.constants.h[c1],t:hxsl_Type.TVoid,p:null},!0))}return _g.toString()},ifBlock:function(e){var tmp;if(null!=e){var tmp1,_g=e.e;if(10==_g._hx_index){_g.eelse,_g.eif,_g.econd;tmp1=!0}else tmp1=!1;tmp=!tmp1}else tmp=!0;return tmp?e:{e:hxsl_TExprDef.TBlock([e]),t:e.t,p:e.p}},evalExpr:function(e,isVal){null==isVal&&(isVal=!0);var d,_gthis=this,_g=e.e;switch(_g._hx_index){case 0:var _g1=_g.c;d=e.e;break;case 1:var v=_g.v;if(null!=(c=this.constants.h[v.id]))d=c;else{var v2=this.mapVar(v);d=hxsl_TExprDef.TVar(v2)}break;case 2:_g1=_g.g;d=e.e;break;case 3:var e1=_g.e;if(0==(_g1=(e2=this.evalExpr(e1,isVal)).e)._hx_index){var _g2=_g1.c;d=e2.e}else d=hxsl_TExprDef.TParenthesis(e2);break;case 4:var out=[],last=(el=_g.el).length-1;for(_g1=0,_g2=el.length;_g1<_g2;){var i=_g1++,isVal1=isVal&&i==last;switch((_g3=(e1=this.evalExpr(el[i],isVal1)).e)._hx_index){case 0:var _g4=_g3.c;isVal1&&out.push(e1);break;case 1:var _g5=_g3.v;isVal1&&out.push(e1);break;default:out.push(e1)}}d=1==out.length&&this.curFun.kind!=hxsl_FunctionKind.Init?out[0].e:hxsl_TExprDef.TBlock(out);break;case 5:var e2=_g.e2,op=(e1=_g.e1,_g.op),e11=this.evalExpr(e1),e21=this.evalExpr(e2);switch(op._hx_index){case 0:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 2:if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){var a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a+b|0))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:if(0==_g1._hx_index)if(3==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CFloat(a+b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 1:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 2:if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a*b|0))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:if(0==_g1._hx_index)if(3==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CFloat(a*b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 2:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 2:if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a/b|0))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:if(0==_g1._hx_index)if(3==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CFloat(a/b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 2:if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a-b|0))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:if(0==_g1._hx_index)if(3==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CFloat(a-b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 4:case 21:d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 5:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 0:d=0==_g1._hx_index?0==_g1.c._hx_index?hxsl_TExprDef.TConst(hxsl_Const.CBool(!0)):hxsl_TExprDef.TConst(hxsl_Const.CBool(!1)):hxsl_TExprDef.TBinop(op,e11,e21);break;case 1:_g2=_g3.b;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 1:a=_g2,b=_g4.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(0==(a==b?0:1)));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 2:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 2:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a-b==0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 3:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(0==(a>b?1:a==b?0:-1)));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 4:_g2=_g3.v;if(0==_g1._hx_index)switch((_g3=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 4:a=_g2,b=_g3.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(0==(a>b?1:a==b?0:-1)));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 6:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 0:d=0==_g1._hx_index?0==_g1.c._hx_index?hxsl_TExprDef.TConst(hxsl_Const.CBool(!1)):hxsl_TExprDef.TConst(hxsl_Const.CBool(!0)):hxsl_TExprDef.TBinop(op,e11,e21);break;case 1:_g2=_g3.b;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 1:a=_g2,b=_g4.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(0!=(a==b?0:1)));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 2:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 2:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a-b!=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 3:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(0!=(a>b?1:a==b?0:-1)));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 4:_g2=_g3.v;if(0==_g1._hx_index)switch((_g3=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 4:a=_g2,b=_g3.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(0!=(a>b?1:a==b?0:-1)));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 7:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 0:d=0==_g1._hx_index?(_g1.c._hx_index,hxsl_TExprDef.TConst(hxsl_Const.CBool(!1))):hxsl_TExprDef.TBinop(op,e11,e21);break;case 1:_g2=_g3.b;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 1:a=_g2,b=_g4.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a==b?0:1)>0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 2:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 2:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a-b>0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 3:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)>0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 4:_g2=_g3.v;if(0==_g1._hx_index)switch((_g3=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 4:a=_g2,b=_g3.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)>0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 8:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 0:d=0==_g1._hx_index?0==_g1.c._hx_index?hxsl_TExprDef.TConst(hxsl_Const.CBool(!0)):hxsl_TExprDef.TConst(hxsl_Const.CBool(!1)):hxsl_TExprDef.TBinop(op,e11,e21);break;case 1:_g2=_g3.b;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 1:a=_g2,b=_g4.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a==b?0:1)>=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 2:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 2:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a-b>=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 3:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)>=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 4:_g2=_g3.v;if(0==_g1._hx_index)switch((_g3=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!0));break;case 4:a=_g2,b=_g3.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)>=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 9:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 0:d=0==_g1._hx_index?0==_g1.c._hx_index?hxsl_TExprDef.TConst(hxsl_Const.CBool(!1)):hxsl_TExprDef.TConst(hxsl_Const.CBool(!0)):hxsl_TExprDef.TBinop(op,e11,e21);break;case 1:_g2=_g3.b;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 1:a=_g2,b=_g4.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a==b?0:1)<0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 2:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 2:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a-b<0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 3:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)<0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 4:_g2=_g3.v;if(0==_g1._hx_index)switch((_g3=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 4:a=_g2,b=_g3.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)<0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 10:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 0:d=0==_g1._hx_index?(_g1.c._hx_index,hxsl_TExprDef.TConst(hxsl_Const.CBool(!0))):hxsl_TExprDef.TBinop(op,e11,e21);break;case 1:_g2=_g3.b;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 1:a=_g2,b=_g4.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a==b?0:1)<=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 2:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 2:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a-b<=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:_g2=_g3.v;if(0==_g1._hx_index)switch((_g4=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 3:a=_g2,b=_g4.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)<=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 4:_g2=_g3.v;if(0==_g1._hx_index)switch((_g3=_g1.c)._hx_index){case 0:d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!1));break;case 4:a=_g2,b=_g3.v;d=hxsl_TExprDef.TConst(hxsl_Const.CBool((a>b?1:a==b?0:-1)<=0));break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 11:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(2==(_g3=_g2.c)._hx_index)if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a&b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 12:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(2==(_g3=_g2.c)._hx_index)if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a|b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 13:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(2==(_g3=_g2.c)._hx_index)if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a^b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 14:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(1==(_g3=_g2.c)._hx_index){_g2=_g3.b;if(0==_g1._hx_index)if(1==(_g3=_g1.c)._hx_index){var a=_g2;b=_g3.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a&&b))}else{d=0==(a=_g2)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e21.e}else d=0==(a=_g2)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e21.e}else if(0==_g1._hx_index){if(1==(_g2=_g1.c)._hx_index)d=0==(a=_g2.b)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e11.e;else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);else if(0==_g1._hx_index){if(1==(_g2=_g1.c)._hx_index)d=0==(a=_g2.b)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e11.e;else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 15:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(1==(_g3=_g2.c)._hx_index){_g2=_g3.b;if(0==_g1._hx_index)if(1==(_g3=_g1.c)._hx_index){a=_g2,b=_g3.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(a||b))}else{d=1==(a=_g2)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e21.e}else d=1==(a=_g2)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e21.e}else if(0==_g1._hx_index){if(1==(_g2=_g1.c)._hx_index)d=1==(a=_g2.b)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e11.e;else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);else if(0==_g1._hx_index){if(1==(_g2=_g1.c)._hx_index)d=1==(a=_g2.b)?hxsl_TExprDef.TConst(hxsl_Const.CBool(a)):e11.e;else d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 16:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(2==(_g3=_g2.c)._hx_index)if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a<<b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 17:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(2==(_g3=_g2.c)._hx_index)if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a>>b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 18:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)if(2==(_g3=_g2.c)._hx_index)if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a>>>b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 19:_g1=e21.e;if(0==(_g2=e11.e)._hx_index)switch((_g3=_g2.c)._hx_index){case 2:if(0==_g1._hx_index)if(2==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(a%b|0))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 3:if(0==_g1._hx_index)if(3==(_g2=_g1.c)._hx_index){a=_g3.v,b=_g2.v;d=hxsl_TExprDef.TConst(hxsl_Const.CFloat(a%b))}else d=hxsl_TExprDef.TBinop(op,e11,e21);else d=hxsl_TExprDef.TBinop(op,e11,e21);break;default:d=hxsl_TExprDef.TBinop(op,e11,e21)}else d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 20:_g1=op.op;d=hxsl_TExprDef.TBinop(op,e11,e21);break;case 22:case 23:throw haxe_Exception.thrown("assert")}break;case 6:e1=_g.e1,op=_g.op;if(0==(_g1=(e2=this.evalExpr(e1)).e)._hx_index){var c=_g1.c;switch(op._hx_index){case 2:if(1==c._hx_index){b=c.b;d=hxsl_TExprDef.TConst(hxsl_Const.CBool(!b))}else d=hxsl_TExprDef.TUnop(op,e2);break;case 3:switch(c._hx_index){case 2:i=c.v;d=hxsl_TExprDef.TConst(hxsl_Const.CInt(-i));break;case 3:var f=c.v;d=hxsl_TExprDef.TConst(hxsl_Const.CFloat(-f));break;default:d=hxsl_TExprDef.TUnop(op,e2)}break;default:d=hxsl_TExprDef.TUnop(op,e2)}}else d=hxsl_TExprDef.TUnop(op,e2);break;case 7:var init=_g.init;v=_g.v;d=hxsl_TExprDef.TVarDecl(this.mapVar(v),null==init?null:this.evalExpr(init));break;case 8:var eargs=_g.args,c1=(c=_g.e,this.evalExpr(c));for(_g1=[],_g2=0;_g2<eargs.length;){a=eargs[_g2];++_g2,_g1.push(this.evalExpr(a))}var args=_g1;switch((_g1=c1.e)._hx_index){case 1:if(this.inlineCalls){v=_g1.v;if(null!=this.funMap.h.__keys__[v.__id__]){for(var outExprs=[],undo=[],_g3=(_g2=0,(f=this.funMap.h[v.__id__]).args.length);_g2<_g3;){i=_g2++,v=[f.args[i]];switch((_g4=(e1=args[i]).e)._hx_index){case 0:_g5=_g4.c;var old=[this.constants.h[v[0].id]];undo.push(function(old,v){return function(){null==old[0]?_gthis.constants.remove(v[0].id):_gthis.constants.h[v[0].id]=old[0]}}(old,v)),this.constants.h[v[0].id]=e1.e;break;case 1:var _g6=_g4.v;_g6.type,_g6.qualifiers,_g6.parent,_g6.name,_g6.id;switch(_g6.kind._hx_index){case 0:case 1:case 2:var old1=[this.constants.h[v[0].id]];undo.push(function(old,v){return function(){null==old[0]?_gthis.constants.remove(v[0].id):_gthis.constants.h[v[0].id]=old[0]}}(old1,v)),this.constants.h[v[0].id]=e1.e;break;default:var old2=[this.varMap.h[v[0].__id__]];null==old2[0]?undo.push(function(v){return function(){_gthis.varMap.remove(v[0])}}(v)):(this.varMap.remove(v[0]),undo.push(function(old,v){return function(){_gthis.varMap.set(v[0],old[0])}}(old2,v)));v2=this.mapVar(v[0]);outExprs.push({e:hxsl_TExprDef.TVarDecl(v2,e1),t:hxsl_Type.TVoid,p:e1.p})}break;default:var old3=[this.varMap.h[v[0].__id__]];null==old3[0]?undo.push(function(v){return function(){_gthis.varMap.remove(v[0])}}(v)):(this.varMap.remove(v[0]),undo.push(function(old,v){return function(){_gthis.varMap.set(v[0],old[0])}}(old3,v)));var v21=this.mapVar(v[0]);outExprs.push({e:hxsl_TExprDef.TVarDecl(v21,e1),t:hxsl_Type.TVoid,p:e1.p})}}for(e1=this.handleReturn(this.evalExpr(f.expr,!1),!0),_g2=0;_g2<undo.length;){var u=undo[_g2];++_g2,u()}if(4==(_g2=e1.e)._hx_index){var el=_g2.el;for(_g2=0;_g2<el.length;){e2=el[_g2];++_g2,outExprs.push(e2)}}else outExprs.push(e1);d=hxsl_TExprDef.TBlock(outExprs)}else d=hxsl_Error.t("Cannot eval non-static call expresssion '"+(new hxsl_Printer).exprString(c1)+"'",c1.p)}else d=hxsl_TExprDef.TCall(c1,args);break;case 2:var g=_g1.g;d=null!=(v1=this.evalCall(g,args,eargs,e.p))?v1:hxsl_TExprDef.TCall(c1,args);break;default:d=hxsl_Error.t("Cannot eval non-static call expresssion '"+(new hxsl_Printer).exprString(c1)+"'",c1.p)}break;case 9:var r=_g.regs;e1=_g.e;d=hxsl_TExprDef.TSwiz(this.evalExpr(e1),r.slice());break;case 10:var eelse=_g.eelse,eif=_g.eif,econd=_g.econd,econd1=this.evalExpr(econd);if(0==(_g1=econd1.e)._hx_index)if(1==(_g2=_g1.c)._hx_index)d=(b=_g2.b)?this.evalExpr(eif,isVal).e:null==eelse?hxsl_TExprDef.TConst(hxsl_Const.CNull):this.evalExpr(eelse,isVal).e;else if(isVal&&null!=eelse&&this.eliminateConditionals)d=hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Mix),t:e.t,p:e.p},[this.evalExpr(eelse,!0),this.evalExpr(eif,!0),{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.ToFloat),t:hxsl_Type.TFun([]),p:econd1.p},[econd1]),t:hxsl_Type.TFloat,p:e.p}]);else{if(eif=this.evalExpr(eif,isVal),null!=eelse)0==(_g1=(eelse=this.evalExpr(eelse,isVal)).e)._hx_index&&0==_g1.c._hx_index&&(eelse=null);eif=this.ifBlock(eif),eelse=this.ifBlock(eelse),d=hxsl_TExprDef.TIf(econd1,eif,eelse)}else if(isVal&&null!=eelse&&this.eliminateConditionals)d=hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Mix),t:e.t,p:e.p},[this.evalExpr(eelse,!0),this.evalExpr(eif,!0),{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.ToFloat),t:hxsl_Type.TFun([]),p:econd1.p},[econd1]),t:hxsl_Type.TFloat,p:e.p}]);else{if(eif=this.evalExpr(eif,isVal),null!=eelse)0==(_g1=(eelse=this.evalExpr(eelse,isVal)).e)._hx_index&&0==_g1.c._hx_index&&(eelse=null);eif=this.ifBlock(eif),eelse=this.ifBlock(eelse),d=hxsl_TExprDef.TIf(econd1,eif,eelse)}break;case 11:d=hxsl_TExprDef.TDiscard;break;case 12:e1=_g.e;d=hxsl_TExprDef.TReturn(null==e1?null:this.evalExpr(e1));break;case 13:var loop=_g.loop,it=_g.it,v1=_g.v,it1=(v2=this.mapVar(v1),this.evalExpr(it));if(5==(_g1=it1.e)._hx_index){_g2=_g1.e2,_g3=_g1.e1;if(21==_g1.op._hx_index){_g1=_g3.t,_g1=_g3.p;if(0==(_g1=_g3.e)._hx_index)if(2==(_g3=_g1.c)._hx_index){_g1=_g2.t,_g1=_g2.p;if(0==(_g1=_g2.e)._hx_index)if(2==(_g2=_g1.c)._hx_index){var start=_g3.v,len=_g2.v;if(this.unrollLoops){for(out=[],_g1=start,_g2=len;_g1<_g2;){i=_g1++;this.constants.h[v1.id]=hxsl_TExprDef.TConst(hxsl_Const.CInt(i)),out.push(this.evalExpr(loop,!1))}this.constants.remove(v1.id),e1=hxsl_TExprDef.TBlock(out)}else e1=hxsl_TExprDef.TFor(v2,it1,this.ifBlock(this.evalExpr(loop,!1)))}else e1=hxsl_TExprDef.TFor(v2,it1,this.ifBlock(this.evalExpr(loop,!1)));else e1=hxsl_TExprDef.TFor(v2,it1,this.ifBlock(this.evalExpr(loop,!1)))}else e1=hxsl_TExprDef.TFor(v2,it1,this.ifBlock(this.evalExpr(loop,!1)));else e1=hxsl_TExprDef.TFor(v2,it1,this.ifBlock(this.evalExpr(loop,!1)))}else e1=hxsl_TExprDef.TFor(v2,it1,this.ifBlock(this.evalExpr(loop,!1)))}else e1=hxsl_TExprDef.TFor(v2,it1,this.ifBlock(this.evalExpr(loop,!1)));this.varMap.remove(v1),d=e1;break;case 14:d=hxsl_TExprDef.TContinue;break;case 15:d=hxsl_TExprDef.TBreak;break;case 16:e2=_g.index,e1=_g.e,e11=this.evalExpr(e1),_g1=(e21=this.evalExpr(e2)).e;if(17==(_g2=e11.e)._hx_index)if(0==_g1._hx_index)if(2==(_g3=_g1.c)._hx_index){el=_g2.el;d=(i=_g3.v)>=0&&i<el.length?el[i].e:hxsl_TExprDef.TArray(e11,e21)}else d=hxsl_TExprDef.TArray(e11,e21);else d=hxsl_TExprDef.TArray(e11,e21);else d=hxsl_TExprDef.TArray(e11,e21);break;case 17:for(el=_g.el,_g1=[],_g2=0;_g2<el.length;){e1=el[_g2];++_g2,_g1.push(this.evalExpr(e1))}d=hxsl_TExprDef.TArrayDecl(_g1);break;case 18:var def=_g.def,cases=_g.cases;for(e1=_g.e,e2=this.evalExpr(e1),_g1=[],_g2=0;_g2<cases.length;){c=cases[_g2];++_g2;for(_g3=[],_g4=0,_g5=c.values;_g4<_g5.length;){v1=_g5[_g4];++_g4,_g3.push(this.evalExpr(v1))}_g1.push({values:_g3,expr:this.evalExpr(c.expr,isVal)})}cases=_g1;var def1=null==def?null:this.evalExpr(def,isVal),hasCase=!1;if(0==(_g1=e2.e)._hx_index){if(2!=(c=_g1.c)._hx_index)throw haxe_Exception.thrown("Unsupported switch constant "+Std.string(c));var val=c.v;for(_g1=0;_g1<cases.length;){c1=cases[_g1];++_g1;for(_g2=0,_g3=c1.values;_g2<_g3.length;){v1=_g3[_g2];if(++_g2,0==(_g4=v1.e)._hx_index){var cst=_g4.c;switch(cst._hx_index){case 2:if(cst.v==val)return c1.expr;break;case 3:if(cst.v==val)return c1.expr}}else hasCase=!0}}}else hasCase=!0;d=hasCase?hxsl_TExprDef.TSwitch(e2,cases,def1):null==def1?hxsl_TExprDef.TBlock([]):def1.e;break;case 19:var normalWhile=_g.normalWhile,cond=(loop=_g.loop,_g.e),cond1=this.evalExpr(cond),loop1=this.evalExpr(loop,!1);d=hxsl_TExprDef.TWhile(cond1,this.ifBlock(loop1),normalWhile);break;case 20:e1=_g.e,args=_g.args;var name=_g.m;if("unroll"==name){this.unrollLoops;this.unrollLoops=!0,e2=this.evalExpr(e1,isVal),this.unrollLoops=!1}else e2=this.evalExpr(e1,isVal);d=hxsl_TExprDef.TMeta(name,args,e2)}return{e:d,t:e.t,p:e.p}},__class__:hxsl_Eval};var hxsl__$Flatten_Alloc=function(g,t,pos,size){this.g=g,this.t=t,this.pos=pos,this.size=size};$hxClasses["hxsl._Flatten.Alloc"]=hxsl__$Flatten_Alloc,hxsl__$Flatten_Alloc.__name__="hxsl._Flatten.Alloc",hxsl__$Flatten_Alloc.prototype={__class__:hxsl__$Flatten_Alloc};var hxsl_ARead=$hxEnums["hxsl.ARead"]={__ename__:"hxsl.ARead",__constructs__:["AIndex","AOffset"],AIndex:($_=function(a){return{_hx_index:0,a:a,__enum__:"hxsl.ARead",toString:$estr}},$_.__params__=["a"],$_),AOffset:($_=function(a,stride,delta){return{_hx_index:1,a:a,stride:stride,delta:delta,__enum__:"hxsl.ARead",toString:$estr}},$_.__params__=["a","stride","delta"],$_)};hxsl_ARead.__empty_constructs__=[];var hxsl_Flatten=function(){};$hxClasses["hxsl.Flatten"]=hxsl_Flatten,hxsl_Flatten.__name__="hxsl.Flatten",hxsl_Flatten.prototype={flatten:function(s,kind,constsToGlobal){if(this.globals=[],this.params=[],this.outVars=[],constsToGlobal){this.consts=[];var p=s.funs[0].expr.p,gc={id:hxsl_Tools.allocVarId(),name:"__consts__",kind:hxsl_VarKind.Global,type:null};this.econsts={e:hxsl_TExprDef.TVar(gc),t:null,p:p};for(var s1=s.name,s2=s.vars.slice(),_g=[],_g1=0,_g2=s.funs;_g1<_g2.length;){var f=_g2[_g1];++_g1,_g.push(this.mapFun(f,$bind(this,this.mapConsts)))}s={name:s1,vars:s2,funs:_g};for(_g=0,_g1=s.vars;_g<_g1.length;){var v=_g1[_g];if(++_g,9==(_g2=v.type)._hx_index){_g2.size;this.allocConst(255,p)}}this.consts.length>0&&(gc.type=this.econsts.t=hxsl_Type.TArray(hxsl_Type.TFloat,hxsl_SizeDecl.SConst(this.consts.length)),s.vars.push(gc))}this.varMap=new haxe_ds_ObjectMap,this.allocData=new haxe_ds_ObjectMap;var prefix;for(_g=0,_g1=s.vars;_g<_g1.length;){v=_g1[_g];++_g,this.gatherVar(v)}switch(kind._hx_index){case 0:prefix="vertex";break;case 1:prefix="fragment";break;default:throw haxe_Exception.thrown("assert")}this.pack(prefix+"Globals",hxsl_VarKind.Global,this.globals,hxsl_VecType.VFloat),this.pack(prefix+"Params",hxsl_VarKind.Param,this.params,hxsl_VecType.VFloat);var allVars=this.globals.concat(this.params),textures=this.packTextures(prefix+"Textures",allVars,hxsl_Type.TSampler2D).concat(this.packTextures(prefix+"TexturesCube",allVars,hxsl_Type.TSamplerCube)).concat(this.packTextures(prefix+"TexturesArray",allVars,hxsl_Type.TSampler2DArray));this.packBuffers(allVars);for(_g=[],_g1=0,_g2=s.funs;_g1<_g2.length;){f=_g2[_g1];++_g1,_g.push(this.mapFun(f,$bind(this,this.mapExpr)))}var funs=_g;for(_g=0;_g<textures.length;){var t=textures[_g];++_g,t.pos>>=2}return{name:s.name,vars:this.outVars,funs:funs}},mapFun:function(f,mapExpr){return{kind:f.kind,ret:f.ret,args:f.args,ref:f.ref,expr:mapExpr(f.expr)}},mapExpr:function(e){switch((_g=e.e)._hx_index){case 1:var v=_g.v;null!=(a=this.varMap.h[v.__id__])&&(e=this.access(a,v.type,e.p,hxsl_ARead.AIndex(a)));break;case 16:var _g2=(_g1=_g.e).t;if(1==(_g2=_g1.e)._hx_index){var e1,a,eindex=_g.index,vp=_g1.p;v=_g2.v;if(0==(_g=eindex.e)._hx_index)if(2==(_g1=_g.c)._hx_index){var _g=_g1.v;e1=!0}else e1=!1;else e1=!1;if(e1)e=hxsl_Tools.map(e,$bind(this,this.mapExpr));else if(null!=(a=this.varMap.h[v.__id__])){if(15!=(_g=v.type)._hx_index)throw haxe_Exception.thrown("assert");var _g1=_g.size,t=_g.t,stride=this.varSize(t,a.t);if(0==stride||0!=(3&stride))throw haxe_Exception.thrown(new hxsl_Error("Dynamic access to an Array which size is not 4 components-aligned is not allowed",e.p));stride>>=2,eindex=this.mapExpr(eindex);var toInt={e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.ToInt),t:hxsl_Type.TFun([]),p:vp},[eindex]),t:hxsl_Type.TInt,p:vp};e=this.access(a,t,vp,hxsl_ARead.AOffset(a,stride,1==stride?toInt:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpMult,toInt,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(stride)),t:hxsl_Type.TInt,p:vp}),t:hxsl_Type.TInt,p:vp}))}}else e=hxsl_Tools.map(e,$bind(this,this.mapExpr));break;default:e=hxsl_Tools.map(e,$bind(this,this.mapExpr))}return this.optimize(e)},mapConsts:function(e){switch((_g=e.e)._hx_index){case 0:var c=_g.c;switch(c._hx_index){case 2:var v=c.v;return this.allocConst(v,e.p);case 3:v=c.v;return this.allocConst(v,e.p);default:return e}break;case 2:switch(_g.g._hx_index){case 0:this.allocConst(Math.PI/180,e.p);break;case 1:this.allocConst(180/Math.PI,e.p);break;case 9:this.allocConst(1.4426950408889634,e.p);break;case 10:this.allocConst(.6931471805599453,e.p);break;case 24:this.allocConst(1,e.p);break;case 26:this.allocConst(2,e.p),this.allocConst(3,e.p);break;case 54:this.allocConsts([1,255,65025,16581375],e.p),this.allocConsts([.00392156862745098,.00392156862745098,.00392156862745098,0],e.p);break;case 55:this.allocConsts([1,.00392156862745098,15378700499807768e-21,6.030862941101084e-8],e.p);break;case 56:this.allocConst(1,e.p),this.allocConst(.5,e.p);break;case 57:this.allocConst(.5,e.p);break;case 58:this.allocConsts([.5,.5],e.p),this.allocConsts([.5,-.5],e.p);break;case 59:this.allocConsts([2,-2],e.p),this.allocConsts([-1,1],e.p)}break;case 5:var _g1=_g.e2,_g2=_g.e1;if(1==_g.op._hx_index){_g2=_g1.p,_g2=_g1.e;8==_g1.t._hx_index&&this.allocConst(1,e.p)}break;case 8:_g1=_g.args;var _g3=(_g2=_g.e).t;_g3=_g2.p;if(2==(_g3=_g2.e)._hx_index&&42==_g3.g._hx_index&&2==_g1.length){_g2=_g1[1],_g1=(_g3=_g1[0]).t;var _g4=_g3.p;if(1==(_g4=_g3.e)._hx_index){_g4=(_g3=_g4.v).type,_g4=_g3.qualifiers,_g4=_g3.parent,_g4=_g3.name,_g4=_g3.id;switch(_g3.kind._hx_index){case 0:if(5==_g1._hx_index&&3==_g1.size&&1==_g1.t._hx_index){_g3=_g2.t,_g3=_g2.p;if(0==(_g3=_g2.e)._hx_index)if(2==(_g4=_g3.c)._hx_index&&1==_g4.v)return e}break;case 1:if(5==_g1._hx_index&&3==_g1.size&&1==_g1.t._hx_index){_g3=_g2.t,_g3=_g2.p;if(0==(_g3=_g2.e)._hx_index)if(2==(_g4=_g3.c)._hx_index&&1==_g4.v)return e}break;case 2:if(5==_g1._hx_index&&3==_g1.size&&1==_g1.t._hx_index){_g3=_g2.t,_g3=_g2.p;if(0==(_g3=_g2.e)._hx_index)if(2==(_g4=_g3.c)._hx_index&&1==_g4.v)return e}break;case 3:if(5==_g1._hx_index&&3==_g1.size&&1==_g1.t._hx_index){_g1=_g2.t,_g1=_g2.p;if(0==(_g1=_g2.e)._hx_index)if(2==(_g2=_g1.c)._hx_index&&1==_g2.v)return e}}}}break;case 16:_g1=_g.index,_g2=_g.e;var _g=_g1.t;_g=_g1.p;if(0==(_g=_g1.e)._hx_index){if(2==(_g3=_g.c)._hx_index){_g=_g3.v;var ea=_g2,eindex=_g1;return{e:hxsl_TExprDef.TArray(this.mapConsts(ea),eindex),t:e.t,p:e.p}}eindex=_g1;if(15==(_g=(ea=_g2).t)._hx_index){_g3=_g.size;var t=_g.t,stride=this.varSize(t,hxsl_VecType.VFloat)>>2;this.allocConst(stride,e.p)}}else{eindex=_g1;if(15==(_g=(ea=_g2).t)._hx_index){_g1=_g.size,t=_g.t,stride=this.varSize(t,hxsl_VecType.VFloat)>>2;this.allocConst(stride,e.p)}}}return hxsl_Tools.map(e,$bind(this,this.mapConsts))},allocConst:function(v,p){var index=this.consts.indexOf(v);return index<0&&(index=this.consts.length,this.consts.push(v)),{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p}},allocConsts:function(va,p){for(var pad=va.length-1&3,index=-1,_g=0,_g1=this.consts.length-(va.length-1);_g<_g1;){var i=_g++;if(i>>2==i+pad>>2){for(var found=!0,_g2=0,_g3=va.length;_g2<_g3;){var j=_g2++;if(this.consts[i+j]!=va[j]){found=!1;break}}if(found){index=i;break}}}if(index<0){for(;this.consts.length>>2!=this.consts.length+pad>>2;)this.consts.push(0);index=this.consts.length;for(_g=0;_g<va.length;){var v=va[_g];++_g,this.consts.push(v)}}switch(va.length){case 1:return{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p};case 2:return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Vec2),t:hxsl_Type.TVoid,p:p},[{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p},{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index+1)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p}]),t:hxsl_Type.TVec(2,hxsl_VecType.VFloat),p:p};case 3:return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Vec3),t:hxsl_Type.TVoid,p:p},[{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p},{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index+1)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p},{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index+2)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p}]),t:hxsl_Type.TVec(3,hxsl_VecType.VFloat),p:p};case 4:return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Vec4),t:hxsl_Type.TVoid,p:p},[{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p},{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index+1)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p},{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index+3)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p},{e:hxsl_TExprDef.TArray(this.econsts,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index+4)),t:hxsl_Type.TInt,p:p}),t:hxsl_Type.TFloat,p:p}]),t:hxsl_Type.TVec(4,hxsl_VecType.VFloat),p:p};default:throw haxe_Exception.thrown("assert")}},access:function(a,t,pos,acc){switch(t._hx_index){case 6:var tmp=this.access(a,hxsl_Type.TMat3x4,pos,acc);return{e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Mat3),t:hxsl_Type.TFun([]),p:pos},[tmp]),t:hxsl_Type.TMat3,p:pos};case 7:tmp=hxsl_TExprDef.TGlobal(hxsl_TGlobal.Mat4);var tmp5,tmp1=hxsl_Type.TFun([]);switch(acc._hx_index){case 0:var a1=acc.a;tmp2={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(a1.pos>>2)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:var delta=acc.delta,stride=acc.stride,offset=0==(index=(a1=acc.a).pos>>2)?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};tmp2={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}switch(acc._hx_index){case 0:a1=acc.a;tmp3={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(1+(a1.pos>>2))),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=1+((a1=acc.a).pos>>2))?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};tmp3={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}switch(acc._hx_index){case 0:a1=acc.a;tmp4={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(2+(a1.pos>>2))),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=2+((a1=acc.a).pos>>2))?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};tmp4={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}switch(acc._hx_index){case 0:a1=acc.a;tmp5={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(3+(a1.pos>>2))),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=3+((a1=acc.a).pos>>2))?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};tmp5={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}return{e:hxsl_TExprDef.TCall({e:tmp,t:tmp1,p:pos},[tmp2,tmp3,tmp4,tmp5]),t:hxsl_Type.TMat4,p:pos};case 8:var tmp2,tmp3,tmp4;tmp=hxsl_TExprDef.TGlobal(hxsl_TGlobal.Mat3x4),tmp1=hxsl_Type.TFun([]);switch(acc._hx_index){case 0:a1=acc.a;tmp2={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(a1.pos>>2)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=(a1=acc.a).pos>>2)?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};tmp2={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}switch(acc._hx_index){case 0:a1=acc.a;tmp3={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(1+(a1.pos>>2))),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=1+((a1=acc.a).pos>>2))?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};tmp3={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}switch(acc._hx_index){case 0:a1=acc.a;tmp4={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(2+(a1.pos>>2))),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=2+((a1=acc.a).pos>>2))?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};tmp4={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}return{e:hxsl_TExprDef.TCall({e:tmp,t:tmp1,p:pos},[tmp2,tmp3,tmp4]),t:hxsl_Type.TMat3x4,p:pos};case 15:if(0==(_g=t.size)._hx_index){for(var t1=t.t,len=_g.v,_g=(stride=a.size/len|0,[]),_g1=0,_g2=len;_g1<_g2;){var i=_g1++;a1=new hxsl__$Flatten_Alloc(a.g,a.t,a.pos+stride*i,stride);_g.push(this.access(a1,t1,pos,hxsl_ARead.AIndex(a1)))}var earr=_g;return{e:hxsl_TExprDef.TArrayDecl(earr),t:t1,p:pos}}if(hxsl_Tools.isSampler(t)){switch(acc._hx_index){case 0:a1=acc.a;e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(a1.pos>>2)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=(a1=acc.a).pos>>2)?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}return e.t=t,e}if((size=this.varSize(t,a.t))>4)return hxsl_Error.t("Access not supported for "+hxsl_Tools.toString(t),null);switch(acc._hx_index){case 0:a1=acc.a;e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(a1.pos>>2)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=(a1=acc.a).pos>>2)?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}if(4==size){if(0!=(3&a.pos))throw haxe_Exception.thrown("assert")}else{var sw=[];for(_g=0,_g1=size;_g<_g1;){i=_g++;sw.push(hxsl_Tools.SWIZ[i+(3&a.pos)])}e={e:hxsl_TExprDef.TSwiz(e,sw),t:t,p:pos}}switch(t._hx_index){case 1:e.t=hxsl_Type.TFloat,e={e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.ToInt),t:hxsl_Type.TFun([]),p:pos},[e]),t:t,p:pos};break;case 5:if(0==t.t._hx_index){var size=t.size;e.t=hxsl_Type.TVec(size,hxsl_VecType.VFloat),e={e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal([hxsl_TGlobal.IVec2,hxsl_TGlobal.IVec3,hxsl_TGlobal.IVec4][size-2]),t:hxsl_Type.TFun([]),p:pos},[e]),t:t,p:pos}}}return e;default:if(hxsl_Tools.isSampler(t)){switch(acc._hx_index){case 0:a1=acc.a;e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(a1.pos>>2)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:delta=acc.delta,stride=acc.stride,offset=0==(index=(a1=acc.a).pos>>2)?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}return e.t=t,e}var e;if((size=this.varSize(t,a.t))>4)return hxsl_Error.t("Access not supported for "+hxsl_Tools.toString(t),null);switch(acc._hx_index){case 0:a1=acc.a;e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(a1.pos>>2)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TVec(4,a1.t),p:pos};break;case 1:var index;delta=acc.delta,stride=acc.stride,offset=0==(index=(a1=acc.a).pos>>2)?delta:{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAdd,delta,{e:hxsl_TExprDef.TConst(hxsl_Const.CInt(index)),t:hxsl_Type.TInt,p:pos}),t:hxsl_Type.TInt,p:pos};e={e:hxsl_TExprDef.TArray({e:hxsl_TExprDef.TVar(a1.g),t:a1.g.type,p:pos},offset),t:hxsl_Type.TVec(4,a1.t),p:pos}}if(4==size){if(0!=(3&a.pos))throw haxe_Exception.thrown("assert")}else{for(sw=[],_g=0,_g1=size;_g<_g1;){i=_g++;sw.push(hxsl_Tools.SWIZ[i+(3&a.pos)])}e={e:hxsl_TExprDef.TSwiz(e,sw),t:t,p:pos}}switch(t._hx_index){case 1:e.t=hxsl_Type.TFloat,e={e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.ToInt),t:hxsl_Type.TFun([]),p:pos},[e]),t:t,p:pos};break;case 5:if(0==t.t._hx_index){size=t.size;e.t=hxsl_Type.TVec(size,hxsl_VecType.VFloat),e={e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal([hxsl_TGlobal.IVec2,hxsl_TGlobal.IVec3,hxsl_TGlobal.IVec4][size-2]),t:hxsl_Type.TFun([]),p:pos},[e]),t:t,p:pos}}}return e}},optimize:function(e){switch((_g=e.e)._hx_index){case 8:var _g1=_g.args,_g3=(_g2=_g.e).t;_g3=_g2.p;if(2==(_g3=_g2.e)._hx_index&&52==_g3.g._hx_index&&1==_g1.length){_g1=(_g2=_g1[0]).t,_g1=_g2.p;if(8==(_g1=_g2.e)._hx_index){_g3=(_g2=_g1.e).t,_g3=_g2.p;if(2==(_g3=_g2.e)._hx_index&&51==_g3.g._hx_index){for(var args=_g1.args,rem=0,size=0;size<4;){var t=args[args.length-1-rem].t;size+=this.varSize(t,hxsl_VecType.VFloat),++rem}if(4==size){_g1=0;for(var emat,_g2=rem;_g1<_g2;){var i=_g1++;args.pop()}if(8!=(_g1=e.e)._hx_index)throw haxe_Exception.thrown("assert");_g2=_g1.args;return emat=_g1.e,{e:hxsl_TExprDef.TCall(emat,args),t:e.t,p:e.p}}}}}break;case 16:_g1=_g.index;var _g=(_g2=_g.e).t;_g=_g2.p;if(17==(_g=_g2.e)._hx_index){_g2=_g1.t,_g2=_g1.p;if(0==(_g2=_g1.e)._hx_index)if(2==(_g1=_g2.c)._hx_index){var el=_g.el;if((i=_g1.v)>=0&&i<el.length)return el[i];hxsl_Error.t("Reading outside array bounds",e.p)}}}return e},packTextures:function(name,vars,t){for(var alloc=[],g={id:hxsl_Tools.allocVarId(),name:name,type:t,kind:hxsl_VarKind.Param},_g=0;_g<vars.length;){var v=vars[_g];if(++_g,v.type!=t){var tmp;if(t==hxsl_Type.TSampler2D){var _g1=v.type;if(17==_g1._hx_index){_g1.size;tmp=!0}else tmp=!1}else tmp=!1;if(!tmp)continue}var a=new hxsl__$Flatten_Alloc(g,null,alloc.length<<2,1);a.v=v,this.varMap.set(v,a),alloc.push(a)}return g.type=hxsl_Type.TArray(t,hxsl_SizeDecl.SConst(alloc.length)),alloc.length>0&&(this.outVars.push(g),this.allocData.set(g,alloc)),alloc},packBuffers:function(vars){for(var alloc=[],g={id:hxsl_Tools.allocVarId(),name:"buffers",type:hxsl_Type.TVoid,kind:hxsl_VarKind.Param},_g=0;_g<vars.length;){var v=vars[_g];++_g;var tmp,_g1=v.type;if(16==_g1._hx_index){_g1.size,_g1.t;tmp=!0}else tmp=!1;if(tmp){var a=new hxsl__$Flatten_Alloc(g,null,alloc.length,1);a.v=v,alloc.push(a),this.outVars.push(v)}}g.type=hxsl_Type.TArray(hxsl_Type.TBuffer(hxsl_Type.TVoid,hxsl_SizeDecl.SConst(0)),hxsl_SizeDecl.SConst(alloc.length)),this.allocData.set(g,alloc)},pack:function(name,kind,vars,t){for(var alloc=[],apos=0,g={id:hxsl_Tools.allocVarId(),name:name,type:hxsl_Type.TVec(0,t),kind:kind},_g=0;_g<vars.length;){var tmp,v=vars[_g];if(++_g,hxsl_Tools.isSampler(v.type))tmp=!0;else{var _g1=v.type;if(16==_g1._hx_index){_g1.size,_g1.t;tmp=!0}else tmp=!1}if(!tmp){for(var size=this.varSize(v.type,t),best=null,_g4=0;_g4<alloc.length;){var a=alloc[_g4];++_g4,null==a.v&&a.size>=size&&(null==best||best.size>a.size)&&(best=a)}if(null!=best){var free=best.size-size;if(free>0){var i=alloc.indexOf(best),a1=new hxsl__$Flatten_Alloc(g,t,best.pos+size,free);alloc.splice(i+1,0,a1),best.size=size}best.v=v,this.varMap.set(v,best)}else{var a2=new hxsl__$Flatten_Alloc(g,t,apos,size);apos+=size,a2.v=v,this.varMap.set(v,a2),alloc.push(a2);var pad=(4-size%4)%4;if(pad>0){var a3=new hxsl__$Flatten_Alloc(g,t,apos,pad);apos+=pad,alloc.push(a3)}}}}return g.type=hxsl_Type.TArray(hxsl_Type.TVec(4,t),hxsl_SizeDecl.SConst(apos>>2)),apos>0&&(this.outVars.push(g),this.allocData.set(g,alloc)),g},varSize:function(v,t){switch(v._hx_index){case 1:case 3:if(t==hxsl_VecType.VFloat)return 1;throw haxe_Exception.thrown(hxsl_Tools.toString(v)+" size unknown for type "+Std.string(t));case 5:var t2=v.t,n=v.size;if(t==t2)return n;throw haxe_Exception.thrown(hxsl_Tools.toString(v)+" size unknown for type "+Std.string(t));case 7:if(t==hxsl_VecType.VFloat)return 16;throw haxe_Exception.thrown(hxsl_Tools.toString(v)+" size unknown for type "+Std.string(t));case 6:case 8:if(t==hxsl_VecType.VFloat)return 12;throw haxe_Exception.thrown(hxsl_Tools.toString(v)+" size unknown for type "+Std.string(t));case 15:var _g=v.size;if(0==_g._hx_index){var at=v.t;n=_g.v;return this.varSize(at,t)*n}throw haxe_Exception.thrown(hxsl_Tools.toString(v)+" size unknown for type "+Std.string(t));default:throw haxe_Exception.thrown(hxsl_Tools.toString(v)+" size unknown for type "+Std.string(t))}},gatherVar:function(v){if(13==(_g=v.type)._hx_index)for(var vl=_g.vl,_g=0;_g<vl.length;){var v1=vl[_g];++_g,this.gatherVar(v1)}else switch(v.kind._hx_index){case 0:hxsl_Tools.hasQualifier(v,hxsl_VarQualifier.PerObject)?this.params.push(v):this.globals.push(v);break;case 2:this.params.push(v);break;default:this.outVars.push(v)}},__class__:hxsl_Flatten};var hxsl_Globals=function(){this.channels=[],this.map=new haxe_ds_IntMap};$hxClasses["hxsl.Globals"]=hxsl_Globals,hxsl_Globals.__name__="hxsl.Globals",hxsl_Globals.allocID=function(path){null==hxsl_Globals.MAP&&(hxsl_Globals.MAP=new haxe_ds_StringMap,hxsl_Globals.ALL=[]);var id=hxsl_Globals.MAP.h[path];return null==id&&(id=hxsl_Globals.ALL.length,hxsl_Globals.ALL.push(path),hxsl_Globals.MAP.h[path]=id),id},hxsl_Globals.prototype={set:function(path,v){var this1=this.map,key=hxsl_Globals.allocID(path);this1.h[key]=v},allocChannelID:function(t){for(var _g=0,_g1=this.maxChannels;_g<_g1;){var i=_g++;if(this.channels[i]==t)return i}if(this.maxChannels==1<<hxsl_Tools.MAX_CHANNELS_BITS)throw haxe_Exception.thrown("Too many unique channels");i=this.maxChannels++;return this.channels[i]=t,i},__class__:hxsl_Globals};var hxsl_GlslOut=function(){this.outIndex=0,this.uniformBuffer=0,this.exprIds=0,this.varNames=new haxe_ds_IntMap,this.allNames=new haxe_ds_StringMap};$hxClasses["hxsl.GlslOut"]=hxsl_GlslOut,hxsl_GlslOut.__name__="hxsl.GlslOut",hxsl_GlslOut.prototype={decl:function(s){for(var _g=0,_g1=this.decls;_g<_g1.length;){var d=_g1[_g];if(++_g,d==s)return}35==HxOverrides.cca(s,0)?this.decls.unshift(s):this.decls.push(s)},addType:function(t){switch(t._hx_index){case 0:this.buf.b+=Std.string("void");break;case 1:this.buf.b+=Std.string("int");break;case 2:this.buf.b+=Std.string("bool");break;case 3:this.buf.b+=Std.string("float");break;case 4:this.buf.b+=Std.string("string");break;case 5:var k=t.t,size=t.size;switch(k._hx_index){case 0:this.buf.b+=Std.string("i");break;case 1:break;case 2:this.buf.b+=Std.string("b")}this.buf.b+=Std.string("vec"),this.buf.b+=Std.string(size);break;case 6:this.buf.b+=Std.string("mat3");break;case 7:this.buf.b+=Std.string("mat4");break;case 8:this.decl(hxsl_GlslOut.MAT34),this.buf.b+=Std.string("_mat3x4");break;case 9:var n=t.size;this.buf.b+=Std.string("vec"),this.buf.b+=Std.string(n);break;case 10:this.buf.b+=Std.string("sampler2D");break;case 11:this.buf.b+=Std.string("sampler2DArray"),null!=this.glES&&this.decl("precision lowp sampler2DArray;");break;case 12:this.buf.b+=Std.string("samplerCube");break;case 13:var vl=t.vl;this.buf.b+=Std.string("struct { ");for(var _g=0;_g<vl.length;){var v=vl[_g];++_g,this.addVar(v),this.buf.b+=Std.string(";")}this.buf.b+=Std.string(" }");break;case 14:_g=t.variants;this.buf.b+=Std.string("function");break;case 15:size=t.size;var t1=t.t;switch(this.addType(t1),this.buf.b+=Std.string("["),size._hx_index){case 0:if(1==(_g=size.v))if(this.intelDriverFix)this.buf.b+=Std.string(2);else{v=_g;this.buf.b+=Std.string(v)}else{v=_g;this.buf.b+=Std.string(v)}break;case 1:v=size.v;var v1=this.varName(v);this.buf.b+=Std.string(v1)}this.buf.b+=Std.string("]");break;case 16:_g=t.size,_g=t.t;throw haxe_Exception.thrown("assert");case 17:n=t.size;this.buf.b+=Std.string("channel"+n)}},addVar:function(v){var _g=v.type;switch(_g._hx_index){case 15:var size=_g.size,t=_g.t,old=v.type;switch(v.type=t,this.addVar(v),v.type=old,this.buf.b+=Std.string("["),size._hx_index){case 0:var _g1=size.v;if(1==_g1)if(this.intelDriverFix)this.buf.b+=Std.string(2);else{var n=_g1;this.buf.b+=Std.string(n)}else{n=_g1;this.buf.b+=Std.string(n)}break;case 1:var v1=size.v,v2=this.varName(v1);this.buf.b+=Std.string(v2)}this.buf.b+=Std.string("]");break;case 16:size=_g.size,t=_g.t;this.buf.b+=Std.string("uniform_buffer"+this.uniformBuffer++),this.buf.b+=Std.string(" { "),v.type=hxsl_Type.TArray(t,size),this.addVar(v),v.type=hxsl_Type.TBuffer(t,size),this.buf.b+=Std.string("; }");break;default:this.addType(v.type),this.buf.b+=Std.string(" ");v1=this.varName(v);this.buf.b+=Std.string(v1)}},addValue:function(e,tabs){var _g=e.e;switch(_g._hx_index){case 4:var el=_g.el,name="val"+this.exprIds++,tmp=this.buf;this.buf=new StringBuf,this.addType(e.t),this.buf.b+=Std.string(" "),this.buf.b+=Std.string(name),this.buf.b+=Std.string("(void)");var el2=el.slice(),last=el2[el2.length-1];el2[el2.length-1]={e:hxsl_TExprDef.TReturn(last),t:e.t,p:last.p};var e2={t:hxsl_Type.TVoid,e:hxsl_TExprDef.TBlock(el2),p:e.p};this.addExpr(e2,""),this.exprValues.push(this.buf.b),this.buf=tmp,this.buf.b+=Std.string(name),this.buf.b+=Std.string("()");break;case 10:var eelse=_g.eelse,eif=_g.eif,econd=_g.econd;this.buf.b+=Std.string("( "),this.addValue(econd,tabs),this.buf.b+=Std.string(" ) ? "),this.addValue(eif,tabs),this.buf.b+=Std.string(" : "),this.addValue(eelse,tabs);break;case 20:_g.args,_g.m;var e1=_g.e;this.addValue(e1,tabs);break;default:this.addExpr(e,tabs)}},addBlock:function(e,tabs){this.addExpr(e,tabs)},getFunName:function(g,args,rt){switch(g._hx_index){case 20:if(rt==hxsl_Type.TInt&&null!=this.glES)return this.decl("int _imod( int x, int y ) { return int(mod(float(x),float(y))); }"),"_imod";break;case 33:switch((_g=args[0].t)._hx_index){case 10:case 11:if(null!=this.glES&&this.glES<=2)return"texture2D";break;case 12:if(null!=this.glES&&this.glES<=2)return"textureCube";break;case 17:_g.size;if(null!=this.glES&&this.glES<=2)return"texture2D"}break;case 34:var _g;switch((_g=args[0].t)._hx_index){case 10:case 11:if(null!=this.glES&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"texture2DLodEXT";break;case 12:if(null!=this.glES&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"textureCubeLodEXT";break;case 17:_g.size;if(null!=this.glES&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"texture2DLodEXT"}break;case 35:case 36:return"texelFetch";case 50:if(args[0].t==hxsl_Type.TMat3x4)return this.decl(hxsl_GlslOut.MAT34),this.decl("mat3 _mat3( _mat3x4 v ) { return mat3(v.a.xyz,v.b.xyz,v.c.xyz); }"),"_mat3";break;case 52:if(this.decl(hxsl_GlslOut.MAT34),1==args.length)return this.decl("_mat3x4 mat_to_34( mat4 m ) { return _mat3x4(m[0],m[1],m[2]); }"),"mat_to_34";break;case 54:this.decl("vec4 pack( float v ) { vec4 color = fract(v * vec4(1, 255, 255.*255., 255.*255.*255.)); return color - color.yzww * vec4(1. / 255., 1. / 255., 1. / 255., 0.); }");break;case 55:this.decl("float unpack( vec4 color ) { return dot(color,vec4(1., 1. / 255., 1. / (255. * 255.), 1. / (255. * 255. * 255.))); }");break;case 56:this.decl("vec4 packNormal( vec3 v ) { return vec4((v + vec3(1.)) * vec3(0.5),1.); }");break;case 57:this.decl("vec3 unpackNormal( vec4 v ) { return normalize((v.xyz - vec3(0.5)) * vec3(2.)); }");break;case 58:this.decl("vec2 screenToUv( vec2 v ) { return v * vec2(0.5,-0.5) + vec2(0.5,0.5); }");break;case 59:this.decl("vec2 uvToScreen( vec2 v ) { return v * vec2(2.,-2.) + vec2(-1., 1.); }");break;case 60:case 61:case 62:this.decl("#extension GL_OES_standard_derivatives:enable")}return hxsl_GlslOut.GLOBALS.get(g)},addExpr:function(e,tabs){var _g=e.e;switch(_g._hx_index){case 0:var c=_g.c;switch(c._hx_index){case 0:this.buf.b+=Std.string("null");break;case 1:var b=c.b;this.buf.b+=Std.string(b);break;case 2:var v=c.v;this.buf.b+=Std.string(v);break;case 3:var str=""+c.v;this.buf.b+=Std.string(str),-1==str.indexOf(".")&&-1==str.indexOf("e")&&(this.buf.b+=Std.string("."));break;case 4:v=c.v;this.buf.b+=Std.string('"'+v+'"')}break;case 1:v=_g.v;var v1=this.varName(v);this.buf.b+=Std.string(v1);break;case 2:var g=_g.g;v=hxsl_GlslOut.GLOBALS.get(g);this.buf.b+=Std.string(v);break;case 3:var e1=_g.e;this.buf.b+=Std.string("("),this.addValue(e1,tabs),this.buf.b+=Std.string(")");break;case 4:var el=_g.el;this.buf.b+=Std.string("{\n");for(var t2=tabs+"\t",_g1=0;_g1<el.length;){e1=el[_g1];++_g1,this.buf.b+=Std.string(t2),this.addExpr(e1,t2),this.newLine(e1)}this.buf.b+=Std.string(tabs),this.buf.b+=Std.string("}");break;case 5:var e2=_g.e2,op=(e1=_g.e1,_g.op),_g2=(_g1=e2.t,e1.t);switch(op._hx_index){case 1:if(5==_g2._hx_index)if(3==_g2.size)if(1==_g2.t._hx_index)if(8==_g1._hx_index){if(this.decl(hxsl_GlslOut.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),20==op._hx_index){var _g3=op.op;tmp=!0}else tmp=!1;tmp&&(this.addValue(e1,tabs),this.buf.b+=Std.string(" = ")),this.buf.b+=Std.string("m3x4mult("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string(")")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 5:if(5==_g2._hx_index){_g3=_g2.t;if(5==_g1._hx_index){_g3=_g1.t,_g3=_g1.size;var n=_g2.size;switch(this.buf.b+=Std.string("vec"+n+"("),op._hx_index){case 5:v="equal";break;case 6:v="notEqual";break;case 7:v="greaterThan";break;case 8:v="greaterThanEqual";break;case 9:v="lessThan";break;case 10:v="lessThanEqual";break;default:throw haxe_Exception.thrown("assert")}this.buf.b+=Std.string(v),this.buf.b+=Std.string("("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string("))")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 6:if(5==_g2._hx_index){_g3=_g2.t;if(5==_g1._hx_index){_g3=_g1.t,_g3=_g1.size,n=_g2.size;switch(this.buf.b+=Std.string("vec"+n+"("),op._hx_index){case 5:v="equal";break;case 6:v="notEqual";break;case 7:v="greaterThan";break;case 8:v="greaterThanEqual";break;case 9:v="lessThan";break;case 10:v="lessThanEqual";break;default:throw haxe_Exception.thrown("assert")}this.buf.b+=Std.string(v),this.buf.b+=Std.string("("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string("))")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 7:if(5==_g2._hx_index){_g3=_g2.t;if(5==_g1._hx_index){_g3=_g1.t,_g3=_g1.size,n=_g2.size;switch(this.buf.b+=Std.string("vec"+n+"("),op._hx_index){case 5:v="equal";break;case 6:v="notEqual";break;case 7:v="greaterThan";break;case 8:v="greaterThanEqual";break;case 9:v="lessThan";break;case 10:v="lessThanEqual";break;default:throw haxe_Exception.thrown("assert")}this.buf.b+=Std.string(v),this.buf.b+=Std.string("("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string("))")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 8:if(5==_g2._hx_index){_g3=_g2.t;if(5==_g1._hx_index){_g3=_g1.t,_g3=_g1.size,n=_g2.size;switch(this.buf.b+=Std.string("vec"+n+"("),op._hx_index){case 5:v="equal";break;case 6:v="notEqual";break;case 7:v="greaterThan";break;case 8:v="greaterThanEqual";break;case 9:v="lessThan";break;case 10:v="lessThanEqual";break;default:throw haxe_Exception.thrown("assert")}this.buf.b+=Std.string(v),this.buf.b+=Std.string("("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string("))")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 9:if(5==_g2._hx_index){_g3=_g2.t;if(5==_g1._hx_index){_g3=_g1.t,_g3=_g1.size,n=_g2.size;switch(this.buf.b+=Std.string("vec"+n+"("),op._hx_index){case 5:v="equal";break;case 6:v="notEqual";break;case 7:v="greaterThan";break;case 8:v="greaterThanEqual";break;case 9:v="lessThan";break;case 10:v="lessThanEqual";break;default:throw haxe_Exception.thrown("assert")}this.buf.b+=Std.string(v),this.buf.b+=Std.string("("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string("))")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 10:if(5==_g2._hx_index){_g3=_g2.t;if(5==_g1._hx_index){_g3=_g1.t,_g3=_g1.size,n=_g2.size;switch(this.buf.b+=Std.string("vec"+n+"("),op._hx_index){case 5:v="equal";break;case 6:v="notEqual";break;case 7:v="greaterThan";break;case 8:v="greaterThanEqual";break;case 9:v="lessThan";break;case 10:v="lessThanEqual";break;default:throw haxe_Exception.thrown("assert")}this.buf.b+=Std.string(v),this.buf.b+=Std.string("("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string("))")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 18:this.decl("int _ushr( int i, int j ) { return int(uint(i) >> uint(j)); }"),this.buf.b+=Std.string("_ushr("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string(")");break;case 19:if(e.t!=hxsl_Type.TInt){if(20==op._hx_index){_g3=op.op;tmp=!0}else tmp=!1;tmp&&(this.addValue(e1,tabs),this.buf.b+=Std.string(" = ")),this.addExpr({e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Mod),t:hxsl_Type.TFun([]),p:e.p},[e1,e2]),t:e.t,p:e.p},tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 20:switch(op.op._hx_index){case 1:if(5==_g2._hx_index)if(3==_g2.size)if(1==_g2.t._hx_index)if(8==_g1._hx_index){if(this.decl(hxsl_GlslOut.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),20==op._hx_index){_g1=op.op;tmp=!0}else tmp=!1;tmp&&(this.addValue(e1,tabs),this.buf.b+=Std.string(" = ")),this.buf.b+=Std.string("m3x4mult("),this.addValue(e1,tabs),this.buf.b+=Std.string(","),this.addValue(e2,tabs),this.buf.b+=Std.string(")")}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 19:if(e.t!=hxsl_Type.TInt){if(20==op._hx_index){_g1=op.op;tmp=!0}else tmp=!1;tmp&&(this.addValue(e1,tabs),this.buf.b+=Std.string(" = ")),this.addExpr({e:hxsl_TExprDef.TCall({e:hxsl_TExprDef.TGlobal(hxsl_TGlobal.Mod),t:hxsl_Type.TFun([]),p:e.p},[e1,e2]),t:e.t,p:e.p},tabs)}else{this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;default:this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;default:this.addValue(e1,tabs),this.buf.b+=Std.string(" ");v=hxsl_Printer.opStr(op);this.buf.b+=Std.string(v),this.buf.b+=Std.string(" "),this.addValue(e2,tabs)}break;case 6:e1=_g.e1,op=_g.op;var _this1=(_this=this.buf).b;switch(op._hx_index){case 0:tmp="++";break;case 1:tmp="--";break;case 2:tmp="!";break;case 3:tmp="-";break;case 4:tmp="~"}_this.b=_this1+Std.string(tmp),this.addValue(e1,tabs);break;case 7:var init=_g.init;v=_g.v;if(this.locals.h[v.id]=v,null!=init){v1=this.varName(v);this.buf.b+=Std.string(v1),this.buf.b+=Std.string(" = "),this.addValue(init,tabs)}else this.buf.b+=Std.string("/*var*/");break;case 8:_g1=_g.args,_g3=(_g2=_g.e).t,_g3=_g2.p;if(2==(_g3=_g2.e)._hx_index){var _g4=_g3.g;switch(_g4._hx_index){case 35:var args=_g1;g=_g4,v=this.getFunName(g,args,e.t);this.buf.b+=Std.string(v),this.buf.b+=Std.string("(");for(_g3=0;_g3<args.length;){e1=args[_g3];++_g3,this.addValue(e1,tabs),this.buf.b+=Std.string(", ")}this.buf.b+=Std.string("0)");break;case 53:if(1==_g1.length){e1=_g1[0];this.buf.b+=Std.string("clamp("),this.addValue(e1,tabs),this.buf.b+=Std.string(", 0., 1.)")}else{args=_g1;if(2==(_g3=(v=_g2).e)._hx_index){g=_g3.g,v1=this.getFunName(g,args,e.t);this.buf.b+=Std.string(v1)}else this.addValue(v,tabs);this.buf.b+=Std.string("(");var first=!0;for(_g3=0;_g3<args.length;){e1=args[_g3];++_g3,first?first=!1:this.buf.b+=Std.string(", "),this.addValue(e1,tabs)}this.buf.b+=Std.string(")")}break;default:args=_g1;if(2==(_g3=(v=_g2).e)._hx_index){g=_g3.g,v1=this.getFunName(g,args,e.t);this.buf.b+=Std.string(v1)}else this.addValue(v,tabs);this.buf.b+=Std.string("(");for(first=!0,_g3=0;_g3<args.length;){e1=args[_g3];++_g3,first?first=!1:this.buf.b+=Std.string(", "),this.addValue(e1,tabs)}this.buf.b+=Std.string(")")}}else{args=_g1;if(2==(_g1=(v=_g2).e)._hx_index){g=_g1.g,v1=this.getFunName(g,args,e.t);this.buf.b+=Std.string(v1)}else this.addValue(v,tabs);this.buf.b+=Std.string("(");for(first=!0,_g1=0;_g1<args.length;){e1=args[_g1];++_g1,first?first=!1:this.buf.b+=Std.string(", "),this.addValue(e1,tabs)}this.buf.b+=Std.string(")")}break;case 9:var regs=_g.regs;if(3==(e1=_g.e).t._hx_index){for(_g1=0;_g1<regs.length;){var r=regs[_g1];if(++_g1,r!=hxsl_Component.X)throw haxe_Exception.thrown("assert")}switch(regs.length){case 1:this.addValue(e1,tabs);break;case 2:this.decl("vec2 _vec2( float v ) { return vec2(v,v); }"),this.buf.b+=Std.string("_vec2("),this.addValue(e1,tabs),this.buf.b+=Std.string(")");break;case 3:this.decl("vec3 _vec3( float v ) { return vec3(v,v,v); }"),this.buf.b+=Std.string("_vec3("),this.addValue(e1,tabs),this.buf.b+=Std.string(")");break;case 4:this.decl("vec4 _vec4( float v ) { return vec4(v,v,v,v); }"),this.buf.b+=Std.string("_vec4("),this.addValue(e1,tabs),this.buf.b+=Std.string(")");break;default:throw haxe_Exception.thrown("assert")}}else{this.addValue(e1,tabs),this.buf.b+=Std.string(".");for(_g1=0;_g1<regs.length;){r=regs[_g1];++_g1;var _this,tmp;_this1=(_this=this.buf).b;switch(r._hx_index){case 0:tmp="x";break;case 1:tmp="y";break;case 2:tmp="z";break;case 3:tmp="w"}_this.b=_this1+Std.string(tmp)}}break;case 10:var eelse=_g.eelse,eif=_g.eif,econd=_g.econd;this.buf.b+=Std.string("if( "),this.addValue(econd,tabs),this.buf.b+=Std.string(") "),this.addExpr(eif,tabs),null!=eelse&&(this.isBlock(eif)||(this.buf.b+=Std.string(";")),this.buf.b+=Std.string(" else "),this.addExpr(eelse,tabs));break;case 11:this.buf.b+=Std.string("discard");break;case 12:null==(e1=_g.e)?this.buf.b+=Std.string("return"):(this.buf.b+=Std.string("return "),this.addValue(e1,tabs));break;case 13:var loop=_g.loop,it=_g.it;v=_g.v;if(this.locals.h[v.id]=v,5!=(_g1=it.e)._hx_index)throw haxe_Exception.thrown("assert");if(21!=_g1.op._hx_index)throw haxe_Exception.thrown("assert");e2=_g1.e2,e1=_g1.e1;this.buf.b+=Std.string("for("),this.buf.b+=Std.string(v.name+"="),this.addValue(e1,tabs),this.buf.b+=Std.string(";"+v.name+"<"),this.addValue(e2,tabs),this.buf.b+=Std.string(";"+v.name+"++) "),this.addBlock(loop,tabs);break;case 14:this.buf.b+=Std.string("continue");break;case 15:this.buf.b+=Std.string("break");break;case 16:var index=_g.index;e1=_g.e;this.addValue(e1,tabs),this.buf.b+=Std.string("["),this.addValue(index,tabs),this.buf.b+=Std.string("]");break;case 17:el=_g.el;if(15!=(_g1=e.t)._hx_index)throw haxe_Exception.thrown("assert");_g2=_g1.size;var t=_g1.t;this.addType(t),this.buf.b+=Std.string("["+el.length+"]"),this.buf.b+=Std.string("(");for(first=!0,_g1=0;_g1<el.length;){e=el[_g1];++_g1,first?first=!1:this.buf.b+=Std.string(", "),this.addValue(e,tabs)}this.buf.b+=Std.string(")");break;case 18:_g1=_g.def,_g1=_g.cases,_g1=_g.e;this.buf.b+=Std.string("switch(...)");break;case 19:_g1=_g.loop,_g2=_g.e;if(0==_g.normalWhile){e=_g2,loop=_g1;tabs+="\t",this.buf.b+=Std.string("do "),this.addBlock(loop,tabs),this.buf.b+=Std.string(" while( "),this.addValue(e,tabs),this.buf.b+=Std.string(" )")}else{e=_g2,loop=_g1;this.buf.b+=Std.string("while( "),this.addValue(e,tabs),this.buf.b+=Std.string(" ) "),this.addBlock(loop,tabs)}break;case 20:_g1=_g.args,_g1=_g.m,e=_g.e;this.addExpr(e,tabs)}},varName:function(v){if(v.kind==hxsl_VarKind.Output){if(this.isVertex)return"gl_Position";if(null!=this.glES&&this.glES<=2)return null==this.outIndexes?"gl_FragColor":"gl_FragData["+this.outIndexes.h[v.id]+"]"}var n=this.varNames.h[v.id];if(null!=n)return n;if(n=v.name,Object.prototype.hasOwnProperty.call(hxsl_GlslOut.KWDS.h,n)&&(n="_"+n),Object.prototype.hasOwnProperty.call(this.allNames.h,n)){var k=2;for(n+="_";Object.prototype.hasOwnProperty.call(this.allNames.h,n+k);)++k;n+=k}return this.varNames.h[v.id]=n,this.allNames.h[n]=v.id,n},newLine:function(e){this.isBlock(e)?this.buf.b+=Std.string("\n"):this.buf.b+=Std.string(";\n")},isBlock:function(e){var _g=e.e;switch(_g._hx_index){case 4:_g.el;return!0;case 13:_g.it,_g.v;var loop=_g.loop;return this.isBlock(loop);case 19:_g.e;if(1==_g.normalWhile){loop=_g.loop;return this.isBlock(loop)}return!1;default:return!1}},initVar:function(v){switch(v.kind._hx_index){case 0:case 2:var tmp;if(16==(_g=v.type)._hx_index){var _g1=_g.size;_g1=_g.t;tmp=!0}else tmp=!1;tmp&&(this.buf.b+=Std.string("layout(std140) ")),this.buf.b+=Std.string("uniform ");break;case 1:this.buf.b+=Std.string(null!=this.glES&&this.glES<=2?"attribute ":"in ");break;case 3:this.buf.b+=Std.string(null!=this.glES&&this.glES<=2?"varying ":this.isVertex?"out ":"in ");break;case 4:break;case 5:if(null!=this.glES&&this.glES<=2)return void(this.outIndexes.h[v.id]=this.outIndex++);if(this.isVertex)return;null!=this.glES&&(this.buf.b+=Std.string("layout(location="+this.outIndex+++") ")),this.buf.b+=Std.string("out ");break;case 6:return}if(null!=v.qualifiers){var _g=0;for(_g1=v.qualifiers;_g<_g1.length;){var q=_g1[_g];if(++_g,6==q._hx_index)switch(q.p._hx_index){case 0:this.buf.b+=Std.string("lowp ");break;case 1:this.buf.b+=Std.string("mediump ");break;case 2:this.buf.b+=Std.string("highp ")}}}this.addVar(v),this.buf.b+=Std.string(";\n")},initVars:function(s){this.outIndex=0,this.uniformBuffer=0,this.outIndexes=new haxe_ds_IntMap;for(var _g=0,_g1=s.vars;_g<_g1.length;){var v=_g1[_g];++_g,this.initVar(v)}this.buf.b+=Std.string("\n"),this.outIndex<2?this.outIndexes=null:!this.isVertex&&null!=this.glES&&this.glES<=2&&this.decl("#extension GL_EXT_draw_buffers : enable")},run:function(s){if(this.locals=new haxe_ds_IntMap,this.decls=[],this.buf=new StringBuf,this.exprValues=[],this.decl("precision mediump float;"),1!=s.funs.length)throw haxe_Exception.thrown("assert");var f=s.funs[0];this.isVertex=f.kind==hxsl_FunctionKind.Vertex,this.initVars(s);var tmp=this.buf;if(this.buf=new StringBuf,this.buf.b+=Std.string("void main(void) {\n"),4==(_g=f.expr.e)._hx_index)for(var el=_g.el,_g=0;_g<el.length;){var e=el[_g];++_g,this.buf.b+=Std.string("\t"),this.addExpr(e,"\t"),this.newLine(e)}else this.addExpr(f.expr,"");this.buf.b+=Std.string("}"),this.exprValues.push(this.buf.b),this.buf=tmp;var locals=Lambda.array(this.locals);locals.sort((function(v1,v2){return Reflect.compare(v1.name,v2.name)}));for(_g=0;_g<locals.length;){var v=locals[_g];++_g,this.addVar(v),this.buf.b+=Std.string(";\n")}this.buf.b+=Std.string("\n");_g=0;for(var _g1=this.exprValues;_g<_g1.length;){e=_g1[_g];++_g,this.buf.b+=Std.string(e),this.buf.b+=Std.string("\n\n")}return null!=this.glES?this.decl("#version "+(this.version<100?100:this.version)+(this.version>150?" es":"")):null!=this.version?this.decl("#version "+(this.version>150?150:this.version)):this.decl("#version 130"),this.decls.push(this.buf.b),this.buf=null,this.decls.join("\n")},__class__:hxsl_GlslOut};var hxsl__$Linker_AllocatedVar=function(){};$hxClasses["hxsl._Linker.AllocatedVar"]=hxsl__$Linker_AllocatedVar,hxsl__$Linker_AllocatedVar.__name__="hxsl._Linker.AllocatedVar",hxsl__$Linker_AllocatedVar.prototype={__class__:hxsl__$Linker_AllocatedVar};var hxsl__$Linker_ShaderInfos=function(n,v){this.name=n,this.uid=hxsl__$Linker_ShaderInfos.UID++,this.vertex=v,this.processed=new haxe_ds_IntMap,this.usedFunctions=[],this.read=new haxe_ds_IntMap,this.write=new haxe_ds_IntMap};$hxClasses["hxsl._Linker.ShaderInfos"]=hxsl__$Linker_ShaderInfos,hxsl__$Linker_ShaderInfos.__name__="hxsl._Linker.ShaderInfos",hxsl__$Linker_ShaderInfos.prototype={__class__:hxsl__$Linker_ShaderInfos};var hxsl_Linker=function(batchMode){null==batchMode&&(batchMode=!1),this.debugDepth=0,this.batchMode=batchMode};$hxClasses["hxsl.Linker"]=hxsl_Linker,hxsl_Linker.__name__="hxsl.Linker",hxsl_Linker.prototype={error:function(msg,p){return hxsl_Error.t(msg,p)},mergeVar:function(path,v,v2,p){switch(v.kind._hx_index){case 0:case 1:case 3:case 4:case 5:break;case 2:case 6:throw haxe_Exception.thrown("assert")}v.kind!=v2.kind&&v.kind!=hxsl_VarKind.Local&&v2.kind!=hxsl_VarKind.Local&&this.error("'"+path+"' kind does not match : "+Std.string(v.kind)+" should be "+Std.string(v2.kind),p);var _g=v2.type;if(13==(_g1=v.type)._hx_index)if(13==_g._hx_index){var fl1=_g1.vl,fl2=_g.vl;for(_g=0;_g<fl1.length;){var f1=fl1[_g];++_g;for(var ft=null,_g1=0;_g1<fl2.length;){var f2=fl2[_g1];if(++_g1,f1.name==f2.name){ft=f2;break}}null==ft?fl2.push(this.allocVar(f1,p).v):this.mergeVar(path+"."+ft.name,f1,ft,p)}}else Type.enumEq(v.type,v2.type)||this.error("'"+path+"' type does not match : "+hxsl_Tools.toString(v.type)+" should be "+hxsl_Tools.toString(v2.type),p);else Type.enumEq(v.type,v2.type)||this.error("'"+path+"' type does not match : "+hxsl_Tools.toString(v.type)+" should be "+hxsl_Tools.toString(v2.type),p)},allocVar:function(v,p,path,parent){if(null!=v.parent&&null==parent){var p1=(parent=this.allocVar(v.parent,p)).v;for(path=p1.name,p1=p1.parent;null!=p1;)path=p1.name+"."+path,p1=p1.parent}var key=null==path?v.name:path+"."+v.name;if(null!=v.qualifiers)for(var _g=0,_g1=v.qualifiers;_g<_g1.length;){var q=_g1[_g];if(++_g,4==q._hx_index)key=q.n}var v2=this.varMap.h[key],vname=v.name;if(null!=v2){var tmp;for(_g=0,_g1=v2.merged;_g<_g1.length;){var vm=_g1[_g];if(++_g,vm==v)return v2}if(v.kind==hxsl_VarKind.Param&&!hxsl_Tools.hasQualifier(v,hxsl_VarQualifier.Shared)&&!this.isBatchShader||v.kind==hxsl_VarKind.Function||v.kind==hxsl_VarKind.Var&&hxsl_Tools.hasQualifier(v,hxsl_VarQualifier.Private))tmp=!0;else{var v1=v2.v;tmp=v1.kind==hxsl_VarKind.Param&&!hxsl_Tools.hasQualifier(v1,hxsl_VarQualifier.Shared)&&!this.isBatchShader||v1.kind==hxsl_VarKind.Function||v1.kind==hxsl_VarKind.Var&&hxsl_Tools.hasQualifier(v1,hxsl_VarQualifier.Private)}if(!(tmp||v.kind==hxsl_VarKind.Param&&v2.v.kind==hxsl_VarKind.Param))return v2.merged.push(v),this.mergeVar(key,v,v2.v,p),this.varIdMap.h[v.id]=v2.id,v2;for(var k=2;;){if(null==(a=this.varMap.h[key+k]))break;for(_g=0,_g1=a.merged;_g<_g1.length;){vm=_g1[_g];if(++_g,vm==v)return a}++k}vname+=k,key+=k}var a,vid=this.allVars.length+1;v2={id:vid,name:vname,type:v.type,kind:v.kind,qualifiers:v.qualifiers,parent:null==parent?null:parent.v};if((a=new hxsl__$Linker_AllocatedVar).v=v2,a.merged=[v],a.path=key,a.id=vid,a.parent=parent,a.instanceIndex=this.curInstance,this.allVars.push(a),this.varMap.h[key]=a,13==(_g=v2.type)._hx_index){var vl=_g.vl;for(_g=[],_g1=0;_g1<vl.length;){v=vl[_g1];++_g1,_g.push(this.allocVar(v,p,key,a).v)}v2.type=hxsl_Type.TStruct(_g)}return a},mapExprVar:function(e){var _g=e.e;switch(_g._hx_index){case 1:var v=_g.v;if(!this.locals.h.hasOwnProperty(v.id)){var v1=this.allocVar(v,e.p);return null==this.curShader||this.curShader.write.h.hasOwnProperty(v1.id)||(this.curShader.read.h[v1.id]=v1,null==this.curShader.vertex&&v1.v.kind==hxsl_VarKind.Var&&(this.curShader.vertex=!1)),{e:hxsl_TExprDef.TVar(v1.v),t:v1.v.type,p:e.p}}break;case 5:var e2=_g.e2,e1=_g.e1,op=_g.op,_g1=e1.e;switch(op._hx_index){case 4:switch(_g1._hx_index){case 1:v=_g2=_g1.v;if(!this.locals.h.hasOwnProperty(v.id)){var e21=this.mapExprVar(e2);v1=this.allocVar(v,e1.p);return null!=this.curShader&&(this.curShader.write.h[v1.id]=v1),{e:hxsl_TExprDef.TBinop(op,{e:hxsl_TExprDef.TVar(v1.v),t:v1.v.type,p:e.p},e21),t:e.t,p:e.p}}v=_g2;if(!this.locals.h.hasOwnProperty(v.id)){var e11=this.mapExprVar(e1);e21=this.mapExprVar(e2),v1=this.allocVar(v,e11.p);return null!=this.curShader&&(this.curShader.write.h[v1.id]=v1),{e:hxsl_TExprDef.TBinop(op,e11,e21),t:e.t,p:e.p}}break;case 9:var _g2=_g1.regs,_g3=(_g2=_g1.e).t;_g3=_g2.p;if(1==(_g3=_g2.e)._hx_index){v=_g3.v;if(!this.locals.h.hasOwnProperty(v.id)){e11=this.mapExprVar(e1),e21=this.mapExprVar(e2),v1=this.allocVar(v,e11.p);return null!=this.curShader&&(this.curShader.write.h[v1.id]=v1),{e:hxsl_TExprDef.TBinop(op,e11,e21),t:e.t,p:e.p}}}}break;case 20:_g2=op.op;switch(_g1._hx_index){case 1:v=_g1.v;if(!this.locals.h.hasOwnProperty(v.id)){e11=this.mapExprVar(e1),e21=this.mapExprVar(e2),v1=this.allocVar(v,e11.p);return null!=this.curShader&&(this.curShader.write.h[v1.id]=v1),{e:hxsl_TExprDef.TBinop(op,e11,e21),t:e.t,p:e.p}}break;case 9:_g2=_g1.regs,_g1=(_g2=_g1.e).t,_g1=_g2.p;if(1==(_g1=_g2.e)._hx_index){v=_g1.v;if(!this.locals.h.hasOwnProperty(v.id)){e11=this.mapExprVar(e1),e21=this.mapExprVar(e2),v1=this.allocVar(v,e11.p);return null!=this.curShader&&(this.curShader.write.h[v1.id]=v1),{e:hxsl_TExprDef.TBinop(op,e11,e21),t:e.t,p:e.p}}}}}break;case 7:_g1=_g.init,v=_g.v;this.locals.h[v.id]=!0;break;case 11:null!=this.curShader&&(this.curShader.vertex=!1,this.curShader.hasDiscard=!0);break;case 13:_g1=_g.loop,_g1=_g.it,v=_g.v;this.locals.h[v.id]=!0}return hxsl_Tools.map(e,$bind(this,this.mapExprVar))},addShader:function(name,vertex,e,p){var s=new hxsl__$Linker_ShaderInfos(name,vertex);return this.curShader=s,s.priority=p,s.body=this.mapExprVar(e),this.shaders.push(s),this.curShader=null,s},sortByPriorityDesc:function(s1,s2){return s1.priority==s2.priority?s1.uid-s2.uid:s2.priority-s1.priority},buildDependency:function(s,v,isWritten){for(var found=!isWritten,_g=0,_g1=this.shaders;_g<_g1.length;){var parent=_g1[_g];if(++_g,parent!=s){if(found&&parent.write.h.hasOwnProperty(v.id)){if(s.vertex){if(0==parent.vertex)continue;null==parent.vertex&&(parent.vertex=!0)}if(s.deps.set(parent,!0),this.debugDepth++,this.initDependencies(parent),this.debugDepth--,!parent.read.h.hasOwnProperty(v.id))return}}else found=!0}v.v.kind==hxsl_VarKind.Var&&this.error("Variable "+v.path+" required by "+s.name+" is missing initializer",null)},initDependencies:function(s){if(null==s.deps){s.deps=new haxe_ds_ObjectMap;for(var r=s.read.iterator();r.hasNext();){var r1=r.next();this.buildDependency(s,r1,s.write.h.hasOwnProperty(r1.id))}if(null==s.vertex)for(var d=s.deps.keys();d.hasNext();){if(0==(d1=d.next()).vertex){s.vertex=!1;break}}if(s.vertex)for(d=s.deps.keys();d.hasNext();){var d1;null==(d1=d.next()).vertex&&(d1.vertex=!0)}}},collect:function(cur,out,vertex){if(cur.onStack&&this.error("Loop in shader dependencies ("+cur.name+")",null),cur.marked!=vertex){cur.marked=vertex,cur.onStack=!0;for(var _g=[],d=cur.deps.keys();d.hasNext();){var d1=d.next();_g.push(d1)}var deps=_g;deps.sort($bind(this,this.sortByPriorityDesc));for(_g=0;_g<deps.length;){d=deps[_g];++_g,this.collect(d,out,vertex)}null==cur.vertex&&(cur.vertex=vertex),cur.vertex==vertex&&out.push(cur),cur.onStack=!1}},uniqueLocals:function(expr,locals){switch((_g=expr.e)._hx_index){case 4:for(var el=_g.el,_g1=new haxe_ds_StringMap,k=haxe_ds_StringMap.keysIterator(locals.h);k.hasNext();){var k1=k.next();_g1.h[k1]=!0}var locals1=_g1;for(_g1=0;_g1<el.length;){var e=el[_g1];++_g1,this.uniqueLocals(e,locals1)}break;case 7:_g1=_g.init;var v=_g.v;if(Object.prototype.hasOwnProperty.call(locals.h,v.name)){for(k=2;Object.prototype.hasOwnProperty.call(locals.h,v.name+k);)++k;v.name+=k}locals.h[v.name]=!0;break;default:var _g=$bind(this,this.uniqueLocals);locals1=locals;hxsl_Tools.iter(expr,(function(expr){_g(expr,locals1)}))}},link:function(shadersData){var _gthis=this;this.varMap=new haxe_ds_StringMap,this.varIdMap=new haxe_ds_IntMap,this.allVars=[],this.shaders=[],this.locals=new haxe_ds_IntMap;for(var dupShaders=new haxe_ds_ObjectMap,_g=[],_g1=0;_g1<shadersData.length;){var s=shadersData[_g1];++_g1;var sreal=s1=s;null!=dupShaders.h.__keys__[s1.__id__]&&(s1=hxsl_Clone.shaderData(s1)),dupShaders.set(s1,sreal),_g.push(s1)}shadersData=_g,this.curInstance=0;var outVars=[];for(_g=0;_g<shadersData.length;){s=shadersData[_g];++_g,this.isBatchShader=this.batchMode&&StringTools.startsWith(s.name,"batchShader_");_g1=0;for(var _g2=s.vars;_g1<_g2.length;){var v=_g2[_g1];++_g1;var v2=this.allocVar(v,null);this.isBatchShader&&v2.v.kind==hxsl_VarKind.Param&&!StringTools.startsWith(v2.path,"Batch_")&&(v2.v.kind=hxsl_VarKind.Local),v.kind==hxsl_VarKind.Output&&outVars.push(v)}for(var _g3=0,_g4=s.funs;_g3<_g4.length;){var f=_g4[_g3];++_g3,(v1=this.allocVar(f.ref,f.expr.p)).kind=f.kind}this.curInstance++}var priority=0,initPrio_init=[-3e3],initPrio_vert=[-2e3],initPrio_frag=[-1e3];for(_g=0;_g<shadersData.length;){s=shadersData[_g];++_g;for(_g1=0,_g2=s.funs;_g1<_g2.length;){f=_g2[_g1];if(++_g1,null==(v=this.allocVar(f.ref,f.expr.p)).kind)throw haxe_Exception.thrown("assert");switch(v.kind._hx_index){case 0:case 1:this.addShader(s.name+"."+(v.kind==hxsl_FunctionKind.Vertex?"vertex":"fragment"),v.kind==hxsl_FunctionKind.Vertex,f.expr,priority);break;case 2:var prio,status;switch(f.ref.name){case"__init__fragment":prio=initPrio_frag,status=!1;break;case"__init__vertex":prio=initPrio_vert,status=!0;break;default:prio=initPrio_init,status=null}if(4==(_g3=f.expr.e)._hx_index){var el=_g3.el,index=0;for(_g4=0;_g4<el.length;){var e=el[_g4];++_g4,this.addShader(s.name+"."+f.ref.name+index++,status,e,prio[0]++)}}else this.addShader(s.name+"."+f.ref.name,status,f.expr,prio[0]++);break;case 3:throw haxe_Exception.thrown("Unexpected helper function in linker "+v.v.name)}}++priority}this.shaders.sort($bind(this,this.sortByPriorityDesc));var entry=new hxsl__$Linker_ShaderInfos("<entry>",!1);entry.deps=new haxe_ds_ObjectMap;for(_g=0;_g<outVars.length;){v=outVars[_g];++_g,this.buildDependency(entry,this.allocVar(v,null),!1)}for(_g=0,_g1=this.shaders;_g<_g1.length;){s=_g1[_g];++_g,s.hasDiscard&&(this.initDependencies(s),entry.deps.set(s,!0))}for(_g=0,_g1=this.shaders;_g<_g1.length;){s=_g1[_g];if(++_g,null==s.vertex){for(var onlyParams=!0,r=s.read.iterator();r.hasNext();){if(r.next().v.kind!=hxsl_VarKind.Param){onlyParams=!1;break}}onlyParams&&(s.vertex=!1)}}v=[],f=[];if(this.collect(entry,v,!0),this.collect(entry,f,!1),f.pop()!=entry)throw haxe_Exception.thrown("assert");for(_g=0,_g1=this.shaders;_g<_g1.length;){s=_g1[_g];++_g,s.marked=null}for(_g=0,_g1=v.concat(f);_g<_g1.length;){s=_g1[_g];++_g;for(var d=s.deps.keys();d.hasNext();){var d1=d.next();null==d1.marked&&this.error(d1.name+" needed by "+s.name+" is unreachable",null)}s.marked=!0}outVars=[];var varMap_h={},addVar=null;addVar=function(v){varMap_h.hasOwnProperty(v.id)||(varMap_h[v.id]=!0,null!=v.v.parent?addVar(v.parent):outVars.push(v.v))};for(_g=0,_g1=v.concat(f);_g<_g1.length;){s=_g1[_g];++_g;for(var v1=s.read.iterator();v1.hasNext();){v2=v1.next();addVar(v2)}for(var v3=s.write.iterator();v3.hasNext();){var v4=v3.next();addVar(v4)}}var cleanVar=null;cleanVar=function(v){if(13==(_g=v.type)._hx_index){var vl=_g.vl;if(v.kind!=hxsl_VarKind.Input){for(var vout=[],_g=0;_g<vl.length;){var v1=vl[_g];++_g,varMap_h.hasOwnProperty(v1.id)&&(cleanVar(v1),vout.push(v1))}v.type=hxsl_Type.TStruct(vout)}}};for(_g=0;_g<outVars.length;){v1=outVars[_g];++_g,cleanVar(v1)}var build=function(kind,name,a){var v={id:hxsl_Tools.allocVarId(),name:name,type:hxsl_Type.TFun([{ret:hxsl_Type.TVoid,args:[]}]),kind:hxsl_VarKind.Function};outVars.push(v);for(var exprs=[],_g=0;_g<a.length;){var s=a[_g];++_g;var _g1=s.body.e;if(4==_g1._hx_index)for(var el=_g1.el,_g2=0;_g2<el.length;){var e=el[_g2];++_g2,exprs.push(e)}else exprs.push(s.body)}var expr={e:hxsl_TExprDef.TBlock(exprs),t:hxsl_Type.TVoid,p:0==exprs.length?null:exprs[0].p};return _gthis.uniqueLocals(expr,new haxe_ds_StringMap),{kind:kind,ref:v,ret:hxsl_Type.TVoid,args:[],expr:expr}},funs=[build(hxsl_FunctionKind.Vertex,"vertex",v),build(hxsl_FunctionKind.Fragment,"fragment",f)];for(s=dupShaders.keys();s.hasNext();){var s1;if((s1=s.next())!=(sreal=dupShaders.h[s1.__id__]))for(_g=0,_g1=s1.vars.length;_g<_g1;){var i=_g++;this.allocVar(s1.vars[i],null).merged.unshift(sreal.vars[i])}}return{name:"out",vars:outVars,funs:funs}},__class__:hxsl_Linker};var hxsl_Output=$hxEnums["hxsl.Output"]={__ename__:"hxsl.Output",__constructs__:["Const","Value","PackNormal","PackFloat","Vec2","Vec3","Vec4","Swiz"],Const:($_=function(v){return{_hx_index:0,v:v,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["v"],$_),Value:($_=function(v,size){return{_hx_index:1,v:v,size:size,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["v","size"],$_),PackNormal:($_=function(v){return{_hx_index:2,v:v,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["v"],$_),PackFloat:($_=function(v){return{_hx_index:3,v:v,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["v"],$_),Vec2:($_=function(a){return{_hx_index:4,a:a,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["a"],$_),Vec3:($_=function(a){return{_hx_index:5,a:a,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["a"],$_),Vec4:($_=function(a){return{_hx_index:6,a:a,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["a"],$_),Swiz:($_=function(a,swiz){return{_hx_index:7,a:a,swiz:swiz,__enum__:"hxsl.Output",toString:$estr}},$_.__params__=["a","swiz"],$_)};hxsl_Output.__empty_constructs__=[];var hxsl_Printer=function(varId){null==varId&&(varId=!1),this.varId=varId};$hxClasses["hxsl.Printer"]=hxsl_Printer,hxsl_Printer.__name__="hxsl.Printer",hxsl_Printer.opStr=function(op){switch(op._hx_index){case 0:return"+";case 1:return"*";case 2:return"/";case 3:return"-";case 4:return"=";case 5:return"==";case 6:return"!=";case 7:return">";case 8:return">=";case 9:return"<";case 10:return"<=";case 11:return"&";case 12:return"|";case 13:return"^";case 14:return"&&";case 15:return"||";case 16:return"<<";case 17:return">>";case 18:return">>>";case 19:return"%";case 20:var op1=op.op;return hxsl_Printer.opStr(op1)+"=";case 21:return"...";case 22:return"=>";case 23:return" in "}},hxsl_Printer.toString=function(e,varId){return null==varId&&(varId=!1),new hxsl_Printer(varId).exprString(e)},hxsl_Printer.shaderToString=function(s,varId){return null==varId&&(varId=!1),new hxsl_Printer(varId).shaderString(s)},hxsl_Printer.prototype={shaderString:function(s){this.buffer=new StringBuf;for(var _g=0,_g1=s.vars;_g<_g1.length;){var v=_g1[_g];++_g,this.addVar(v,hxsl_VarKind.Var),this.buffer.b+=Std.string(";\n")}s.vars.length>0&&(this.buffer.b+=Std.string("\n"));for(_g=0,_g1=s.funs;_g<_g1.length;){var f=_g1[_g];++_g,this.addFun(f),this.buffer.b+=Std.string("\n\n")}return this.buffer.b},exprString:function(e){return this.buffer=new StringBuf,this.addExpr(e,""),this.buffer.b},addVar:function(v,defKind,tabs,parent){if(null==tabs&&(tabs=""),null!=v.qualifiers)for(var _g=0,_g1=v.qualifiers;_g<_g1.length;){var q=_g1[_g];switch(++_g,q._hx_index){case 0:var max=q.max;v1="const"+(null==max?"":"("+max+")");break;case 1:v1="private";break;case 2:v1="nullable";break;case 3:v1="perObject";break;case 4:v1="name('"+q.n+"')";break;case 5:v1="shared";break;case 6:var p=q.p;v1=$hxEnums[p.__enum__].__constructs__[p._hx_index].toLowerCase()+"p";break;case 7:var max1=q.max;v1="range("+q.min+","+max1+")";break;case 8:v1="ignore";break;case 9:v1="perInstance("+q.v+")"}this.buffer.b+=Std.string("@"+v1+" ")}if(v.kind!=defKind)switch(v.kind._hx_index){case 0:this.buffer.b+=Std.string("@global ");break;case 1:this.buffer.b+=Std.string("@input ");break;case 2:this.buffer.b+=Std.string("@param ");break;case 3:this.buffer.b+=Std.string("@var ");break;case 4:this.buffer.b+=Std.string("@local ");break;case 5:this.buffer.b+=Std.string("@output ");break;case 6:this.buffer.b+=Std.string("@function ")}if(this.buffer.b+=Std.string("var "),v.parent==parent?this.buffer.b+=Std.string(v.name+(this.varId?"@"+v.id:"")):this.addVarName(v),this.buffer.b+=Std.string(" : "),13==(_g=v.type)._hx_index){var vl=_g.vl;this.buffer.b+=Std.string("{");var first=!0;for(_g=0;_g<vl.length;){var v1=vl[_g];++_g,first?first=!1:this.buffer.b+=Std.string(", "),this.addVar(v1,v1.kind,tabs,v1)}this.buffer.b+=Std.string("}")}else{v1=hxsl_Tools.toString(v.type);this.buffer.b+=Std.string(v1)}},addFun:function(f){this.buffer.b+=Std.string("function "+f.ref.name+"(");for(var first=!0,_g=0,_g1=f.args;_g<_g1.length;){var a=_g1[_g];++_g,first?(this.buffer.b+=Std.string(" "),first=!1):this.buffer.b+=Std.string(", "),this.addVar(a,hxsl_VarKind.Local)}f.args.length>0&&(this.buffer.b+=Std.string(" "));var v=") : "+hxsl_Tools.toString(f.ret)+" ";this.buffer.b+=Std.string(v),this.addExpr(f.expr,"")},addVarName:function(v){null!=v.parent&&(this.addVarName(v.parent),this.buffer.b+=Std.string(".")),this.buffer.b+=Std.string(v.name),this.varId&&(this.buffer.b+=Std.string("@"+v.id))},addConst:function(c){var tmp,_this=this.buffer,_this1=_this.b;switch(c._hx_index){case 0:tmp="null";break;case 1:tmp=c.b;break;case 2:tmp=c.v;break;case 3:tmp=c.v;break;case 4:tmp='"'+c.v+'"'}_this.b=_this1+Std.string(tmp)},addExpr:function(e,tabs){switch((_g=e.e)._hx_index){case 0:var c=_g.c;this.addConst(c);break;case 1:var v=_g.v;this.addVarName(v);break;case 2:var g=_g.g;v=hxsl_Tools2.toString(g);this.buffer.b+=Std.string(v);break;case 3:e=_g.e;this.buffer.b+=Std.string("("),this.addExpr(e,tabs),this.buffer.b+=Std.string(")");break;case 4:var el=_g.el;this.buffer.b+=Std.string("{"),tabs+="\t";for(var _g1=0;_g1<el.length;){e=el[_g1];++_g1,this.buffer.b+=Std.string("\n"+tabs),this.addExpr(e,tabs),this.buffer.b+=Std.string(";")}tabs=HxOverrides.substr(tabs,1,null),el.length>0&&(this.buffer.b+=Std.string("\n"+tabs)),this.buffer.b+=Std.string("}");break;case 5:var e2=_g.e2,e1=_g.e1,op=_g.op;this.addExpr(e1,tabs);v=" "+hxsl_Printer.opStr(op)+" ";this.buffer.b+=Std.string(v),this.addExpr(e2,tabs);break;case 6:e=_g.e1,op=_g.op;var tmp,_this=this.buffer,_this1=_this.b;switch(op._hx_index){case 0:tmp="++";break;case 1:tmp="--";break;case 2:tmp="!";break;case 3:tmp="-";break;case 4:tmp="~"}_this.b=_this1+Std.string(tmp),this.addExpr(e,tabs);break;case 7:var init=_g.init;v=_g.v;this.addVar(v,hxsl_VarKind.Local,tabs),null!=init&&(this.buffer.b+=Std.string(" = "),this.addExpr(init,tabs));break;case 8:el=_g.args,e=_g.e;this.addExpr(e,tabs),this.buffer.b+=Std.string("(");var first=!0;for(_g1=0;_g1<el.length;){e=el[_g1];++_g1,first?first=!1:this.buffer.b+=Std.string(", "),this.addExpr(e,tabs)}this.buffer.b+=Std.string(")");break;case 9:var regs=_g.regs;e=_g.e;this.addExpr(e,tabs),this.buffer.b+=Std.string(".");for(_g1=0;_g1<regs.length;){var r=regs[_g1];++_g1,this.buffer.b+=Std.string(hxsl_Printer.SWIZ[r._hx_index])}break;case 10:var eelse=_g.eelse,eif=_g.eif,cond=_g.econd;this.buffer.b+=Std.string("if( "),this.addExpr(cond,tabs),this.buffer.b+=Std.string(" ) "),this.addExpr(eif,tabs),null!=eelse&&(this.buffer.b+=Std.string(" else "),this.addExpr(eelse,tabs));break;case 11:this.buffer.b+=Std.string("discard");break;case 12:e=_g.e;this.buffer.b+=Std.string("return"),null!=e&&(this.buffer.b+=Std.string(" "),this.addExpr(e,tabs));break;case 13:var loop=_g.loop,it=_g.it;v=_g.v;this.buffer.b+=Std.string("for( "),this.addVarName(v),this.buffer.b+=Std.string(" in "),this.addExpr(it,tabs),this.buffer.b+=Std.string(" ) "),this.addExpr(loop,tabs);break;case 14:this.buffer.b+=Std.string("continue");break;case 15:this.buffer.b+=Std.string("break");break;case 16:e2=_g.index,e1=_g.e;this.addExpr(e1,tabs),this.buffer.b+=Std.string("["),this.addExpr(e2,tabs),this.buffer.b+=Std.string("]");break;case 17:el=_g.el;this.buffer.b+=Std.string("[");for(first=!0,_g1=0;_g1<el.length;){e=el[_g1];++_g1,first?first=!1:this.buffer.b+=Std.string(", "),this.addExpr(e,tabs)}this.buffer.b+=Std.string("]");break;case 18:var def=_g.def,cases=_g.cases;e=_g.e;this.buffer.b+=Std.string("switch( "),this.addExpr(e,tabs),this.buffer.b+=Std.string(") {");var old=tabs;for(_g1=0;_g1<cases.length;){c=cases[_g1];++_g1,this.buffer.b+=Std.string("\n"+tabs),this.buffer.b+=Std.string("case ");first=!0;for(var _g2=0,_g3=c.values;_g2<_g3.length;){v=_g3[_g2];++_g2,first?first=!1:this.buffer.b+=Std.string(", "),this.addExpr(v,tabs)}tabs+="\t",this.buffer.b+=Std.string(":\n"+tabs),this.addExpr(c.expr,tabs),tabs=old}null!=def&&(this.buffer.b+=Std.string("\n"+tabs),tabs+="\t",this.buffer.b+=Std.string("default:\n"+tabs),this.addExpr(def,tabs),tabs=old),this.buffer.b+=Std.string("\n"+tabs+"}");break;case 19:_g1=_g.loop,_g2=_g.e;if(0==_g.normalWhile){e=_g2,loop=_g1,old=tabs;tabs+="\t",this.buffer.b+=Std.string("do {\n"+tabs),this.addExpr(loop,tabs),tabs=old,this.buffer.b+=Std.string("\n"+tabs+"} while( "),this.addExpr(e,tabs),this.buffer.b+=Std.string(" )")}else{e=_g2,loop=_g1;this.buffer.b+=Std.string("while( "),this.addExpr(e,tabs);old=tabs;tabs+="\t",this.buffer.b+=Std.string(" ) {\n"+tabs),this.addExpr(loop,tabs),tabs=old,this.buffer.b+=Std.string("\n"+tabs+"}")}break;case 20:e=_g.e;var args=_g.args,m=_g.m;if(this.buffer.b+=Std.string(m),args.length>0){this.buffer.b+=Std.string("(");first=!0;for(var _g=0;_g<args.length;){c=args[_g];++_g,first?first=!1:this.buffer.b+=Std.string(", "),this.addConst(c)}this.buffer.b+=Std.string(")")}this.buffer.b+=Std.string(" "),this.addExpr(e,tabs)}},__class__:hxsl_Printer};var hxsl_AllocParam=function(name,pos,instance,index,type){this.name=name,this.pos=pos,this.instance=instance,this.index=index,this.type=type};$hxClasses["hxsl.AllocParam"]=hxsl_AllocParam,hxsl_AllocParam.__name__="hxsl.AllocParam",hxsl_AllocParam.prototype={__class__:hxsl_AllocParam};var hxsl_AllocGlobal=function(pos,path,type){this.pos=pos,this.path=path,this.gid=hxsl_Globals.allocID(path),this.type=type};$hxClasses["hxsl.AllocGlobal"]=hxsl_AllocGlobal,hxsl_AllocGlobal.__name__="hxsl.AllocGlobal",hxsl_AllocGlobal.prototype={__class__:hxsl_AllocGlobal};var hxsl_RuntimeShaderData=function(){};$hxClasses["hxsl.RuntimeShaderData"]=hxsl_RuntimeShaderData,hxsl_RuntimeShaderData.__name__="hxsl.RuntimeShaderData",hxsl_RuntimeShaderData.prototype={__class__:hxsl_RuntimeShaderData};var hxsl_ShaderInstanceDesc=function(shader,bits){this.shader=shader,this.bits=bits};$hxClasses["hxsl.ShaderInstanceDesc"]=hxsl_ShaderInstanceDesc,hxsl_ShaderInstanceDesc.__name__="hxsl.ShaderInstanceDesc",hxsl_ShaderInstanceDesc.prototype={__class__:hxsl_ShaderInstanceDesc};var hxsl_RuntimeShader=function(){this.id=hxsl_RuntimeShader.UID++};$hxClasses["hxsl.RuntimeShader"]=hxsl_RuntimeShader,hxsl_RuntimeShader.__name__="hxsl.RuntimeShader",hxsl_RuntimeShader.prototype={__class__:hxsl_RuntimeShader};var hxsl_Serializer=function(){};$hxClasses["hxsl.Serializer"]=hxsl_Serializer,hxsl_Serializer.__name__="hxsl.Serializer",hxsl_Serializer.prototype={readVarInt:function(){var b=this.input.readByte();return b<128?b:255==b?this.input.readInt32():(127&b)<<8|this.input.readByte()},readType:function(){switch(this.input.readByte()){case 0:return hxsl_Type.TVoid;case 1:return hxsl_Type.TInt;case 2:return hxsl_Type.TBool;case 3:return hxsl_Type.TFloat;case 4:return hxsl_Type.TString;case 5:var bits=this.input.readByte();return null==(v=hxsl_Serializer.TVECS.h[bits])&&(v=hxsl_Type.TVec(7&bits,Type.createEnumIndex(hxsl_VecType,bits>>3,null)),hxsl_Serializer.TVECS.h[bits]=v),v;case 6:return hxsl_Type.TMat3;case 7:return hxsl_Type.TMat4;case 8:return hxsl_Type.TMat3x4;case 9:return hxsl_Type.TBytes(this.input.readInt32());case 10:return hxsl_Type.TSampler2D;case 11:return hxsl_Type.TSampler2DArray;case 12:return hxsl_Type.TSamplerCube;case 13:var id=this.readVarInt();if(null!=(t=this.types[id]))return t;for(var f=$bind(this,this.readVar),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){_g1++;_g.push(f())}return t=hxsl_Type.TStruct(_g),this.types[id]=t,t;case 14:return hxsl_Type.TFun(null);case 15:var t=this.readType(),v=this.readVar();return hxsl_Type.TArray(t,null==v?hxsl_SizeDecl.SConst(this.readVarInt()):hxsl_SizeDecl.SVar(v));case 16:t=this.readType(),v=this.readVar();return hxsl_Type.TBuffer(t,null==v?hxsl_SizeDecl.SConst(this.readVarInt()):hxsl_SizeDecl.SVar(v));case 17:return hxsl_Type.TChannel(this.input.readByte());default:throw haxe_Exception.thrown("assert")}},readString:function(){var len=this.readVarInt();return this.input.read(len).getString(0,len)},readConst:function(){switch(this.input.readByte()){case 0:return hxsl_Const.CNull;case 1:return hxsl_Const.CBool(0!=this.input.readByte());case 2:return hxsl_Const.CInt(this.input.readInt32());case 3:return hxsl_Const.CFloat(this.input.readDouble());case 4:return hxsl_Const.CString(this.readString());default:throw haxe_Exception.thrown("assert")}},readExpr:function(){var e,k=this.input.readByte();if(0==k--)return null;switch(k){case 0:e=hxsl_TExprDef.TConst(this.readConst());break;case 1:e=hxsl_TExprDef.TVar(this.readVar());break;case 2:e=hxsl_TExprDef.TGlobal(hxsl_Serializer.TGLOBALS[this.input.readByte()]);break;case 3:e=hxsl_TExprDef.TParenthesis(this.readExpr());break;case 4:for(var f=$bind(this,this.readExpr),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){var i=_g1++;_g.push(f())}e=hxsl_TExprDef.TBlock(_g);break;case 5:var op=this.input.readByte();e=hxsl_TExprDef.TBinop(op>=128?haxe_macro_Binop.OpAssignOp(hxsl_Serializer.BOPS[127&op]):hxsl_Serializer.BOPS[op],this.readExpr(),this.readExpr());break;case 6:e=hxsl_TExprDef.TUnop(hxsl_Serializer.UNOPS[this.input.readByte()],this.readExpr());break;case 7:e=hxsl_TExprDef.TVarDecl(this.readVar(),this.readExpr());break;case 8:var e1=this.readExpr();for(f=$bind(this,this.readExpr),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){i=_g1++;_g.push(f())}e=hxsl_TExprDef.TCall(e1,_g);break;case 9:e1=this.readExpr();var bits=this.input.readUInt16(),swiz=hxsl_Serializer.TSWIZ.h[bits];if(null==swiz){for(_g=[],_g1=0,_g2=1+(3&bits);_g1<_g2;){i=_g1++;_g.push(hxsl_Serializer.REGS[bits>>2*i+2&3])}swiz=_g,hxsl_Serializer.TSWIZ.h[bits]=swiz}e=hxsl_TExprDef.TSwiz(e1,swiz);break;case 10:e=hxsl_TExprDef.TIf(this.readExpr(),this.readExpr(),this.readExpr());break;case 11:e=hxsl_TExprDef.TDiscard;break;case 12:e=hxsl_TExprDef.TReturn(this.readExpr());break;case 13:e=hxsl_TExprDef.TFor(this.readVar(),this.readExpr(),this.readExpr());break;case 14:e=hxsl_TExprDef.TContinue;break;case 15:e=hxsl_TExprDef.TBreak;break;case 16:e=hxsl_TExprDef.TArray(this.readExpr(),this.readExpr());break;case 17:for(f=$bind(this,this.readExpr),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){i=_g1++;_g.push(f())}e=hxsl_TExprDef.TArrayDecl(_g);break;case 18:for(e1=this.readExpr(),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){i=_g1++,f=$bind(this,this.readExpr);for(var _g3=[],_g4=0,_g5=this.readVarInt();_g4<_g5;){_g4++;_g3.push(f())}_g.push({values:_g3,expr:this.readExpr()})}e=hxsl_TExprDef.TSwitch(e1,_g,this.readExpr());break;case 19:e=hxsl_TExprDef.TWhile(this.readExpr(),this.readExpr(),0!=this.input.readByte());break;case 20:for(e1=this.readString(),f=$bind(this,this.readConst),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){i=_g1++;_g.push(f())}e=hxsl_TExprDef.TMeta(e1,_g,this.readExpr());break;default:throw haxe_Exception.thrown("assert")}return{e:e,t:this.readType(),p:null}},readVar:function(){var id=this.readVarInt();if(0==id)return null;var v=this.varMap.h[id];if(null!=v)return v;v={id:hxsl_Tools.allocVarId(),name:this.readString(),type:null,kind:null},this.varMap.h[id]=v,v.type=this.readType(),v.kind=hxsl_Serializer.VKINDS[this.input.readByte()],v.parent=this.readVar();var nq=this.input.readByte();if(nq>0){v.qualifiers=[];for(var _g=0,_g1=nq;_g<_g1;){var q;_g++;switch(this.input.readByte()){case 0:var n=this.input.readInt32();q=hxsl_VarQualifier.Const(0==n?null:n);break;case 1:q=hxsl_VarQualifier.Private;break;case 2:q=hxsl_VarQualifier.Nullable;break;case 3:q=hxsl_VarQualifier.PerObject;break;case 4:q=hxsl_VarQualifier.Name(this.readString());break;case 5:q=hxsl_VarQualifier.Shared;break;case 6:q=hxsl_VarQualifier.Precision(hxsl_Serializer.PRECS[this.input.readByte()]);break;case 7:q=hxsl_VarQualifier.Range(this.input.readDouble(),this.input.readDouble());break;case 8:q=hxsl_VarQualifier.Ignore;break;case 9:q=hxsl_VarQualifier.PerInstance(this.input.readInt32());break;default:throw haxe_Exception.thrown("assert")}v.qualifiers.push(q)}}return v},readFun:function(){for(var tmp=hxsl_Serializer.FKIND[this.input.readByte()],tmp1=this.readVar(),f=$bind(this,this.readVar),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){_g1++;_g.push(f())}return{kind:tmp,ref:tmp1,args:_g,ret:this.readType(),expr:this.readExpr()}},unserialize:function(data){if(this.input=new haxe_io_BytesInput(haxe_crypto_Base64.decode(data,!1)),this.input.readByte()!=(255&hxsl_Serializer.SIGN)||this.input.readByte()!=(hxsl_Serializer.SIGN>>8&255)||this.input.readByte()!=(hxsl_Serializer.SIGN>>16&255))throw haxe_Exception.thrown("Invalid HXSL data");this.varMap=new haxe_ds_IntMap,this.types=[];for(var tmp=this.readString(),f=$bind(this,this.readVar),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){_g1++;_g.push(f())}var tmp1=_g;for(f=$bind(this,this.readFun),_g=[],_g1=0,_g2=this.readVarInt();_g1<_g2;){_g1++;_g.push(f())}return{name:tmp,vars:tmp1,funs:_g}},__class__:hxsl_Serializer};var hxsl_ShaderList=function(s,n){this.s=s,this.next=n};$hxClasses["hxsl.ShaderList"]=hxsl_ShaderList,hxsl_ShaderList.__name__="hxsl.ShaderList",hxsl_ShaderList.addSort=function(s,shaders){for(var prev=null,hd=shaders;null!=hd&&hd.s.priority<s.priority;)prev=hd,hd=hd.next;return null==prev?new hxsl_ShaderList(s,shaders):(prev.next=new hxsl_ShaderList(s,prev.next),shaders)},hxsl_ShaderList.prototype={__class__:hxsl_ShaderList};var hxsl_ShaderInstance=function(shader){this.id=hxsl_Tools.allocVarId(),this.shader=shader,this.params=new haxe_ds_IntMap};$hxClasses["hxsl.ShaderInstance"]=hxsl_ShaderInstance,hxsl_ShaderInstance.__name__="hxsl.ShaderInstance",hxsl_ShaderInstance.prototype={__class__:hxsl_ShaderInstance};var hxsl_ShaderGlobal=function(v,gid){this.v=v,this.globalId=gid};$hxClasses["hxsl.ShaderGlobal"]=hxsl_ShaderGlobal,hxsl_ShaderGlobal.__name__="hxsl.ShaderGlobal",hxsl_ShaderGlobal.prototype={__class__:hxsl_ShaderGlobal};var hxsl_ShaderConst=function(v,pos,bits){this.v=v,this.pos=pos,this.bits=bits};$hxClasses["hxsl.ShaderConst"]=hxsl_ShaderConst,hxsl_ShaderConst.__name__="hxsl.ShaderConst",hxsl_ShaderConst.prototype={__class__:hxsl_ShaderConst};var hxsl_SharedShader=function(src){this.instanceCache=new haxe_ds_IntMap,this.consts=null,this.globals=[],""!=src&&(this.data=(new hxsl_Serializer).unserialize(src),this.initialize())};$hxClasses["hxsl.SharedShader"]=hxsl_SharedShader,hxsl_SharedShader.__name__="hxsl.SharedShader",hxsl_SharedShader.prototype={initialize:function(){for(var _g=0,_g1=this.data.vars;_g<_g1.length;){var v=_g1[_g];++_g,this.browseVar(v)}},makeInstance:function(constBits){for(var $eval=new hxsl_Eval,c=this.consts;null!=c;){var tmp,c1=c.v;switch((_g=c.v.type)._hx_index){case 1:tmp=hxsl_Const.CInt(constBits>>>c.pos&(1<<c.bits)-1);break;case 2:tmp=hxsl_Const.CBool(0!=(constBits>>>c.pos&1));break;case 17:var _g1=_g.size;tmp=hxsl_Const.CInt(constBits>>>c.pos&(1<<c.bits)-1);break;default:throw haxe_Exception.thrown("assert")}$eval.setConstant(c1,tmp),c=c.next}$eval.inlineCalls=!0,$eval.unrollLoops=hxsl_SharedShader.UNROLL_LOOPS;var i=new hxsl_ShaderInstance($eval.eval(this.data));this.paramsCount=0;var _g=0;for(_g1=this.data.vars;_g<_g1.length;){var v=_g1[_g];++_g,this.addParam($eval,i,v)}return this.instanceCache.h[constBits]=i,i},addParam:function($eval,i,v){if(13==(_g=v.type)._hx_index)for(var vl=_g.vl,_g=0;_g<vl.length;){var v1=vl[_g];++_g,this.addParam($eval,i,v1)}else v.kind==hxsl_VarKind.Param&&(i.params.h[$eval.varMap.h[v.__id__].id]=this.paramsCount,this.paramsCount++)},browseVar:function(v,path){if(v.id=hxsl_Tools.allocVarId(),null==path?path=hxsl_Tools.getName(v):path+="."+v.name,13==(_g=v.type)._hx_index)for(var vl=_g.vl,_g=0;_g<vl.length;){var vs=vl[_g];++_g,this.browseVar(vs,path)}else{var globalId=0;if(v.kind==hxsl_VarKind.Global&&(globalId=hxsl_Globals.allocID(path),this.globals.push(new hxsl_ShaderGlobal(v,globalId))),!hxsl_Tools.isConst(v))return;var bits=hxsl_Tools.getConstBits(v);if(bits>0){var pos=null==this.consts?0:this.consts.pos+this.consts.bits,c=new hxsl_ShaderConst(v,pos,bits);c.globalId=globalId,c.next=this.consts,this.consts=c}}},__class__:hxsl_SharedShader};var hxsl__$Splitter_VarProps=function(v){this.v=v,this.read=0,this.write=0};$hxClasses["hxsl._Splitter.VarProps"]=hxsl__$Splitter_VarProps,hxsl__$Splitter_VarProps.__name__="hxsl._Splitter.VarProps",hxsl__$Splitter_VarProps.prototype={__class__:hxsl__$Splitter_VarProps};var hxsl_Splitter=function(){};$hxClasses["hxsl.Splitter"]=hxsl_Splitter,hxsl_Splitter.__name__="hxsl.Splitter",hxsl_Splitter.prototype={split:function(s){var vfun=null,vvars=new haxe_ds_IntMap,ffun=null,fvars=new haxe_ds_IntMap;this.varNames=new haxe_ds_StringMap,this.varMap=new haxe_ds_ObjectMap;for(var _g=0,_g1=s.funs;_g<_g1.length;){var f=_g1[_g];switch(++_g,f.kind._hx_index){case 0:this.vars=vvars,vfun=f,this.checkExpr(f.expr);break;case 1:this.vars=fvars,ffun=f,this.checkExpr(f.expr);break;default:throw haxe_Exception.thrown("assert")}}vfun={ret:vfun.ret,ref:vfun.ref,kind:vfun.kind,args:vfun.args,expr:this.mapVars(vfun.expr)};var _g=0;for(_g1=Lambda.array(vvars);_g<_g1.length;){var inf=_g1[_g];switch(++_g,(v=inf.v).kind._hx_index){case 3:case 4:v.kind=fvars.h.hasOwnProperty(v.id)?hxsl_VarKind.Var:hxsl_VarKind.Local}switch(v.kind._hx_index){case 3:case 5:if(inf.read>0||inf.write>1){var nv={id:hxsl_Tools.allocVarId(),name:v.name,kind:v.kind,type:v.type};this.vars=vvars;this.get(nv);v.kind=hxsl_VarKind.Local;var p=vfun.expr.p,e={e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAssign,{e:hxsl_TExprDef.TVar(nv),t:nv.type,p:p},{e:hxsl_TExprDef.TVar(v),t:v.type,p:p}),t:nv.type,p:p};if(this.addExpr(vfun,e),this.checkExpr(e),nv.kind==hxsl_VarKind.Var){var old=fvars.h[v.id];this.varMap.set(v,nv),fvars.remove(v.id);var np=new hxsl__$Splitter_VarProps(nv);np.read=old.read,np.write=old.write,fvars.h[nv.id]=np}}}}var finits=[],todo=[];for(inf=fvars.iterator();inf.hasNext();){var inf1=inf.next();switch((v=inf1.v).kind._hx_index){case 1:nv={id:hxsl_Tools.allocVarId(),name:v.name,kind:hxsl_VarKind.Var,type:v.type};this.uniqueName(nv);var i=vvars.h[v.id];null==i&&(i=new hxsl__$Splitter_VarProps(v),vvars.h[v.id]=i),i.read++;var vp=new hxsl__$Splitter_VarProps(nv);vp.write=1,vvars.h[nv.id]=vp;var fp=new hxsl__$Splitter_VarProps(nv);fp.read=1,todo.push(fp),this.addExpr(vfun,{e:hxsl_TExprDef.TBinop(haxe_macro_Binop.OpAssign,{e:hxsl_TExprDef.TVar(nv),t:v.type,p:vfun.expr.p},{e:hxsl_TExprDef.TVar(v),t:v.type,p:vfun.expr.p}),t:v.type,p:vfun.expr.p}),this.varMap.set(v,nv),inf1.local=!0;break;case 3:if(inf1.write>0){var nv1={id:hxsl_Tools.allocVarId(),name:v.name,kind:hxsl_VarKind.Local,type:v.type};this.uniqueName(nv1),finits.push({e:hxsl_TExprDef.TVarDecl(nv1,{e:hxsl_TExprDef.TVar(v),t:v.type,p:ffun.expr.p}),t:hxsl_Type.TVoid,p:ffun.expr.p}),this.varMap.set(v,nv1)}}}for(_g=0;_g<todo.length;){var v=todo[_g];++_g,fvars.h[v.v.id]=v}for(v=vvars.iterator();v.hasNext();){var v1=v.next();this.checkVar(v1,!0,vvars,vfun.expr.p)}for(v=fvars.iterator();v.hasNext();){v1=v.next();this.checkVar(v1,!1,vvars,ffun.expr.p)}for(v=this.varMap.keys();v.hasNext();){v1=v.next();var v2=this.varMap.h[this.varMap.h[v1.__id__].__id__];null!=v2&&this.varMap.set(v1,v2)}if(4==(_g=(ffun={ret:ffun.ret,ref:ffun.ref,kind:ffun.kind,args:ffun.args,expr:this.mapVars(ffun.expr)}).expr.e)._hx_index){var el=_g.el;for(_g=0;_g<finits.length;){e=finits[_g];++_g,el.unshift(e)}}else finits.push(ffun.expr),ffun.expr={e:hxsl_TExprDef.TBlock(finits),t:hxsl_Type.TVoid,p:ffun.expr.p};for(_g=[],v=vvars.iterator();v.hasNext();){(v1=v.next()).local||_g.push(v1.v)}for(vvars=_g,_g=[],v=fvars.iterator();v.hasNext();){(v1=v.next()).local||_g.push(v1.v)}fvars=_g;return vvars.sort((function(v1,v2){return v1.id-v2.id})),fvars.sort((function(v1,v2){return v1.id-v2.id})),{vertex:{name:"vertex",vars:vvars,funs:[vfun]},fragment:{name:"fragment",vars:fvars,funs:[ffun]}}},addExpr:function(f,e){var _g=f.expr.e;4==_g._hx_index?_g.el.push(e):f.expr={e:hxsl_TExprDef.TBlock([f.expr,e]),t:hxsl_Type.TVoid,p:f.expr.p}},checkVar:function(v,vertex,vvars,p){switch(v.v.kind._hx_index){case 3:if(!vertex){var i=vvars.h[v.v.id];if(null==i||0==i.write)throw haxe_Exception.thrown(new hxsl_Error("Varying "+v.v.name+" is not written by vertex shader",p))}break;case 4:if(v.requireInit)throw haxe_Exception.thrown(new hxsl_Error("Variable "+v.v.name+" is used without being initialized",p))}},mapVars:function(e){var _g=e.e;switch(_g._hx_index){case 1:var v=_g.v;return null==(v2=this.varMap.h[v.__id__])?e:{e:hxsl_TExprDef.TVar(v2),t:e.t,p:e.p};case 7:var init=_g.init;v=_g.v;return null==(v2=this.varMap.h[v.__id__])?hxsl_Tools.map(e,$bind(this,this.mapVars)):{e:hxsl_TExprDef.TVarDecl(v2,this.mapVars(init)),t:e.t,p:e.p};case 13:var v2,loop=_g.loop,it=_g.it;v=_g.v;return null==(v2=this.varMap.h[v.__id__])?hxsl_Tools.map(e,$bind(this,this.mapVars)):{e:hxsl_TExprDef.TFor(v2,this.mapVars(it),this.mapVars(loop)),t:e.t,p:e.p};default:return hxsl_Tools.map(e,$bind(this,this.mapVars))}},get:function(v){var i=this.vars.h[v.id];if(null==i){var v2=this.varMap.h[v.__id__];if(null!=v2)return this.get(v2);var oldName=v.name;if(this.uniqueName(v),v.kind==hxsl_VarKind.Local&&oldName!=v.name){var nv={id:hxsl_Tools.allocVarId(),name:v.name,kind:v.kind,type:v.type};this.varMap.set(v,nv),v.name=oldName,v=nv}i=new hxsl__$Splitter_VarProps(v),this.vars.h[v.id]=i}return i},uniqueName:function(v){if(v.kind!=hxsl_VarKind.Global&&v.kind!=hxsl_VarKind.Output&&v.kind!=hxsl_VarKind.Input){v.parent=null;var n=this.varNames.h[v.name];if(null!=n&&n!=v){for(var prefix=v.name;HxOverrides.cca(prefix,prefix.length-1)>=48&&HxOverrides.cca(prefix,prefix.length-1)<=57;)prefix=HxOverrides.substr(prefix,0,-1);for(var k=prefix==v.name?2:Std.parseInt(HxOverrides.substr(v.name,prefix.length,null));Object.prototype.hasOwnProperty.call(this.varNames.h,prefix+k);)++k;v.name=prefix+k}this.varNames.h[v.name]=v}},checkExpr:function(e){var _g=e.e;switch(_g._hx_index){case 1:var v=_g.v;0==(inf=this.get(v)).write&&(inf.requireInit=!0),inf.read++;break;case 5:var _g1=_g.e2,_g2=_g.e1;switch((_g3=_g.op)._hx_index){case 4:var _g4=_g2.t;_g4=_g2.p;switch((_g4=_g2.e)._hx_index){case 1:var e1=_g1;v=_g4.v;(inf=this.get(v)).write++,this.checkExpr(e1);break;case 9:var _g5=_g4.regs;_g4=(_g5=_g4.e).t,_g4=_g5.p;if(1==(_g4=_g5.e)._hx_index){e1=_g1,v=_g4.v;(inf=this.get(v)).write++,this.checkExpr(e1)}else hxsl_Tools.iter(e,$bind(this,this.checkExpr));break;default:hxsl_Tools.iter(e,$bind(this,this.checkExpr))}break;case 20:_g4=_g3.op;var _g3=_g2.t;_g3=_g2.p;switch((_g3=_g2.e)._hx_index){case 1:e1=_g1,v=_g3.v;0==(inf=this.get(v)).write&&(inf.requireInit=!0),inf.read++,inf.write++,this.checkExpr(e1);break;case 9:_g2=_g3.regs,_g3=(_g2=_g3.e).t,_g3=_g2.p;if(1==(_g3=_g2.e)._hx_index){e1=_g1,v=_g3.v;0==(inf=this.get(v)).write&&(inf.requireInit=!0),inf.read++,inf.write++,this.checkExpr(e1)}else hxsl_Tools.iter(e,$bind(this,this.checkExpr));break;default:hxsl_Tools.iter(e,$bind(this,this.checkExpr))}break;default:hxsl_Tools.iter(e,$bind(this,this.checkExpr))}break;case 7:var init=_g.init;v=_g.v;(inf=this.get(v)).local=!0,null!=init&&(this.checkExpr(init),inf.write++);break;case 13:var inf,loop=_g.loop,it=_g.it;v=_g.v;this.checkExpr(it),(inf=this.get(v)).local=!0,inf.write++,this.checkExpr(loop);break;default:hxsl_Tools.iter(e,$bind(this,this.checkExpr))}},__class__:hxsl_Splitter};var js_html__$CanvasElement_CanvasUtil=function(){};$hxClasses["js.html._CanvasElement.CanvasUtil"]=js_html__$CanvasElement_CanvasUtil,js_html__$CanvasElement_CanvasUtil.__name__="js.html._CanvasElement.CanvasUtil",js_html__$CanvasElement_CanvasUtil.getContextWebGL=function(canvas,attribs){var name="webgl";if(null!=(ctx=canvas.getContext(name,attribs)))return ctx;var ctx;name="experimental-webgl";return null!=(ctx=canvas.getContext(name,attribs))?ctx:null},Math.__name__="Math";var reckoner_TmpVec2D=function(x,y){this.x=x,this.y=y};$hxClasses["reckoner.TmpVec2D"]=reckoner_TmpVec2D,reckoner_TmpVec2D.__name__="reckoner.TmpVec2D",reckoner_TmpVec2D.prototype={__class__:reckoner_TmpVec2D};var scenes_PlayScene=function(heapsScene,timersCapacity){broker_scene_heaps_Scene.call(this,heapsScene,timersCapacity)};$hxClasses["scenes.PlayScene"]=scenes_PlayScene,scenes_PlayScene.__name__="scenes.PlayScene",scenes_PlayScene.__super__=broker_scene_heaps_Scene,scenes_PlayScene.prototype=$extend(broker_scene_heaps_Scene.prototype,{initialize:function(){broker_scene_heaps_Scene.prototype.initialize.call(this),this.world=new World;var worldArea=this.world.area,this1=2;worldArea.posChanged=!0,worldArea.x=broker_App.width/this1-.5*worldArea.width,worldArea.posChanged=!0,worldArea.y=broker_App.height/2-.5*worldArea.height,this.layers.main.addChild(worldArea);this1=this.world;Global.world=this1},update:function(){broker_scene_heaps_Scene.prototype.update.call(this),this.world.update()},__class__:scenes_PlayScene});var sinker_extensions_StringExtension=function(){};$hxClasses["sinker.extensions.StringExtension"]=sinker_extensions_StringExtension,sinker_extensions_StringExtension.__name__="sinker.extensions.StringExtension";var sneaker_exception_Exception=function(content,callStack,appendCallStack,pos){if(this.content=content,this.appendCallStack=null!=appendCallStack?appendCallStack:sneaker_exception_ExceptionSettings.appendCallStackDefault,null!=callStack)this.callStack=callStack;else{var currentCallStack=haxe_CallStack.callStack();currentCallStack.shift(),this.callStack=currentCallStack}this.positionInformation=pos};$hxClasses["sneaker.exception.Exception"]=sneaker_exception_Exception,sneaker_exception_Exception.__name__="sneaker.exception.Exception",sneaker_exception_Exception.prototype={toString:function(){var classObject=js_Boot.getClass(this),name=null!=classObject?classObject.__name__:"sneaker.exception.Exception";return this.appendCallStack?name+"\n"+this.content+"\nCall Stack:\n"+sneaker_exception_ExceptionSettings.callStackFormat(this.callStack):name+"\n"+this.content},__class__:sneaker_exception_Exception};var sneaker_format_CallStackItemExtension=function(){};$hxClasses["sneaker.format.CallStackItemExtension"]=sneaker_format_CallStackItemExtension,sneaker_format_CallStackItemExtension.__name__="sneaker.format.CallStackItemExtension",sneaker_format_CallStackItemExtension.format=function(item){if(null==item)return"null";switch(item._hx_index){case 0:return Std.string(item);case 1:var m=item.m;return sneaker_format_CallStackItemFormat.formatModule(m);case 2:var column=item.column,line=item.line,file=item.file,s=item.s;return sneaker_format_CallStackItemFormat.formatFilePos(s,file,line,column);case 3:var methodName=item.method,className=item.classname;return sneaker_format_CallStackItemFormat.formatMethod(className,methodName);case 4:var v=item.v;return sneaker_format_CallStackItemFormat.formatLocalFunction(v)}},sneaker_format_CallStackItemExtension.formatStackIndent=function(stack,indent){null==indent&&(indent="  ");var separator="\n"+indent,buffer_b="";buffer_b+=null==indent?"null":""+indent,buffer_b+=Std.string(sneaker_format_CallStackItemExtension.format(stack[0]));for(var _g=1,_g1=stack.length;_g<_g1;){var i=_g++;buffer_b+=null==separator?"null":""+separator,buffer_b+=Std.string(sneaker_format_CallStackItemExtension.format(stack[i]))}return buffer_b};var sneaker_format_CallStackItemFormat=function(){};$hxClasses["sneaker.format.CallStackItemFormat"]=sneaker_format_CallStackItemFormat,sneaker_format_CallStackItemFormat.__name__="sneaker.format.CallStackItemFormat",sneaker_format_CallStackItemFormat.formatLineColumn=function(line,column){return"line "+line+(null!=column?", col "+column:"")},sneaker_format_CallStackItemFormat.formatModule=function(module){return module},sneaker_format_CallStackItemFormat.formatFilePos=function(s,file,line,column){return""+(sneaker_format_CallStackItemFormat.hideFilePath?"":file+sneaker_format_CallStackItemFormat.separator)+sneaker_format_CallStackItemExtension.format(s)+sneaker_format_CallStackItemFormat.separator+sneaker_format_CallStackItemFormat.formatLineColumn(line,column)},sneaker_format_CallStackItemFormat.formatClass=function(className){if(null!=className){var tmp;if(sneaker_format_CallStackItemFormat.hidePackagePath){var searchString=sinker_extensions_StringExtension.dot;tmp=HxOverrides.substr(className,className.lastIndexOf(searchString)+1,null)}else tmp=className;return""+tmp}return"?"},sneaker_format_CallStackItemFormat.formatMethod=function(className,methodName){return sneaker_format_CallStackItemFormat.formatClass(className)+"::"+methodName},sneaker_format_CallStackItemFormat.formatLocalFunction=function(v){return"fn "+v};var sneaker_format_CallStackItemCallbacks=function(){};$hxClasses["sneaker.format.CallStackItemCallbacks"]=sneaker_format_CallStackItemCallbacks,sneaker_format_CallStackItemCallbacks.__name__="sneaker.format.CallStackItemCallbacks";var sneaker_exception_ExceptionSettings=function(){};$hxClasses["sneaker.exception.ExceptionSettings"]=sneaker_exception_ExceptionSettings,sneaker_exception_ExceptionSettings.__name__="sneaker.exception.ExceptionSettings";var sneaker_exception_NotOverriddenException=function(appendCallStack,pos){var currentCallStack=haxe_CallStack.callStack();currentCallStack.shift();var methodPosition=sneaker_format_PosInfosExtension.formatClassMethod(pos);sneaker_exception_Exception.call(this,"This method must be overridden by a subclass.\nPosition: "+methodPosition,currentCallStack,appendCallStack,pos)};$hxClasses["sneaker.exception.NotOverriddenException"]=sneaker_exception_NotOverriddenException,sneaker_exception_NotOverriddenException.__name__="sneaker.exception.NotOverriddenException",sneaker_exception_NotOverriddenException.__super__=sneaker_exception_Exception,sneaker_exception_NotOverriddenException.prototype=$extend(sneaker_exception_Exception.prototype,{__class__:sneaker_exception_NotOverriddenException});var sneaker_format_PosInfosExtension=function(){};$hxClasses["sneaker.format.PosInfosExtension"]=sneaker_format_PosInfosExtension,sneaker_format_PosInfosExtension.__name__="sneaker.format.PosInfosExtension",sneaker_format_PosInfosExtension.formatClassMethod=function(pos){return null==pos?sneaker_format_PosInfosExtension.noPositionInfo:pos.className+"::"+pos.methodName};var sneaker_print_PrinterCallbacks=function(){};$hxClasses["sneaker.print.PrinterCallbacks"]=sneaker_print_PrinterCallbacks,sneaker_print_PrinterCallbacks.__name__="sneaker.print.PrinterCallbacks",sneaker_print_PrinterCallbacks.printDirect=function(s){sneaker_print_Printer.lastPrinted=s,console.log(s)};var sneaker_string_$buffer_StringBufferBox=function(onFull,maxLength,maxCount){null==maxCount&&(maxCount=1024),null==maxLength&&(maxLength=8192),this.buffer=new sneaker_string_$buffer_CensoredStringBuffer,this.onFull=onFull,this.maxLength=maxLength,this.maxCount=maxCount,this.currentCount=0};$hxClasses["sneaker.string_buffer.StringBufferBox"]=sneaker_string_$buffer_StringBufferBox,sneaker_string_$buffer_StringBufferBox.__name__="sneaker.string_buffer.StringBufferBox",sneaker_string_$buffer_StringBufferBox.prototype={__class__:sneaker_string_$buffer_StringBufferBox};var sneaker_string_$buffer_interfaces_StringBuffer=function(){};$hxClasses["sneaker.string_buffer.interfaces.StringBuffer"]=sneaker_string_$buffer_interfaces_StringBuffer,sneaker_string_$buffer_interfaces_StringBuffer.__name__="sneaker.string_buffer.interfaces.StringBuffer",sneaker_string_$buffer_interfaces_StringBuffer.__isInterface__=!0,sneaker_string_$buffer_interfaces_StringBuffer.prototype={__class__:sneaker_string_$buffer_interfaces_StringBuffer};var sneaker_string_$buffer_CensoredStringBuffer=function(onAdd){this.data=new StringBuf,this.onAdd=null!=onAdd?onAdd:sneaker_string_$buffer_CensoredStringBuffer.defaultOnAdd};$hxClasses["sneaker.string_buffer.CensoredStringBuffer"]=sneaker_string_$buffer_CensoredStringBuffer,sneaker_string_$buffer_CensoredStringBuffer.__name__="sneaker.string_buffer.CensoredStringBuffer",sneaker_string_$buffer_CensoredStringBuffer.__interfaces__=[sneaker_string_$buffer_interfaces_StringBuffer],sneaker_string_$buffer_CensoredStringBuffer.defaultOnAdd=function(_s){return!0},sneaker_string_$buffer_CensoredStringBuffer.prototype={add:function(x){var s=Std.string(x);this.onAdd(s)&&(this.data.b+=null==s?"null":""+s)},__class__:sneaker_string_$buffer_CensoredStringBuffer};var sneaker_print_Printer=function(){};$hxClasses["sneaker.print.Printer"]=sneaker_print_Printer,sneaker_print_Printer.__name__="sneaker.print.Printer",sneaker_print_Printer.println_String=function(s){if(sneaker_print_PrinterSettings.useBuffer)return sneaker_print_Printer.lastBuffered=s,void sneaker_print_Printer.buffer.buffer.add((null==s?"null":""+s)+"\n");sneaker_print_Printer.lastPrinted=s,console.log(s)};var sneaker_print_PrinterSettings=function(){};$hxClasses["sneaker.print.PrinterSettings"]=sneaker_print_PrinterSettings,sneaker_print_PrinterSettings.__name__="sneaker.print.PrinterSettings";var sneaker_string_$buffer_StringBuffer=function(){StringBuf.call(this)};$hxClasses["sneaker.string_buffer.StringBuffer"]=sneaker_string_$buffer_StringBuffer,sneaker_string_$buffer_StringBuffer.__name__="sneaker.string_buffer.StringBuffer",sneaker_string_$buffer_StringBuffer.__interfaces__=[sneaker_string_$buffer_interfaces_StringBuffer],sneaker_string_$buffer_StringBuffer.__super__=StringBuf,sneaker_string_$buffer_StringBuffer.prototype=$extend(StringBuf.prototype,{__class__:sneaker_string_$buffer_StringBuffer});var sneaker_tag_Tag=function(name,bits){null==bits&&(bits=-1),this.internalName=name,this.internalBits=bits};$hxClasses["sneaker.tag.Tag"]=sneaker_tag_Tag,sneaker_tag_Tag.__name__="sneaker.tag.Tag",sneaker_tag_Tag.prototype={__class__:sneaker_tag_Tag};var sneaker_tag_Tags=function(){};function $bind(o,m){return null==m?null:(null==m.__id__&&(m.__id__=$global.$haxeUID++),null==o.hx__closures__?o.hx__closures__={}:f=o.hx__closures__[m.__id__],null==f&&(f=m.bind(o),o.hx__closures__[m.__id__]=f),f);var f}$hxClasses["sneaker.tag.Tags"]=sneaker_tag_Tags,sneaker_tag_Tags.__name__="sneaker.tag.Tags",$global.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(HxOverrides.now=performance.now.bind(performance)),$hxClasses.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(c){return c<65536?String.fromCharCode(c):String.fromCharCode(55232+(c>>10))+String.fromCharCode(56320+(1023&c))}),String.prototype.__class__=$hxClasses.String=String,String.__name__="String",$hxClasses.Array=Array,Array.__name__="Array",Date.prototype.__class__=$hxClasses.Date=Date,Date.__name__="Date";var pool,this1,vector,ops,_g,Int={},Dynamic={},Float=Number,Bool=Boolean,Class={},Enum={};js_Boot.__toStr={}.toString,haxe_Resource.content=[{name:"R_bullet_png",data:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAT0lEQVQ4T2P04ZjZwEABYAQZwPifgZ8cM/4zMnyEG8DM+G8iKYb8/c+UP2rAaBhA0gHTh+GUkEjJBzC10DCYXQ8R+MeIMITpPyofl/FM/wGIxnTktEiRwAAAAABJRU5ErkJggg"},{name:"R_agent_png",data:"iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAxklEQVRoQ+2asQ2DMBQFjWiyRgZijQzFGgyUNdKgoDRIFIhrTtjOc/30/P9daQ+l8TM0Pn/pa4HpMX9bMLJ8Xjv4g4FuFhjL+qzRxFrG92+uSwNZQNIXAxJYXBsDGJUUjAEJLK6NAYxKCsaABBbXxgBGJQVjQAKLa2MAo5KCMSCBxbUxgFFJwRiQwOLaGMCopGAMSGBxbQxgVFIwBiSwuDYGMCopGAMSWFz7PwYwkpuCl6+UN82Frz1dADdUFOzrr0RFYPEoG56yGkDaBNqaAAAAAElFTkSuQmCC"}],haxe_ds_ObjectMap.count=0,haxe_MainLoop.add(hxd_System.updateCursor,-1),Global.world=null,broker_App.frameCount=0,actor_ArmyBuilder.defaultChunkCapacity=64,banker_binary_BytesData.hexChars=function($this){for(var _this="0123456789abcdef".split(""),result=new Array(_this.length),_g=0,_g1=_this.length;_g<_g1;){var tmp,i=_g++,charCode=HxOverrides.cca(_this[i],0);if(null==charCode)throw haxe_Exception.thrown(sinker_errors_Errors.emptyString());tmp=charCode,result[i]=tmp}return result.slice(0)}(),hxd_Pad.CONFIG_JS_STD={A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,back:8,start:9,analogClick:10,ranalogClick:11,dpadUp:12,dpadDown:13,dpadLeft:14,dpadRight:15,analogX:17,analogY:18,ranalogX:19,ranalogY:20,names:["A","B","X","Y","LB","RB","LT","RT","Select","Start","LCLK","RCLK","DUp","DDown","DLeft","DRight","LX","LY","RX","RY"]},hxd_Pad.CONFIG_JS_DS4={A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,back:8,start:9,analogClick:10,ranalogClick:11,dpadUp:12,dpadDown:13,dpadLeft:14,dpadRight:15,analogX:18,analogY:19,ranalogX:20,ranalogY:21,names:["A","B","X","Y","LB","RB","LT","RT","Select","Start","LCLK","RCLK","DUp","DDown","DLeft","DRight","LX","LY","RX","RY"]},hxd_Pad.CONFIG_JS_DS4_FF={A:1,B:2,X:0,Y:3,LB:4,RB:5,LT:6,RT:7,back:8,start:9,analogClick:10,ranalogClick:11,dpadUp:9e3,dpadDown:9e3,dpadLeft:9e3,dpadRight:9e3,analogX:18,analogY:19,ranalogX:20,ranalogY:23,names:["A","B","X","Y","LB","RB","LT","RT","Select","Start","LCLK","RCLK","DUp","DDown","DLeft","DRight","LX","LY","RX","RY"]},hxd_Pad.DEFAULT_CONFIG=hxd_Pad.CONFIG_JS_STD,hxd_Pad.initDone=!1,hxd_Pad.pads=new haxe_ds_IntMap,broker_input_physical_heaps_Pad.NULL=hxd_Pad.createDummy(),broker_input_physical_PadMultitap.ports=broker_input_physical_PadMultitap.createPorts(8),broker_scene_heaps_SceneStatics.bitmapFadeOutTimerPool=((pool=new broker_timer_builtin_heaps_FadeOutTimerPool_$h2d_$Bitmap(4)).newTag("Scene FadeOutTimer pool"),pool),broker_sound_SoundManager.frameCount=0,broker_sound_SoundManager.masterVolumeChangeTimer=(this1=null,(vector=new Array(1))[0]=this1,this1=vector),broker_sound_SoundManager.queuedSounds=new banker_map_ArrayMap_$broker_$sound_$Sound_$sinker_$UInt(1),firedancer_script_Api.position=new firedancer_script_api_$components_Position,firedancer_script_Api.velocity=new firedancer_script_api_$components_Velocity,firedancer_script_Api.shot=new firedancer_script_api_$components_Shot,firedancer_script_Api.random=new firedancer_script_api_$components_Random,firedancer_vm_CompilerFlags.version=new prayer_CompilerFlag("firedancer-vm",(function(){return"0.1.0-alpha"}),(function(define){return null!=define?haxe_ds_Option.Some(Std.string(define)):haxe_ds_Option.None}),prayer_CompilerFlagType.Optional("0.0.0")),format_mp3_MPEG.Reserved=1,format_mp3_MPEG.V1_Bitrates=[[format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad],[format_mp3_Bitrate.BR_Free,format_mp3_Bitrate.BR_32,format_mp3_Bitrate.BR_40,format_mp3_Bitrate.BR_48,format_mp3_Bitrate.BR_56,format_mp3_Bitrate.BR_64,format_mp3_Bitrate.BR_80,format_mp3_Bitrate.BR_96,format_mp3_Bitrate.BR_112,format_mp3_Bitrate.BR_128,format_mp3_Bitrate.BR_160,format_mp3_Bitrate.BR_192,format_mp3_Bitrate.BR_224,format_mp3_Bitrate.BR_256,format_mp3_Bitrate.BR_320,format_mp3_Bitrate.BR_Bad],[format_mp3_Bitrate.BR_Free,format_mp3_Bitrate.BR_32,format_mp3_Bitrate.BR_48,format_mp3_Bitrate.BR_56,format_mp3_Bitrate.BR_64,format_mp3_Bitrate.BR_80,format_mp3_Bitrate.BR_96,format_mp3_Bitrate.BR_112,format_mp3_Bitrate.BR_128,format_mp3_Bitrate.BR_160,format_mp3_Bitrate.BR_192,format_mp3_Bitrate.BR_224,format_mp3_Bitrate.BR_256,format_mp3_Bitrate.BR_320,format_mp3_Bitrate.BR_384,format_mp3_Bitrate.BR_Bad],[format_mp3_Bitrate.BR_Free,format_mp3_Bitrate.BR_32,format_mp3_Bitrate.BR_64,format_mp3_Bitrate.BR_96,format_mp3_Bitrate.BR_128,format_mp3_Bitrate.BR_160,format_mp3_Bitrate.BR_192,format_mp3_Bitrate.BR_224,format_mp3_Bitrate.BR_256,format_mp3_Bitrate.BR_288,format_mp3_Bitrate.BR_320,format_mp3_Bitrate.BR_352,format_mp3_Bitrate.BR_384,format_mp3_Bitrate.BR_416,format_mp3_Bitrate.BR_448,format_mp3_Bitrate.BR_Bad]],format_mp3_MPEG.V2_Bitrates=[[format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad,format_mp3_Bitrate.BR_Bad],[format_mp3_Bitrate.BR_Free,format_mp3_Bitrate.BR_8,format_mp3_Bitrate.BR_16,format_mp3_Bitrate.BR_24,format_mp3_Bitrate.BR_32,format_mp3_Bitrate.BR_40,format_mp3_Bitrate.BR_48,format_mp3_Bitrate.BR_56,format_mp3_Bitrate.BR_64,format_mp3_Bitrate.BR_80,format_mp3_Bitrate.BR_96,format_mp3_Bitrate.BR_112,format_mp3_Bitrate.BR_128,format_mp3_Bitrate.BR_144,format_mp3_Bitrate.BR_160,format_mp3_Bitrate.BR_Bad],[format_mp3_Bitrate.BR_Free,format_mp3_Bitrate.BR_8,format_mp3_Bitrate.BR_16,format_mp3_Bitrate.BR_24,format_mp3_Bitrate.BR_32,format_mp3_Bitrate.BR_40,format_mp3_Bitrate.BR_48,format_mp3_Bitrate.BR_56,format_mp3_Bitrate.BR_64,format_mp3_Bitrate.BR_80,format_mp3_Bitrate.BR_96,format_mp3_Bitrate.BR_112,format_mp3_Bitrate.BR_128,format_mp3_Bitrate.BR_144,format_mp3_Bitrate.BR_160,format_mp3_Bitrate.BR_Bad],[format_mp3_Bitrate.BR_Free,format_mp3_Bitrate.BR_32,format_mp3_Bitrate.BR_48,format_mp3_Bitrate.BR_56,format_mp3_Bitrate.BR_64,format_mp3_Bitrate.BR_80,format_mp3_Bitrate.BR_96,format_mp3_Bitrate.BR_112,format_mp3_Bitrate.BR_128,format_mp3_Bitrate.BR_144,format_mp3_Bitrate.BR_160,format_mp3_Bitrate.BR_176,format_mp3_Bitrate.BR_192,format_mp3_Bitrate.BR_224,format_mp3_Bitrate.BR_256,format_mp3_Bitrate.BR_Bad]],format_mp3_MPEG.SamplingRates=[[format_mp3_SamplingRate.SR_11025,format_mp3_SamplingRate.SR_12000,format_mp3_SamplingRate.SR_8000,format_mp3_SamplingRate.SR_Bad],[format_mp3_SamplingRate.SR_Bad,format_mp3_SamplingRate.SR_Bad,format_mp3_SamplingRate.SR_Bad,format_mp3_SamplingRate.SR_Bad],[format_mp3_SamplingRate.SR_22050,format_mp3_SamplingRate.SR_24000,format_mp3_SamplingRate.SR_12000,format_mp3_SamplingRate.SR_Bad],[format_mp3_SamplingRate.SR_44100,format_mp3_SamplingRate.SR_48000,format_mp3_SamplingRate.SR_32000,format_mp3_SamplingRate.SR_Bad]],format_mp3_CLayer.LReserved=0,h3d_Buffer.GUID=0,h3d_Engine.SOFTWARE_DRIVER=!1,h3d_Engine.ANTIALIASING=0,h3d_impl_InputNames.UID=0,h3d_impl_InputNames.CACHE=new haxe_ds_StringMap,h3d_impl_GlDriver.ALLOW_WEBGL2=!0,h3d_impl_GlDriver.outOfMemoryCheck=!1,h3d_impl_GlDriver.TFILTERS=[[[9728,9728],[9729,9729]],[[9728,9984],[9729,9985]],[[9728,9986],[9729,9987]]],h3d_impl_GlDriver.TWRAP=[33071,10497],h3d_impl_GlDriver.FACES=[0,1028,1029,1032],h3d_impl_GlDriver.BLEND=[1,0,770,768,772,774,771,769,773,775,32769,32771,32770,32772,776],h3d_impl_GlDriver.COMPARE=[519,512,514,517,516,518,513,515],h3d_impl_GlDriver.STENCIL_OP=[7680,0,7681,7682,34055,7683,34056,5386],h3d_impl_GlDriver.OP=[32774,32778,32779,32775,32776],h3d_impl_GlDriver.CUBE_FACES=[34069,34070,34071,34072,34073,34074],h3d_impl_GlDriver.CBUFFERS=function($this){for(var _g=[],_g1=0;_g1<32;){for(var _g2=[],_g3=0,_g4=_g1++;_g3<_g4;){var k=_g3++;_g2.push(36064+k)}_g.push(_g2)}return _g}(),h3d_impl_MemoryManager.ALL_FLAGS=h3d_BufferFlag.__empty_constructs__.slice(),h3d_mat_Defaults.defaultKillAlphaThreshold=.5,h3d_mat_Defaults.loadingTextureColor=-65281,h3d_mat_MaterialSetup.current=new h3d_mat_MaterialSetup("Default"),h3d_mat_Texture.UID=0,h3d_mat_Texture.PREVENT_AUTO_DISPOSE=2147483647,h3d_mat_Texture.nativeFormat=hxd_PixelFormat.RGBA,h3d_pass_Blur.__meta__={obj:{ignore:["shader"]}},h3d_shader_ScreenShader.SRC="HXSLF2gzZC5zaGFkZXIuU2NyZWVuU2hhZGVyBwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACghfX2luaXRfXw4GAAALBnZlcnRleA4GAAACAgoAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAALAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAA",h3d_pass__$Border_BorderShader.SRC="HXSLHWgzZC5wYXNzLl9Cb3JkZXIuQm9yZGVyU2hhZGVyCQEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgVjb2xvcgUMAgAACwhfX2luaXRfXw4GAAAMBnZlcnRleA4GAAANCGZyYWdtZW50DgYAAAMCCwAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAAwAAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ0AAAUBBgQCCAUMAgoFDAUMAA",h3d_pass__$Copy_ArrayCopyShader.SRC="HXSLHmgzZC5wYXNzLl9Db3B5LkFycmF5Q29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQsCAAALBWxheWVyAQIAAAwIX19pbml0X18OBgAADQZ2ZXJ0ZXgOBgAADghmcmFnbWVudA4GAAADAgwAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAANAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEOAAAFAQYEAggFDAkDIQ4CAgoLCQMpDgICCQUKCQMmDgECCwEDBQsFDAUMAA",h3d_pass__$Copy_CopyShader.SRC="HXSLGWgzZC5wYXNzLl9Db3B5LkNvcHlTaGFkZXIJAQVpbnB1dA0BAgIIcG9zaXRpb24FCgEBAAMCdXYFCgEBAAEAAAQFZmxpcFkDAgAABQZvdXRwdXQNAgIGCHBvc2l0aW9uBQwEBQAHBWNvbG9yBQwEBQAEAAAICnBpeGVsQ29sb3IFDAQAAAkMY2FsY3VsYXRlZFVWBQoEAAAKB3RleHR1cmUKAgAACwhfX2luaXRfXw4GAAAMBnZlcnRleA4GAAANCGZyYWdtZW50DgYAAAMCCwAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAAwAAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ0AAAUBBgQCCAUMCQMhDgICCgoCCQUKBQwFDAA",h3d_pass__$CubeCopy_CubeCopyShader.SRC="HXSLIWgzZC5wYXNzLl9DdWJlQ29weS5DdWJlQ29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQwCAAALA21hdAYCAAAMCF9faW5pdF9fDgYAAA0GdmVydGV4DgYAAA4IZnJhZ21lbnQOBgAAAwIMAAAFAgYEAgcFDAIIBQwFDAYEAgkFCgIDBQoFCgAADQAABQEGBAIGBQwJAyoOBAoCAgUKAAADBgEKAgIFCgQAAwIEAwMBAwAAAAAAAAAAAwEDAAAAAAAA8D8DBQwFDAABDgAABQIIDwJ1dgUKBAAABgMGAQIJBQoBAwAAAAAAAABAAwUKAQMAAAAAAADwPwMFCgAGBAIIBQwJAyEOAgIKDAkDHw4BBgEJAykOAgIPBQoBAwAAAAAAAPA/AwULAgsGBQsFCwUMBQwA",h3d_pass__$HardwarePick_FixedColor.SRC="HXSLIWgzZC5wYXNzLl9IYXJkd2FyZVBpY2suRml4ZWRDb2xvcgUBB2NvbG9ySUQFDAIAAAIIdmlld3BvcnQFDAIAAAMGb3V0cHV0DQECBAhwb3NpdGlvbgUMBAMABQdjb2xvcklEBQwEAwAEAAAGBnZlcnRleA4GAAAHCGZyYWdtZW50DgYAAAIABgAABQEGBAIEBQwGAQQGAAIEBQwGAQkDKg4DCgICBQwRAAUKAQMAAAAAAAAAAAMBAwAAAAAAAAAAAwUMCgIEBQwMAAMFDAUMBQwJAyoOAwoCAgUMOQAFCgEDAAAAAAAA8D8DAQMAAAAAAADwPwMFDAUMBQwAAQcAAAUBBgQCBQUMAgEFDAUMAA",h3d_pass_ShaderManager.STRICT=!0,h3d_shader_AmbientLight.SRC="HXSLF2gzZC5zaGFkZXIuQW1iaWVudExpZ2h0CgEGZ2xvYmFsDQECAgxhbWJpZW50TGlnaHQFCwABAAMQcGVyUGl4ZWxMaWdodGluZwIAAQEAAAAAAAAAAAQKcGl4ZWxDb2xvcgUMBAAABQ9saWdodFBpeGVsQ29sb3IFCwQAAAYKbGlnaHRDb2xvcgULBAAABwhhZGRpdGl2ZQICAAEAAAAAAAgIX19pbml0X18OBgAACRBfX2luaXRfX2ZyYWdtZW50DgYAAAoJY2FsY0xpZ2h0DgYAAAsGdmVydGV4DgYAAAwIZnJhZ21lbnQOBgAABQIIAAAFAQYEAgYFCwsCBwICAgULCQMpDgEBAwAAAAAAAAAAAwULBQsFCwACCQAABQEGBAIFBQsLAgcCAgIFCwkDKQ4BAQMAAAAAAAAAAAMFCwULBQsAAwoBDQpsaWdodENvbG9yBQsEAAAFCwUBDQsCBwICDQULBAYAAgIFCwYBCQMWDgIEBgMBAwAAAAAAAPA/AwICBQsFCwULAQMAAAAAAAAAAAMFCwINBQsFCwULBQsFCwAAAAsAAAUBCwcCAgMCAgaBCgIEBQySAAULCQIKDgECBgULBQsFCwAAAAEMAAAFAQsCAwIGgQoCBAUMkgAFCwkCCg4BAgUFCwULBQsAAAA",h3d_shader_Base2d.SRC="HXSLEWgzZC5zaGFkZXIuQmFzZTJkGgEFaW5wdXQNAQMCCHBvc2l0aW9uBQoBAQADAnV2BQoBAQAEBWNvbG9yBQwBAQABAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgEdGltZQMAAAAJBnpWYWx1ZQMCAAAKB3RleHR1cmUKAgAACw5zcHJpdGVQb3NpdGlvbgUMBAAADBBhYnNvbHV0ZVBvc2l0aW9uBQwEAAANCnBpeGVsQ29sb3IFDAQAAA4MdGV4dHVyZUNvbG9yBQwEAAAPDGNhbGN1bGF0ZWRVVgUKAwAAEAppc1JlbGF0aXZlAgIAAQAAAAAAEQVjb2xvcgUMAgAAEg9hYnNvbHV0ZU1hdHJpeEEFCwIAABMPYWJzb2x1dGVNYXRyaXhCBQsCAAAUDWZpbHRlck1hdHJpeEEFCwIAABUNZmlsdGVyTWF0cml4QgULAgAAFghoYXNVVlBvcwICAAEAAAAAABcFdXZQb3MFDAIAABgJa2lsbEFscGhhAgIAAQAAAAAAGQpwaXhlbEFsaWduAgIAAQAAAAAAGhBoYWxmUGl4ZWxJbnZlcnNlBQoCAAAbCHZpZXdwb3J0BQwCAAAcDm91dHB1dFBvc2l0aW9uBQwEAAAdCF9faW5pdF9fDgYAAB4GdmVydGV4DgYAAB8IZnJhZ21lbnQOBgAAAwIdAAAFBgYEAgsFDAkDKg4DAgIFCgIJAwEDAAAAAAAA8D8DBQwFDAsCEAIFAwYECgIMBQwAAAMJAx0OAgkDKQ4CCgILBQwRAAUKAQMAAAAAAADwPwMFCwISBQsDAwYECgIMBQwEAAMJAx0OAgkDKQ4CCgILBQwRAAUKAQMAAAAAAADwPwMFCwITBQsDAwYECgIMBQw5AAUKCgILBQw5AAUKBQoABgQCDAUMAgsFDAUMAAYEAg8FCgsCFgIGAAYBAgMFCgoCFwUMOQAFCgUKCgIXBQwRAAUKBQoCAwUKBQoFCgYEAg0FDAsCEAIGAQIRBQwCBAUMBQwCBAUMBQwFDAYEAg4FDAkDIQ4CAgoKAg8FCgUMBQwGgQINBQwCDgUMBQwAAB4AAAUFCCADdG1wBQsEAAAJAykOAgoCDAUMEQAFCgEDAAAAAAAA8D8DBQsABgQCHAUMCQMqDgMJAx0OAgIgBQsCFAULAwkDHQ4CAiAFCwIVBQsDCgIMBQw5AAUKBQwFDAYECgIcBQwRAAUKBgEEBgAKAhwFDBEABQoKAhsFDBEABQoFCgUKCgIbBQw5AAUKBQoFCgsCGQIGgwoCHAUMEQAFCgIaBQoFCgAABgQCBgUMAhwFDAUMAAEfAAAFAgsGDgIYAgYJCgINBQwMAAMBA/yp8dJNYlA/AwICDAAAAAYEAgcFDAINBQwFDAA",h3d_shader_BaseMesh.SRC="HXSLE2gzZC5zaGFkZXIuQmFzZU1lc2gXAQZjYW1lcmENAQoCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAID2ludmVyc2VWaWV3UHJvagcAAQAJBXpOZWFyAwABAAoEekZhcgMAAQALA2RpcgULAwEAAAAADAZnbG9iYWwNAgQNBHRpbWUDAAwADglwaXhlbFNpemUFCgAMAA8JbW9kZWxWaWV3BwAMAQMQEG1vZGVsVmlld0ludmVyc2UHAAwBAwAAABEFaW5wdXQNAwISCHBvc2l0aW9uBQsBEQATBm5vcm1hbAULAREAAQAAFAZvdXRwdXQNBAUVCHBvc2l0aW9uBQwEFAAWBWNvbG9yBQwEFAAXBWRlcHRoAwQUABgGbm9ybWFsBQsEFAAZCXdvcmxkRGlzdAMEFAAEAAAaEHJlbGF0aXZlUG9zaXRpb24FCwQAABsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAHBhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAB0RdHJhbnNmb3JtZWROb3JtYWwFCwQAAB4RcHJvamVjdGVkUG9zaXRpb24FDAQAAB8KcGl4ZWxDb2xvcgUMBAAAIAVkZXB0aAMEAAAhCHNjcmVlblVWBQoEAAAiCXNwZWNQb3dlcgMEAAAjCXNwZWNDb2xvcgULBAAAJAl3b3JsZERpc3QDBAAAJQVjb2xvcgUMAgAAJg1zcGVjdWxhclBvd2VyAwIAAQcAAAAAAAAAAAAAAAAAAFlAJw5zcGVjdWxhckFtb3VudAMCAAEHAAAAAAAAAAAAAAAAAAAkQCgNc3BlY3VsYXJDb2xvcgULAgAAKQhfX2luaXRfXw4GAAAqEF9faW5pdF9fZnJhZ21lbnQOBgAAKwZ2ZXJ0ZXgOBgAALAhmcmFnbWVudA4GAAAEAikAAAULBgQCGgULAhIFCwULBgQCGwULBgECGgULCQM0DgECDwcIBQsFCwYEAh4FDAYBCQMqDgICGwULAQMAAAAAAADwPwMFDAIHBwUMBQwGBAIdBQsJAx8OAQQGAQITBQsJAzIOAQIPBwYFCwULBQsFCwYEAgsFCwkDHw4BBAYDAgQFCwIbBQsFCwULBQsFCwYEAh8FDAIlBQwFDAYEAiIDAiYDAwYEAiMFCwYBAigFCwInAwULBQsGBAIhBQoJAzoOAQYCCgIeBQwRAAUKCgIeBQwMAAMFCgUKBQoGBAIgAwYCCgIeBQwIAAMKAh4FDAwAAwMDBgQCJAMGAgkDGw4BBgMCGwULAgQFCwULAwIKAwMDAAIqAAAFBQYEAh0FCwkDHw4BAh0FCwULBQsGBAIhBQoJAzoOAQYCCgIeBQwRAAUKCgIeBQwMAAMFCgUKBQoGBAIgAwYCCgIeBQwIAAMKAh4FDAwAAwMDBgQCIgMCJgMDBgQCIwULBgECKAULAicDBQsFCwAAKwAABQIGBAIVBQwGAQIeBQwJAyoOBAEDAAAAAAAA8D8DAgUDAQMAAAAAAADwPwMBAwAAAAAAAPA/AwUMBQwFDAYEAhwFCwIbBQsFCwABLAAABQQGBAIWBQwCHwUMBQwGBAIXAwIgAwMGBAIYBQsCHQULBQsGBAIZAwIkAwMA",h3d_shader_Blur.SRC="HXSLD2gzZC5zaGFkZXIuQmx1choBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoVY2FtZXJhSW52ZXJzZVZpZXdQcm9qBwIAAAsHdGV4dHVyZQoCAAAMDGRlcHRoVGV4dHVyZQoCAAANB1F1YWxpdHkBAgABAAAAAAAOB2lzRGVwdGgCAgABAAAAAAAPBnZhbHVlcw8DDQIAABAHb2Zmc2V0cw8DDQIAABEFcGl4ZWwFCgIAABINaGFzRml4ZWRDb2xvcgICAAEAAAAAABMQc21vb3RoRml4ZWRDb2xvcgICAAEAAAAAABQKZml4ZWRDb2xvcgUMAgAAFRBpc0RlcHRoRGVwZW5kYW50AgIAAQAAAAAAFgloYXNOb3JtYWwCAgABAAAAAAAXDW5vcm1hbFRleHR1cmUKAgAAGAZpc0N1YmUCAgABAAAAAAAZC2N1YmVUZXh0dXJlDAIAABoHY3ViZURpcgYCAAAbCF9faW5pdF9fDgYAABwGdmVydGV4DgYAAB0IZnJhZ21lbnQOBgAAHgtnZXRQb3NpdGlvbg4GAAAEAhsAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAAcAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEdAAAFAgsCFQIFBggfBHBjdXIFCwQAAAkCHg4BAgMFCgULAAggBGNjdXIFDAQAAAkDIQ4CAgsKAgMFCgUMAAghBWNvbG9yBQwEAAAJAyoOBAEDAAAAAAAAAAADAQMAAAAAAAAAAAMBAwAAAAAAAAAAAwEDAAAAAAAAAAADBQwACCIEbmN1cgULBAAACQM5DgEJAyEOAgIXCgIDBQoFDAULABUGdW5yb2xsAA4jAWkBBAAABhUGAAcDAg0BAQECAQAAAAEBAg0BDwEAAAUICCQCdXYFCgQAAAYAAgMFCgYBAhEFChECEA8DDQsGCQIjAQECAAAAAAECBwMCIwEBAiMBAQMFCgUKAAglAWMFDAQAAAkDIQ4CAgsKAiQFCgUMAAgmAXAFCwQAAAkCHg4BAiQFCgULAAgnAWQDBAAACQMdDgIEBgMCJgULAh8FCwULBQsGAwImBQsCHwULBQsDAAgoAW4FCwQAAAkDOQ4BCQMhDgICFwoCJAUKBQwFCwAGBAIlBQwJAxgOAwIgBQwCJQUMCQMdDgICIgULAigFCwMFDAUMBgQCJQUMCQMYDgMCJQUMAiAFDAkDFQ4CBAYBCQMWDgIEBgMCJwMBA/yp8dJNYlA/AwMDAQMAAAAAAAAAAAMDAQMAAAAAAGr4QAMDAwEDAAAAAAAA8D8DAwUMBQwGgAIhBQwGAQIlBQwRAg8PAw0LBgkCIwEBAgAAAAABAgcDAiMBAQIjAQEDBQwFDAAAAAYEAggFDAIhBQwFDAALAg4CBQMIKQN2YWwDBAAAAQMAAAAAAAAAAAMAFQZ1bnJvbGwADioBaQEEAAAGFQYABwMCDQEBAQIBAAAAAQECDQEPAQAABQELAhgCBoACKQMGAQkDNw4BCQMhDgICGQwGAQkDKQ4CBgMGAQQGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIqAQECAAAAAAECBwMCKgEBAioBAQMFCgkDJg4BAioBAwUKBQoFCgEDAAAAAAAAAEADBQoBAwAAAAAAAPA/AwUKAQMAAAAAAADwPwMFCwIaBgULBQwDEQIPDwMNCwYJAioBAQIAAAAAAQIHAwIqAQECKgEBAwMDBoACKQMGAQkDNw4BCQMhDgICCwoGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIqAQECAAAAAAECBwMCKgEBAioBAQMFCgkDJg4BAioBAwUKBQoFDAMRAg8PAw0LBgkCKgEBAgAAAAABAgcDAioBAQIqAQEDAwMAAAAABgQCCAUMCQM2DgEJAxUOAgIpAwEDyxpQyv//7z8DAwUMBQwABQMIKwVjb2xvcgUMBAAACQMqDgQBAwAAAAAAAAAAAwEDAAAAAAAAAAADAQMAAAAAAAAAAAMBAwAAAAAAAAAAAwUMABUGdW5yb2xsAA4sAWkBBAAABhUGAAcDAg0BAQECAQAAAAEBAg0BDwEAAAUBCwIYAgaAAisFDAYBCQMhDgICGQwGAQkDKQ4CBgMGAQQGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIsAQECAAAAAAECBwMCLAEBAiwBAQMFCgkDJg4BAiwBAwUKBQoFCgEDAAAAAAAAAEADBQoBAwAAAAAAAPA/AwUKAQMAAAAAAADwPwMFCwIaBgULBQwRAg8PAw0LBgkCLAEBAgAAAAABAgcDAiwBAQIsAQEDBQwFDAaAAisFDAYBCQMhDgICCwoGAAIDBQoGAQYBAhEFChECEA8DDQsGCQIsAQECAAAAAAECBwMCLAEBAiwBAQMFCgkDJg4BAiwBAwUKBQoFDBECDw8DDQsGCQIsAQECAAAAAAECBwMCLAEBAiwBAQMFDAUMAAAAAAYEAggFDAIrBQwFDAAAAAsCEgIFAgsCEwIGgQoCCAUMDAADCgIUBQwMAAMDBgQKAggFDAwAAwYBCgIUBQwMAAMJAyYOAQYHCgIIBQwMAAMBAwAAAAAAAAAAAwIDAwMABgQKAggFDJIABQsGAQoCFAUMkgAFCwoCCAUMDAADBQsFCwAAAAADHgEtAnV2BQoEAAAFCwUECC4FZGVwdGgDBAAACQM3DgEJAyEOAgIMCgItBQoFDAMACC8EdGVtcAUMBAAABgEJAyoOAwkDOw4BAi0FCgUKAi4DAQMAAAAAAADwPwMFDAIKBwUMAAgwCG9yaWdpbldTBQsEAAAGAgoCLwUMkgAFCwoCLwUMDAADBQsADQIwBQsAAA",h3d_shader_ColorAdd.SRC="HXSLE2gzZC5zaGFkZXIuQ29sb3JBZGQDAQpwaXhlbENvbG9yBQwEAAACBWNvbG9yBQsCAAADCGZyYWdtZW50DgYAAAEBAwAABQEGgAoCAQUMkgAFCwICBQsFCwA",h3d_shader_ColorKey.SRC="HXSLE2gzZC5zaGFkZXIuQ29sb3JLZXkDAQhjb2xvcktleQUMAgAAAgx0ZXh0dXJlQ29sb3IFDAQAAAMIZnJhZ21lbnQOBgAAAQEDAAAFAggEBWNkaWZmBQwEAAAGAwICBQwCAQUMBQwACwYJCQMdDgICBAUMAgQFDAMBA/Fo44i1+OQ+AwIMAAAAAA",h3d_shader_ColorMatrix.SRC="HXSLFmgzZC5zaGFkZXIuQ29sb3JNYXRyaXgDAQpwaXhlbENvbG9yBQwEAAACBm1hdHJpeAcCAAADCGZyYWdtZW50DgYAAAEBAwAABQEGBAIBBQwJAyoOAgoEBgEJAyoOAgoCAQUMkgAFCwEDAAAAAAAA8D8DBQwCAgcFDAUMkgAFCwoEBgECAQUMAgIHBQwFDAwAAwUMBQwA",h3d_shader_DirShadow.SRC="HXSLFGgzZC5zaGFkZXIuRGlyU2hhZG93EgEGZW5hYmxlAgIAAQAAAAAAAgdVU0VfRVNNAgIAAQAAAAAAAwtzaGFkb3dQb3dlcgMCAAAEB1VTRV9QQ0YCAgABAAAAAAAFCnBjZlF1YWxpdHkBAgABAAAAAAAGCHBjZlNjYWxlAwIAAAcJc2hhZG93UmVzBQoCAAAICXNoYWRvd01hcBEBAgAACQpzaGFkb3dQcm9qCAIAAAoKc2hhZG93QmlhcwMCAAALE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAwGc2hhZG93AwQAAA0JZGlyU2hhZG93AwQAAA4OcG9pc3NvbkRpc2tMb3cPBQwABAIAAA8PcG9pc3NvbkRpc2tIaWdoDwUMAAwCAAAQE3BvaXNzb25EaXNrVmVyeUhpZ2gPBQwAQAIAABEEcmFuZA4GAAASCGZyYWdtZW50DgYAAAIDEQETAXYDBAAAAwUCCBQCZHADBAAACQMdDgIJAyoOAQITAwUMCQMqDgQBA18pyxDH+ilAAwED9P3UeOmOU0ADAQOiRbbz/ZRGQAMBA1CNl24Sq1dAAwUMAwANCQMTDgEGAQkDAg4BAhQDAwEDUPwYc9Fd5UADAwMAAAESAAAFAgsCAQIFAQsCBAIFBwYEAgwDAQMAAAAAAADwPwMDCBUJdGV4ZWxTaXplBQoEAAAGAgEDAAAAAAAA8D8DAgcFCgUKAAgWCXNoYWRvd1BvcwULBAAABgECCwULAgkIBQsACBcIc2hhZG93VXYFCgQAAAkDOg4BCgIWBQsRAAUKBQoACBgEek1heAMEAAAJAzUOAQoCFgULCAADAwAIGQNyb3QDBAAABgEGAQkCEQ4BBgAGAAoCCwULAAADCgILBQsEAAMDCgILBQsIAAMDAwEDH4XrUbgeCUADAwEDAAAAAAAAAEADAwATBAIFAQEDAQECAQAAAAEFAggaDnNhbXBsZVN0cmVuZ3RoAwQAAAYCAQMAAAAAAADwPwMBAwAAAAAAABBAAwMADhsBaQEEAAAGFQECAAAAAAEBAgQAAAABDwEAAAUECBwGb2Zmc2V0BQoEAAAGAQYBChECDg8FDAAEAhsBBQwRAAUKAhUFCgUKAgYDBQoABgQCHAUKCQMoDgIGAwYBCQMDDgECGQMDCgIcBQoAAAMDBgEJAwIOAQIZAwMKAhwFCgQAAwMDBgAGAQkDAw4BAhkDAwoCHAUKBAADAwYBCQMCDgECGQMDCgIcBQoAAAMDAwUKBQoIHQVkZXB0aAMEAAAJA0AOAwIIEQEGAAIXBQoCHAUKBQoBAwAAAAAAAAAAAwMACwYHBgMCGAMCCgMDAh0DAgaDAgwDAhoDAwAAAAAAAQECAgAAAAEFAggeDnNhbXBsZVN0cmVuZ3RoAwQAAAYCAQMAAAAAAADwPwMBAwAAAAAAAChAAwMADh8BaQEEAAAGFQECAAAAAAEBAgwAAAABDwEAAAUECCAGb2Zmc2V0BQoEAAAGAQYBChECDw8FDAAMAh8BBQwRAAUKAhUFCgUKAgYDBQoABgQCIAUKCQMoDgIGAwYBCQMDDgECGQMDCgIgBQoAAAMDBgEJAwIOAQIZAwMKAiAFCgQAAwMDBgAGAQkDAw4BAhkDAwoCIAUKBAADAwYBCQMCDgECGQMDCgIgBQoAAAMDAwUKBQoIIQVkZXB0aAMEAAAJA0AOAwIIEQEGAAIXBQoCIAUKBQoBAwAAAAAAAAAAAwMACwYHBgMCGAMCCgMDAiEDAgaDAgwDAh4DAwAAAAAAAQECAwAAAAEFAggiDnNhbXBsZVN0cmVuZ3RoAwQAAAYCAQMAAAAAAADwPwMBAwAAAAAAAFBAAwMADiMBaQEEAAAGFQECAAAAAAEBAkAAAAABDwEAAAUECCQGb2Zmc2V0BQoEAAAGAQYBChECEA8FDABAAiMBBQwRAAUKAhUFCgUKAgYDBQoABgQCJAUKCQMoDgIGAwYBCQMDDgECGQMDCgIkBQoAAAMDBgEJAwIOAQIZAwMKAiQFCgQAAwMDBgAGAQkDAw4BAhkDAwoCJAUKBAADAwYBCQMCDgECGQMDCgIkBQoAAAMDAwUKBQoIJQVkZXB0aAMEAAAJA0AOAwIIEQEGAAIXBQoCJAUKBQoBAwAAAAAAAAAAAwMACwYHBgMCGAMCCgMDAiUDAgaDAgwDAiIDAwAAAAAAAAAACwICAgUFCCYJc2hhZG93UG9zBQsEAAAGAQILBQsCCQgFCwAIJwVkZXB0aAMEAAAJAz8OAgIIEQEJAzoOAQoCJgULEQAFCgUKAwAIKAR6TWF4AwQAAAkDNQ4BCgImBQsIAAMDAAgpBWRlbHRhAwQAAAYDCQMVDgIEBgACJwMCCgMDAwIoAwMCKAMDAAYEAgwDCQM1DgEJAwkOAQYBAgMDAikDAwMDAwAFBAgqCXNoYWRvd1BvcwULBAAABgECCwULAgkIBQsACCsIc2hhZG93VXYFCgQAAAkDOg4BCgIqBQsRAAUKBQoACCwFZGVwdGgDBAAACQM/DgICCBEBCgIrBQoRAAUKAwAGBAIMAwsGBwYDCgIqBQsIAAMCCgMDAiwDAgEDAAAAAAAAAAADAQMAAAAAAADwPwMDAwAAAAAAAAYEAg0DAgwDAwA",h3d_shader_GenTexture.SRC="HXSLFWgzZC5zaGFkZXIuR2VuVGV4dHVyZQoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEbW9kZQECAAEAAAAAAAsFY29sb3IFDAIAAAwIX19pbml0X18OBgAADQZ2ZXJ0ZXgOBgAADghmcmFnbWVudA4GAAADAgwAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAANAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEOAAAFARMEAgoBAQEBAQIAAAAAAQUBBgQCCAUMCwYHCQMbDgEKAgYFDBEABQoDAQMAAAAAAADwPwMCCQMqDgEBAwAAAAAAAAAAAwUMAgsFDAUMBQwAAAAA",h3d_shader_LineShader.SRC="HXSLFWgzZC5zaGFkZXIuTGluZVNoYWRlcgwBBmNhbWVyYQ0BAwIEdmlldwcAAQADBHByb2oHAAEABAh2aWV3UHJvagcAAQAAAAAFBmdsb2JhbA0CAgYJcGl4ZWxTaXplBQoABQAHCW1vZGVsVmlldwcABQEDAAAACAVpbnB1dA0DAwkIcG9zaXRpb24FCwEIAAoGbm9ybWFsBQsBCAALAnV2BQoBCAABAAAMBm91dHB1dA0EAQ0IcG9zaXRpb24FDAQMAAQAAA4RdHJhbnNmb3JtZWROb3JtYWwFCwQAAA8TdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAEBFwcm9qZWN0ZWRQb3NpdGlvbgUMBAAAEQtsZW5ndGhTY2FsZQMCAAASBXdpZHRoAwIAABMEcGRpcgUMBAAAFAhfX2luaXRfXw4GAAAVBnZlcnRleA4GAAACAhQAAAUBBQUIFgNkaXIFCwQAAAYBAgoFCwkDMg4BAgcHBgULAAYEAhMFDAYBCQMqDgIGAQIWBQsJAzIOAQICBwYFCwEDAAAAAAAA8D8DBQwCAwcFDAUMBoEKAhMFDBEABQoGAgEDAAAAAAAA8D8DCQMNDgEGAAYBCgITBQwAAAMKAhMFDAAAAwMGAQoCEwUMBAADCgITBQwEAAMDAwMDBQoGgAIPBQsGAQYBAhYFCwoCCwUKAAADBQsCEQMFCwULBgQCDgULCQMfDgECFgULBQsFCwAAABUAAAUBBoAKAhAFDBEABQoGAQYBBgEGAQQGAQoCEwUMBQAFCgkDKA4CAQMAAAAAAADwPwMBAwAAAAAAAPC/AwUKBQoFCgQGAwoCCwUKBAADAQMAAAAAAADgPwMDAwUKCgIQBQwIAAMFCgIGBQoFCgISAwUKBQoA",h3d_shader_MinMaxShader.SRC="HXSLF2gzZC5zaGFkZXIuTWluTWF4U2hhZGVyCwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgR0ZXhBCgIAAAsEdGV4QgoCAAAMBWlzTWF4AgIAAQAAAAAADQhfX2luaXRfXw4GAAAOBnZlcnRleA4GAAAPCGZyYWdtZW50DgYAAAMCDQAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAA4AAAUBBgQCBgUMCQMqDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ8AAAUDCBABYQUMBAAACQMhDgICCgoCCQUKBQwACBEBYgUMBAAACQMhDgICCwoCCQUKBQwABgQCCAUMCwIMAgkDFg4CAhAFDAIRBQwFDAkDFQ4CAhAFDAIRBQwFDAUMBQwA",h3d_shader_CubeMinMaxShader.SRC="HXSLG2gzZC5zaGFkZXIuQ3ViZU1pbk1heFNoYWRlcgwBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEdGV4QQwCAAALBHRleEIMAgAADAVpc01heAICAAEAAAAAAA0DbWF0BgIAAA4IX19pbml0X18OBgAADwZ2ZXJ0ZXgOBgAAEAhmcmFnbWVudA4GAAADAg4AAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAAPAAAFAQYEAgYFDAkDKg4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEQAAAFBQgRAnV2BQoEAAAGAwYBAgkFCgEDAAAAAAAAAEADBQoBAwAAAAAAAPA/AwUKAAgSA2RpcgULBAAABgEJAykOAgIRBQoBAwAAAAAAAPA/AwULAg0GBQsACBMBYQUMBAAACQMhDgICCgwCEgULBQwACBQBYgUMBAAACQMhDgICCwwCEgULBQwABgQCCAUMCwIMAgkDFg4CAhMFDAIUBQwFDAkDFQ4CAhMFDAIUBQwFDAUMBQwA",h3d_shader_NormalMap.SRC="HXSLFGgzZC5zaGFkZXIuTm9ybWFsTWFwCgEGY2FtZXJhDQECAghwb3NpdGlvbgULAAEAAwNkaXIFCwMBAAAAAAQGZ2xvYmFsDQIBBQltb2RlbFZpZXcHAAQBAwAAAAYFaW5wdXQNAwIHBm5vcm1hbAULAQYACAd0YW5nZW50BQsBBgABAAAJB3RleHR1cmUKAgAACgxjYWxjdWxhdGVkVVYFCgQAAAsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAADBF0cmFuc2Zvcm1lZE5vcm1hbAULBAAADRJ0cmFuc2Zvcm1lZFRhbmdlbnQFDAMAAA4OX19pbml0X192ZXJ0ZXgOBgAADwhmcmFnbWVudA4GAAACAg4AAAUBBgQCDQUMCQMqDgIGAQIIBQsJAzIOAQIFBwYFCwsGBwkDHQ4CAggFCwIIBQsDAQMAAAAAAADgPwMCAQMAAAAAAADwPwMBAwAAAAAAAPC/AwMFDAUMAAEPAAAFBQgQAW4FCwQAAAIMBQsACBECbmYFCwQAAAkDOQ4BCQMhDgICCQoCCgUKBQwFCwAIEgR0YW5YBQsEAAAJAx8OAQoCDQUMkgAFCwULAAgTBHRhblkFCwQAAAYBCQMeDgICEAULAhIFCwULBwMKAg0FDAwAAwMFCwAGBAIMBQsJAx8OAQQGAAYABgEKAhEFCwAAAwISBQsFCwYBCgIRBQsEAAMCEwULBQsFCwYBCgIRBQsIAAMCEAULBQsFCwULBQsFCwA",h3d_shader_Shadow.SRC="HXSLEWgzZC5zaGFkZXIuU2hhZG93BgEGc2hhZG93DQEFAgNtYXARAQABAAMEcHJvaggAAQAEBWNvbG9yBQsAAQAFBXBvd2VyAwABAAYEYmlhcwMAAQAAAAAHCnBpeGVsQ29sb3IFDAQAAAgTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAACRhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAoJc2hhZG93UG9zBQsDAAEBCwhmcmFnbWVudA4GAAABAQsAAAUGCAwJc2hhZG93UG9zBQsEAAAGAQIJBQsCAwgFCwAIDQVkZXB0aAMEAAAJAz8OAgICEQEJAzoOAQoCDAULEQAFCgUKAwAIDgR6TWF4AwQAAAkDNQ4BCgIMBQsIAAMDAAgPBWRlbHRhAwQAAAYDCQMVDgIEBgACDQMCBgMDAwIOAwMCDgMDAAgQBXNoYWRlAwQAAAkDNQ4BCQMJDgEGAQIFAwIPAwMDAwAGgQoCBwUMkgAFCwYABgEEBgMBAwAAAAAAAPA/AwIQAwMDCgIEBQuSAAULBQsCEAMFCwULAA",h3d_shader_SkinBase.SRC="HXSLE2gzZC5zaGFkZXIuU2tpbkJhc2UFARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFDWJvbmVzTWF0cml4ZXMPCAQCAAEIAA",h3d_shader_Skin.SRC="HXSLD2gzZC5zaGFkZXIuU2tpbggBEHJlbGF0aXZlUG9zaXRpb24FCwQAAAITdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAAxF0cmFuc2Zvcm1lZE5vcm1hbAULBAAABAhNYXhCb25lcwECAAEAAAAAAAUNYm9uZXNNYXRyaXhlcw8IBAIAAQgGBWlucHV0DQEEBwhwb3NpdGlvbgULAQYACAZub3JtYWwFCwEGAAkHd2VpZ2h0cwULAQYACgdpbmRleGVzCQQAAAABBgABAAALEnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAADAZ2ZXJ0ZXgOBgAAAQAMAAAFAgYEAgIFCwYABgAGAQQGAQIBBQsRAgUPCAQKAgoJBAAAAAAAAQgFCwULCgIJBQsAAAMFCwYBBAYBAgEFCxECBQ8IBAoCCgkEAAAABAABCAULBQsKAgkFCwQAAwULBQsGAQQGAQIBBQsRAgUPCAQKAgoJBAAAAAgAAQgFCwULCgIJBQsIAAMFCwULBQsGBAIDBQsJAx8OAQYABgAGAQQGAQIIBQsJAzIOARECBQ8IBAoCCgkEAAAAAAABCAYFCwULCgIJBQsAAAMFCwYBBAYBAggFCwkDMg4BEQIFDwgECgIKCQQAAAAEAAEIBgULBQsKAgkFCwQAAwULBQsGAQQGAQIIBQsJAzIOARECBQ8IBAoCCgkEAAAACAABCAYFCwULCgIJBQsIAAMFCwULBQsFCwA",h3d_shader_SkinTangent.SRC="HXSLFmgzZC5zaGFkZXIuU2tpblRhbmdlbnQIARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFDWJvbmVzTWF0cml4ZXMPCAQCAAEIBgVpbnB1dA0BBQcIcG9zaXRpb24FCwEGAAgGbm9ybWFsBQsBBgAJB3RhbmdlbnQFCwEGAAoHd2VpZ2h0cwULAQYACwdpbmRleGVzCQQAAAABBgABAAAMEnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAADQZ2ZXJ0ZXgOBgAAAQANAAAFAwYEAgIFCwYABgAGAQQGAQIBBQsRAgUPCAQKAgsJBAAAAAAAAQgFCwULCgIKBQsAAAMFCwYBBAYBAgEFCxECBQ8IBAoCCwkEAAAABAABCAULBQsKAgoFCwQAAwULBQsGAQQGAQIBBQsRAgUPCAQKAgsJBAAAAAgAAQgFCwULCgIKBQsIAAMFCwULBQsGBAIDBQsJAx8OAQYABgAGAQQGAQIIBQsJAzIOARECBQ8IBAoCCwkEAAAAAAABCAYFCwULCgIKBQsAAAMFCwYBBAYBAggFCwkDMg4BEQIFDwgECgILCQQAAAAEAAEIBgULBQsKAgoFCwQAAwULBQsGAQQGAQIIBQsJAzIOARECBQ8IBAoCCwkEAAAACAABCAYFCwULCgIKBQsIAAMFCwULBQsFCwYEAgwFDAkDKg4CCQMfDgEGAAYABgEEBgEKAgkFC5IABQsJAzIOARECBQ8IBAoCCwkEAAAAAAABCAYFCwULCgIKBQsAAAMFCwYBBAYBCgIJBQuSAAULCQMyDgERAgUPCAQKAgsJBAAAAAQAAQgGBQsFCwoCCgULBAADBQsFCwYBBAYBCgIJBQuSAAULCQMyDgERAgUPCAQKAgsJBAAAAAgAAQgGBQsFCwoCCgULCAADBQsFCwULCgIMBQwMAAMFDAUMAA",h3d_shader_SpecularTexture.SRC="HXSLGmgzZC5zaGFkZXIuU3BlY3VsYXJUZXh0dXJlBAEHdGV4dHVyZQoCAAACDGNhbGN1bGF0ZWRVVgUKBAAAAwlzcGVjQ29sb3IFCwQAAAQIZnJhZ21lbnQOBgAAAQEEAAAFAQaBAgMFCwoJAyEOAgIBCgICBQoFDJIABQsFCwA",h3d_shader_Texture.SRC="HXSLEmgzZC5zaGFkZXIuVGV4dHVyZQsBBWlucHV0DQEBAgJ1dgUKAQEAAQAAAwhhZGRpdGl2ZQICAAEAAAAAAAQJa2lsbEFscGhhAgIAAQAAAAAABQ1zcGVjdWxhckFscGhhAgIAAQAAAAAABhJraWxsQWxwaGFUaHJlc2hvbGQDAgABBwAAAAAAAAAAAAAAAAAA8D8HB3RleHR1cmUKAgAACAxjYWxjdWxhdGVkVVYFCgQAAAkKcGl4ZWxDb2xvcgUMBAAACglzcGVjQ29sb3IFCwQAAAsGdmVydGV4DgYAAAwIZnJhZ21lbnQOBgAAAgALAAAFAQYEAggFCgICBQoFCgABDAAABQQIDQFjBQwEAAAJAyEOAgIHCgIIBQoFDAALBg4CBAIGCQYDCgINBQwMAAMCBgMDAQMAAAAAAAAAAAMCAgwAAAALAgMCBoACCQUMAg0FDAUMBoECCQUMAg0FDAUMAAsCBQIGgQIKBQsKAg0FDP4ABQsFCwAAAA",h3d_shader_UVDelta.SRC="HXSLEmgzZC5zaGFkZXIuVVZEZWx0YQQBB3V2RGVsdGEFCgIAAAIHdXZTY2FsZQUKAgAAAwxjYWxjdWxhdGVkVVYFCgQAAAQGdmVydGV4DgYAAAEABAAABQEGBAIDBQoGAAYBAgMFCgICBQoFCgIBBQoFCgUKAA",h3d_shader_VertexColorAlpha.SRC="HXSLG2gzZC5zaGFkZXIuVmVydGV4Q29sb3JBbHBoYQQBBWlucHV0DQEBAgVjb2xvcgUMAQEAAQAAAwpwaXhlbENvbG9yBQwEAAAECGFkZGl0aXZlAgIAAQAAAAAABQhmcmFnbWVudA4GAAABAQUAAAUBCwIEAgaAAgMFDAICBQwFDAaBAgMFDAICBQwFDAAA",h3d_shader_VolumeDecal.SRC="HXSLFmgzZC5zaGFkZXIuVm9sdW1lRGVjYWwYAQZjYW1lcmENAQoCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAID2ludmVyc2VWaWV3UHJvagcAAQAJBXpOZWFyAwABAAoEekZhcgMAAQALA2RpcgULAwEAAAAADAZnbG9iYWwNAgQNBHRpbWUDAAwADglwaXhlbFNpemUFCgAMAA8JbW9kZWxWaWV3BwAMAQMQEG1vZGVsVmlld0ludmVyc2UHAAwBAwAAABEFaW5wdXQNAwISCHBvc2l0aW9uBQsBEQATBm5vcm1hbAULAREAAQAAFAZvdXRwdXQNBAUVCHBvc2l0aW9uBQwEFAAWBWNvbG9yBQwEFAAXBWRlcHRoAwQUABgGbm9ybWFsBQsEFAAZCXdvcmxkRGlzdAMEFAAEAAAaEHJlbGF0aXZlUG9zaXRpb24FCwQAABsTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAHBhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAB0RdHJhbnNmb3JtZWROb3JtYWwFCwQAAB4RcHJvamVjdGVkUG9zaXRpb24FDAQAAB8KcGl4ZWxDb2xvcgUMBAAAIAVkZXB0aAMEAAAhCHNjcmVlblVWBQoEAAAiCXNwZWNQb3dlcgMEAAAjCXNwZWNDb2xvcgULBAAAJAl3b3JsZERpc3QDBAAAJQhkZXB0aE1hcBEBAAAAJgVzY2FsZQUKAgAAJwZub3JtYWwFCwIAACgHdGFuZ2VudAULAgAAKQppc0NlbnRlcmVkAgIAAQAAAAAAKgxjYWxjdWxhdGVkVVYFCgQAACsSdHJhbnNmb3JtZWRUYW5nZW50BQwEAAAsDl9faW5pdF9fdmVydGV4DgYAAC0IZnJhZ21lbnQOBgAAAgIsAAAFAgYEAh0FCwkDHw4BBAYBAicFCwkDMg4BAg8HBgULBQsFCwULBgQCKwUMCQMqDgIJAx8OAQQGAQIoBQsJAzIOAQIPBwYFCwULBQsBAwAAAAAAAPA/AwUMBQwAAS0AAAUJCC4GbWF0cml4BwQAAAYBAggHAhAHBwAILwlzY3JlZW5Qb3MFCgQAAAYCCgIeBQwRAAUKCgIeBQwMAAMFCgAIMANydXYFDAQAAAkDKg4DAi8FCgkDPw4CAiURAQkDOg4BAi8FCgUKAwEDAAAAAAAA8D8DBQwACDEEd3BvcwUMBAAABgECMAUMAi4HBQwACDIEcHBvcwUMBAAABgECMAUMAggHBQwABgQCHAULBgIKAjIFDJIABQsKAjIFDAwAAwULBQsGBAIqBQoGAQImBQoEBgIKAjEFDBEABQoKAjEFDAwAAwUKBQoFCgUKCwIpAgaAAioFCgEDAAAAAAAA4D8DBQoAAAsGCQkDFQ4CCQMVDgIKAioFCgAAAwoCKgUKBAADAwkDFQ4CBgMBAwAAAAAAAPA/AwoCKgUKAAADAwYDAQMAAAAAAADwPwMKAioFCgQAAwMDAwEDAAAAAAAAAAADAgwAAAAA",haxe_EntryPoint.pending=[],haxe_EntryPoint.threadCount=0,haxe_Int32._mul=null!=Math.imul?Math.imul:function(a,b){return a*(65535&b)+(a*(b>>>16)<<16|0)|0},haxe_Serializer.USE_CACHE=!1,haxe_Serializer.USE_ENUM_INDEX=!1,haxe_Serializer.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",haxe_Unserializer.DEFAULT_RESOLVER=new haxe__$Unserializer_DefaultResolver,haxe_Unserializer.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",haxe_crypto_Base64.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",haxe_crypto_Base64.BYTES=haxe_io_Bytes.ofString(haxe_crypto_Base64.CHARS),haxe_io_FPHelper.helper=new DataView(new ArrayBuffer(8)),haxe_zip_InflateImpl.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1],haxe_zip_InflateImpl.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],haxe_zip_InflateImpl.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1],haxe_zip_InflateImpl.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],haxe_zip_InflateImpl.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],hxd_Key.initDone=!1,hxd_Key.keyPressed=[],hxd_Key.ALLOW_KEY_REPEAT=!1,hxd_Timer.wantedFPS=60,hxd_Timer.maxDeltaTime=.5,hxd_Timer.smoothFactor=.95,hxd_Timer.lastTimeStamp=HxOverrides.now()/1e3,hxd_Timer.elapsedTime=0,hxd_Timer.frameCount=0,hxd_Timer.dt=1/hxd_Timer.wantedFPS,hxd_Timer.currentDT=1/hxd_Timer.wantedFPS,hxd_System.setCursor=hxd_System.setNativeCursor,hxd_System.loopInit=!1,hxd_fs_EmbedFileSystem.invalidChars=new EReg("[^A-Za-z0-9_]","g"),hxd_res_Resource.LIVE_UPDATE=!1,hxd_res_Image.ALLOW_NPOT=!0,hxd_res_Image.DEFAULT_FILTER=h3d_mat_Filter.Linear,hxd_res_Image.DEFAULT_ASYNC=!1,hxd_res_Image.ENABLE_AUTO_WATCH=!0,hxd_res_Sound.ENABLE_AUTO_WATCH=!0,hxd_snd_Channel.ID=0,hxd_snd_Source.ID=0,hxd_snd_Manager.STREAM_DURATION=5,hxd_snd_Manager.STREAM_BUFFER_SAMPLE_COUNT=44100,hxd_snd_Manager.BUFFER_QUEUE_LENGTH=2,hxd_snd_Manager.MAX_SOURCES=16,hxd_snd_Manager.SOUND_BUFFER_CACHE_SIZE=256,hxd_snd_Manager.VIRTUAL_VOLUME_THRESHOLD=1e-5,hxd_snd_Manager.BUFFER_STREAM_SPLIT=16,hxsl_Tools.UID=0,hxsl_Tools.SWIZ=hxsl_Component.__empty_constructs__.slice(),hxsl_Tools.MAX_CHANNELS_BITS=3,hxsl_BatchShader.SRC="HXSLEGh4c2wuQmF0Y2hTaGFkZXICAQtCYXRjaF9Db3VudAECAAEAAAABAAIMQmF0Y2hfQnVmZmVyEAUMAQIAAAA",hxsl_GlslOut.KWD_LIST=["input","output","discard","dvec2","dvec3","dvec4","hvec2","hvec3","hvec4","fvec2","fvec3","fvec4","int","float","bool","long","short","double","half","fixed","unsigned","superp","lowp","mediump","highp","precision","invariant","discard","struct","asm","union","template","this","packed","goto","sizeof","namespace","noline","volatile","external","flat","input","output","out","attribute","const","uniform","varying","inout","void"],hxsl_GlslOut.KWDS=function($this){for(var _g=new haxe_ds_StringMap,_g1=0,_g2=hxsl_GlslOut.KWD_LIST;_g1<_g2.length;){var k=_g2[_g1];++_g1,_g.h[k]=!0}return _g}(),hxsl_GlslOut.GLOBALS=function($this){for(var m=new haxe_ds_EnumValueMap,_g=0,_g1=hxsl_TGlobal.__empty_constructs__.slice();_g<_g1.length;){var g=_g1[_g];++_g;var n=""+Std.string(g);n=n.charAt(0).toLowerCase()+HxOverrides.substr(n,1,null),m.set(g,n)}m.set(hxsl_TGlobal.ToInt,"int"),m.set(hxsl_TGlobal.ToFloat,"float"),m.set(hxsl_TGlobal.ToBool,"bool"),m.set(hxsl_TGlobal.LReflect,"reflect"),m.set(hxsl_TGlobal.Mat3x4,"_mat3x4"),m.set(hxsl_TGlobal.VertexID,"gl_VertexID"),m.set(hxsl_TGlobal.InstanceID,"gl_InstanceID"),m.set(hxsl_TGlobal.IVec2,"ivec2"),m.set(hxsl_TGlobal.IVec3,"ivec3"),m.set(hxsl_TGlobal.IVec4,"ivec4"),m.set(hxsl_TGlobal.BVec2,"bvec2"),m.set(hxsl_TGlobal.BVec3,"bvec3"),m.set(hxsl_TGlobal.BVec4,"bvec4"),m.set(hxsl_TGlobal.FragCoord,"gl_FragCoord");for(g=m.iterator();g.hasNext();){var g1=g.next();hxsl_GlslOut.KWDS.h[g1]=!0}return m}(),hxsl_GlslOut.MAT34="struct _mat3x4 { vec4 a; vec4 b; vec4 c; };",hxsl__$Linker_ShaderInfos.UID=0,hxsl_Printer.SWIZ=["x","y","z","w"],hxsl_RuntimeShader.UID=0,hxsl_Serializer.TVECS=new haxe_ds_IntMap,hxsl_Serializer.BOPS=((ops=haxe_macro_Binop.__empty_constructs__.slice()).splice(haxe_macro_Binop.OpAssignOp(null)._hx_index,0,null),ops),hxsl_Serializer.UNOPS=haxe_macro_Unop.__empty_constructs__.slice(),hxsl_Serializer.TGLOBALS=hxsl_TGlobal.__empty_constructs__.slice(),hxsl_Serializer.TSWIZ=new haxe_ds_IntMap,hxsl_Serializer.REGS=[hxsl_Component.X,hxsl_Component.Y,hxsl_Component.Z,hxsl_Component.W],hxsl_Serializer.VKINDS=hxsl_VarKind.__empty_constructs__.slice(),hxsl_Serializer.PRECS=hxsl_Prec.__empty_constructs__.slice(),hxsl_Serializer.FKIND=hxsl_FunctionKind.__empty_constructs__.slice(),hxsl_Serializer.SIGN=9139229,hxsl_SharedShader.UNROLL_LOOPS=!1,sinker_extensions_StringExtension.dot=".",sneaker_format_CallStackItemFormat.hideFilePath=!1,sneaker_format_CallStackItemFormat.hidePackagePath=!0,sneaker_format_CallStackItemFormat.separator=" ",sneaker_format_CallStackItemCallbacks.formatStackIndent=sneaker_format_CallStackItemExtension.formatStackIndent,sneaker_exception_ExceptionSettings.appendCallStackDefault=!1,sneaker_exception_ExceptionSettings.callStackFormat=(_g=sneaker_format_CallStackItemCallbacks.formatStackIndent,function(stack){return _g(stack)}),sneaker_format_PosInfosExtension.noPositionInfo="(No position info)",sneaker_print_Printer.buffer=new sneaker_string_$buffer_StringBufferBox(sneaker_print_PrinterCallbacks.printDirect,null,null),sneaker_print_PrinterSettings.useBuffer=!1,sneaker_tag_Tags.anonymous=new sneaker_tag_Tag("no name",-1),Main.main(),haxe_EntryPoint.run()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);